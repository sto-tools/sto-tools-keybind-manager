const e="v2025.06.22-beta-1",t=new Map;function i(e,i){return t.has(e)||t.set(e,new Set),t.get(e).add(i),()=>{a(e,i)}}function a(e,i){const a=t.get(e);a&&a.delete(i)}function n(e,i){const a=t.get(e);a&&a.forEach(t=>{try{t(i)}catch(t){console.error(`Error in event listener for ${e}:`,t)}})}function s(e,t,i,a){if("string"==typeof e){"function"==typeof i&&void 0===a&&(a=i,i=t);const s=/^[.#]/.test(e)?e:`#${e}`,o=e=>{if(e.target.closest(s)){if(a)try{a(e)}catch(e){console.error(e)}n(i||t,e)}};return document.addEventListener(t,o,!0),()=>{document.removeEventListener(t,o,!0)}}if(!e||!e.addEventListener)return()=>{};if("function"==typeof i&&(a=i,i=t),i||(i=t),a){const s=e=>{try{a(e)}catch(e){console.error(e)}n(i,e)};return e.addEventListener(t,s),()=>{e.removeEventListener(t,s)}}{const a=e=>n(i,e);return e.addEventListener(t,a),()=>{e.removeEventListener(t,a)}}}function o(e,t=250){let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>e.apply(this,a),t)}}var r={on:i,off:a,emit:n,onDom:s,onDomDebounced:function(e,t,i,a,n=250){"number"==typeof a&&(n=a,a=void 0);const r=o(a||(()=>{}),n);return s(e,t,i,e=>{r(e)})},debounce:o,once:function(e,t){const n=i=>{a(e,n),t(i)};i(e,n)},clear:function(){t.clear()},getListenerCount:function(e){const i=t.get(e);return i?i.size:0},getAllListenerCounts:function(){const e={};for(const[i,a]of t)e[i]=a.size;return e},get listeners(){return t}};const c={commands:{targeting:{name:"Targeting",icon:"fas fa-crosshairs",description:"Target selection and management",commands:{target:{name:"Target by Name",command:"Target",description:"Target entity by name (requires quotes)",syntax:'Target "EntityName"',icon:"🎯",customizable:!0,parameters:{entityName:{type:"text",default:"EntityName",placeholder:"Enter entity name"}}},target_enemy_near:{name:"Target Nearest Enemy",command:"Target_Enemy_Near",description:"Target the nearest enemy in view",syntax:"Target_Enemy_Near",icon:"🎯"},target_friend_near:{name:"Target Nearest Friend",command:"Target_Friend_Near",description:"Target the nearest friendly entity",syntax:"Target_Friend_Near",icon:"🤝"},target_self:{name:"Target Self",command:"Target_Self",description:"Target your own ship/character",syntax:"Target_Self",icon:"👤"},target_clear:{name:"Clear Target",command:"Target_Clear",description:"Remove current target lock",syntax:"Target_Clear",icon:"❌"},target_teammate_1:{name:"Target Teammate 1",command:"Target_Teammate 1",description:"Target first team member",syntax:"Target_Teammate 1",icon:"👥"},target_teammate_2:{name:"Target Teammate 2",command:"Target_Teammate 2",description:"Target second team member",syntax:"Target_Teammate 2",icon:"👥"},target_teammate_3:{name:"Target Teammate 3",command:"Target_Teammate 3",description:"Target third team member",syntax:"Target_Teammate 3",icon:"👥"},target_teammate_4:{name:"Target Teammate 4",command:"Target_Teammate 4",description:"Target fourth team member",syntax:"Target_Teammate 4",icon:"👥"}}},combat:{name:"Combat",icon:"fas fa-fire",description:"Weapon firing and combat actions",commands:{fire_all:{name:"Fire All Weapons",command:"FireAll",description:"Fire all weapons",syntax:"FireAll",environment:"space",icon:"🔥",warning:"Not recommended on spam bars as it interferes with firing cycles"},fire_phasers:{name:"Fire Energy Weapons",command:"FirePhasers",description:"Fire all Energy Weapons",syntax:"FirePhasers",environment:"space",icon:"⚡",warning:"Not recommended on spam bars as it interferes with firing cycles"},fire_torps:{name:"Fire Torpedoes",command:"FireTorps",description:"Fire all Torpedos",syntax:"FireTorps",environment:"space",icon:"🚀",warning:"Not recommended on spam bars as it interferes with firing cycles"},fire_mines:{name:"Fire Mines",command:"FireMines",description:"Fire all Mines",syntax:"FireMines",environment:"space",icon:"💣",warning:"Not recommended on spam bars as it interferes with firing cycles"},fire_phasers_torps:{name:"Fire Phasers & Torpedoes",command:"FirePhasersTorps",description:"Fire phasers & torpedos",syntax:"FirePhasersTorps",environment:"space",icon:"💥",warning:"Not recommended on spam bars as it interferes with firing cycles"},fire_projectiles:{name:"Fire Projectiles",command:"FireProjectiles",description:"Fire torpedos & mines",syntax:"FireProjectiles",environment:"space",icon:"🎯",warning:"Not recommended on spam bars as it interferes with firing cycles"},aim:{name:"Aim/Scope",command:"aim",description:"Toggle scope on/off. In scope mode the player does more damage. Can either be used as a toggle or a press and hold",syntax:"aim",environment:"ground",icon:"🎯"},holster:{name:"Holster Weapon",command:"Holster",description:"Attempt to holster your active weapon",syntax:"Holster",environment:"ground",icon:"🔫"},holster_toggle:{name:"Holster Toggle",command:"HolsterToggle",description:"Attempt to holster or draw your weapons",syntax:"HolsterToggle",environment:"ground",icon:"🔄"},unholster:{name:"Unholster Weapon",command:"Unholster",description:"Attempt to draw your active weapon",syntax:"Unholster",environment:"ground",icon:"🔫"},toggle_shooter_mode:{name:"Toggle Shooter Mode",command:"ToggleShooterMode",description:"Toggle shooter mode on/off",syntax:"ToggleShooterMode",environment:"ground",icon:"🎮"},shooter_primary:{name:"Shooter Primary",command:"ShooterPrimary",description:"Primary shooter mode action",syntax:"ShooterPrimary",environment:"ground",icon:"🎯"},shooter_secondary:{name:"Shooter Secondary",command:"Shootersecondary",description:"Secondary shooter mode action",syntax:"Shootersecondary",environment:"ground",icon:"🎯"},shooter_tertiary:{name:"Shooter Tertiary",command:"Shootertertiary",description:"Tertiary shooter mode action",syntax:"Shootertertiary",environment:"ground",icon:"🎯"},shooter_clear_offset_tray_binds:{name:"Shooter Clear Offset Tray Binds",command:"ShooterClearOffsetTrayBinds",description:"Clear the starting location and movement of the yellow action box that appears on the tray while in shooter mode",syntax:"ShooterClearOffsetTrayBinds",environment:"ground",icon:"🧹"},shooter_clear_overlay_tray_binds:{name:"Shooter Clear Overlay Tray Binds",command:"ShooterClearOverlayTrayBinds",description:"Clear overlay tray bindings for shooter mode",syntax:"ShooterClearOverlayTrayBinds",environment:"ground",icon:"🧹"},shooter_set_offset_tray_binds:{name:"Shooter Set Offset Tray Binds",command:"ShooterSetOffsetTrayBinds",description:"Set the starting location and movement of the yellow action box that appears on the tray while in shooter mode",syntax:"ShooterSetOffsetTrayBinds",environment:"ground",icon:"⚙️"},shooter_set_overlay_tray_binds:{name:"Shooter Set Overlay Tray Binds",command:"ShooterSetOverlayTrayBinds",description:"Set overlay tray bindings for shooter mode",syntax:"ShooterSetOverlayTrayBinds",environment:"ground",icon:"⚙️"}}},cosmetic:{name:"Cosmetic",icon:"fas fa-palette",description:"Character appearance and customization",commands:{setactivecostume:{name:"Set Active Costume",command:"setactivecostume",description:"Sets current active costume. Requires two modifiers.",syntax:"setactivecostume <modifier1> <modifier2>",environment:"ground",icon:"👕",customizable:!0,parameters:{modifier1:{type:"text",default:"modifier1",placeholder:"First modifier"},modifier2:{type:"text",default:"modifier2",placeholder:"Second modifier"}}}}},bridge_officer:{name:"Bridge Officer",icon:"fas fa-user-friends",description:"Ground bridge officer control commands",commands:{setrallypoint:{name:"Set Rally Point",command:"Setrallypoint",description:"Set a rally point for your current target",syntax:"Setrallypoint",environment:"ground",icon:"📍"},setrallypointconsole:{name:"Set Rally Point (Console)",command:"Setrallypointconsole",description:"Set a rally point for your current target (console variant)",syntax:"Setrallypointconsole",environment:"ground",icon:"🖥️"},clearrallypoint:{name:"Clear Rally Point",command:"Clearrallypoint",description:"Clear the rally point for your current target",syntax:"Clearrallypoint",environment:"ground",icon:"❌"},clearallrallypoints:{name:"Clear All Rally Points",command:"Clearallrallypoints",description:"Clear all the rally points",syntax:"Clearallrallypoints",environment:"ground",icon:"🧹"},assist:{name:"Assist",command:"Assist",description:'Assist "<name>": Assists the Entity with the matching name. If no name is given, assists your current target.',syntax:"Assist <name>",environment:"ground",icon:"🤝",customizable:!0,parameters:{name:{type:"text",default:"",placeholder:"Entity name (optional)"}}}}},tray:{name:"Tray Execution",icon:"fas fa-th",description:"Execute abilities from action trays",commands:{custom_tray:{name:"Tray Execution",command:"+STOTrayExecByTray 0 0",description:"Execute specific tray slot",syntax:"+STOTrayExecByTray <tray> <slot>",icon:"⚡",customizable:!0,parameters:{tray:{type:"number",min:0,max:9,default:0},slot:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},tray_with_backup:{name:"Tray Execution with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute specific tray slot with backup ability",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot>",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},slot:{type:"number",min:0,max:9,default:0},backup_tray:{type:"number",min:0,max:9,default:0},backup_slot:{type:"number",min:0,max:9,default:0}}},tray_range:{name:"Tray Range Execution",command:"+STOTrayExecByTray 0 0",description:"Execute a range of tray slots",syntax:"+STOTrayExecByTray <tray> <slot> $$ ... (range)",icon:"⚡",customizable:!0,parameters:{start_tray:{type:"number",min:0,max:9,default:0},start_slot:{type:"number",min:0,max:9,default:0},end_tray:{type:"number",min:0,max:9,default:0},end_slot:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},tray_range_with_backup:{name:"Tray Range with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute a range of tray slots with backup abilities",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot> $$ ... (range)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},start_tray:{type:"number",min:0,max:9,default:0},start_slot:{type:"number",min:0,max:9,default:0},end_tray:{type:"number",min:0,max:9,default:0},end_slot:{type:"number",min:0,max:9,default:0},backup_start_tray:{type:"number",min:0,max:9,default:0},backup_start_slot:{type:"number",min:0,max:9,default:0},backup_end_tray:{type:"number",min:0,max:9,default:0},backup_end_slot:{type:"number",min:0,max:9,default:0}}},whole_tray:{name:"Whole Tray Execution",command:"+STOTrayExecByTray 0 0",description:"Execute all slots in a tray",syntax:"+STOTrayExecByTray <tray> <slot> $$ ... (all slots)",icon:"⚡",customizable:!0,parameters:{tray:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},whole_tray_with_backup:{name:"Whole Tray with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute all slots in a tray with backup tray",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot> $$ ... (all slots)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},backup_tray:{type:"number",min:0,max:9,default:0}}}}},power:{name:"Shield Management",icon:"fas fa-shield-alt",description:"Shield power and distribution management",commands:{distribute_shields:{name:"Distribute Shields",command:"+power_exec Distribute_Shields",description:"Evenly distributes shields as if clicking in the middle of the ship and shields icon",syntax:"+power_exec Distribute_Shields",environment:"space",icon:"🛡️",warning:"Not recommended on spam bars as it interferes with firing cycles"},reroute_shields_rear:{name:"Reroute Shields Rear",command:"+power_exec reroute_shields_rear",description:"Route shield power to rear facing",syntax:"+power_exec reroute_shields_rear",environment:"space",icon:"🛡️"},reroute_shields_left:{name:"Reroute Shields Left",command:"+power_exec reroute_shields_left",description:"Route shield power to left side",syntax:"+power_exec reroute_shields_left",environment:"space",icon:"🛡️"},reroute_shields_right:{name:"Reroute Shields Right",command:"+power_exec reroute_shields_right",description:"Route shield power to right side",syntax:"+power_exec reroute_shields_right",environment:"space",icon:"🛡️"},reroute_shields_forward:{name:"Reroute Shields Forward",command:"+power_exec reroute_shields_forward",description:"Route shield power to forward facing",syntax:"+power_exec reroute_shields_forward",environment:"space",icon:"🛡️"}}},movement:{name:"Movement",icon:"fas fa-arrows-alt",description:"Ship movement and navigation",commands:{full_impulse:{name:"Full Impulse",command:"+fullimpulse",description:"Engage full impulse drive",syntax:"+fullimpulse",environment:"space",icon:"🚀"},reverse:{name:"Reverse",command:"+reverse",description:"Reverse engines",syntax:"+reverse",icon:"⬅️"},throttle_adjust:{name:"Throttle Adjust",command:"ThrottleAdjust",description:"Increase or decrease the throttle by amount",syntax:"ThrottleAdjust <amount>",icon:"⚡",customizable:!0,parameters:{amount:{type:"number",min:-1,max:1,default:.25,step:.05}}},throttle_set:{name:"Throttle Set",command:"ThrottleSet",description:"Set the throttle to a specific position (negative = reverse, 0 = stop)",syntax:"ThrottleSet <position>",icon:"🎛️",customizable:!0,parameters:{position:{type:"number",min:-1,max:1,default:1,step:.1}}},throttle_toggle:{name:"Throttle Toggle",command:"ThrottleToggle",description:"Alternates between full throttle and full stop",syntax:"ThrottleToggle",icon:"🔄"},turn_left:{name:"Turn Left",command:"+turnleft",description:"Turn ship left (continuous while held)",syntax:"+turnleft",icon:"↪️"},turn_right:{name:"Turn Right",command:"+turnright",description:"Turn ship right (continuous while held)",syntax:"+turnright",icon:"↩️"},pitch_up:{name:"Pitch Up",command:"+up",description:"Pitch ship nose up (space altitude change)",syntax:"+up",icon:"⬆️"},pitch_down:{name:"Pitch Down",command:"+down",description:"Pitch ship nose down (space altitude change)",syntax:"+down",icon:"⬇️"},strafe_left:{name:"Strafe Left",command:"+left",description:"Strafe ship left",syntax:"+left",icon:"⬅️"},strafe_right:{name:"Strafe Right",command:"+right",description:"Strafe ship right",syntax:"+right",icon:"➡️"},forward:{name:"Forward",command:"+forward",description:"Move forward",syntax:"+forward",icon:"⬆️"},backward:{name:"Backward",command:"+backward",description:"Move backward",syntax:"+backward",icon:"⬇️"},auto_forward:{name:"Auto Forward",command:"autoForward",description:"Character moves forward until given new movement commands",syntax:"autoForward",environment:"ground",icon:"🏃"},follow:{name:"Follow Target",command:"Follow",description:"Follow the targeted entity",syntax:"Follow",icon:"👥"},follow_cancel:{name:"Cancel Follow",command:"Follow_Cancel",description:"Stop following and forget about the target",syntax:"Follow_Cancel",icon:"❌"}}},camera:{name:"Camera",icon:"fas fa-video",description:"Camera control and view management",commands:{zoom_in:{name:"Zoom In",command:"Camzoomin",description:"Zoom the camera in",syntax:"Camzoomin",icon:"🔍"},zoom_out:{name:"Zoom Out",command:"Camzoomout",description:"Zoom the camera out",syntax:"Camzoomout",icon:"🔎"},zoom_in_small:{name:"Zoom In Small",command:"Camzoominsmall",description:"Zoom the camera in slightly",syntax:"Camzoominsmall",icon:"🔍"},zoom_out_small:{name:"Zoom Out Small",command:"Camzoomoutsmall",description:"Zoom the camera out slightly",syntax:"Camzoomoutsmall",icon:"🔎"},cam_distance:{name:"Set Camera Distance",command:"camdist",description:"Sets the camera distance from the player",syntax:"camdist <distance>",icon:"📏",customizable:!0,parameters:{distance:{type:"number",min:1,max:500,default:50}}},cam_reset:{name:"Reset Camera",command:"CamReset",description:"Reset the camera position to default",syntax:"CamReset",icon:"🔄"},cam_target_lock:{name:"Lock Camera to Target",command:"Camsetlocktotarget",description:"Lock or unlock the camera to the target",syntax:"Camsetlocktotarget",icon:"🎯"},cam_cycle_distance:{name:"Cycle Camera Distance",command:"camCycleDist",description:"Cycle the camera distance between several preset values",syntax:"camCycleDist",icon:"🔄"},cam_mouse_look:{name:"Mouse Look",command:"+camMouseLook",description:"Enable mouse look camera control",syntax:"+camMouseLook",icon:"🖱️"},cam_turn_to_face:{name:"Turn to Face Camera",command:"+camTurnToFace",description:"Turn ship to face camera direction",syntax:"+camTurnToFace",icon:"↪️"},look_up:{name:"Look Up",command:"lookUp",description:"Change point of view to look straight up",syntax:"lookUp",icon:"⬆️"},look_down:{name:"Look Down",command:"lookDown",description:"Change point of view to look straight down",syntax:"lookDown",icon:"⬇️"}}},communication:{name:"Communication",icon:"fas fa-comments",description:"Chat and team communication",commands:{team_message:{name:"Team Message",command:"team",description:"Send message to team",syntax:"team message",icon:"💬",customizable:!0,parameters:{verb:{type:"select",default:"team",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}},local_message:{name:"Local Message",command:"say",description:"Send message to local area",syntax:"say message",icon:"📢",customizable:!0,parameters:{verb:{type:"select",default:"say",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}},zone_message:{name:"Zone Message",command:"zone",description:"Send message to zone",syntax:"zone message",icon:"📡",customizable:!0,parameters:{verb:{type:"select",default:"zone",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}}}},system:{name:"System",icon:"fas fa-cog",description:"UI and system commands",commands:{toggle_hud:{name:"Toggle HUD",command:"+GenToggleHUD",description:"Toggle HUD visibility",syntax:"+GenToggleHUD",icon:"👁️"},screenshot:{name:"Screenshot",command:"screenshot",description:"Take a screenshot",syntax:"screenshot",icon:"📷"},screenshot_jpg:{name:"Screenshot JPG",command:"screenshot_jpg",description:"Save a screenshot as JPG",syntax:"screenshot_jpg",icon:"📷"},autofire_toggle:{name:"Toggle Autofire",command:"+GenToggleAutofire",description:"Toggle weapon autofire",syntax:"+GenToggleAutofire",icon:"🔁"},bind_save_file:{name:"Save Binds to File",command:"bind_save_file",description:"Save all your binds to a text file",syntax:"bind_save_file <filename>",icon:"💾",customizable:!0,parameters:{filename:{type:"text",default:"my_binds.txt"}}},bind_load_file:{name:"Load Binds from File",command:"bind_load_file",description:"Load a bind file into the client",syntax:"bind_load_file <filename>",icon:"📁",customizable:!0,parameters:{filename:{type:"text",default:"my_binds.txt"}}},combat_log:{name:"Toggle Combat Log",command:"CombatLog",description:"Turn combat log recording on/off (1=on, 0=off)",syntax:"CombatLog <1/0>",icon:"📊",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},chat_log:{name:"Toggle Chat Log",command:"ChatLog",description:"Turn chat log recording on/off (1=on, 0=off)",syntax:"ChatLog <1/0>",icon:"💬",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},missions:{name:"Show/Hide Missions",command:"missions",description:"Show/hide the mission journal",syntax:"missions",icon:"📋"},inventory:{name:"Show/Hide Inventory",command:"Inventory",description:"Show/hide your inventory",syntax:"Inventory",icon:"🎒"},map:{name:"Show/Hide Map",command:"Map",description:"Show/hide the map window",syntax:"Map",icon:"🗺️"},logout:{name:"Logout",command:"logout",description:"Log out the current character",syntax:"logout",icon:"🚪"},quit:{name:"Quit Game",command:"quit",description:"Close the window",syntax:"quit",icon:"❌"},goto_character_select:{name:"Go to Character Select",command:"gotoCharacterSelect",description:"Go to the character select screen without logging out",syntax:"gotoCharacterSelect",icon:"👤"},ui_load:{name:"Load UI Settings",command:"ui_load",description:"Loads default UI Windows save file, usually Live\\ui_settings.txt",syntax:"ui_load",icon:"📂"},ui_load_file:{name:"Load UI Settings File",command:"ui_load_file",description:"Loads named UI Windows save file",syntax:"ui_load_file <filename>",icon:"📂",customizable:!0,parameters:{filename:{type:"text",default:"ui_settings.txt"}}},ui_save:{name:"Save UI Settings",command:"ui_save",description:"Saves UI layout to default UI Window save file, usually Live\\ui_settings.txt",syntax:"ui_save",icon:"💾"},ui_save_file:{name:"Save UI Settings File",command:"ui_save_file",description:"Saves UI layout to named UI Window save file",syntax:"ui_save_file <filename>",icon:"💾",customizable:!0,parameters:{filename:{type:"text",default:"ui_settings.txt"}}},ui_cancel:{name:"UI Cancel",command:"uiCancel",description:'Respond "Cancel" to an open dialog box; may not work in all dialogs',syntax:"uiCancel",icon:"❌"},ui_ok:{name:"UI OK",command:"uiOK",description:'Respond "OK" to an open dialog box; may not work in all dialogs',syntax:"uiOK",icon:"✅"},ui_gen_layers_reset:{name:"Reset UI Layout",command:"ui_GenLayersReset",description:"Resets the layout, used for when the server updates movable window positions",syntax:"ui_GenLayersReset",icon:"🔄"},ui_resolution:{name:"Print UI Resolution",command:"ui_resolution",description:"Print the current UI screen resolution",syntax:"ui_resolution",icon:"📐"},ui_tooltip_delay:{name:"Set Tooltip Delay",command:"ui_TooltipDelay",description:"Sets the additional delay, in seconds, before tooltips appear",syntax:"ui_TooltipDelay <seconds>",icon:"⏱️",customizable:!0,parameters:{seconds:{type:"number",min:0,max:10,default:.5,step:.1}}},remember_ui_lists:{name:"Remember UI Lists",command:"RememberUILists",description:"Whether to remember UI List Column placement and width",syntax:"RememberUILists <1/0>",icon:"📋",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},ui_remember_positions:{name:"Remember UI Positions",command:"UIRememberPositions",description:"Whether to remember UI sizes and positions. On by default",syntax:"UIRememberPositions <1/0>",icon:"📍",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},safe_login:{name:"Safe Login",command:"SafeLogin",description:"If true, then log the player back into their most recent static map instead of anything else",syntax:"SafeLogin <1/0>",icon:"🛡️",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},show_game_ui:{name:"Show Game UI",command:"ShowGameUI",description:"Show the game UI",syntax:"ShowGameUI",icon:"🎮"},show_game_ui_no_extra_keybinds:{name:"Show Game UI (No Extra Keybinds)",command:"ShowGameUINoExtraKeyBinds",description:"This command does not add any keybinds for showing the UI when the user presses escape",syntax:"ShowGameUINoExtraKeyBinds",icon:"🎮"},change_instance:{name:"Change Instance",command:"ChangeInstance",description:"Change to an already created instance of the same map. Only works while not at red alert",syntax:"ChangeInstance",icon:"🔄"},net_timing_graph:{name:"Net Timing Graph",command:"netTimingGraph",description:"Enable or disable the network timing graph (0=disable, 1=enable)",syntax:"netTimingGraph <0/1>",icon:"📊",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},net_timing_graph_alpha:{name:"Net Timing Graph Alpha",command:"netTimingGraphAlpha",description:"Set transparency level for network timing graph (50=highest transparency, 255=no transparency)",syntax:"netTimingGraphAlpha <50-255>",icon:"🎨",customizable:!0,parameters:{alpha:{type:"number",min:50,max:255,default:255}}},net_timing_graph_paused:{name:"Net Timing Graph Paused",command:"netTimingGraphPaused",description:"Pause or resume the network timing graph (0=pause disabled, 1=pause enabled)",syntax:"netTimingGraphPaused <0/1>",icon:"⏸️",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:0}}},netgraph:{name:"Net Graph",command:"netgraph",description:"Display SND and RCV network data as text (1=enabled, 0=disabled)",syntax:"netgraph <0/1>",icon:"🌐",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}}}}},templates:{space_combat:{basic_attack:{name:"Basic Attack Sequence",description:"Target enemy and fire all weapons",commands:["Target_Enemy_Near","FireAll"]},defensive_sequence:{name:"Defensive Sequence",description:"Target self and activate defensive abilities",commands:["Target_Self","+power_exec Distribute_Shields"]},alpha_strike:{name:"Alpha Strike",description:"Full offensive sequence with buffs",commands:["Target_Enemy_Near","FireAll"]},healing_sequence:{name:"Emergency Healing",description:"Self-healing and damage control",commands:["Target_Self","+power_exec Distribute_Shields"]}},ground_combat:{basic_ground_attack:{name:"Basic Ground Attack",description:"Target and attack sequence for ground combat",commands:["Target_Enemy_Near","+STOTrayExecByTray 0 0"]}}},defaultProfiles:{default_space:{name:"Default Space",description:"Basic space combat configuration",currentEnvironment:"space",builds:{space:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_1"},{command:"FireAll",type:"combat",icon:"🔥",text:"Fire all weapons",id:"cmd_2"}]}},ground:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_g1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Primary attack",id:"cmd_g2"}]}}},aliases:{AttackCall:{description:"Call out attack target to team",commands:"team Attacking [$Target] - focus fire!"},TargetReport:{description:"Report current target to team",commands:"team Current target: [$Target]"},HealCall:{description:"Request healing for target",commands:"team Need healing on [$Target]!"}}},tactical_space:{name:"Tactical Space",description:"Aggressive DPS-focused space build",currentEnvironment:"space",builds:{space:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Execute Tray 1 Slot 1",id:"cmd_2"},{command:"FireAll",type:"combat",icon:"🔥",text:"Fire all weapons",id:"cmd_3"},{command:"+power_exec Distribute_Shields",type:"power",icon:"🛡️",text:"Distribute shields",id:"cmd_4"}],1:[{command:"+STOTrayExecByTray 1 0",type:"tray",icon:"⚡",text:"Execute Tray 2 Slot 1",id:"cmd_5"}],F1:[{command:"Target_Self",type:"targeting",icon:"👤",text:"Target self",id:"cmd_6"},{command:"+STOTrayExecByTray 2 0",type:"tray",icon:"⚡",text:"Execute Tray 3 Slot 1",id:"cmd_7"}]}},ground:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_g1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Primary attack",id:"cmd_g2"}],1:[{command:"+STOTrayExecByTray 0 1",type:"tray",icon:"⚡",text:"Secondary attack",id:"cmd_g3"}],F1:[{command:"Target_Self",type:"targeting",icon:"👤",text:"Target self",id:"cmd_g4"},{command:"+STOTrayExecByTray 1 0",type:"tray",icon:"💊",text:"Heal self",id:"cmd_g5"}]}}},aliases:{}}},keys:{common:{name:"Common Keys",description:"Most frequently used keys",keys:[{key:"Space",description:"Spacebar"},{key:"1",description:"Number 1"},{key:"2",description:"Number 2"},{key:"3",description:"Number 3"},{key:"4",description:"Number 4"},{key:"5",description:"Number 5"},{key:"F1",description:"Function Key 1"},{key:"F2",description:"Function Key 2"},{key:"F3",description:"Function Key 3"},{key:"F4",description:"Function Key 4"},{key:"Tab",description:"Tab"},{key:"enter",description:"Main Enter Key"},{key:"Shift",description:"Shift"},{key:"Control",description:"Control"},{key:"ALT",description:"Alt"}]},letters:{name:"Letter Keys",description:"A-Z keyboard letters",keys:[{key:"A",description:"Key A"},{key:"B",description:"Key B"},{key:"C",description:"Key C"},{key:"D",description:"Key D"},{key:"E",description:"Key E"},{key:"F",description:"Key F"},{key:"G",description:"Key G"},{key:"H",description:"Key H"},{key:"I",description:"Key I"},{key:"J",description:"Key J"},{key:"K",description:"Key K"},{key:"L",description:"Key L"},{key:"M",description:"Key M"},{key:"N",description:"Key N"},{key:"O",description:"Key O"},{key:"P",description:"Key P"},{key:"Q",description:"Key Q"},{key:"R",description:"Key R"},{key:"S",description:"Key S"},{key:"T",description:"Key T"},{key:"U",description:"Key U"},{key:"V",description:"Key V"},{key:"W",description:"Key W"},{key:"X",description:"Key X"},{key:"Y",description:"Key Y"},{key:"Z",description:"Key Z"}]},numbers:{name:"Number Keys",description:"Number row and numpad",keys:[{key:"0",description:"Number 0"},{key:"6",description:"Number 6"},{key:"7",description:"Number 7"},{key:"8",description:"Number 8"},{key:"9",description:"Number 9"},{key:"numpad0",description:"Numerical Keypad 0"},{key:"numpad1",description:"Numerical Keypad 1"},{key:"numpad2",description:"Numerical Keypad 2"},{key:"numpad3",description:"Numerical Keypad 3"},{key:"numpad4",description:"Numerical Keypad 4"},{key:"numpad5",description:"Numerical Keypad 5"},{key:"numpad6",description:"Numerical Keypad 6"},{key:"numpad7",description:"Numerical Keypad 7"},{key:"numpad8",description:"Numerical Keypad 8"},{key:"numpad9",description:"Numerical Keypad 9"},{key:"Decimal",description:"Numerical Keypad Decimal"},{key:"Divide",description:"Numerical Keypad Divide"},{key:"Multiply",description:"Multiply (*)"},{key:"Subtract",description:"Subtract (-)"},{key:"Add",description:"Add (+)"},{key:"numpadenter",description:"Numerical Keypad Enter"}]},function:{name:"Function Keys",description:"F1-F24 function keys",keys:[{key:"F5",description:"Function Key 5"},{key:"F6",description:"Function Key 6"},{key:"F7",description:"Function Key 7"},{key:"F8",description:"Function Key 8"},{key:"F9",description:"Function Key 9"},{key:"F10",description:"Function Key 10"},{key:"F11",description:"Function Key 11"},{key:"F12",description:"Function Key 12"},{key:"F13",description:"Function Key 13"},{key:"F14",description:"Function Key 14"},{key:"F15",description:"Function Key 15"},{key:"F16",description:"Function Key 16"},{key:"F17",description:"Function Key 17"},{key:"F18",description:"Function Key 18"},{key:"F19",description:"Function Key 19"},{key:"F20",description:"Function Key 20"},{key:"F21",description:"Function Key 21"},{key:"F22",description:"Function Key 22"},{key:"F23",description:"Function Key 23"},{key:"F24",description:"Function Key 24"}]},arrows:{name:"Arrow & Navigation",description:"Arrow keys and navigation",keys:[{key:"Up",description:"Arrow Key: Up"},{key:"Down",description:"Arrow Key: Down"},{key:"Left",description:"Arrow Key: Left"},{key:"Right",description:"Arrow Key: Right"},{key:"Home",description:"Home"},{key:"End",description:"End"},{key:"PageUp",description:"Page Up"},{key:"PageDown",description:"Page Down"},{key:"insert",description:"Insert"},{key:"delete",description:"Delete"}]},modifiers:{name:"Modifier Keys",description:"Shift, Ctrl, Alt variations",keys:[{key:"ALT",description:"Alt"},{key:"LALT",description:"Alt (Left)"},{key:"RALT",description:"Alt (Right)"},{key:"CTRL",description:"Control"},{key:"LCTRL",description:"Control (Left)"},{key:"RCTRL",description:"Control (Right)"}]},symbols:{name:"Symbol Keys",description:"Punctuation and symbols",keys:[{key:"[",description:"["},{key:"]",description:"]"},{key:"\\",description:"\\"},{key:",",description:"Comma (,)"},{key:".",description:"Period (.)"},{key:"/",description:"Divide (/)"},{key:"`",description:"Tilda Key (~)"}]},mouse:{name:"Mouse Controls",description:"Mouse buttons and scroll",keys:[{key:"Lbutton",description:"Mouse Left Press"},{key:"Rbutton",description:"Mouse Right Press"},{key:"Middleclick",description:"Mouse Middle Click"},{key:"Button1",description:"Mouse Button 1"},{key:"Button2",description:"Mouse Button 2"},{key:"Button3",description:"Mouse Button 3"},{key:"Button4",description:"Mouse Button 4"},{key:"Button5",description:"Mouse Button 5"},{key:"Button6",description:"Mouse Button 6"},{key:"Button7",description:"Mouse Button 7"},{key:"Button8",description:"Mouse Button 8"},{key:"Button9",description:"Mouse Button 9"},{key:"Button10",description:"Mouse Button 10"},{key:"Wheelplus",description:"Mouse Scroll Up"},{key:"Wheelminus",description:"Mouse Scroll Down"}]},gamepad:{name:"Xbox Controller",description:"Xbox/Gamepad controls",keys:[{key:"Joy1",description:"XBOX Contr [Start]"},{key:"Joy2",description:"XBOX Contr [Back]"},{key:"Joy3",description:"XBOX Contr [L Thumb depress]"},{key:"Joy4",description:"XBOX Contr [R Thumb depress]"},{key:"Joy5",description:"XBOX Contr [Left Bumper]"},{key:"Joy6",description:"XBOX Contr [Right Bumper]"},{key:"Joy7",description:"XBOX Contr [Left Trigger]"},{key:"Joy8",description:"XBOX Contr [Right Trigger]"},{key:"Joy9",description:"XBOX Contr [A Button]"},{key:"Joy10",description:"XBOX Contr [B Button]"},{key:"Joy11",description:"XBOX Contr [X Button]"},{key:"Joy12",description:"XBOX Contr [Y Button]"},{key:"Joypad_up",description:"XBOX Contr [Pad up]"},{key:"Joypad_down",description:"XBOX Contr [Pad down]"},{key:"Joypad_left",description:"XBOX Contr [Pad left]"},{key:"Joypad_right",description:"XBOX Contr [Pad right]"},{key:"Lstick_up",description:"XBOX Contr [Left Stick up]"},{key:"Lstick_down",description:"XBOX Contr [Left Stick down]"},{key:"Lstick_left",description:"XBOX Contr [Left Stick left]"},{key:"Lstick_right",description:"XBOX Contr [Left Stick right]"},{key:"Rstick_up",description:"XBOX Contr [Right Stick up]"},{key:"Rstick_down",description:"XBOX Contr [Right Stick down]"},{key:"Rstick_left",description:"XBOX Contr [Right Stick left]"},{key:"Rstick_right",description:"XBOX Contr [Right Stick right]"}]}},validation:{keyNamePattern:/^[a-zA-Z0-9_+\-\s]+$/,aliasNamePattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,maxCommandsPerKey:20,maxKeysPerProfile:100},settings:{version:"1.0.0",autoSave:!0,maxUndoSteps:50,defaultMode:"space",language:"en"},variables:{target:{variable:"$Target",description:"Replaced with the name of your current target",example:"team Target [$Target]",usableIn:["communication","custom","aliases"],notes:"If your target's name is 'froggyMonster', this will output 'Target [froggyMonster]'"}},vfxEffects:{space:[{label:"Advanced inhibiting turret shield bubble",effect:"Fx_Rep_Temporal_Ship_Chroniton_Stabilization_Proc"},{label:"Approaching Agony",effect:"Cfx_Lockboxfx_Cb29_Ship_Agony_Field"},{label:"Attack Pattern Alpha",effect:"Fx_Ship_Tac_Attackpatternalpha"},{label:"Attack Pattern Beta",effect:"Fx_Ship_Tac_Attackpatternbeta"},{label:"Attack Pattern Delta",effect:"Fx_Ship_Tac_Attackpatterndelta"},{label:"Attack Pattern Omega",effect:"Fx_Ship_Tac_Attackpatternomega"},{label:"Beacon of Kahless",effect:"Fx_Er_Bbs_Beacon_Of_Kahless_Flash"},{label:"Boost Morale",effect:"Fx_Ship_Spec_Powers_Command_Boost_Morale_Bufffx,Cfx_Ship_Spec_Powers_Command_Boost_Morale_Activate"},{label:"Brace for Impact",effect:"Fx_Bop_Braceforimpact,Cfx_Ship_Sci_Hazardemitter_Buff"},{label:"Breath of the Dragon",effect:"Fx_Ship_Cp_T6_Hysperian_Dragonbreath"},{label:"Call Emergency Artillery",effect:"Fx_Ships_Boffs_Cmd_Callartillery_Activate,Fx_Ships_Boffs_Cmd_Callartillery_Explosion"},{label:"Competitive Engine Buff Effect",effect:"Fx_Ship_Mod_Haste_Buff_Gen"},{label:"Co-opt Energy Weapons",effect:"Fx_Capt_Powers_Ship_Sci_Coopt_Energy_Wep_Aoe,Cfx_Capt_Powers_Ship_Sci_Coopt_Energy_Wep_Area"},{label:"Concentrate Fire Power",effect:"Fx_Ships_Boff_Cmd_Confire_Activatefx,Cfx_Ships_Boff_Cmd_Confire_Mark"},{label:"Cnidarian Jellyfish AoE",effect:"Cfx_Ship_Sp_T6_Jellyfish_Cnidarian_Defense_Aoe"},{label:"Dark Matter Anomaly",effect:"Cfx_Ship_Console_Dark_Matter_Anamoly_Costumefx"},{label:"Delphic Tear",effect:"Fx_Ships_Consoles_Cb21_Delphictear"},{label:"Destabilising Resonance Beam",effect:"P_Er_Ship_Destabilizing_Resonance_Beam_Aoe_Particles"},{label:"Elachi Walker Combat Pet (3 effects)",effect:"Soundfx_Elachiwalker_Footstep_Pet,Fx_Er_Tfo_Elachi_Walker_Combat_Pet_Deathfx,Soundfx_Elachiwalker_Petsummon"},{label:"Electrified Anomalies Trait",effect:"Fx_Tp_Ship_T6_Risian_Science_Electrified_Anomalies_Arc_Foe,Fx_Tp_Ship_T6_Risian_Science_Electrified_Anomalies_Arc_Friend"},{label:"Emergency Pwr to Shields",effect:"Fx_Ship_Eng_Emergencypowershields"},{label:"Emergency Pwr to Wep",effect:"Fx_Ship_Eng_Emergencypowerweapons"},{label:"Engineering Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Engineering_Teambuff"},{label:"Engineering Team",effect:"Cfx_Ship_Crewteam_Engineeringteam_Buff"},{label:"EPS Power Transfer",effect:"Cfx_Ship_Eng_Epspowertransfer_Target"},{label:"Focus Frenzy",effect:"Fx_Skilltree_Ship_Ffrenzy_Activatefx"},{label:"Go Down Fighting",effect:"Fx_Bop_Godownfighting"},{label:"Hangar Pet Rank Up",effect:"Fx_Ship_Levelup_Fighter_Rankup"},{label:"Hazard Emitters",effect:"Cfx_Ship_Sci_Hazardemitter_Buff"},{label:"Intel Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Intel_Teambuff"},{label:"Intel Team (uses 3 effects)",effect:"Cfx_Ship_Cruiser_Auras_Taunt,Cfx_Spc_Boffpowers_Intel_Intelteam_Buff,Fx_Ships_Intel_Lyinginwait"},{label:"Kemocite on ship animation",effect:"C1_E_Ship_Xindi_Lockboxcb15_Kemocite_Weaponry_Bufffx"},{label:"Kemocite HitFX ring",effect:"Fx_Ship_Xindi_Lockboxcb15_Kemocite_Weaponry_Aoe_Proc"},{label:"Kentari Ferocity Weapons Glow",effect:"P_Trait_Powers_Ship_Lukari_Colony_Kentari_Ferocity_Weapons_Glow"},{label:"Kobayashi Maru powerup silenced",effect:"Fx_Evr_Kmaru_Ship_Dev_Resupply_Drop_Powerup_Bufffx,Fx_Evr_Kmaru_Ship_Dev_Resupply_Drop_Powerup"},{label:"Less Obvious Loot Drop Common",effect:"Cfx_Space_Loot_Drop_Common_Costumefx"},{label:"Less Obvious Loot Drop Uncommon",effect:"Cfx_Space_Loot_Drop_Uncommon_Costumefx"},{label:"Less Obvious Loot Drop Rare",effect:"Cfx_Space_Loot_Drop_Rare_Costumefx"},{label:"Less Obvious Loot Drop Very Rare",effect:"Cfx_Space_Loot_Drop_Veryrare_Costumefx"},{label:"Less Obvious Loot Drop Lock Box",effect:"Cfx_Space_Loot_Drop_Chancebox_Costumefx"},{label:"Less Obvious Loot Drop Dilithium",effect:"Cfx_Space_Loot_Drop_Dilithium_Costumefx"},{label:"Miraculous Repairs",effect:"Fx_Bop_Miracleworker"},{label:"MW - Align Shield Frequencies",effect:"Fx_Spc_Boffpowers_Miracleworker_Alignshieldfrequencies_Hitfx"},{label:"MW - Destabilize Warp Core",effect:"Fx_Spc_Boffpowers_Miracleworker_Destabilizewarpcore"},{label:"MW - Exceed rated limits",effect:"Fx_Spc_Boffpowers_Miracleworker_Energyweaponsexceedratedlimits_Dot_Hitfx,Fx_Spc_Boffpowers_Miracleworker_Energyweaponsexceedratedlimits"},{label:"MW - Fix em up (and other green glows)",effect:"Fx_Ship_Mod_Damage_Buff"},{label:"MW - Mixed Armaments Synergy",effect:"Fx_Spc_Boffpowers_Miracleworker_Mixedarmamentssynergy"},{label:"MW - Narrow Sensor Bands",effect:"Fx_Spc_Boffpowers_Miracleworker_Narrowsensorbands"},{label:"MW - Null Pointer Flood",effect:"Fx_Spc_Boffpowers_Miracleworker_Nullpointerflood"},{label:"MW - Reroute shilds to Hull containment",effect:"Fx_Spc_Boffpowers_Miracleworker_Rerouteshieldstohullcontainment,Cfx_Spc_Boffpowers_Miracleworker_Rerouteshieldstohullcontainment"},{label:"Nadion Inversion",effect:"Fx_Bop_Nadioinversion"},{label:"Nanoprobe Shield Generator (Dyson Rep)",effect:"Cfx_Rp_Dyson_Ship_Reactive_Shielding"},{label:"Neutronic Eddies",effect:"Cfx_Ships_Cp_T6_Risian_Science_Neutronic_Edides_Costumefx"},{label:"Overwhelm Emitters",effect:"Fx_Ships_Boff_Cmd_Owemitters_Activatefx"},{label:"Photonic Officer",effect:"Fx_Bop_Photonicofficer_activate"},{label:"PILOT - Clean Getaway",effect:"Fx_Spc_Boff_Pilot_Cleangetaway_Activate"},{label:"PILOT - Coolant Ignition (mostly)",effect:"Fx_Spc_Boff_Pilot_Coolantinjection_Ignite,Fx_Spc_Boff_Pilot_Coolantinjection_Costumefx"},{label:"PILOT - Deploy Countermeasures",effect:"Fx_Spc_Boff_Pilot_Deploycm"},{label:"PILOT - Fly her apart",effect:"Cfx_Spc_Boff_Pilot_Flyapart_Dot"},{label:"PILOT - Form Up (mostly)",effect:"Fx_Spc_Boff_Pilot_Formup_Teleport,Fx_Spc_Boff_Pilot_Formup_Buff_Wepbuff"},{label:"PILOT - hold Together",effect:"Cfx_Spc_Boff_Pilot_Holdtogether"},{label:"PILOT - Lambda",effect:"Fx_Ship_Mod_Damage_Buff,Fx_Spc_Boff_Pilot_Aplambda_Bufffx,Fx_Spc_Boff_Pilot_Aplambda"},{label:"PILOT - Lock Trajectory",effect:"Fx_Spc_Boff_Pilot_Flares_Switch,Cfx_Spc_Boff_Pilot_Locktrajectory"},{label:"PILOT - Pilot Team",effect:"Cfx_Spc_Boff_Pilot_Pilotteam_Buff"},{label:"PILOT - Reroute Reserves to Weapons",effect:"Fx_Spc_Boff_Pilot_Reroute_Wepbuff,Fx_Spc_Boff_Pilot_Reroute_Activate"},{label:"PILOT - Subspace Boom",effect:"Cfx_Spc_Boff_Pilot_Ssboom_Costumefx_Neverdie,Fx_Spc_Boff_Pilot_Ssboom_Boom"},{label:"Plasma Storm",effect:"Cfx_Ship_Cp_Cb27_Generate_Plasma_Storm_Costumefx"},{label:"Rally Point Marker",effect:"Cfx_Ships_Boff_Cmd_Rallypoint_Marker"},{label:"Reverse Shield Polarity",effect:"Cfx_Ship_Eng_Reverseshieldpolarity_Buff"},{label:"Scattering Field",effect:"Cfx_Ship_Sci_Dampeningfield_Aoe,Cfx_Ship_Sci_Dampeningfield_Shield_Buff"},{label:"Science Team",effect:"Cfx_Ship_Crewteam_Scienceteam_Buff"},{label:"Science Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Science_Teambuff"},{label:"Soliton Wave Generator (uses 4 effects)",effect:"Cfx_Ship_Risa_Loot_Soliton_Wave_Suckfx_Target,Cfx_Ship_Risa_Loot_Soliton_Wave_Suckfx,Cfx_Ship_Risa_Loot_Soliton_Wave_Out,Cfx_Ship_Risa_Loot_Soliton_Wave_In"},{label:"Spore Infused Anomalies",effect:"Fx_Trait_Powers_Ship_T6_Somerville_Sia_Blast"},{label:"Subspace Vortex Teleport Effect",effect:"Fx_Ship_Xindi_Lockboxcb15_Subspace_Vortex_Teleport"},{label:"Suppression Barrage",effect:"Cfx_Ships_Boff_Cmd_Sbarrage_Buff"},{label:"Surgical Strikes",effect:"Fx_Spc_Boffpowers_Int_Sstrikes_Buff"},{label:"Tactical Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Tactical_Teambuff"},{label:"Tactical Initiative",effect:"Fx_Bop_Tacticalinitiative"},{label:"Tactical Team",effect:"Cfx_Ship_Crewteam_Tacticalteam_Buff"},{label:"Target Rich Environment",effect:"Fx_Ship_Trait_Cb20_Targetrichenvironment"},{label:"Temporal Anchor",effect:"Cfx_Ship_Trait_Temporal_Anchor_Costumefx"},{label:"Temporal Vortex Probe",effect:"C1_Eventreward_Fcd_Temporal_Vortex_Costumefx,Fx_Eventreward_Fcd_Temporal_Vortex_Blast"},{label:"Timeline Collapse (5 effects!)",effect:"Cfx_Ship_Temp_Tcollapse_Costume,Fx_Ship_Temp_Tcollapse_Hitfx,Fx_Ship_Temp_Tcollapse_Explode,Fx_Ship_Temp_Tcollapse_Beamhitfx,Fx_Ship_Temp_Tcollapse"},{label:"V'Ger Torpedo (Volatile Digital Transformation)",effect:"Fx_Ship_Torpedo_Plasma_Vger_Anniv_Explode,Cfx_Ship_Torpedo_Vger_Disintegrate_In_Tintable"},{label:"Viral Impulse Burst",effect:"Fx_Spc_Boffpowers_int_Viralimpulse"},{label:"Vulcan Jelly Fish Eject Red Matter",effect:"Cfx_ship_jellyfish_eject_red_matter_costumefx"},{label:"Vulnerability Assessment Sweep",effect:"Fx_Capt_Powers_Ship_Tac_Vulnerability_Assessment_Sweep"}],ground:[{label:"Agony Field Generator",effect:"Fx_Ground_Lockboxfx_Cb29_Agony_Field_Generator"},{label:"Anti-time ground",effect:"Cfx_Rep_Temp_Char_Kit_Sci_Antitime_Entanglement_Field_Costumefx"},{label:"Ball Lightning",effect:"Cfx_Char_Kit_Univ_Sum_Ball_Lightning_Costumefx"},{label:"Chaos Blaze",effect:"Cfx_Char_Chaos_Blaze_Aoe"},{label:"Conussive Tachyon Emission",effect:"fx_Char_Delta_Rep_Cte_Aoe"},{label:"Disco Ball (Party Bomb)",effect:"Cfx_Char_Device_Partybomb"},{label:"Dot-7 Drone Support Field",effect:"Cfx_Er_Bbs_char_Dot7_Drone_support_Field"},{label:"Eng Proficiency (Character Glow)",effect:"Cfx_Ground_Kit_Eng_Engineeringproficiency"},{label:"Ever Watchful",effect:"Cfx_Ground_Kit_Tac_Overwatch_Bufffx,Fx_Ground_Kit_Tac_Overwatch_Activatefx"},{label:"Herald AP Beam Projector ground weapon",effect:"Fx_Char_Icoenergy_Rifle_Energyblast,Fx_Char_Icoenergy_Assault_Beam_Lockbox"},{label:"Lava Floor",effect:"Cfx_Char_Kit_Univ_Sum_The_Floor_Is_Lava_Costumefx,Cfx_Char_Kit_Univ_Sum_The_Floor_Is_Lava_Geyser"},{label:"Less Obvious Loot Drop Common",effect:"Cfx_Gnd_Loot_Drop_Common_Costumefx"},{label:"Less Obvious Loot Drop Uncommon",effect:"Cfx_Gnd_Loot_Drop_Uncommon_Costumefx"},{label:"Less Obvious Loot Drop Rare",effect:"Cfx_Gnd_Loot_Drop_Rare_Costumefx"},{label:"Less Obvious Loot Drop Very Rare",effect:"Cfx_Gnd_Loot_Drop_Veryrare_Costumefx"},{label:"Less Obvious Loot Drop Lock Box",effect:"Cfx_Gnd_Loot_Drop_Chancebox_Costumefx"},{label:"Less Obvious Loot Drop Dilithium",effect:"Cfx_Gnd_Loot_Drop_Dilithium_Costumefx"},{label:"Motivation (Tac Kit Module)",effect:"Cfx_Ground_Kit_Tac_Motivation_Buff,Fx_Ground_Kit_Tac_Motivation"},{label:"Orbital Devastation",effect:"Fx_Char_Voth_Orbitalstrike_Chasebeam"},{label:"Pahvan Crystal Prism noisy tether",effect:"Cfx_Er_Tfo_Pahvan_Crystal_Prism_Tether_Beam"},{label:"Rally Cry",effect:"Fx_Ground_Kit_Tac_Rallycry"},{label:"Red Riker Gun Sound effect",effect:"Cfx_Ep_Winterevent_Redriker_Sniper_Chargefx"},{label:"Scientific Aptitude (character glow)",effect:"Cfx_Ground_Kit_Sci_Scientificaptitude"},{label:"Solar Gateway",effect:"Fx_Char_Ico_Capt_Portal,Fx_Char_Ico_Capt_Portal_Sunbeam"},{label:"Smoke Grenade",effect:"Fx_Char_Grenade_smoke_costume,Fx_Char_Grenade_Smoke_Explode"},{label:"Sompek Energy Rebounder",effect:"Fx_Env_Gnd_Qadhos_Arena_Phaserhazard_Cylinder_Turret"},{label:"Strike Team III (character red glow)",effect:"Cfx_Ground_Kit_Tac_Striketeam"},{label:"Symphony of Lightning Char Glow",effect:"Fx_Er_Featured_Char_Kuumaarke_Wristgun_Tir_bufffx"},{label:"Symphony of Lightning Drone AoE",effect:"Cfx_Er_Featured_Char_Kuumaarke_Set_Symphony_Of_Lightning_Drone_Aoe"},{label:"Symphony of Lightning STRIKE",effect:"Fx_Er_Featured_Char_Kuumaarke_Set_Symphony_Of_Lightning_Strike"},{label:"Trajectory Bending",effect:"Cfx_Char_Xindi_Cb15_Tac_Kit_Trajectory_Bending"},{label:"Visual Dampening Field",effect:"Cfx_Char_Trait_Mirror_Vdfield"}]}};window.STO_DATA=c,window.VFX_EFFECTS=c.vfxEffects,window.COMMAND_CATEGORIES=c.commands,window.COMMANDS={},Object.entries(c.commands).forEach(([e,t])=>{Object.entries(t.commands).forEach(([t,i])=>{window.COMMANDS[t]={...i,category:e,key:t}})}),window.KEY_LAYOUTS=c.keyLayouts||{qwerty:{name:"QWERTY",rows:[[{key:"Escape",display:"Esc"},{key:"F1",display:"F1"},{key:"F2",display:"F2"},{key:"F3",display:"F3"},{key:"F4",display:"F4"},{key:"F5",display:"F5"},{key:"F6",display:"F6"},{key:"F7",display:"F7"},{key:"F8",display:"F8"},{key:"F9",display:"F9"},{key:"F10",display:"F10"},{key:"F11",display:"F11"},{key:"F12",display:"F12"}],[{key:"`",display:"`"},{key:"1",display:"1"},{key:"2",display:"2"},{key:"3",display:"3"},{key:"4",display:"4"},{key:"5",display:"5"},{key:"6",display:"6"},{key:"7",display:"7"},{key:"8",display:"8"},{key:"9",display:"9"},{key:"0",display:"0"},{key:"-",display:"-"},{key:"=",display:"="},{key:"Backspace",display:"Backspace"}],[{key:"Tab",display:"Tab"},{key:"Q",display:"Q"},{key:"W",display:"W"},{key:"E",display:"E"},{key:"R",display:"R"},{key:"T",display:"T"},{key:"Y",display:"Y"},{key:"U",display:"U"},{key:"I",display:"I"},{key:"O",display:"O"},{key:"P",display:"P"},{key:"[",display:"["},{key:"]",display:"]"},{key:"\\",display:"\\"}],[{key:"CapsLock",display:"Caps"},{key:"A",display:"A"},{key:"S",display:"S"},{key:"D",display:"D"},{key:"F",display:"F"},{key:"G",display:"G"},{key:"H",display:"H"},{key:"J",display:"J"},{key:"K",display:"K"},{key:"L",display:"L"},{key:";",display:";"},{key:"'",display:"'"},{key:"Enter",display:"Enter"}],[{key:"Shift",display:"Shift"},{key:"Z",display:"Z"},{key:"X",display:"X"},{key:"C",display:"C"},{key:"V",display:"V"},{key:"B",display:"B"},{key:"N",display:"N"},{key:"M",display:"M"},{key:",",display:","},{key:".",display:"."},{key:"/",display:"/"},{key:"Shift",display:"Shift"}],[{key:"Ctrl",display:"Ctrl"},{key:"Alt",display:"Alt"},{key:"Space",display:"Space"},{key:"Alt",display:"Alt"},{key:"Ctrl",display:"Ctrl"}]]}},window.DEFAULT_SETTINGS={keyLayout:"qwerty",autoSave:c.settings?.autoSave||!0,showTooltips:!0,exportFormat:"txt",maxUndoSteps:c.settings?.maxUndoSteps||50,defaultMode:c.settings?.defaultMode||"space",language:c.settings?.language||"en"},window.SAMPLE_PROFILES=Object.values(c.defaultProfiles).map(e=>({id:e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,description:e.description,currentEnvironment:e.currentEnvironment||"space",builds:e.builds||{space:{keys:{}},ground:{keys:{}}},created:(new Date).toISOString(),modified:(new Date).toISOString()})),window.SAMPLE_ALIASES={attack_sequence:{name:"Attack Sequence",commands:["Target_Enemy_Near","FireAll"],description:"Target and attack nearest enemy"},defensive_sequence:{name:"Defensive Sequence",commands:["Target_Self","+power_exec Distribute_Shields"],description:"Self-target and activate defensive abilities"},heal_sequence:{name:"Healing Sequence",commands:["Target_Self","+STOTrayExecByTray 3 0 $$ +STOTrayExecByTray 3 1"],description:"Emergency healing and repair sequence"}},window.TRAY_CONFIG={maxTrays:10,slotsPerTray:10,defaultTray:0,maxCommandsPerSlot:1},window.getCommandsByCategory=function(e){return e&&c.commands[e]?Object.values(c.commands[e].commands):[]},window.localizeCommandData=function(){const e=window.i18next;e&&Object.entries(c.commands).forEach(([t,i])=>{i.name&&(i.name=e.t(`command_categories.${t}`)),i.description&&(i.description=e.t(`category_descriptions.${t}`)),Object.entries(i.commands).forEach(([t,i])=>{i.name&&(i.name=e.t(`command_definitions.${t}.name`)),i.description&&(i.description=e.t(`command_definitions.${t}.description`))})})};class l extends Error{constructor(e,t="STO_ERROR"){super(e),this.name="STOError",this.code=t}}class d extends l{constructor(e,t="VFX_ERROR"){super(e,t),this.name="VertigoError"}}"undefined"!=typeof window&&(window.STOError=l,window.VertigoError=d,window.InvalidEnvironmentError=class extends d{constructor(e){super(`Invalid environment '${e}'. Valid environments are: space, ground`,"INVALID_ENVIRONMENT"),this.environment=e}},window.InvalidEffectError=class extends d{constructor(e,t){super(`Invalid effect '${e}' for environment '${t}'`,"INVALID_EFFECT"),this.effectName=e,this.environment=t}});const m=e=>"string"==typeof e,h=()=>{let e,t;const i=new Promise((i,a)=>{e=i,t=a});return i.resolve=e,i.reject=t,i},u=e=>null==e?"":""+e,p=/###/g,_=e=>e&&e.indexOf("###")>-1?e.replace(p,"."):e,f=e=>!e||m(e),y=(e,t,i)=>{const a=m(t)?t.split("."):t;let n=0;for(;n<a.length-1;){if(f(e))return{};const t=_(a[n]);!e[t]&&i&&(e[t]=new i),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++n}return f(e)?{}:{obj:e,k:_(a[n])}},g=(e,t,i)=>{const{obj:a,k:n}=y(e,t,Object);if(void 0!==a||1===t.length)return void(a[n]=i);let s=t[t.length-1],o=t.slice(0,t.length-1),r=y(e,o,Object);for(;void 0===r.obj&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),r=y(e,o,Object),r?.obj&&void 0!==r.obj[`${r.k}.${s}`]&&(r.obj=void 0);r.obj[`${r.k}.${s}`]=i},v=(e,t)=>{const{obj:i,k:a}=y(e,t);if(i&&Object.prototype.hasOwnProperty.call(i,a))return i[a]},b=(e,t,i)=>{for(const a in t)"__proto__"!==a&&"constructor"!==a&&(a in e?m(e[a])||e[a]instanceof String||m(t[a])||t[a]instanceof String?i&&(e[a]=t[a]):b(e[a],t[a],i):e[a]=t[a]);return e},w=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const S=e=>m(e)?e.replace(/[&<>"'\/]/g,e=>k[e]):e,x=[" ",",","?","!",";"],C=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}(20),T=(e,t,i=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const a=t.split(i);let n=e;for(let e=0;e<a.length;){if(!n||"object"!=typeof n)return;let t,s="";for(let o=e;o<a.length;++o)if(o!==e&&(s+=i),s+=a[o],t=n[s],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&o<a.length-1)continue;e+=o-e+1;break}n=t}return n},A=e=>e?.replace("_","-"),E={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class I{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||E,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,a){return a&&!this.debug?null:(m(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new I(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new I(this.logger,e)}}var $=new I;class B{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);const i=this.observers[e].get(t)||0;this.observers[e].set(t,i+1)}),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([e,i])=>{for(let a=0;a<i;a++)e(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,a])=>{for(let n=0;n<a;n++)i.apply(i,[e,...t])})}}class P extends B{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,a={}){const n=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,s=void 0!==a.ignoreJSONStructure?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],i&&(Array.isArray(i)?o.push(...i):m(i)&&n?o.push(...i.split(n)):o.push(i)));const r=v(this.data,o);return!r&&!t&&!i&&e.indexOf(".")>-1&&(e=o[0],t=o[1],i=o.slice(2).join(".")),!r&&s&&m(i)?T(this.data?.[e]?.[t],i,n):r}addResource(e,t,i,a,n={silent:!1}){const s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator;let o=[e,t];i&&(o=o.concat(s?i.split(s):i)),e.indexOf(".")>-1&&(o=e.split("."),a=t,t=o[1]),this.addNamespaces(t),g(this.data,o,a),n.silent||this.emit("added",e,t,i,a)}addResources(e,t,i,a={silent:!1}){for(const a in i)(m(i[a])||Array.isArray(i[a]))&&this.addResource(e,t,a,i[a],{silent:!0});a.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,a,n,s={silent:!1,skipCopy:!1}){let o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),a=i,i=t,t=o[1]),this.addNamespaces(t);let r=v(this.data,o)||{};s.skipCopy||(i=JSON.parse(JSON.stringify(i))),a?b(r,i,n):r={...r,...i},g(this.data,o,r),s.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var F={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,i,a,n){return e.forEach(e=>{t=this.processors[e]?.process(t,i,a,n)??t}),t}};const j={},M=e=>!m(e)&&"boolean"!=typeof e&&"number"!=typeof e;class N extends B{constructor(e,t={}){var i,a;super(),i=e,a=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach(e=>{i[e]&&(a[e]=i[e])}),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=$.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(null==e)return!1;const a=this.resolve(e,i);return void 0!==a?.res}extractFromKey(e,t){let i=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");const a=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let n=t.ns||this.options.defaultNS||[];const s=i&&e.indexOf(i)>-1,o=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,i)=>{t=t||"",i=i||"";const a=x.filter(e=>t.indexOf(e)<0&&i.indexOf(e)<0);if(0===a.length)return!0;const n=C.getRegExp(`(${a.map(e=>"?"===e?"\\?":e).join("|")})`);let s=!n.test(e);if(!s){const t=e.indexOf(i);t>0&&!n.test(e.substring(0,t))&&(s=!0)}return s})(e,i,a));if(s&&!o){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:m(n)?[n]:n};const s=e.split(i);(i!==a||i===a&&this.options.ns.indexOf(s[0])>-1)&&(n=s.shift()),e=s.join(a)}return{key:e,namespaces:m(n)?[n]:n}}translate(e,t,i){let a="object"==typeof t?{...t}:t;if("object"!=typeof a&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(a={...a}),a||(a={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const n=void 0!==a.returnDetails?a.returnDetails:this.options.returnDetails,s=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,{key:o,namespaces:r}=this.extractFromKey(e[e.length-1],a),c=r[r.length-1];let l=void 0!==a.nsSeparator?a.nsSeparator:this.options.nsSeparator;void 0===l&&(l=":");const d=a.lng||this.language,h=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===d?.toLowerCase())return h?n?{res:`${c}${l}${o}`,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:`${c}${l}${o}`:n?{res:o,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:o;const u=this.resolve(e,a);let p=u?.res;const _=u?.usedKey||o,f=u?.exactUsedKey||o,y=void 0!==a.joinArrays?a.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,v=void 0!==a.count&&!m(a.count),b=N.hasDefaultValue(a),w=v?this.pluralResolver.getSuffix(d,a.count,a):"",k=a.ordinal&&v?this.pluralResolver.getSuffix(d,a.count,{ordinal:!1}):"",S=v&&!a.ordinal&&0===a.count,x=S&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${w}`]||a[`defaultValue${k}`]||a.defaultValue;let C=p;g&&!p&&b&&(C=x);const T=M(C),A=Object.prototype.toString.apply(C);if(!(g&&C&&T&&["[object Number]","[object Function]","[object RegExp]"].indexOf(A)<0)||m(y)&&Array.isArray(C))if(g&&m(y)&&Array.isArray(p))p=p.join(y),p&&(p=this.extendTranslation(p,e,a,i));else{let t=!1,n=!1;!this.isValidLookup(p)&&b&&(t=!0,p=x),this.isValidLookup(p)||(n=!0,p=o);const r=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&n?void 0:p,m=b&&x!==p&&this.options.updateMissing;if(n||t||m){if(this.logger.log(m?"updateKey":"missingKey",d,c,o,m?x:p),s){const e=this.resolve(o,{...a,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let i=0;i<t.length;i++)e.push(t[i]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(a.lng||this.language):e.push(a.lng||this.language);const i=(e,t,i)=>{const n=b&&i!==p?i:r;this.options.missingKeyHandler?this.options.missingKeyHandler(e,c,t,n,m,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,c,t,n,m,a),this.emit("missingKey",e,c,t,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&v?e.forEach(e=>{const t=this.pluralResolver.getSuffixes(e,a);S&&a[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach(t=>{i([e],o+t,a[`defaultValue${t}`]||x)})}):i(e,o,x))}p=this.extendTranslation(p,e,a,u,i),n&&p===o&&this.options.appendNamespaceToMissingKey&&(p=`${c}${l}${o}`),(n||t)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${l}${o}`:o,t?p:void 0,a))}else{if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(_,C,{...a,ns:r}):`key '${o} (${this.language})' returned an object instead of string.`;return n?(u.res=e,u.usedParams=this.getUsedParamsDetails(a),u):e}if(s){const e=Array.isArray(C),t=e?[]:{},i=e?f:_;for(const e in C)if(Object.prototype.hasOwnProperty.call(C,e)){const n=`${i}${s}${e}`;t[e]=b&&!p?this.translate(n,{...a,defaultValue:M(x)?x[e]:void 0,joinArrays:!1,ns:r}):this.translate(n,{...a,joinArrays:!1,ns:r}),t[e]===n&&(t[e]=C[e])}p=t}}return n?(u.res=p,u.usedParams=this.getUsedParamsDetails(a),u):p}extendTranslation(e,t,i,a,n){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const s=m(e)&&(void 0!==i?.interpolation?.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let o;if(s){const t=e.match(this.interpolator.nestingRegexp);o=t&&t.length}let r=i.replace&&!m(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),e=this.interpolator.interpolate(e,r,i.lng||this.language||a.usedLng,i),s){const t=e.match(this.interpolator.nestingRegexp);o<(t&&t.length)&&(i.nest=!1)}!i.lng&&a&&a.res&&(i.lng=this.language||a.usedLng),!1!==i.nest&&(e=this.interpolator.nest(e,(...e)=>n?.[0]!==e[0]||i.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null),i)),i.interpolation&&this.interpolator.reset()}const s=i.postProcess||this.options.postProcess,o=m(s)?[s]:s;return null!=e&&o?.length&&!1!==i.applyPostProcessor&&(e=F.handle(o,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,a,n,s,o;return m(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(i))return;const r=this.extractFromKey(e,t),c=r.key;a=c;let l=r.namespaces;this.options.fallbackNS&&(l=l.concat(this.options.fallbackNS));const d=void 0!==t.count&&!m(t.count),h=d&&!t.ordinal&&0===t.count,u=void 0!==t.context&&(m(t.context)||"number"==typeof t.context)&&""!==t.context,p=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);l.forEach(e=>{this.isValidLookup(i)||(o=e,j[`${p[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(o)||(j[`${p[0]}-${e}`]=!0,this.logger.warn(`key "${a}" for languages "${p.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(a=>{if(this.isValidLookup(i))return;s=a;const o=[c];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(o,c,a,e,t);else{let e;d&&(e=this.pluralResolver.getSuffix(a,t.count,t));const i=`${this.options.pluralSeparator}zero`,n=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(o.push(c+e),t.ordinal&&0===e.indexOf(n)&&o.push(c+e.replace(n,this.options.pluralSeparator)),h&&o.push(c+i)),u){const a=`${c}${this.options.contextSeparator}${t.context}`;o.push(a),d&&(o.push(a+e),t.ordinal&&0===e.indexOf(n)&&o.push(a+e.replace(n,this.options.pluralSeparator)),h&&o.push(a+i))}}let r;for(;r=o.pop();)this.isValidLookup(i)||(n=r,i=this.getResource(a,e,r,t))}))})}),{res:i,usedKey:a,exactUsedKey:n,usedLng:s,usedNS:o}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,i,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,i,a):this.resourceStore.getResource(e,t,i,a)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!m(e.replace);let a=i?e.replace:e;if(i&&void 0!==e.count&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!i){a={...a};for(const e of t)delete a[e]}return a}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}class D{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=$.create("languageUtils")}getScriptPartFromCode(e){if(!(e=A(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=A(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(m(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(e=>{if(t)return;const i=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(i)||(t=i)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;const i=this.getScriptPartFromCode(e);if(this.isSupportedCode(i))return t=i;const a=this.getLanguagePartFromCode(e);if(this.isSupportedCode(a))return t=a;t=this.options.supportedLngs.find(e=>e===a?e:e.indexOf("-")<0&&a.indexOf("-")<0?void 0:e.indexOf("-")>0&&a.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===a||0===e.indexOf(a)&&a.length>1?e:void 0)}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),m(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),a=[],n=e=>{e&&(this.isSupportedCode(e)?a.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return m(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):m(e)&&n(this.formatLanguageCode(e)),i.forEach(e=>{a.indexOf(e)<0&&n(this.formatLanguageCode(e))}),a}}const O={zero:0,one:1,two:2,few:3,many:4,other:5},z={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class K{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=$.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=A("dev"===e?"en":e),a=t.ordinal?"ordinal":"cardinal",n=JSON.stringify({cleanedCode:i,type:a});if(n in this.pluralRulesCache)return this.pluralRulesCache[n];let s;try{s=new Intl.PluralRules(i,{type:a})}catch(i){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),z;if(!e.match(/-|_/))return z;const a=this.languageUtils.getLanguagePartFromCode(e);s=this.getRule(a,t)}return this.pluralRulesCache[n]=s,s}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(e=>`${t}${e}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((e,t)=>O[e]-O[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t,i={}){const a=this.getRule(e,i);return a?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${a.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const L=(e,t,i,a=".",n=!0)=>{let s=((e,t,i)=>{const a=v(e,i);return void 0!==a?a:v(t,i)})(e,t,i);return!s&&n&&m(i)&&(s=T(e,i,a),void 0===s&&(s=T(t,i,a))),s},R=e=>e.replace(/\$/g,"$$$$");class U{constructor(e={}){this.logger=$.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:a,prefix:n,prefixEscaped:s,suffix:o,suffixEscaped:r,formatSeparator:c,unescapeSuffix:l,unescapePrefix:d,nestingPrefix:m,nestingPrefixEscaped:h,nestingSuffix:u,nestingSuffixEscaped:p,nestingOptionsSeparator:_,maxReplaces:f,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:S,this.escapeValue=void 0===i||i,this.useRawValueToEscape=void 0!==a&&a,this.prefix=n?w(n):s||"{{",this.suffix=o?w(o):r||"}}",this.formatSeparator=c||",",this.unescapePrefix=l?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":l||"",this.nestingPrefix=m?w(m):h||w("$t("),this.nestingSuffix=u?w(u):p||w(")"),this.nestingOptionsSeparator=_||",",this.maxReplaces=f||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,i,a){let n,s,o;const r=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=e=>{if(e.indexOf(this.formatSeparator)<0){const n=L(t,r,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,i,{...a,...t,interpolationkey:e}):n}const n=e.split(this.formatSeparator),s=n.shift().trim(),o=n.join(this.formatSeparator).trim();return this.format(L(t,r,s,this.options.keySeparator,this.options.ignoreJSONStructure),o,i,{...a,...t,interpolationkey:s})};this.resetRegExp();const l=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,d=void 0!==a?.interpolation?.skipOnVariables?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>R(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?R(this.escape(e)):R(e)}].forEach(t=>{for(o=0;n=t.regex.exec(e);){const i=n[1].trim();if(s=c(i),void 0===s)if("function"==typeof l){const t=l(e,n,a);s=m(t)?t:""}else if(a&&Object.prototype.hasOwnProperty.call(a,i))s="";else{if(d){s=n[0];continue}this.logger.warn(`missed to pass in variable ${i} for interpolating ${e}`),s=""}else m(s)||this.useRawValueToEscape||(s=u(s));const r=t.safeValue(s);if(e=e.replace(n[0],r),d?(t.regex.lastIndex+=s.length,t.regex.lastIndex-=n[0].length):t.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t,i={}){let a,n,s;const o=(e,t)=>{const i=this.nestingOptionsSeparator;if(e.indexOf(i)<0)return e;const a=e.split(new RegExp(`${i}[ ]*{`));let n=`{${a[1]}`;e=a[0],n=this.interpolate(n,s);const o=n.match(/'/g),r=n.match(/"/g);((o?.length??0)%2==0&&!r||r.length%2!=0)&&(n=n.replace(/'/g,'"'));try{s=JSON.parse(n),t&&(s={...t,...s})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${i}${n}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,e};for(;a=this.nestingRegexp.exec(e);){let r=[];s={...i},s=s.replace&&!m(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let c=!1;if(-1!==a[0].indexOf(this.formatSeparator)&&!/{.*}/.test(a[1])){const e=a[1].split(this.formatSeparator).map(e=>e.trim());a[1]=e.shift(),r=e,c=!0}if(n=t(o.call(this,a[1].trim(),s),s),n&&a[0]===e&&!m(n))return n;m(n)||(n=u(n)),n||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),n=""),c&&(n=r.reduce((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:a[1].trim()}),n.trim())),e=e.replace(a[0],n),this.regexp.lastIndex=0}return e}}const q=e=>{const t={};return(i,a,n)=>{let s=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(s={...s,[n.interpolationkey]:void 0});const o=a+JSON.stringify(s);let r=t[o];return r||(r=e(A(a),n),t[o]=r),r(i)}},V=e=>(t,i,a)=>e(A(i),a)(t);class G{constructor(e={}){this.logger=$.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?q:V;this.formats={number:i((e,t)=>{const i=new Intl.NumberFormat(e,{...t});return e=>i.format(e)}),currency:i((e,t)=>{const i=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>i.format(e)}),datetime:i((e,t)=>{const i=new Intl.DateTimeFormat(e,{...t});return e=>i.format(e)}),relativetime:i((e,t)=>{const i=new Intl.RelativeTimeFormat(e,{...t});return e=>i.format(e,t.range||"day")}),list:i((e,t)=>{const i=new Intl.ListFormat(e,{...t});return e=>i.format(e)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=q(t)}format(e,t,i,a={}){const n=t.split(this.formatSeparator);if(n.length>1&&n[0].indexOf("(")>1&&n[0].indexOf(")")<0&&n.find(e=>e.indexOf(")")>-1)){const e=n.findIndex(e=>e.indexOf(")")>-1);n[0]=[n[0],...n.splice(1,e)].join(this.formatSeparator)}return n.reduce((e,t)=>{const{formatName:n,formatOptions:s}=(e=>{let t=e.toLowerCase().trim();const i={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const n=a[1].substring(0,a[1].length-1);"currency"===t&&n.indexOf(":")<0?i.currency||(i.currency=n.trim()):"relativetime"===t&&n.indexOf(":")<0?i.range||(i.range=n.trim()):n.split(";").forEach(e=>{if(e){const[t,...a]=e.split(":"),n=a.join(":").trim().replace(/^'+|'+$/g,""),s=t.trim();i[s]||(i[s]=n),"false"===n&&(i[s]=!1),"true"===n&&(i[s]=!0),isNaN(n)||(i[s]=parseInt(n,10))}})}return{formatName:t,formatOptions:i}})(t);if(this.formats[n]){let t=e;try{const o=a?.formatParams?.[a.interpolationkey]||{},r=o.locale||o.lng||a.locale||a.lng||i;t=this.formats[n](e,r,{...s,...a,...o})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${n}`),e},e)}}class W extends B{constructor(e,t,i,a={}){super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=a,this.logger=$.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(i,a.backend,a)}queueLoad(e,t,i,a){const n={},s={},o={},r={};return e.forEach(e=>{let a=!0;t.forEach(t=>{const o=`${e}|${t}`;!i.reload&&this.store.hasResourceBundle(e,t)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===s[o]&&(s[o]=!0):(this.state[o]=1,a=!1,void 0===s[o]&&(s[o]=!0),void 0===n[o]&&(n[o]=!0),void 0===r[t]&&(r[t]=!0)))}),a||(o[e]=!0)}),(Object.keys(n).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(n),pending:Object.keys(s),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(r)}}loaded(e,t,i){const a=e.split("|"),n=a[0],s=a[1];t&&this.emit("failedLoading",n,s,t),!t&&i&&this.store.addResourceBundle(n,s,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const o={};this.queue.forEach(i=>{((e,t,i)=>{const{obj:a,k:n}=y(e,t,Object);a[n]=a[n]||[],a[n].push(i)})(i.loaded,[n],s),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(i,e),t&&i.errors.push(t),0!==i.pendingCount||i.done||(Object.keys(i.loaded).forEach(e=>{o[e]||(o[e]={});const t=i.loaded[e];t.length&&t.forEach(t=>{void 0===o[e][t]&&(o[e][t]=!0)})}),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(e=>!e.done)}read(e,t,i,a=0,n=this.retryTimeout,s){if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:i,tried:a,wait:n,callback:s});this.readingCalls++;const o=(o,r)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}o&&r&&a<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,i,a+1,2*n,s)},n):s(o,r)},r=this.backend[i].bind(this.backend);if(2!==r.length)return r(e,t,o);try{const i=r(e,t);i&&"function"==typeof i.then?i.then(e=>o(null,e)).catch(o):o(null,i)}catch(e){o(e)}}prepareLoading(e,t,i={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();m(e)&&(e=this.languageUtils.toResolveHierarchy(e)),m(t)&&(t=[t]);const n=this.queueLoad(e,t,i,a);if(!n.toLoad.length)return n.pending.length||a(),null;n.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),a=i[0],n=i[1];this.read(a,n,"read",void 0,void 0,(i,s)=>{i&&this.logger.warn(`${t}loading namespace ${n} for language ${a} failed`,i),!i&&s&&this.logger.log(`${t}loaded namespace ${n} for language ${a}`,s),this.loaded(e,i,s)})}saveMissing(e,t,i,a,n,s={},o=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=i&&""!==i){if(this.backend?.create){const r={...s,isUpdate:n},c=this.backend.create.bind(this.backend);if(c.length<6)try{let n;n=5===c.length?c(e,t,i,a,r):c(e,t,i,a),n&&"function"==typeof n.then?n.then(e=>o(null,e)).catch(o):o(null,n)}catch(e){o(e)}else c(e,t,i,a,o,r)}e&&e[0]&&this.store.addResource(e[0],t,i,a)}}else this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const X=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),m(e[1])&&(t.defaultValue=e[1]),m(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const i=e[3]||e[2];Object.keys(i).forEach(e=>{t[e]=i[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),H=e=>(m(e.ns)&&(e.ns=[e.ns]),m(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),m(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),Z=()=>{};class J extends B{constructor(e={},t){var i;if(super(),this.options=H(e),this.services={},this.logger=$,this.modules={external:[]},i=this,Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(e=>{"function"==typeof i[e]&&(i[e]=i[e].bind(i))}),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(m(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=X();this.options={...i,...this.options,...H(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const a=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?$.init(a(this.modules.logger),this.options):$.init(null,this.options),e=this.modules.formatter?this.modules.formatter:G;const t=new D(this.options);this.store=new P(this.options.resources,this.options);const n=this.services;n.logger=$,n.resourceStore=this.store,n.languageUtils=t,n.pluralResolver=new K(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(n.formatter=a(e),n.formatter.init(n,this.options),this.options.interpolation.format=n.formatter.format.bind(n.formatter)),n.interpolator=new U(this.options),n.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},n.backendConnector=new W(a(this.modules.backend),n.resourceStore,n,this.options),n.backendConnector.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.languageDetector&&(n.languageDetector=a(this.modules.languageDetector),n.languageDetector.init&&n.languageDetector.init(n,this.options.detection,this.options)),this.modules.i18nFormat&&(n.i18nFormat=a(this.modules.i18nFormat),n.i18nFormat.init&&n.i18nFormat.init(this)),this.translator=new N(this.services,this.options),this.translator.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Z),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=(...t)=>this.store[e](...t)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=(...t)=>(this.store[e](...t),this)});const n=h(),s=()=>{const e=(e,i)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),n.resolve(i),t(e,i)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),n}loadResources(e,t=Z){let i=t;const a=m(e)?e:this.language;if("function"==typeof e&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===a?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return i();const e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)})};a?t(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>t(e)),this.options.preload?.forEach?.(e=>t(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),i(e)})}else i(null)}reloadResources(e,t,i){const a=h();return"function"==typeof e&&(i=e,e=void 0),"function"==typeof t&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=Z),this.services.backendConnector.reload(e,t,e=>{a.resolve(),i(e)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&F.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=h();this.emit("languageChanging",e);const a=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},n=(n,s)=>{s?this.isLanguageChangingTo===e&&(a(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,i.resolve((...e)=>this.t(...e)),t&&t(n,(...e)=>this.t(...e))},s=t=>{e||t||!this.services.languageDetector||(t=[]);const i=m(t)?t:t&&t[0],s=this.store.hasLanguageSomeTranslations(i)?i:this.services.languageUtils.getBestMatchFromCodes(m(t)?[t]:t);s&&(this.language||a(s),this.translator.language||this.translator.changeLanguage(s),this.services.languageDetector?.cacheUserLanguage?.(s)),this.loadResources(s,e=>{n(e,s)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),i}getFixedT(e,t,i){const a=(e,t,...n)=>{let s;s="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(n)):{...t},s.lng=s.lng||a.lng,s.lngs=s.lngs||a.lngs,s.ns=s.ns||a.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||i||a.keyPrefix);const o=this.options.keySeparator||".";let r;return r=s.keyPrefix&&Array.isArray(e)?e.map(e=>`${s.keyPrefix}${o}${e}`):s.keyPrefix?`${s.keyPrefix}${o}${e}`:e,this.t(r,s)};return m(e)?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=i,a}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],a=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;const s=(e,t)=>{const i=this.services.backendConnector.state[`${e}|${t}`];return-1===i||0===i||2===i};if(t.precheck){const e=t.precheck(this,s);if(void 0!==e)return e}return!(!this.hasResourceBundle(i,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(i,e)||a&&!s(n,e)))}loadNamespaces(e,t){const i=h();return this.options.ns?(m(e)&&(e=[e]),e.forEach(e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}),this.loadResources(e=>{i.resolve(),t&&t(e)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=h();m(e)&&(e=[e]);const a=this.options.preload||[],n=e.filter(e=>a.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e));return n.length?(this.options.preload=a.concat(n),this.loadResources(e=>{i.resolve(),t&&t(e)}),i):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services?.languageUtils||new D(X());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new J(e,t)}cloneInstance(e={},t=Z){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},n=new J(a);if(void 0===e.debug&&void 0===e.prefix||(n.logger=n.logger.clone(e)),["store","services","language"].forEach(e=>{n[e]=this[e]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},i){const e=Object.keys(this.store.data).reduce((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce((i,a)=>(i[a]={...e[t][a]},i),e[t]),e),{});n.store=new P(e,a),n.services.resourceStore=n.store}return n.translator=new N(n.services,a),n.translator.on("*",(e,...t)=>{n.emit(e,...t)}),n.init(a,t),n.translator.options=a,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Y=J.createInstance();Y.createInstance=J.createInstance,Y.createInstance,Y.dir,Y.init,Y.loadResources,Y.reloadResources,Y.use,Y.changeLanguage,Y.getFixedT,Y.t,Y.exists,Y.setDefaultNamespace,Y.hasLoadedNamespace,Y.loadNamespaces,Y.loadLanguages;var Q={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Open",save:"Save",explorer:"Explorer",keybinds:"Keybinds",import_keybinds:"Import Keybinds",export_keybinds:"Export Keybinds",aliases:"Aliases",import_aliases:"Import Aliases",export_aliases:"Export Aliases",import:"Import",import_menu:"Import",backup:"Backup",backup_menu:"Backup",backup_application_state:"Backup Application State",restore_application_state:"Restore Application State",preferences:"Preferences",language:"Language",sync_folder_label:"Synchronization Folder:",no_folder_selected:"No folder selected",download:"Download",vfx:"VFX",dark_mode:"Dark Mode",light_mode:"Light Mode",load_default_data:"Load Default Data",reset_application:"Reset Application",set_sync_folder:"Set Sync Folder",sync_now:"Sync Now",about:"About",new:"New",create:"Create",create_new_alias:"Create New Alias",clone:"Clone",rename:"Rename",delete:"Delete",space:"Space",ground:"Ground",alias:"Alias",modified:"Modified",valid:"Valid",keys:"keys",key_singular:"key",keys_firstupper:"Keys",all:"All",add_key:"Add Key",copy:"Copy",select_a_key_to_edit:"Select a key to edit",select_an_alias_to_edit:"Select an alias to edit",commands:"commands",command_singular:"command",stabilize_execution_order:"Stabilize Execution Order",alias_options:"Alias Options:",select_options:"Select Options",toggle_type:"Toggle Type",cycle_type:"Cycle Type",validate:"Validate",clear:"Clear",no_key_selected:"No Key Selected",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Select a key from the left panel to view and edit its command chain.",generated_command:"Generated Command:",select_a_key_to_see_the_generated_command:"Select a key to see the generated command",select_an_alias_to_see_the_generated_command:"Select an alias to see the generated command",add_command:"Add Command",from_template:"From Template",add_alias:"Add Alias",copy_from_key:"Copy from Key",command_library:"Command Library",add_new_key:"Add New Key",key_name:"Key Name:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Use standard key names like F1, Ctrl+A, Shift+Space, etc.",or_capture_keys:"Or capture keys:",click_here_then_press_keys:"Click here, then press the key combination",press_key_combination_now:"Press the key combination now...",supports_single_modifier_plus_key_combinations:"Supports single modifier + key combinations (e.g., Ctrl+A, Alt+1, Shift+Space)",common_keys:"Common Keys:",ctrl:"Ctrl",alt:"Alt",shift:"Shift",cancel:"Cancel",command_type:"Command Type:",select_command_type:"Select command type...",targeting:"Targeting",combat:"Combat",tray_execution:"Tray Execution",shield_management:"Shield Management",movement:"Movement",camera:"Camera",communication:"Communication",system:"System",custom_command:"Custom Command",select_a_command_type_to_see_preview:"Select a command type to see preview",profile:"Profile",profile_name:"Profile Name:",description_optional:"Description (optional):",command_alias_manager:"Command Alias Manager",new_alias:"New Alias",edit_alias:"Edit Alias",alias_name:"Alias Name:",alias_command:"Alias Command",enter_alias_name:"Enter alias name",use_alphanumeric_characters_only_no_spaces:"Use alphanumeric characters only, no spaces",description:"Description:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Example: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Use in communication commands to include target name",preview:"Preview:",alias_myalias_command_sequence:'alias MyAlias "command sequence"',save_alias:"Save Alias",select_key:"Select Key",select_key_dialog_title:"Select Key",select_key_dialog_description:"Choose from the available keys below:",key_combination:"Key Combination:",capture_key:"Capture Key",select_this_key:"Select This Key",select_modifier_key:"Select Modifier + Key",step_1_select_modifiers_optional:"Step 1: Select Modifiers (Optional)",step_2_select_key:"Step 2: Select Key",common:"Common",letters:"Letters",numbers:"Numbers",function:"Function",arrows:"Arrows",symbols:"Symbols",mouse:"Mouse",gamepad:"Gamepad",numpad:"Numpad",common_keys1:"Common Keys",find_other_keys:"Find other keys...",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Select visual effects to disable using dynFxSetFXExlusionList aliases. Effects are organized by environment.",space_effects:"Space Effects",selected:"selected",ground_effects:"Ground Effects",generated_aliases:"Generated Aliases:",space_alias:"Space Alias:",ground_alias:"Ground Alias:",about_sto_tools_keybind_manager:"About STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"A comprehensive web-based tool for creating, editing, and managing Star Trek Online keybind configurations with visual editing and advanced features.",features:"Features:",visual_keybind_editor:"Visual keybind editor",sto_command_library_with_search_and_categorization:"STO command library with search and categorization",multiple_profile_management_create_clone_rename_delete:"Multiple profile management (create, clone, rename, delete)",custom_alias_system_for_complex_command_sequences:"Custom alias system for complex command sequences",vertigo_inspired_vfx_manager_for_visual_effects_control:"VERTIGO-inspired VFX Manager for visual effects control",import_export_keybind_and_alias_files_and_project_backups:"Import/export keybind and alias files, and project backups",real_time_validation_and_command_preview:"Real-time validation and command preview",quick_start:"Quick Start:",create_a_new_profile_or_use_the_default_profile:"Create a new profile or use the default profile",select_keys_from_the_grid_and_add_commands_from_the_library:"Select keys from the grid and add commands from the library",use_the_command_chain_editor_to_build_complex_sequences:"Use the command chain editor to build complex sequences",export_your_keybinds_as_txt_files_for_use_in_sto:"Export your keybinds as .txt files for use in STO",resources:"Resources:",copyright:"© 2025 STO Tools. All rights reserved.",got_it:"Got it!",file_explorer:"File Explorer",select_an_item_on_the_left_to_preview_export:"Select an item on the left to preview export",close:"Close",select_export_format:"Select Export Format",export_as:"Export As:",sto_keybind_file_txt:"STO Keybind File (.txt)",json_profile_json:"JSON Profile (.json)",complete_project_json:"Complete Project (.json)",csv_data_csv:"CSV Data (.csv)",html_report_html:"HTML Report (.html)",alias_file_txt:"Alias File (.txt)",environment:"Environment:",export:"Export",filter_keys:"Filter keys...",filter_aliases:"Filter aliases...",search_commands:"Search commands...",e_g_f5_ctrl_a_shift_1:"e.g., F5, Ctrl+A, Shift+1",enter_profile_name:"Enter profile name",describe_this_keybind_profile:"Describe this keybind profile",myalias:"MyAlias",brief_description_of_what_this_alias_does:"Brief description of what this alias does",enter_command_sequence_use_to_separate_commands:"Enter command sequence (use $$ to separate commands)",search_keys:"Search keys...",open_project_json:"Restore Application State",save_project_json:"Backup Application State",keybind_operations:"Keybind Operations",alias_operations:"Alias Operations",settings:"Settings",select_profile:"Select Profile",new_profile:"New Profile",clone_profile:"Clone Profile",rename_profile:"Rename Profile",delete_profile:"Delete Profile",space_mode:"Space Mode",ground_mode:"Ground Mode",alias_mode:"Alias Mode",unsaved_changes:"Unsaved Changes",validation_status:"Validation Status",bound_keys:"Bound Keys",toggle_between_grid_and_categorized_view:"Toggle between grid and categorized view",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Ensures consistent execution order by mirroring commands (Phase 1: left-to-right, Phase 2: right-to-left)",validate_command_chain:"Validate Command Chain",clear_all_commands:"Clear All Commands",copy_to_clipboard:"Copy to Clipboard",collapse_expand:"Collapse/Expand",insert_target_variable:"Insert $Target variable",sto_keybind_report:"STO Keybind Report",mode:"Mode:",generated:"Generated:",created_by:"Created by:",statistics:"Statistics",keys_bound:"Keys Bound:",total_commands:"Total Commands:",aliases_defined:"Aliases Defined:",no_keybinds_defined:"No keybinds defined.",command_aliases:"Command Aliases",vfx_aliases:"VFX Aliases",report_footer:"This report was generated by STO Tools Keybind Manager. For more information about Star Trek Online keybinds, visit the STO Wiki.",command_categories:{targeting:"Targeting",combat:"Combat",cosmetic:"Cosmetic",bridge_officer:"Bridge Officer",tray:"Tray Execution",power:"Shield Management",movement:"Movement",camera:"Camera",communication:"Communication",system:"System"},command_definitions:{target:{name:"Target by Name",description:"Target entity by name (requires quotes)"},target_enemy_near:{name:"Target Nearest Enemy",description:"Target the nearest enemy in view"},target_friend_near:{name:"Target Nearest Friend",description:"Target the nearest friendly entity"},target_self:{name:"Target Self",description:"Target your own ship/character"},target_clear:{name:"Clear Target",description:"Remove current target lock"},target_teammate_1:{name:"Target Teammate 1",description:"Target first team member"},target_teammate_2:{name:"Target Teammate 2",description:"Target second team member"},target_teammate_3:{name:"Target Teammate 3",description:"Target third team member"},target_teammate_4:{name:"Target Teammate 4",description:"Target fourth team member"},fire_all:{name:"Fire All Weapons",description:"Fire all weapons"},fire_phasers:{name:"Fire Energy Weapons",description:"Fire all Energy Weapons"},fire_torps:{name:"Fire Torpedoes",description:"Fire all Torpedos"},fire_mines:{name:"Fire Mines",description:"Fire all Mines"},fire_phasers_torps:{name:"Fire Phasers & Torpedoes",description:"Fire phasers & torpedos"},fire_projectiles:{name:"Fire Projectiles",description:"Fire torpedos & mines"},setactivecostume:{name:"Set Active Costume",description:"Sets current active costume. Requires two modifiers."},custom_tray:{name:"Tray Execution",description:"Execute specific tray slot"},tray_with_backup:{name:"Tray Execution with Backup",description:"Execute specific tray slot with backup ability"},tray_range:{name:"Tray Range Execution",description:"Execute a range of tray slots"},tray_range_with_backup:{name:"Tray Range with Backup",description:"Execute a range of tray slots with backup abilities"},whole_tray:{name:"Whole Tray Execution",description:"Execute all slots in a tray"},whole_tray_with_backup:{name:"Whole Tray with Backup",description:"Execute all slots in a tray with backup tray"},distribute_shields:{name:"Distribute Shields",description:"Evenly distributes shields as if clicking in the middle of the ship and shields icon"},reroute_shields_rear:{name:"Reroute Shields Rear",description:"Route shield power to rear facing"},reroute_shields_left:{name:"Reroute Shields Left",description:"Route shield power to left side"},reroute_shields_right:{name:"Reroute Shields Right",description:"Route shield power to right side"},reroute_shields_forward:{name:"Reroute Shields Forward",description:"Route shield power to forward facing"},full_impulse:{name:"Full Impulse",description:"Engage full impulse drive"},reverse:{name:"Reverse",description:"Reverse engines"},throttle_adjust:{name:"Throttle Adjust",description:"Increase or decrease the throttle by amount"},throttle_set:{name:"Throttle Set",description:"Set the throttle to a specific position (negative = reverse, 0 = stop)"},throttle_toggle:{name:"Throttle Toggle",description:"Alternates between full throttle and full stop"},turn_left:{name:"Turn Left",description:"Turn ship left (continuous while held)"},turn_right:{name:"Turn Right",description:"Turn ship right (continuous while held)"},pitch_up:{name:"Pitch Up",description:"Pitch ship nose up (space altitude change)"},pitch_down:{name:"Pitch Down",description:"Pitch ship nose down (space altitude change)"},strafe_left:{name:"Strafe Left",description:"Strafe ship left"},strafe_right:{name:"Strafe Right",description:"Strafe ship right"},forward:{name:"Forward",description:"Move forward"},backward:{name:"Backward",description:"Move backward"},auto_forward:{name:"Auto Forward",description:"Character moves forward until given new movement commands"},follow:{name:"Follow Target",description:"Follow the targeted entity"},follow_cancel:{name:"Cancel Follow",description:"Stop following and forget about the target"},zoom_in:{name:"Zoom In",description:"Zoom the camera in"},zoom_out:{name:"Zoom Out",description:"Zoom the camera out"},zoom_in_small:{name:"Zoom In Small",description:"Zoom the camera in slightly"},zoom_out_small:{name:"Zoom Out Small",description:"Zoom the camera out slightly"},cam_distance:{name:"Set Camera Distance",description:"Sets the camera distance from the player"},cam_reset:{name:"Reset Camera",description:"Reset the camera position to default"},cam_target_lock:{name:"Lock Camera to Target",description:"Lock or unlock the camera to the target"},cam_cycle_distance:{name:"Cycle Camera Distance",description:"Cycle the camera distance between several preset values"},cam_mouse_look:{name:"Mouse Look",description:"Enable mouse look camera control"},cam_turn_to_face:{name:"Turn to Face Camera",description:"Turn ship to face camera direction"},look_up:{name:"Look Up",description:"Change point of view to look straight up"},look_down:{name:"Look Down",description:"Change point of view to look straight down"},team_message:{name:"Team Message",description:"Send message to team"},local_message:{name:"Local Message",description:"Send message to local area"},zone_message:{name:"Zone Message",description:"Send message to zone"},toggle_hud:{name:"Toggle HUD",description:"Toggle HUD visibility"},screenshot:{name:"Screenshot",description:"Take a screenshot"},screenshot_jpg:{name:"Screenshot JPG",description:"Save a screenshot as JPG"},autofire_toggle:{name:"Toggle Autofire",description:"Toggle weapon autofire"},bind_save_file:{name:"Save Binds to File",description:"Save all your binds to a text file"},bind_load_file:{name:"Load Binds from File",description:"Load a bind file into the client"},combat_log:{name:"Toggle Combat Log",description:"Turn on combat log. 1=on, 0=off, no param=print status. Prepending the command with ++ turns it into a toggle"},missions:{name:"Show/Hide Missions",description:"Show/hide the mission journal"},inventory:{name:"Show/Hide Inventory",description:"Show/hide your inventory"},map:{name:"Show/Hide Map",description:"Show/hide the map window"},logout:{name:"Logout",description:"Log out the current character."},quit:{name:"Quit Game",description:"Close the window."},ui_load:{name:"Load UI Settings",description:"Loads default UI Windows save file, usually Live\\ui_settings.txt"},ui_save:{name:"Save UI Settings",description:"Saves UI layout to default UI Window save file, usually Live\\ui_settings.txt"},ui_load_file:{name:"Load UI Settings File",description:"Loads named UI Windows save file"},ui_save_file:{name:"Save UI Settings File",description:"Saves UI layout to named UI Window save file"},ui_cancel:{name:"UI Cancel",description:'Respond "Cancel" to an open dialog box; may not work in all dialogs.'},ui_ok:{name:"UI OK",description:'Respond "OK" to an open dialog box; may not work in all dialogs.'},chat_log:{name:"Toggle Chat Log",description:"Turn on chat log. 1=on, 0=off, no param=print status. Prepending the command with ++ turns it into a toggle"},remember_ui_lists:{name:"Remember UI Lists",description:"Whether to remember UI List Column placement and width."},ui_remember_positions:{name:"Remember UI Positions",description:"Whether to remember UI sizes and positions. On by default."},safe_login:{name:"Safe Login",description:"If true, then log the player back into their most recent static map instead of anything else."},goto_character_select:{name:"Go to Character Select",description:"Go to the character select screen without logging out."},ui_gen_layers_reset:{name:"Reset UI Layout",description:"Resets the layout, used for when the server updates movable window positions"},ui_resolution:{name:"Print UI Resolution",description:"Print the current UI screen resolution."},ui_tooltip_delay:{name:"Set Tooltip Delay",description:"Sets the additional delay, in seconds, before tooltips appear"},show_game_ui:{name:"Show Game UI",description:"Show the game UI"},show_game_ui_no_extra_keybinds:{name:"Show Game UI (No Extra Keybinds)",description:"This command does not add any keybinds for showing the UI when the user presses escape"},change_instance:{name:"Change Instance",description:"Change to an already created instance of the same map. Only works while not at red alert."},aim:{name:"Aim/Scope",description:"Toggle scope on/off. In scope mode the player does more damage. Can either be used as a toggle or a press and hold"},holster:{name:"Holster Weapon",description:"Attempt to holster your active weapon"},holster_toggle:{name:"Holster Toggle",description:"Attempt to holster or draw your weapons"},unholster:{name:"Unholster Weapon",description:"Attempt to draw your active weapon"},toggle_shooter_mode:{name:"Toggle Shooter Mode",description:"Toggle shooter mode on/off"},shooter_primary:{name:"Shooter Primary",description:"Primary shooter mode action"},shooter_secondary:{name:"Shooter Secondary",description:"Secondary shooter mode action"},shooter_tertiary:{name:"Shooter Tertiary",description:"Tertiary shooter mode action"},shooter_clear_offset_tray_binds:{name:"Shooter Clear Offset Tray Binds",description:"Clear the starting location and movement of the yellow action box that appears on the tray while in shooter mode"},shooter_clear_overlay_tray_binds:{name:"Shooter Clear Overlay Tray Binds",description:"Clear overlay tray bindings for shooter mode"},shooter_set_offset_tray_binds:{name:"Shooter Set Offset Tray Binds",description:"Set the starting location and movement of the yellow action box that appears on the tray while in shooter mode"},shooter_set_overlay_tray_binds:{name:"Shooter Set Overlay Tray Binds",description:"Set overlay tray bindings for shooter mode"},setrallypoint:{name:"Set Rally Point",description:"Set a rally point for your current target"},setrallypointconsole:{name:"Set Rally Point (Console)",description:"Set a rally point for your current target (console variant)"},clearrallypoint:{name:"Clear Rally Point",description:"Clear the rally point for your current target"},clearallrallypoints:{name:"Clear All Rally Points",description:"Clear all the rally points"},assist:{name:"Assist",description:"Assist '<name>': Assists the Entity with the matching name. If no name is given, assists your current target."},net_timing_graph:{name:"Net Timing Graph",description:"Enable or disable the network timing graph (0=disable, 1=enable)"},net_timing_graph_alpha:{name:"Net Timing Graph Alpha",description:"Set transparency level for network timing graph (50=highest transparency, 255=no transparency)"},net_timing_graph_paused:{name:"Net Timing Graph Paused",description:"Pause or resume the network timing graph (0=pause disabled, 1=pause enabled)"},netgraph:{name:"Net Graph",description:"Display SND and RCV network data as text (1=enabled, 0=disabled)"},bridge_officer_command:"Bridge Officer Command",select_bridge_officer_command:"Select a bridge officer command",entity_name_optional:"Entity Name (optional)",entity_name_optional_placeholder:"Enter entity name (optional)"},category_descriptions:{targeting:"Target selection and management",combat:"Weapon firing and combat actions",tray:"Execute abilities from action trays",power:"Shield power and distribution management",movement:"Ship movement and navigation",camera:"Camera control and view management",communication:"Chat and team communication",system:"UI and system commands"},no_aliases:"No Aliases",no_aliases_defined:"No aliases defined",create_alias_to_get_started:"Create an alias to get started",create_aliases_hint:"Create command aliases to simplify complex command sequences.",alias_deleted:'Alias "{{alias}}" deleted',please_select_a_key_first:"Please select a key first",alias_added_to_key:'Alias "{{alias}}" added to {{key}}',no_active_profile:"No active profile",alias_exists:"An alias with this name already exists",alias_template_exists:'Alias "{{alias}}" already exists',alias_created_from_template:'Alias "{{alias}}" created from template',template_not_found:"Template not found",alias_not_found:'Alias "{{alias}}" not found',alias_created:'Alias "{{alias}}" created',alias_updated:'Alias "{{alias}}" updated',no_profile_selected_for_import:"No profile selected for import",no_keybinds_found_in_file:"No keybinds found in file",import_failed:"Import failed: {{error}}",no_aliases_found_in_file:"No aliases found in file",failed_to_get_profile_for_import:"Failed to get profile for import",import_completed_keybinds:"Import completed: {{count}} keybinds",import_completed_keybinds_with_aliases:"Import completed: {{keyCount}} keybinds ({{aliasCount}} aliases ignored - use Import Aliases)",import_completed_aliases:"Import completed: {{count}} aliases",no_profile_selected_to_export:"No profile selected to export",keybind_file_exported:"Keybind file exported successfully",failed_to_export_keybind_file:"Failed to export keybind file: {{error}}",profile_exported_json:"Profile exported as JSON",failed_to_export_profile:"Failed to export profile: {{error}}",complete_project_exported:"Complete project exported",failed_to_export_project:"Failed to export project: {{error}}",data_exported_csv:"Data exported as CSV",failed_to_export_csv:"Failed to export CSV: {{error}}",html_report_exported:"HTML report exported",failed_to_export_html_report:"Failed to export HTML report: {{error}}",no_command_to_copy:"No command to copy",no_profiles_to_export:"No profiles to export",exporting_profiles:"Exporting {{count}} profiles...",aliases_exported_successfully:"Aliases exported successfully",failed_to_export_aliases:"Failed to export aliases: {{error}}",sync_folder_set:"Sync folder selected",failed_to_set_sync_folder:"Failed to select sync folder: {{error}}",no_sync_folder_selected:"No sync folder selected",project_synced_successfully:"Project synchronized successfully",permission_denied_to_folder:"Permission denied to write to folder",failed_to_sync_project:"Failed to sync project: {{error}}",general:"General",synchronization:"Synchronization",appearance:"Appearance",advanced:"Advanced",general_settings:"General Settings",synchronization_settings:"Synchronization Settings",appearance_settings:"Appearance Settings",language_settings:"Language Settings",advanced_settings:"Advanced Settings",auto_save:"Auto Save",auto_save_description:"Automatically save changes as you work",validation_mode:"Validation Mode",validation_mode_description:"How strictly to validate commands and keybinds",strict:"Strict",lenient:"Lenient",disabled:"Disabled",sync_folder_description:"Choose a folder to automatically sync your projects",auto_sync:"Auto Sync",auto_sync_description:"Automatically sync changes to the selected folder",auto_sync_interval:"Auto Sync Interval",auto_sync_interval_description:"How often to automatically sync your changes",after_every_change:"After every change",every_1_minute:"Every 1 minute",every_2_minutes:"Every 2 minutes",every_5_minutes:"Every 5 minutes",auto_sync_completed:"Auto sync completed",selected_folder:"Selected folder",theme:"Theme",theme_description:"Choose between light and dark themes",light_theme:"Light",dark_theme:"Dark",compact_mode:"Compact Mode",compact_mode_description:"Use a more compact interface layout",interface_language:"Interface Language",language_description:"Choose the language for the interface",debug_mode:"Debug Mode",debug_mode_description:"Enable debug logging and developer tools",backup_interval:"Backup Interval",backup_interval_description:"How often to automatically backup your work",every_15_minutes:"Every 15 minutes",every_30_minutes:"Every 30 minutes",every_hour:"Every hour",preferences_saved:"Preferences saved successfully",failed_to_save_preferences:"Failed to save preferences",vfx_manager_description:"Select visual effects to disable using dynFxSetFXExlusionList aliases. Effects are organized by environment.",app_description:"A comprehensive web-based tool for creating, editing, and managing Star Trek Online keybind configurations with visual editing and advanced features.",csv_header:"Key,Command,Type,Description,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Select a Space/Ground build or Aliases to preview export.",no_alias_selected:"No Alias Selected",select_alias_from_left_panel:"Select an alias from the left panel to view and edit its command chain.",select_key_from_left_panel:"Select a key from the left panel to view and edit its command chain.",validation_error:"Validation error",failed_to_load_application:"Failed to load application",profile_created:'Profile "{{name}}" created',failed_to_create_profile:"Failed to create profile",failed_to_clone_profile:"Failed to clone profile",cannot_delete_the_last_profile:"Cannot delete the last profile",profile_deleted:'Profile "{{profileName}}" deleted',failed_to_delete_profile:"Failed to delete profile",invalid_key_name:"Invalid key name",key_added:'Key "{{keyName}}" added',key_already_exists:'Key "{{keyName}}" already exists',key_deleted:'Key "{{keyName}}" deleted',command_added_to_alias:"Command added to alias",commands_added:"{{count}} commands added",command_added:"Command added",command_deleted_from_alias:"Command deleted from alias",command_deleted:"Command deleted",switched_to_mode:"Switched to {{mode}} mode",alias_already_exists:'Alias "{{name}}" already exists',commands_cleared_for_key:"Commands cleared for {{keyName}}",project_loaded_successfully:"Project loaded successfully",failed_to_load_project_file:"Failed to load project file",invalid_project_file:"Invalid project file",project_exported_successfully:"Project exported successfully",no_commands_to_duplicate:"No commands to duplicate",key_duplicated:'Key "{{keyName}}" duplicated as "{{newKeyName}}"',template_system_coming_soon:"Template system coming soon",no_commands_to_validate:"No commands to validate",command_chain_is_valid:"Command chain is valid",please_configure_a_command:"Please configure a command",command_updated_successfully:"Command updated successfully",error_message:"Error: {{error}}",failed_to_select_all_space_effects:"Failed to select all space effects",failed_to_select_all_ground_effects:"Failed to select all ground effects",space_preview_error:"Space preview error: {{error}}",ground_preview_error:"Ground preview error: {{error}}",space_alias_error:"Space alias error: {{error}}",failed_to_generate_space_alias:"Failed to generate space alias",ground_alias_error:"Ground alias error: {{error}}",failed_to_generate_ground_alias:"Failed to generate ground alias",no_profile_selected:"No profile selected",no_profile_found:"No profile found",switched_to_theme:"Switched to {{themeName}}",language_updated:"Language updated",auto_sync_failed:"Auto-sync failed: {{error}}",nothing_to_copy:"Nothing to copy",content_copied_to_clipboard:"Content copied to clipboard",failed_to_generate_export:"Failed to generate export",no_profile_selected_to_clone:"No profile selected to clone",no_profile_selected_to_rename:"No profile selected to rename",profile_name_is_required:"Profile name is required",profile_name_too_long:"Profile name is too long (max 50 characters)",profile_name_already_exists:"A profile with this name already exists",failed_to_save_profile:"Failed to save profile: {{error}}",no_profile_selected_to_delete:"No profile selected to delete",no_keybinds_to_export:"No keybinds to export",no_aliases_to_export:"No aliases to export",failed_to_reset_application:"Failed to reset application: {{error}}",default_demo_data_loaded:"Default demo data loaded successfully",failed_to_load_default_data:"Failed to load default data",failed_to_load_default_data_with_error:"Failed to load default data: {{error}}",failed_to_create_profile_from_template:"Failed to create profile from template",profile_exported:'Profile "{{profileName}}" exported',failed_to_import_profile:"Failed to import profile: {{error}}",sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager loaded successfully",switched_to_profile:"Switched to profile: {{name}} ({{environment}})",profile_created_from:'Profile "{{newName}}" created from "{{sourceProfile}}"',keybinds_exported_successfully:"{{environment}} keybinds exported successfully",commands_updated_successfully:"{{count}} commands updated successfully",command_info:"Command: {{command}}\nType: {{type}}",no_effects_selected:"No effects selected. Please select at least one effect to generate aliases.",generated_vertigo_aliases:"Generated {{count}} Vertigo alias{{plural}}! Check the Alias Manager to bind them to keys.",failed_to_import_keybind_file:"Failed to import keybind file: {{error}}",profile_created_from_current:'Profile "{{name}}" created from "{{currentProfile}}"',profile_renamed:'Profile renamed from "{{oldName}}" to "{{name}}"',failed_to_import_keybind_file_generic:"Failed to import keybind file: {{error}}",failed_to_import_aliases_generic:"Failed to import aliases: {{error}}",application_reset_successfully:"Application reset successfully. All data cleared.",profile_created_from_template_generic:'Profile "{{profileName}}" created from template',profile_imported_successfully:'Profile "{{profileName}}" imported successfully',failed_to_copy_to_clipboard:"Failed to copy to clipboard",confirm_delete_alias:'Are you sure you want to delete the alias "{{aliasName}}"?',confirm_delete_key:'Are you sure you want to delete the key "{{keyName}}" and all its commands?',confirm_clear_commands:'Are you sure you want to clear all commands for "{{keyName}}"?',confirm_delete_profile:'Are you sure you want to delete the profile "{{profileName}}"?\n\nThis action cannot be undone.',confirm_reset_application:"Are you sure you want to reset the application?\n\nThis will delete all profiles, keybinds, and settings. This action cannot be undone.",delete_alias:"Delete Alias",delete_key:"Delete Key",clear_commands:"Clear Commands",yes:"Yes",no:"No",active:"Active",inactive:"Inactive",active_state:"Active State",no_aliases_available:"No aliases available",no_commands:"No commands",profile_not_found:"Profile not found",click_add_command_to_start_building_your_command_chain:"Click 'Add Command' to start building your command chain for",click_add_command_to_start_building_your_alias_chain:"Click 'Add Command' to start building your alias chain for",create_aliases_in_the_alias_manager_first:"Create aliases in the Alias Manager first",enter_sto_command:"Enter STO command",enter_the_exact_sto_command_syntax:"Enter the exact STO command syntax",enter_your_message:"Enter your message",maximum_100_characters:"Maximum 100 characters",replaced_with_your_current_targets_name:"Replaced with your current target's name",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"This alias will automatically toggle between its on/off states when executed",select_an_alias:"Select an alias",select_targeting_command:"Select targeting command",select_combat_command:"Select a combat command",select_shield_command:"Select shield command",select_movement_command:"Select movement command",select_camera_command:"Select camera command",select_system_command:"Select system command",select_communication_type:"Select communication type",create_alias:"Create Alias",alias_commands:"Alias Commands",available_aliases:"Available Aliases",common_commands:"Common Commands",sto_variables:"STO Variables",example:"Example",message:"Message",display_text:"Display Text",descriptive_name_for_this_command:"Descriptive name for this command",filename:"Filename",position:"Position",distance:"Distance",amount:"Amount",state:"State",command:"Command",command_variant:"Command Variant",communication_type:"Communication Type",combat_command:"Combat Command",movement_command:"Movement Command",camera_command:"Camera Command",shield_command:"Shield Command",system_command:"System Command",targeting_command:"Targeting Command",tray_number:"Tray Number",slot_number:"Slot Number",start_tray:"Start Tray",end_tray:"End Tray",start_slot:"Start Slot",end_slot:"End Slot",backup_tray:"Backup Tray",backup_slot:"Backup Slot",backup_start_tray:"Backup Start Tray",backup_end_tray:"Backup End Tray",backup_start_slot:"Backup Start Slot",backup_end_slot:"Backup End Slot",backup_configuration:"Backup Configuration",range_configuration:"Range Configuration",backup_range_configuration:"Backup Range Configuration",single_tray_slot:"Single Tray Slot",single_tray_with_backup:"Single Tray with Backup",tray_range:"Tray Range",tray_range_with_backup:"Tray Range with Backup",whole_tray:"Whole Tray",whole_tray_with_backup:"Whole Tray with Backup",configure_command_options_to_see_preview:"Configure command options to see preview",key:"key",no_profile:"No profile",stotrayexecbytray_description:"STOTrayExecByTray (shows key binding on UI)",trayexecbytray_description:"TrayExecByTray (no UI indication)",on:"On",off:"Off",delay_seconds:"Delay (seconds)",parameter_configuration:"Parameter Configuration",modifier_1:"Modifier 1",modifier_2:"Modifier 2",first_modifier:"First modifier",second_modifier:"Second modifier",cosmetic_command:"Cosmetic Command",select_cosmetic_command:"Select a cosmetic command",tray_command:"Tray Command",create_command_aliases:"Create Command Aliases",bridge_officer:"Bridge Officer",select_bridge_officer_command:"Select a bridge officer command",vfx_manager:"VFX Manager",select_all:"Select All",clear_all:"Clear All",no_space_effects_selected:"No space effects selected",no_ground_effects_selected:"No ground effects selected",show_player_say:"Show Player Say",generate_aliases:"Generate Aliases",net_graph:"Net Graph",net_graph_command:"Net Graph Command",select_net_graph_command:"Select a net graph command",net_timing_graph:"Net Timing Graph",net_timing_graph_alpha:"Net Timing Graph Alpha",net_timing_graph_paused:"Net Timing Graph Paused",netgraph:"Net Graph",enable_disable:"Enable/Disable",transparency_level:"Transparency Level",pause_state:"Pause State",delete_selected_key:"Delete Selected Key",duplicate_selected_key:"Duplicate Selected Key",show_all_keys:"Show All Keys",failed_to_load_profile_data:"Failed to load profile data",no_profile_to_save:"No profile to save",profile_saved:"Profile saved",data_saved:"Data saved",failed_to_save_data:"Failed to save data",failed_to_save_current_profile:"Failed to save current profile",already_on_profile:"Already on this profile",source_profile_not_found:"Source profile not found",no_profile_or_build_data:"No profile or build data",profile_name_required:"Profile name is required",confirm_reset_app:"Are you sure you want to reset the application? This will delete all profiles and data. This action cannot be undone.",switch_to_key_type_view:"Switch to key type view",switch_to_grid_view:"Switch to grid view",switch_to_command_categories:"Switch to command categories",no_profiles_available:"No profiles available",verb:{say:"Say (Local)",team:"Team",zone:"Zone",tell:"Tell"},duplicate_alias:"Duplicate Alias",enter_new_alias_name:"Enter new alias name",alias_name_in_use:"Alias name already exists",duplicate:"Duplicate",invalid_alias_name:"Invalid alias name",reserved_command_name:"Name conflicts with a STO command"},ee={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Öffnen",save:"Speichern",explorer:"Explorer",keybinds:"Tastaturbelegung",import_keybinds:"Tastaturbelegung importieren",export_keybinds:"Tastaturbelegung exportieren",aliases:"Aliase",import_aliases:"Aliase importieren",export_aliases:"Aliase exportieren",import:"Importieren",import_menu:"Importieren",backup:"Sicherung",backup_menu:"Sicherung",backup_application_state:"Anwendungsstatus sichern",restore_application_state:"Anwendungsstatus wiederherstellen",preferences:"Einstellungen",language:"Sprache",sync_folder_label:"Synchronisationsordner:",no_folder_selected:"Kein Ordner ausgewählt",download:"Herunterladen",vfx:"VFX",dark_mode:"Dunkler Modus",light_mode:"Heller Modus",load_default_data:"Standarddaten laden",reset_application:"Anwendung zurücksetzen",set_sync_folder:"Sync-Ordner festlegen",sync_now:"Jetzt synchronisieren",about:"Über",new:"Neu",clone:"Klonen",rename:"Umbenennen",delete:"Löschen",space:"Weltraum",ground:"Boden",modified:"Geändert",valid:"Gültig",keys:"Tasten",keys_firstupper:"Tasten",key_singular:"Taste",all:"Alle",add_key:"Taste hinzufügen",copy:"Kopieren",select_a_key_to_edit:"Wählen Sie eine Taste zum Bearbeiten",commands:"Befehle",command_singular:"Befehl",stabilize_execution_order:"Ausführungsreihenfolge stabilisieren",validate:"Validieren",clear:"Löschen",no_key_selected:"Keine Taste ausgewählt",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Wählen Sie eine Taste aus dem linken Panel, um ihre Befehlskette anzuzeigen und zu bearbeiten.",generated_command:"Generierter Befehl:",select_a_key_to_see_the_generated_command:"Wählen Sie eine Taste, um den generierten Befehl zu sehen",add_command:"Befehl hinzufügen",from_template:"Aus Vorlage",add_alias:"Alias hinzufügen",copy_from_key:"Von Taste kopieren",command_library:"Befehlsbibliothek",add_new_key:"Neue Taste hinzufügen",key_name:"Tastenname:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Verwenden Sie Standard-Tastennamen wie F1, Strg+A, Umschalt+Leertaste, usw.",common_keys:"Häufige Tasten:",ctrl:"Strg",alt:"Alt",shift:"Umschalt",cancel:"Abbrechen",command_type:"Befehlstyp:",select_command_type:"Befehlstyp auswählen...",targeting:"Zielerfassung",combat:"Kampf",tray_execution:"Tray-Ausführung",shield_management:"Schildverwaltung",movement:"Bewegung",camera:"Kamera",communication:"Kommunikation",system:"System",alias:"Alias",custom_command:"Benutzerdefinierter Befehl",select_a_command_type_to_see_preview:"Wählen Sie einen Befehlstyp für eine Vorschau",profile:"Profil",profile_name:"Profilname:",description_optional:"Beschreibung (optional):",command_alias_manager:"Befehlsalias-Manager",new_alias:"Neuer Alias",edit_alias:"Alias bearbeiten",alias_name:"Alias-Name:",use_alphanumeric_characters_only_no_spaces:"Verwenden Sie nur alphanumerische Zeichen, keine Leerzeichen",description:"Beschreibung:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Beispiel: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Verwenden Sie in Kommunikationsbefehlen, um Zielnamen einzuschließen",preview:"Vorschau:",alias_myalias_command_sequence:'alias MeinAlias "Befehlssequenz"',save_alias:"Alias speichern",select_key:"Taste auswählen",select_key_dialog_title:"Taste auswählen",select_key_dialog_description:"Wählen Sie aus den verfügbaren Tasten unten:",key_combination:"Tastenkombination:",capture_key:"Taste erfassen",select_this_key:"Diese Taste auswählen",select_modifier_key:"Modifikator + Taste auswählen",step_1_select_modifiers_optional:"Schritt 1: Modifikatoren auswählen (Optional)",step_2_select_key:"Schritt 2: Taste auswählen",common:"Häufig",letters:"Buchstaben",numbers:"Zahlen",function:"Funktion",arrows:"Pfeile",symbols:"Symbole",mouse:"Maus",gamepad:"Gamepad",common_keys1:"Häufige Tasten",find_other_keys:"Andere Tasten finden...",vfx_manager:"VFX-Manager",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Wählen Sie visuelle Effekte zum Deaktivieren mit dynFxSetFXExlusionList-Aliasen. Effekte sind nach Umgebung organisiert.",space_effects:"Weltraum-Effekte",select_all:"Alle auswählen",clear_all:"Alle löschen",selected:"ausgewählt",ground_effects:"Boden-Effekte",generated_aliases:"Generierte Aliase:",space_alias:"Weltraum-Alias:",no_space_effects_selected:"Keine Weltraum-Effekte ausgewählt",ground_alias:"Boden-Alias:",no_ground_effects_selected:"Keine Boden-Effekte ausgewählt",show_player_say:"Spieler-Say anzeigen",generate_aliases:"Aliase generieren",about_sto_tools_keybind_manager:"Über STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Ein umfassendes webbasiertes Tool zum Erstellen, Bearbeiten und Verwalten von Star Trek Online Keybind-Konfigurationen mit visueller Bearbeitung und erweiterten Funktionen.",features:"Funktionen:",visual_keybind_editor:"Visueller Keybind-Editor",sto_command_library_with_search_and_categorization:"STO-Befehlsbibliothek mit Suche und Kategorisierung",multiple_profile_management_create_clone_rename_delete:"Mehrfache Profilverwaltung (erstellen, klonen, umbenennen, löschen)",custom_alias_system_for_complex_command_sequences:"Benutzerdefiniertes Alias-System für komplexe Befehlssequenzen",vertigo_inspired_vfx_manager_for_visual_effects_control:"VERTIGO-inspirierter VFX-Manager zur Kontrolle visueller Effekte",import_export_keybind_and_alias_files_and_project_backups:"Import/Export von Keybind- und Alias-Dateien sowie Projekt-Backups",real_time_validation_and_command_preview:"Echtzeit-Validierung und Befehlsvorschau",quick_start:"Schnellstart:",create_a_new_profile_or_use_the_default_profile:"Erstellen Sie ein neues Profil oder verwenden Sie das Standardprofil",select_keys_from_the_grid_and_add_commands_from_the_library:"Wählen Sie Tasten aus dem Raster und fügen Sie Befehle aus der Bibliothek hinzu",use_the_command_chain_editor_to_build_complex_sequences:"Verwenden Sie den Befehlsketten-Editor, um komplexe Sequenzen zu erstellen",export_your_keybinds_as_txt_files_for_use_in_sto:"Exportieren Sie Ihre Keybinds als .txt-Dateien für die Verwendung in STO",resources:"Ressourcen:",copyright:"© 2025 STO Tools. Alle Rechte vorbehalten.",got_it:"Verstanden!",file_explorer:"Datei-Explorer",select_an_item_on_the_left_to_preview_export:"Wählen Sie ein Element links aus, um den Export in der Vorschau anzuzeigen",close:"Schließen",select_export_format:"Exportformat auswählen",export_as:"Exportieren als:",sto_keybind_file_txt:"STO Keybind-Datei (.txt)",json_profile_json:"JSON-Profil (.json)",complete_project_json:"Vollständiges Projekt (.json)",csv_data_csv:"CSV-Daten (.csv)",html_report_html:"HTML-Bericht (.html)",alias_file_txt:"Alias-Datei (.txt)",environment:"Umgebung:",export:"Exportieren",filter_keys:"Tasten filtern...",search_commands:"Befehle suchen...",e_g_f5_ctrl_a_shift_1:"z.B. F5, Strg+A, Umschalt+1",enter_profile_name:"Profilnamen eingeben",describe_this_keybind_profile:"Dieses Keybind-Profil beschreiben",myalias:"MeinAlias",brief_description_of_what_this_alias_does:"Kurze Beschreibung, was dieser Alias tut",enter_command_sequence_use_to_separate_commands:"Befehlssequenz eingeben (verwenden Sie $$ zur Trennung von Befehlen)",search_keys:"Tasten suchen...",open_project_json:"Projekt JSON öffnen",save_project_json:"Projekt JSON speichern",keybind_operations:"Keybind-Operationen",alias_operations:"Alias-Operationen",settings:"Einstellungen",select_profile:"Profil auswählen",new_profile:"Neues Profil",clone_profile:"Profil klonen",rename_profile:"Profil umbenennen",delete_profile:"Profil löschen",space_mode:"Weltraum-Modus",ground_mode:"Boden-Modus",unsaved_changes:"Ungespeicherte Änderungen",validation_status:"Validierungsstatus",bound_keys:"Gebundene Tasten",toggle_between_grid_and_categorized_view:"Zwischen Raster- und kategorisierter Ansicht wechseln",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Gewährleistet konsistente Ausführungsreihenfolge durch Spiegelung der Befehle (Phase 1: links nach rechts, Phase 2: rechts nach links)",validate_command_chain:"Befehlskette validieren",clear_all_commands:"Alle Befehle löschen",copy_to_clipboard:"In Zwischenablage kopieren",collapse_expand:"Einklappen/Ausklappen",insert_target_variable:"$Target-Variable einfügen",sto_keybind_report:"STO Keybind-Bericht",mode:"Modus:",generated:"Generiert:",created_by:"Erstellt von:",statistics:"Statistiken",keys_bound:"Gebundene Tasten:",total_commands:"Gesamtbefehle:",aliases_defined:"Definierte Aliase:",no_keybinds_defined:"Keine Keybinds definiert.",command_aliases:"Befehlsaliase",report_footer:"Dieser Bericht wurde vom STO Tools Keybind Manager generiert. Für weitere Informationen über Star Trek Online Keybinds besuchen Sie das STO Wiki.",command_categories:{targeting:"Zielauswahl",combat:"Kampf",cosmetic:"Kosmetik",bridge_officer:"Brückenoffizier",tray:"Fachausführung",power:"Schildverwaltung",movement:"Bewegung",camera:"Kamera",communication:"Kommunikation",system:"System"},command_definitions:{target:{name:"Ziel nach Name",description:"Ziel nach Namen anvisieren (benötigt Anführungszeichen)"},target_enemy_near:{name:"Nächsten Feind anvisieren",description:"Den nächsten sichtbaren Feind anvisieren"},target_friend_near:{name:"Nächsten Verbündeten anvisieren",description:"Die nächste befreundete Einheit anvisieren"},target_self:{name:"Sich selbst anvisieren",description:"Das eigene Schiff/den eigenen Charakter anvisieren"},target_clear:{name:"Ziel aufheben",description:"Aktuelle Zielerfassung aufheben"},target_teammate_1:{name:"Teammitglied 1 anvisieren",description:"Erstes Teammitglied anvisieren"},target_teammate_2:{name:"Teammitglied 2 anvisieren",description:"Zweites Teammitglied anvisieren"},target_teammate_3:{name:"Teammitglied 3 anvisieren",description:"Drittes Teammitglied anvisieren"},target_teammate_4:{name:"Teammitglied 4 anvisieren",description:"Viertes Teammitglied anvisieren"},fire_all:{name:"Alle Waffen feuern",description:"Alle Waffen feuern"},fire_phasers:{name:"Energiewaffen feuern",description:"Alle Energiewaffen feuern"},fire_torps:{name:"Torpedos feuern",description:"Alle Torpedos feuern"},fire_mines:{name:"Minen feuern",description:"Alle Minen feuern"},fire_phasers_torps:{name:"Phaser & Torpedos feuern",description:"Phaser & Torpedos feuern"},fire_projectiles:{name:"Projektile feuern",description:"Torpedos & Minen feuern"},custom_tray:{name:"Tray-Ausführung",description:"Bestimmten Tray-Slot ausführen"},tray_with_backup:{name:"Tray-Ausführung mit Backup",description:"Bestimmten Tray-Slot mit Backup-Fähigkeit ausführen"},tray_range:{name:"Tray-Bereich-Ausführung",description:"Einen Bereich von Tray-Slots ausführen"},tray_range_with_backup:{name:"Tray-Bereich mit Backup",description:"Einen Bereich von Tray-Slots mit Backup-Fähigkeiten ausführen"},whole_tray:{name:"Gesamtes Tray ausführen",description:"Alle Slots in einem Tray ausführen"},whole_tray_with_backup:{name:"Gesamtes Tray mit Backup",description:"Alle Slots in einem Tray mit Backup-Tray ausführen"},distribute_shields:{name:"Schilde verteilen",description:"Schilde gleichmäßig verteilen, als würde man in die Mitte des Schiff- und Schildsymbols klicken"},reroute_shields_rear:{name:"Schilde nach hinten umleiten",description:"Schildenergie zur Heckseite umleiten"},reroute_shields_left:{name:"Schilde nach links umleiten",description:"Schildenergie zur linken Seite umleiten"},reroute_shields_right:{name:"Schilde nach rechts umleiten",description:"Schildenergie zur rechten Seite umleiten"},reroute_shields_forward:{name:"Schilde nach vorne umleiten",description:"Schildenergie zur Bugseite umleiten"},full_impulse:{name:"Vollimpuls",description:"Vollimpulsantrieb einschalten"},reverse:{name:"Rückwärts",description:"Triebwerke rückwärts"},throttle_adjust:{name:"Schub anpassen",description:"Schub um Betrag erhöhen oder verringern"},throttle_set:{name:"Schub setzen",description:"Schub auf bestimmte Position setzen (negativ = rückwärts, 0 = stopp)"},throttle_toggle:{name:"Schub umschalten",description:"Zwischen Vollschub und Vollstopp wechseln"},turn_left:{name:"Links drehen",description:"Schiff nach links drehen (kontinuierlich während gehalten)"},turn_right:{name:"Rechts drehen",description:"Schiff nach rechts drehen (kontinuierlich während gehalten)"},pitch_up:{name:"Aufwärts neigen",description:"Schiffsnase nach oben neigen (Höhenänderung im Weltraum)"},pitch_down:{name:"Abwärts neigen",description:"Schiffsnase nach unten neigen (Höhenänderung im Weltraum)"},strafe_left:{name:"Links seitlich bewegen",description:"Schiff nach links seitlich bewegen"},strafe_right:{name:"Rechts seitlich bewegen",description:"Schiff nach rechts seitlich bewegen"},forward:{name:"Vorwärts",description:"Vorwärts bewegen"},backward:{name:"Rückwärts",description:"Rückwärts bewegen"},auto_forward:{name:"Auto-Vorwärts",description:"Charakter bewegt sich vorwärts bis neue Bewegungsbefehle gegeben werden"},follow:{name:"Ziel folgen",description:"Der anvisierten Einheit folgen"},follow_cancel:{name:"Folgen abbrechen",description:"Aufhören zu folgen und Ziel vergessen"},zoom_in:{name:"Hineinzoomen",description:"Kamera hineinzoomen"},zoom_out:{name:"Herauszoomen",description:"Kamera herauszoomen"},zoom_in_small:{name:"Leicht hineinzoomen",description:"Kamera leicht hineinzoomen"},zoom_out_small:{name:"Leicht herauszoomen",description:"Kamera leicht herauszoomen"},cam_distance:{name:"Kameraentfernung setzen",description:"Kameraentfernung vom Spieler setzen"},cam_reset:{name:"Kamera zurücksetzen",description:"Kameraposition auf Standard zurücksetzen"},cam_target_lock:{name:"Kamera an Ziel fixieren",description:"Kamera am Ziel fixieren oder lösen"},cam_cycle_distance:{name:"Kameraentfernung wechseln",description:"Kameraentfernung zwischen mehreren voreingestellten Werten wechseln"},cam_mouse_look:{name:"Maus-Blick",description:"Maus-Blick-Kamerasteuerung aktivieren"},cam_turn_to_face:{name:"Zur Kamera drehen",description:"Schiff in Kamerarichtung drehen"},look_up:{name:"Nach oben blicken",description:"Blickwinkel ändern um geradeaus nach oben zu blicken"},look_down:{name:"Nach unten blicken",description:"Blickwinkel ändern um geradeaus nach unten zu blicken"},team_message:{name:"Team-Nachricht",description:"Nachricht an Team senden"},local_message:{name:"Lokale Nachricht",description:"Nachricht an lokalen Bereich senden"},zone_message:{name:"Zonen-Nachricht",description:"Nachricht an Zone senden"},toggle_hud:{name:"HUD umschalten",description:"HUD-Sichtbarkeit umschalten"},screenshot:{name:"Screenshot",description:"Einen Screenshot machen"},screenshot_jpg:{name:"Screenshot JPG",description:"Einen Screenshot als JPG speichern"},autofire_toggle:{name:"Autofeuer umschalten",description:"Waffen-Autofeuer umschalten"},bind_save_file:{name:"Binds in Datei speichern",description:"Alle Binds in eine Textdatei speichern"},bind_load_file:{name:"Binds aus Datei laden",description:"Eine Bind-Datei in den Client laden"},combat_log:{name:"Kampflog umschalten",description:"Kampflog-Aufzeichnung ein-/ausschalten (1=ein, 0=aus)"},missions:{name:"Missionen anzeigen/verbergen",description:"Missionstagebuch anzeigen/verbergen"},inventory:{name:"Inventar anzeigen/verbergen",description:"Inventar anzeigen/verbergen"},map:{name:"Karte",description:"Karte anzeigen/verbergen"},assist:{name:"Unterstützen",description:"Unterstützen '<name>': Unterstützt die Entität mit dem übereinstimmenden Namen. Wenn kein Name angegeben wird, unterstützt Ihr aktuelles Ziel."},net_timing_graph:{name:"Netzwerk-Timing-Graph",description:"Netzwerk-Timing-Graph aktivieren oder deaktivieren (0=deaktivieren, 1=aktivieren)"},net_timing_graph_alpha:{name:"Netzwerk-Timing-Graph Alpha",description:"Transparenzstufe für Netzwerk-Timing-Graph setzen (50=höchste Transparenz, 255=keine Transparenz)"},net_timing_graph_paused:{name:"Netzwerk-Timing-Graph Pausiert",description:"Netzwerk-Timing-Graph pausieren oder fortsetzen (0=Pause deaktiviert, 1=Pause aktiviert)"},netgraph:{name:"Netzwerk-Graph",description:"SND und RCV Netzwerkdaten als Text anzeigen (1=aktiviert, 0=deaktiviert)"},setrallypoint:{name:"Sammelpunkt setzen",description:"Einen Sammelpunkt für Ihr aktuelles Ziel setzen"},setrallypointconsole:{name:"Sammelpunkt setzen (Konsole)",description:"Einen Sammelpunkt für Ihr aktuelles Ziel setzen (Konsolenvariante)"},clearrallypoint:{name:"Sammelpunkt löschen",description:"Den Sammelpunkt für Ihr aktuelles Ziel löschen"},clearallrallypoints:{name:"Alle Sammelpunkte löschen",description:"Alle Sammelpunkte löschen"},bridge_officer_command:"Brückenoffizier-Befehl",select_bridge_officer_command:"Wählen Sie einen Brückenoffizier-Befehl",entity_name_optional:"Entitätsname (optional)",entity_name_optional_placeholder:"Geben Sie den Entitätsnamen ein (optional)",aim:{name:"Zielen",description:"Zielt auf das Ziel"},change_instance:{name:"Instanz wechseln",description:"Wechselt zu einer bereits erstellten Instanz derselben Karte. Funktioniert nur außerhalb des Roten Alarms."},chat_log:{name:"Chat-Log umschalten",description:"Chat-Log-Aufzeichnung ein-/ausschalten (1=an, 0=aus)"},goto_character_select:{name:"Zum Charakterauswahlbildschirm",description:"Zum Charakterauswahlbildschirm wechseln, ohne sich abzumelden."},holster:{name:"Waffe ablegen",description:"Waffe ablegen"},holster_toggle:{name:"Waffe umschalten",description:"Waffe ein-/ausblenden"},logout:{name:"Abmelden",description:"Aktuellen Charakter abmelden"},quit:{name:"Spiel beenden",description:"Fenster schließen"},remember_ui_lists:{name:"UI-Listen merken",description:"Ob die Platzierung und Breite der UI-Listen gemerkt werden soll"},safe_login:{name:"Sicherer Login",description:"Bei Aktivierung wird der Spieler auf die zuletzt besuchte statische Karte eingeloggt"},setactivecostume:{name:"Aktives Kostüm setzen",description:"Setzt das aktuelle aktive Kostüm. Erfordert zwei Modifikatoren."},shooter_clear_offset_tray_binds:{name:"Shooter Offset-Tray-Bindings löschen",description:"Löscht Offset-Tray-Bindings im Shooter-Modus"},shooter_clear_overlay_tray_binds:{name:"Shooter Overlay-Tray-Bindings löschen",description:"Löscht Overlay-Tray-Bindings im Shooter-Modus"},shooter_primary:{name:"Shooter Primär",description:"Primärangriff im Shooter-Modus"},shooter_secondary:{name:"Shooter Sekundär",description:"Sekundärangriff im Shooter-Modus"},shooter_set_offset_tray_binds:{name:"Shooter Offset-Tray-Bindings setzen",description:"Setzt Offset-Tray-Bindings im Shooter-Modus"},shooter_set_overlay_tray_binds:{name:"Shooter Overlay-Tray-Bindings setzen",description:"Setzt Overlay-Tray-Bindings im Shooter-Modus"},shooter_tertiary:{name:"Shooter Tertiär",description:"Tertiärangriff im Shooter-Modus"},show_game_ui:{name:"Spiel-UI anzeigen",description:"Zeigt die Spiel-Benutzeroberfläche an"},show_game_ui_no_extra_keybinds:{name:"Spiel-UI anzeigen (ohne zusätzliche Keybinds)",description:"Zeigt die Spiel-UI ohne zusätzliche Escape-Keybinds an"},toggle_shooter_mode:{name:"Shooter-Modus umschalten",description:"Zwischen Shooter- und RPG-Modus umschalten"},ui_cancel:{name:"UI Abbrechen",description:"Antwortet mit 'Abbrechen' auf ein offenes Dialogfeld; funktioniert nicht in allen Dialogen"},ui_gen_layers_reset:{name:"UI-Layout zurücksetzen",description:"Setzt das Layout zurück, wenn der Server die Position beweglicher Fenster aktualisiert"},ui_load:{name:"UI-Einstellungen laden",description:"Lädt die Standard-UI-Einstellungsdatei, normalerweise Live\\ui_settings.txt"},ui_load_file:{name:"UI-Einstellungsdatei laden",description:"Lädt eine benannte UI-Einstellungsdatei"},ui_ok:{name:"UI OK",description:"Antwortet mit 'OK' auf ein offenes Dialogfeld; funktioniert nicht in allen Dialogen"},ui_remember_positions:{name:"UI-Positionen merken",description:"Ob UI-Größen und -Positionen gemerkt werden sollen. Standardmäßig aktiviert."},ui_resolution:{name:"UI-Auflösung anzeigen",description:"Zeigt die aktuelle UI-Bildschirmauflösung an"},ui_save:{name:"UI-Einstellungen speichern",description:"Speichert das UI-Layout in der Standard-UI-Einstellungsdatei, normalerweise Live\\ui_settings.txt"},ui_save_file:{name:"UI-Einstellungsdatei speichern",description:"Speichert das UI-Layout in einer benannten UI-Einstellungsdatei"},ui_tooltip_delay:{name:"Tooltip-Verzögerung setzen",description:"Setzt die zusätzliche Verzögerung in Sekunden, bevor Tooltips angezeigt werden"},unholster:{name:"Waffe ziehen",description:"Waffe ziehen"}},category_descriptions:{targeting:"Zielauswahl und -verwaltung",combat:"Waffenfeuer und Kampfaktionen",tray:"Fähigkeiten aus Aktions-Trays ausführen",power:"Schildenergie und Verteilungsverwaltung",movement:"Schiffsbewegung und Navigation",camera:"Kamerasteuerung und Ansichtsverwaltung",communication:"Chat und Teamkommunikation",system:"UI- und Systembefehle"},no_aliases:"Keine Aliase",no_aliases_defined:"Keine Aliase definiert",create_alias_to_get_started:"Erstellen Sie einen Alias um zu beginnen",create_aliases_hint:"Erstellen Sie Befehlsaliase um komplexe Befehlssequenzen zu vereinfachen.",alias_deleted:'Alias "{{alias}}" gelöscht',please_select_a_key_first:"Bitte wählen Sie zuerst eine Taste",alias_added_to_key:'Alias "{{alias}}" zu {{key}} hinzugefügt',no_active_profile:"Kein aktives Profil",alias_exists:"Ein Alias mit diesem Namen existiert bereits",alias_template_exists:'Alias "{{alias}}" existiert bereits',alias_created_from_template:'Alias "{{alias}}" aus Vorlage erstellt',template_not_found:"Vorlage nicht gefunden",alias_not_found:"Alias nicht gefunden",alias_created:'Alias "{{alias}}" erstellt',alias_updated:'Alias "{{alias}}" aktualisiert',no_profile_selected_for_import:"Kein Profil für Import ausgewählt",no_keybinds_found_in_file:"Keine Keybinds in Datei gefunden",import_failed:"Import fehlgeschlagen: {{error}}",no_aliases_found_in_file:"Keine Aliase in Datei gefunden",failed_to_get_profile_for_import:"Profil für Import konnte nicht abgerufen werden",import_completed_keybinds:"Import abgeschlossen: {{count}} Keybinds",import_completed_keybinds_with_aliases:"Import abgeschlossen: {{keyCount}} Keybinds ({{aliasCount}} Aliase ignoriert - verwenden Sie Aliase importieren)",import_completed_aliases:"Import abgeschlossen: {{count}} Aliase",no_profile_selected_to_export:"Kein Profil für Export ausgewählt",keybind_file_exported:"Keybind-Datei erfolgreich exportiert",failed_to_export_keybind_file:"Keybind-Datei Export fehlgeschlagen: {{error}}",profile_exported_json:"Profil als JSON exportiert",failed_to_export_profile:"Profil Export fehlgeschlagen: {{error}}",complete_project_exported:"Vollständiges Projekt exportiert",failed_to_export_project:"Projekt Export fehlgeschlagen: {{error}}",data_exported_csv:"Daten als CSV exportiert",failed_to_export_csv:"CSV Export fehlgeschlagen: {{error}}",html_report_exported:"HTML-Bericht exportiert",failed_to_export_html_report:"HTML-Bericht Export fehlgeschlagen: {{error}}",no_command_to_copy:"Kein Befehl zum Kopieren",no_profiles_to_export:"Keine Profile zum Exportieren",exporting_profiles:"Exportiere {{count}} Profile...",aliases_exported_successfully:"Aliase erfolgreich exportiert",failed_to_export_aliases:"Alias Export fehlgeschlagen: {{error}}",sync_folder_set:"Sync-Ordner ausgewählt",failed_to_set_sync_folder:"Sync-Ordner auswählen fehlgeschlagen: {{error}}",no_sync_folder_selected:"Kein Sync-Ordner ausgewählt",project_synced_successfully:"Projekt erfolgreich synchronisiert",permission_denied_to_folder:"Berechtigung zum Schreiben in Ordner verweigert",failed_to_sync_project:"Projekt-Synchronisation fehlgeschlagen: {{error}}",general:"Allgemein",synchronization:"Synchronisation",appearance:"Erscheinungsbild",advanced:"Erweitert",general_settings:"Allgemeine Einstellungen",synchronization_settings:"Synchronisationseinstellungen",appearance_settings:"Erscheinungsbildeinstellungen",language_settings:"Spracheinstellungen",advanced_settings:"Erweiterte Einstellungen",auto_save:"Automatisch speichern",auto_save_description:"Änderungen automatisch während der Arbeit speichern",validation_mode:"Validierungsmodus",validation_mode_description:"Wie streng Befehle und Keybinds validiert werden sollen",strict:"Streng",lenient:"Nachsichtig",disabled:"Deaktiviert",sync_folder_description:"Wählen Sie einen Ordner zum automatischen Synchronisieren Ihrer Projekte",auto_sync:"Automatische Synchronisation",auto_sync_description:"Änderungen automatisch mit dem ausgewählten Ordner synchronisieren",auto_sync_interval:"Auto-Sync-Intervall",auto_sync_interval_description:"Wie oft Ihre Änderungen automatisch synchronisiert werden sollen",after_every_change:"Nach jeder Änderung",every_1_minute:"Jede Minute",every_2_minutes:"Alle 2 Minuten",every_5_minutes:"Alle 5 Minuten",auto_sync_completed:"Auto-Sync abgeschlossen",selected_folder:"Ausgewählter Ordner",theme:"Theme",theme_description:"Wählen Sie zwischen hellem und dunklem Theme",light_theme:"Hell",dark_theme:"Dunkel",compact_mode:"Kompaktmodus",compact_mode_description:"Kompakteres Interface-Layout verwenden",interface_language:"Interface-Sprache",language_description:"Wählen Sie die Sprache für das Interface",debug_mode:"Debug-Modus",debug_mode_description:"Debug-Protokollierung und Entwicklertools aktivieren",backup_interval:"Backup-Intervall",backup_interval_description:"Wie oft Ihre Arbeit automatisch gesichert werden soll",every_15_minutes:"Alle 15 Minuten",every_30_minutes:"Alle 30 Minuten",every_hour:"Jede Stunde",preferences_saved:"Einstellungen erfolgreich gespeichert",failed_to_save_preferences:"Einstellungen konnten nicht gespeichert werden",vfx_manager_description:"Wählen Sie visuelle Effekte aus, die mit dynFxSetFXExlusionList-Aliasen deaktiviert werden sollen. Effekte sind nach Umgebung organisiert.",app_description:"Ein umfassendes webbasiertes Tool zum Erstellen, Bearbeiten und Verwalten von Star Trek Online Keybind-Konfigurationen mit visueller Bearbeitung und erweiterten Funktionen.",csv_header:"Taste,Befehl,Typ,Beschreibung,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Wählen Sie einen Raum-/Boden-Build oder Aliase aus, um die Exportvorschau anzuzeigen.",or_capture_keys:"Oder Tasten erfassen:",click_here_then_press_keys:"Hier klicken, dann Tastenkombination drücken",press_key_combination_now:"Drücken Sie jetzt die Tastenkombination...",supports_single_modifier_plus_key_combinations:"Unterstützt Einzelmodifikator + Tastenkombinationen (z.B. Strg+A, Alt+1, Umschalt+Leertaste)",alias_mode:"Alias-Modus",alias_options:"Alias-Optionen",create:"Erstellen",create_new_alias:"Neuen Alias erstellen",cycle_type:"Zyklus-Typ",filter_aliases:"Aliase filtern",select_an_alias_to_edit:"Wählen Sie einen Alias zum Bearbeiten",select_an_alias_to_see_the_generated_command:"Wählen Sie einen Alias um den generierten Befehl zu sehen",select_options:"Optionen auswählen",toggle_type:"Umschalt-Typ",no_alias_selected:"Kein Alias ausgewählt",select_alias_from_left_panel:"Wählen Sie einen Alias aus dem linken Bereich aus, um seine Befehlssequenz anzuzeigen und zu bearbeiten.",select_key_from_left_panel:"Wählen Sie eine Taste aus dem linken Bereich aus, um ihre Befehlssequenz anzuzeigen und zu bearbeiten.",validation_error:"Validierungsfehler",failed_to_load_application:"Anwendung konnte nicht geladen werden",profile_created:'Profil "{{name}}" erstellt',failed_to_create_profile:"Profil konnte nicht erstellt werden",failed_to_clone_profile:"Profil konnte nicht geklont werden",cannot_delete_the_last_profile:"Das letzte Profil kann nicht gelöscht werden",profile_deleted:'Profil "{{profileName}}" gelöscht',failed_to_delete_profile:"Profil konnte nicht gelöscht werden",invalid_key_name:"Ungültiger Tastenname",key_added:'Taste "{{keyName}}" hinzugefügt',key_already_exists:'Taste "{{keyName}}" existiert bereits',key_deleted:'Taste "{{keyName}}" gelöscht',command_added_to_alias:"Befehl zum Alias hinzugefügt",commands_added:"{{count}} Befehle hinzugefügt",command_added:"Befehl hinzugefügt",command_deleted_from_alias:"Befehl aus Alias gelöscht",command_deleted:"Befehl gelöscht",switched_to_mode:"Zu {{mode}}-Modus gewechselt",alias_already_exists:'Alias "{{name}}" existiert bereits',commands_cleared_for_key:"Befehle für {{keyName}} gelöscht",project_loaded_successfully:"Projekt erfolgreich geladen",failed_to_load_project_file:"Projektdatei konnte nicht geladen werden",invalid_project_file:"Ungültige Projektdatei",project_exported_successfully:"Projekt erfolgreich exportiert",no_commands_to_duplicate:"Keine Befehle zum Duplizieren",key_duplicated:'Taste "{{keyName}}" als "{{newKeyName}}" dupliziert',template_system_coming_soon:"Template-System kommt bald",no_commands_to_validate:"Keine Befehle zu validieren",command_chain_is_valid:"Befehlskette ist gültig",please_configure_a_command:"Bitte konfigurieren Sie einen Befehl",command_updated_successfully:"Befehl erfolgreich aktualisiert",error_message:"Fehler: {{error}}",failed_to_select_all_space_effects:"Alle Weltraum-Effekte konnten nicht ausgewählt werden",failed_to_select_all_ground_effects:"Alle Boden-Effekte konnten nicht ausgewählt werden",space_preview_error:"Weltraum-Vorschau-Fehler: {{error}}",ground_preview_error:"Boden-Vorschau-Fehler: {{error}}",space_alias_error:"Weltraum-Alias-Fehler: {{error}}",failed_to_generate_space_alias:"Weltraum-Alias konnte nicht generiert werden",ground_alias_error:"Boden-Alias-Fehler: {{error}}",failed_to_generate_ground_alias:"Boden-Alias konnte nicht generiert werden",no_profile_selected:"Kein Profil ausgewählt",no_profile_found:"Kein Profil gefunden",switched_to_theme:"Zu {{themeName}} gewechselt",language_updated:"Sprache aktualisiert",auto_sync_failed:"Auto-Sync fehlgeschlagen: {{error}}",nothing_to_copy:"Nichts zu kopieren",content_copied_to_clipboard:"Inhalt in Zwischenablage kopiert",failed_to_generate_export:"Export konnte nicht generiert werden",no_profile_selected_to_clone:"Kein Profil zum Klonen ausgewählt",no_profile_selected_to_rename:"Kein Profil zum Umbenennen ausgewählt",profile_name_is_required:"Profilname ist erforderlich",profile_name_too_long:"Profilname ist zu lang (max. 50 Zeichen)",profile_name_already_exists:"Ein Profil mit diesem Namen existiert bereits",failed_to_save_profile:"Profil konnte nicht gespeichert werden: {{error}}",no_profile_selected_to_delete:"Kein Profil zum Löschen ausgewählt",no_keybinds_to_export:"Keine Keybinds zum Exportieren",no_aliases_to_export:"Keine Aliase zum Exportieren",failed_to_reset_application:"Anwendung konnte nicht zurückgesetzt werden: {{error}}",default_demo_data_loaded:"Standard-Demo-Daten erfolgreich geladen",failed_to_load_default_data:"Standarddaten konnten nicht geladen werden",failed_to_load_default_data_with_error:"Standarddaten konnten nicht geladen werden: {{error}}",failed_to_create_profile_from_template:"Profil konnte nicht aus Template erstellt werden",profile_exported:'Profil "{{profileName}}" exportiert',failed_to_import_profile:"Profil konnte nicht importiert werden: {{error}}",application_reset_successfully:"Anwendung erfolgreich zurückgesetzt",clear_commands:"Befehle löschen",command_info:"Befehl: {{command}}\nTyp: {{type}}",commands_updated_successfully:"{{count}} Befehle erfolgreich aktualisiert",confirm_clear_commands:'Sind Sie sicher, dass Sie alle Befehle für "{{keyName}}" löschen möchten?',confirm_delete_alias:'Sind Sie sicher, dass Sie den Alias "{{aliasName}}" löschen möchten?',confirm_delete_key:'Sind Sie sicher, dass Sie die Taste "{{keyName}}" und alle ihre Befehle löschen möchten?',confirm_delete_profile:'Sind Sie sicher, dass Sie das Profil "{{profileName}}" löschen möchten?\n\nDiese Aktion kann nicht rückgängig gemacht werden.',confirm_reset_application:"Sind Sie sicher, dass Sie die Anwendung zurücksetzen möchten?\n\nDies wird alle Profile, Keybinds und Einstellungen löschen. Diese Aktion kann nicht rückgängig gemacht werden.",delete_alias:"Alias löschen",delete_key:"Taste löschen",failed_to_copy_to_clipboard:"In Zwischenablage kopieren fehlgeschlagen",failed_to_import_aliases_generic:"Aliase konnten nicht importiert werden: {{error}}",failed_to_import_keybind_file:"Keybind-Datei konnte nicht importiert werden: {{error}}",failed_to_import_keybind_file_generic:"Keybind-Datei konnte nicht importiert werden: {{error}}",generated_vertigo_aliases:"{{count}} Vertigo-Alias{{plural}} generiert! Überprüfen Sie die Alias-Liste.",keybinds_exported_successfully:"{{environment}} Keybinds erfolgreich exportiert",no_effects_selected:"Keine Effekte ausgewählt. Bitte wählen Sie mindestens einen Effekt aus, um Aliase zu generieren.",profile_created_from:'Profil "{{newName}}" aus "{{sourceProfile}}" erstellt',profile_created_from_current:'Profil "{{name}}" aus aktuellem Profil "{{currentProfile}}" erstellt',profile_created_from_template_generic:'Profil "{{profileName}}" aus Template erstellt',profile_imported_successfully:'Profil "{{profileName}}" erfolgreich importiert',profile_renamed:'Profil von "{{oldName}}" zu "{{name}}" umbenannt',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager erfolgreich geladen",switched_to_profile:"Zu Profil gewechselt: {{name}} ({{environment}})",yes:"Ja",no:"Nein",active:"Aktiv",inactive:"Inaktiv",active_state:"Aktiver Zustand",no_aliases_available:"Keine Aliase verfügbar",no_commands:"Keine Befehle",profile_not_found:"Profil nicht gefunden",click_add_command_to_start_building_your_command_chain:"Klicken Sie auf 'Befehl hinzufügen', um mit dem Erstellen Ihrer Befehlsfolge für zu beginnen",click_add_command_to_start_building_your_alias_chain:"Klicken Sie auf 'Befehl hinzufügen', um mit dem Erstellen Ihrer Alias-Folge für zu beginnen",create_aliases_in_the_alias_manager_first:"Erstellen Sie zuerst Aliase im Alias-Manager",enter_sto_command:"STO-Befehl eingeben",enter_the_exact_sto_command_syntax:"Geben Sie die genaue STO-Befehlssyntax ein",enter_your_message:"Geben Sie Ihre Nachricht ein",maximum_100_characters:"Maximal 100 Zeichen",replaced_with_your_current_targets_name:"Wird durch den Namen Ihres aktuellen Ziels ersetzt",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Dieser Alias wechselt automatisch zwischen seinen Ein/Aus-Zuständen, wenn er ausgeführt wird",select_an_alias:"Alias auswählen",select_targeting_command:"Zielbefehle auswählen",select_combat_command:"Kampfbefehle auswählen",select_shield_command:"Schildbefehle auswählen",select_movement_command:"Bewegungsbefehle auswählen",select_camera_command:"Kamerabefehle auswählen",select_system_command:"Systembefehle auswählen",select_communication_type:"Kommunikationstyp auswählen",create_alias:"Alias erstellen",alias_commands:"Alias-Befehle",available_aliases:"Verfügbare Aliase",common_commands:"Häufige Befehle",sto_variables:"STO-Variablen",example:"Beispiel",message:"Nachricht",display_text:"Anzeigetext",descriptive_name_for_this_command:"Beschreibender Name für diesen Befehl",filename:"Dateiname",position:"Position",distance:"Entfernung",amount:"Menge",state:"Zustand",command:"Befehl",command_variant:"Befehlsvariante",communication_type:"Kommunikationstyp",combat_command:"Kampfbefehl",movement_command:"Bewegungsbefehl",camera_command:"Kamerabefehl",shield_command:"Schildbefehl",system_command:"Systembefehl",targeting_command:"Zielbefehl",tray_number:"Fachnummer",slot_number:"Slotnummer",start_tray:"Startfach",end_tray:"Endfach",start_slot:"Startslot",end_slot:"Endslot",backup_tray:"Backup-Fach",backup_slot:"Backup-Slot",backup_start_tray:"Backup-Startfach",backup_end_tray:"Backup-Endfach",backup_start_slot:"Backup-Startslot",backup_end_slot:"Backup-Endslot",backup_configuration:"Backup-Konfiguration",range_configuration:"Bereichskonfiguration",backup_range_configuration:"Backup-Bereichskonfiguration",single_tray_slot:"Einzelfach-Slot",single_tray_with_backup:"Einzelfach mit Backup",tray_range:"Fachbereich",tray_range_with_backup:"Fachbereich mit Backup",whole_tray:"Ganzes Fach",whole_tray_with_backup:"Ganzes Fach mit Backup",configure_command_options_to_see_preview:"Konfigurieren Sie Befehlsoptionen, um eine Vorschau zu sehen",key:"Taste",no_profile:"Kein Profil",create_command_aliases:"Befehlsaliase erstellen",bridge_officer:"Brückenoffizier",select_bridge_officer_command:"Wählen Sie einen Brückenoffizier-Befehl",net_graph:"Netzwerk-Graph",net_graph_command:"Netzwerk-Graph-Befehl",select_net_graph_command:"Wählen Sie einen Netzwerk-Graph-Befehl",net_timing_graph:"Netzwerk-Timing-Graph",net_timing_graph_alpha:"Netzwerk-Timing-Graph Alpha",net_timing_graph_paused:"Netzwerk-Timing-Graph Pausiert",netgraph:"Netzwerk-Graph",enable_disable:"Aktivieren/Deaktivieren",transparency_level:"Transparenzstufe",pause_state:"Pausenzustand",cosmetic_command:"Kosmetischer Befehl",delay_seconds:"Verzögerung (Sekunden)",first_modifier:"Erster Modifikator",modifier_1:"Modifikator 1",modifier_2:"Modifikator 2",off:"Aus",on:"An",parameter_configuration:"Parameter-Konfiguration",second_modifier:"Zweiter Modifikator",select_cosmetic_command:"Kosmetischen Befehl auswählen",stotrayexecbytray_description:"Führt Tray-Befehle basierend auf der aktuellen Tray-Nummer aus",tray_command:"Tray-Befehl",trayexecbytray_description:"Führt Befehle basierend auf der aktuellen Tray-Nummer aus",vfx_aliases:"VFX-Aliase",delete_selected_key:"Ausgewählte Taste löschen",duplicate_selected_key:"Ausgewählte Taste duplizieren",show_all_keys:"Alle Tasten anzeigen"},te={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Ouvrir",save:"Enregistrer",explorer:"Explorateur",keybinds:"Raccourcis",import_keybinds:"Importer les raccourcis",export_keybinds:"Exporter les raccourcis",aliases:"Alias",import_aliases:"Importer les alias",export_aliases:"Exporter les alias",import:"Importer",import_menu:"Importer",backup:"Sauvegarde",backup_menu:"Sauvegarde",backup_application_state:"Sauvegarder l'état de l'application",restore_application_state:"Restaurer l'état de l'application",preferences:"Préférences",language:"Langue",sync_folder_label:"Dossier de synchronisation :",no_folder_selected:"Aucun dossier sélectionné",download:"Télécharger",vfx:"VFX",dark_mode:"Mode sombre",light_mode:"Mode clair",load_default_data:"Charger les données par défaut",reset_application:"Réinitialiser l'application",set_sync_folder:"Définir dossier de synchronisation",sync_now:"Synchroniser maintenant",about:"À propos",new:"Nouveau",clone:"Cloner",rename:"Renommer",delete:"Supprimer",space:"Espace",ground:"Sol",modified:"Modifié",valid:"Valide",keys:"touches",keys_firstupper:"Touches",key_singular:"touche",all:"Tout",add_key:"Ajouter une touche",copy:"Copier",select_a_key_to_edit:"Sélectionnez une touche à modifier",commands:"commandes",command_singular:"commande",stabilize_execution_order:"Stabiliser l'ordre d'exécution",validate:"Valider",clear:"Effacer",no_key_selected:"Aucune touche sélectionnée",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Sélectionnez une touche dans le panneau de gauche pour voir et modifier sa chaîne de commandes.",generated_command:"Commande générée :",select_a_key_to_see_the_generated_command:"Sélectionnez une touche pour voir la commande générée",add_command:"Ajouter une commande",from_template:"À partir d'un modèle",add_alias:"Ajouter un alias",copy_from_key:"Copier depuis la touche",command_library:"Bibliothèque de commandes",add_new_key:"Ajouter une nouvelle touche",key_name:"Nom de la touche :",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Utilisez des noms de touches standard comme F1, Ctrl+A, Shift+Space, etc.",common_keys:"Touches communes :",ctrl:"Ctrl",alt:"Alt",shift:"Maj",cancel:"Annuler",command_type:"Type de commande :",select_command_type:"Sélectionner le type de commande...",targeting:"Ciblage",combat:"Combat",tray_execution:"Exécution de plateau",shield_management:"Gestion des boucliers",movement:"Mouvement",camera:"Caméra",communication:"Communication",system:"Système",alias:"Alias",custom_command:"Commande personnalisée",select_a_command_type_to_see_preview:"Sélectionnez un type de commande pour voir l'aperçu",profile:"Profil",profile_name:"Nom du profil :",description_optional:"Description (optionnelle) :",command_alias_manager:"Gestionnaire d'alias de commandes",new_alias:"Nouvel alias",edit_alias:"Modifier l'alias",alias_name:"Nom de l'alias :",use_alphanumeric_characters_only_no_spaces:"Utilisez uniquement des caractères alphanumériques, pas d'espaces",description:"Description :",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Exemple : target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Utilisez dans les commandes de communication pour inclure le nom de la cible",preview:"Aperçu :",alias_myalias_command_sequence:'alias MonAlias "séquence de commandes"',save_alias:"Enregistrer l'alias",select_key:"Sélectionner la Touche",select_key_dialog_title:"Sélectionner la Touche",select_key_dialog_description:"Choisissez parmi les touches disponibles ci-dessous :",key_combination:"Combinaison de Touches :",capture_key:"Capturer la Touche",select_this_key:"Sélectionner Cette Touche",select_modifier_key:"Sélectionner Modificateur + Touche",step_1_select_modifiers_optional:"Étape 1 : Sélectionner les Modificateurs (Optionnel)",step_2_select_key:"Étape 2 : Sélectionner la Touche",common:"Commun",letters:"Lettres",numbers:"Chiffres",function:"Fonction",arrows:"Flèches",symbols:"Symboles",mouse:"Souris",gamepad:"Manette",common_keys1:"Touches communes",find_other_keys:"Trouver d'autres touches...",vfx_manager:"Gestionnaire VFX",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Sélectionnez les effets visuels à désactiver en utilisant les alias dynFxSetFXExlusionList. Les effets sont organisés par environnement.",space_effects:"Effets d'espace",select_all:"Tout sélectionner",clear_all:"Tout effacer",selected:"sélectionné",ground_effects:"Effets de sol",generated_aliases:"Alias générés :",space_alias:"Alias d'espace :",no_space_effects_selected:"Aucun effet d'espace sélectionné",ground_alias:"Alias de sol :",no_ground_effects_selected:"Aucun effet de sol sélectionné",show_player_say:"Afficher le Say du joueur",generate_aliases:"Générer des Alias",about_sto_tools_keybind_manager:"À propos de STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Un outil web complet pour créer, modifier et gérer les configurations de raccourcis Star Trek Online avec édition visuelle et fonctionnalités avancées.",features:"Fonctionnalités :",visual_keybind_editor:"Éditeur visuel de raccourcis",sto_command_library_with_search_and_categorization:"Bibliothèque de commandes STO avec recherche et catégorisation",multiple_profile_management_create_clone_rename_delete:"Gestion de profils multiples (créer, cloner, renommer, supprimer)",custom_alias_system_for_complex_command_sequences:"Système d'alias personnalisé pour les séquences de commandes complexes",vertigo_inspired_vfx_manager_for_visual_effects_control:"Gestionnaire VFX inspiré de VERTIGO pour le contrôle des effets visuels",import_export_keybind_and_alias_files_and_project_backups:"Import/export de fichiers de raccourcis et d'alias, et sauvegardes de projet",real_time_validation_and_command_preview:"Validation en temps réel et aperçu des commandes",quick_start:"Démarrage rapide :",create_a_new_profile_or_use_the_default_profile:"Créez un nouveau profil ou utilisez le profil par défaut",select_keys_from_the_grid_and_add_commands_from_the_library:"Sélectionnez des touches dans la grille et ajoutez des commandes depuis la bibliothèque",use_the_command_chain_editor_to_build_complex_sequences:"Utilisez l'éditeur de chaînes de commandes pour construire des séquences complexes",export_your_keybinds_as_txt_files_for_use_in_sto:"Exportez vos raccourcis en fichiers .txt pour utilisation dans STO",resources:"Ressources :",copyright:"© 2025 STO Tools. Tous droits réservés.",got_it:"Compris !",file_explorer:"Explorateur de fichiers",select_an_item_on_the_left_to_preview_export:"Sélectionnez un élément à gauche pour prévisualiser l'export",close:"Fermer",select_export_format:"Sélectionner le format d'export",export_as:"Exporter en :",sto_keybind_file_txt:"Fichier de raccourcis STO (.txt)",json_profile_json:"Profil JSON (.json)",complete_project_json:"Projet complet (.json)",csv_data_csv:"Données CSV (.csv)",html_report_html:"Rapport HTML (.html)",alias_file_txt:"Fichier d'alias (.txt)",environment:"Environnement :",export:"Exporter",filter_keys:"Filtrer les touches...",search_commands:"Rechercher des commandes...",e_g_f5_ctrl_a_shift_1:"ex. F5, Ctrl+A, Maj+1",enter_profile_name:"Entrez le nom du profil",describe_this_keybind_profile:"Décrivez ce profil de raccourcis",myalias:"MonAlias",brief_description_of_what_this_alias_does:"Brève description de ce que fait cet alias",enter_command_sequence_use_to_separate_commands:"Entrez la séquence de commandes (utilisez $$ pour séparer les commandes)",search_keys:"Rechercher des touches...",open_project_json:"Ouvrir le JSON du projet",save_project_json:"Enregistrer le JSON du projet",keybind_operations:"Opérations de raccourcis",alias_operations:"Opérations d'alias",settings:"Paramètres",select_profile:"Sélectionner un profil",new_profile:"Nouveau profil",clone_profile:"Cloner le profil",rename_profile:"Renommer le profil",delete_profile:"Supprimer le profil",space_mode:"Mode espace",ground_mode:"Mode sol",unsaved_changes:"Modifications non enregistrées",validation_status:"Statut de validation",bound_keys:"Touches liées",toggle_between_grid_and_categorized_view:"Basculer entre la vue grille et catégorisée",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Assure un ordre d'exécution cohérent en miroir des commandes (Phase 1 : gauche à droite, Phase 2 : droite à gauche)",validate_command_chain:"Valider la chaîne de commandes",clear_all_commands:"Effacer toutes les commandes",copy_to_clipboard:"Copier dans le presse-papiers",collapse_expand:"Réduire/Développer",insert_target_variable:"Insérer la variable $Target",sto_keybind_report:"Rapport de raccourcis STO",mode:"Mode :",generated:"Généré :",created_by:"Créé par :",statistics:"Statistiques",keys_bound:"Touches liées :",total_commands:"Total des commandes :",aliases_defined:"Alias définis :",no_keybinds_defined:"Aucun raccourci défini.",command_aliases:"Alias de commandes",report_footer:"Ce rapport a été généré par STO Tools Keybind Manager. Pour plus d'informations sur les raccourcis Star Trek Online, visitez le Wiki STO.",bridge_officer:"Officier de pont",enable_disable:"Activer/Désactiver",net_graph:"Graphique réseau",net_graph_command:"Commande de graphique réseau",select_bridge_officer_command:"Sélectionner une commande d'officier de pont",select_net_graph_command:"Sélectionner une commande de graphique réseau",transparency_level:"Niveau de transparence",pause_state:"État de pause",command_categories:{targeting:"Ciblage",combat:"Combat",cosmetic:"Cosmétique",bridge_officer:"Officier de passerelle",tray:"Exécution de Plateau",power:"Gestion des Boucliers",movement:"Mouvement",camera:"Caméra",communication:"Communication",system:"Système"},command_definitions:{target:{name:"Cibler par nom",description:"Cibler une entité par son nom (nécessite des guillemets)"},target_enemy_near:{name:"Cibler l'ennemi le plus proche",description:"Cibler l'ennemi le plus proche en vue"},target_friend_near:{name:"Cibler l'allié le plus proche",description:"Cibler l'entité amie la plus proche"},target_self:{name:"Se cibler soi-même",description:"Cibler votre propre vaisseau/personnage"},target_clear:{name:"Effacer la cible",description:"Supprimer le verrouillage de cible actuel"},target_teammate_1:{name:"Cibler coéquipier 1",description:"Cibler le premier membre de l'équipe"},target_teammate_2:{name:"Cibler coéquipier 2",description:"Cibler le deuxième membre de l'équipe"},target_teammate_3:{name:"Cibler coéquipier 3",description:"Cibler le troisième membre de l'équipe"},target_teammate_4:{name:"Cibler coéquipier 4",description:"Cibler le quatrième membre de l'équipe"},fire_all:{name:"Tirer toutes les armes",description:"Tirer toutes les armes"},fire_phasers:{name:"Tirer armes à énergie",description:"Tirer toutes les armes à énergie"},fire_torps:{name:"Tirer torpilles",description:"Tirer toutes les torpilles"},fire_mines:{name:"Tirer mines",description:"Tirer toutes les mines"},fire_phasers_torps:{name:"Tirer phasers et torpilles",description:"Tirer phasers et torpilles"},fire_projectiles:{name:"Tirer les Projectiles",description:"Tirer les torpilles et mines"},setactivecostume:{name:"Définir le Costume Actif",description:"Définit le costume actif actuel. Nécessite deux modificateurs."},custom_tray:{name:"Exécution de plateau",description:"Exécuter un emplacement de plateau spécifique"},tray_with_backup:{name:"Exécution de plateau avec sauvegarde",description:"Exécuter un emplacement de plateau spécifique avec capacité de sauvegarde"},tray_range:{name:"Exécution de plage de plateau",description:"Exécuter une plage d'emplacements de plateau"},tray_range_with_backup:{name:"Plage de plateau avec sauvegarde",description:"Exécuter une plage d'emplacements de plateau avec capacités de sauvegarde"},whole_tray:{name:"Exécution de plateau entier",description:"Exécuter tous les emplacements d'un plateau"},whole_tray_with_backup:{name:"Plateau entier avec sauvegarde",description:"Exécuter tous les emplacements d'un plateau avec plateau de sauvegarde"},distribute_shields:{name:"Distribuer les boucliers",description:"Distribue uniformément les boucliers comme si on cliquait au milieu de l'icône vaisseau et boucliers"},reroute_shields_rear:{name:"Rediriger boucliers arrière",description:"Rediriger l'énergie des boucliers vers l'arrière"},reroute_shields_left:{name:"Rediriger boucliers gauche",description:"Rediriger l'énergie des boucliers vers la gauche"},reroute_shields_right:{name:"Rediriger boucliers droite",description:"Rediriger l'énergie des boucliers vers la droite"},reroute_shields_forward:{name:"Rediriger boucliers avant",description:"Rediriger l'énergie des boucliers vers l'avant"},full_impulse:{name:"Impulsion maximale",description:"Engager le moteur à impulsion maximale"},reverse:{name:"Marche arrière",description:"Moteurs en marche arrière"},throttle_adjust:{name:"Ajuster les gaz",description:"Augmenter ou diminuer les gaz d'une certaine quantité"},throttle_set:{name:"Régler les gaz",description:"Régler les gaz à une position spécifique (négatif = marche arrière, 0 = arrêt)"},throttle_toggle:{name:"Basculer les gaz",description:"Alterner entre gaz maximum et arrêt complet"},turn_left:{name:"Tourner à gauche",description:"Tourner le vaisseau à gauche (continu tant que maintenu)"},turn_right:{name:"Tourner à droite",description:"Tourner le vaisseau à droite (continu tant que maintenu)"},pitch_up:{name:"Cabrer",description:"Cabrer le nez du vaisseau vers le haut (changement d'altitude dans l'espace)"},pitch_down:{name:"Piquer",description:"Piquer le nez du vaisseau vers le bas (changement d'altitude dans l'espace)"},strafe_left:{name:"Déplacement latéral gauche",description:"Déplacer le vaisseau latéralement à gauche"},strafe_right:{name:"Déplacement latéral droite",description:"Déplacer le vaisseau latéralement à droite"},forward:{name:"Avancer",description:"Avancer"},backward:{name:"Reculer",description:"Reculer"},auto_forward:{name:"Avance automatique",description:"Le personnage avance jusqu'à ce que de nouvelles commandes de mouvement soient données"},follow:{name:"Suivre la cible",description:"Suivre l'entité ciblée"},follow_cancel:{name:"Annuler le suivi",description:"Arrêter de suivre et oublier la cible"},zoom_in:{name:"Zoomer",description:"Zoomer la caméra"},zoom_out:{name:"Dézoomer",description:"Dézoomer la caméra"},zoom_in_small:{name:"Zoomer légèrement",description:"Zoomer légèrement la caméra"},zoom_out_small:{name:"Dézoomer légèrement",description:"Dézoomer légèrement la caméra"},cam_distance:{name:"Définir distance caméra",description:"Définir la distance de la caméra par rapport au joueur"},cam_reset:{name:"Réinitialiser caméra",description:"Réinitialiser la position de la caméra par défaut"},cam_target_lock:{name:"Verrouiller caméra sur cible",description:"Verrouiller ou déverrouiller la caméra sur la cible"},cam_cycle_distance:{name:"Alterner distance caméra",description:"Alterner la distance de la caméra entre plusieurs valeurs prédéfinies"},cam_mouse_look:{name:"Vue souris",description:"Activer le contrôle de caméra par vue souris"},cam_turn_to_face:{name:"Tourner vers la caméra",description:"Tourner le vaisseau pour faire face à la direction de la caméra"},look_up:{name:"Regarder vers le haut",description:"Changer le point de vue pour regarder droit vers le haut"},look_down:{name:"Regarder vers le bas",description:"Changer le point de vue pour regarder droit vers le bas"},team_message:{name:"Message d'équipe",description:"Envoyer un message à l'équipe"},local_message:{name:"Message local",description:"Envoyer un message à la zone locale"},zone_message:{name:"Message de zone",description:"Envoyer un message à la zone"},toggle_hud:{name:"Basculer HUD",description:"Basculer la visibilité du HUD"},screenshot:{name:"Capture d'écran",description:"Prendre une capture d'écran"},screenshot_jpg:{name:"Capture d'écran JPG",description:"Sauvegarder une capture d'écran en JPG"},autofire_toggle:{name:"Basculer tir automatique",description:"Basculer le tir automatique des armes"},bind_save_file:{name:"Sauvegarder raccourcis vers fichier",description:"Sauvegarder tous vos raccourcis dans un fichier texte"},bind_load_file:{name:"Charger raccourcis depuis fichier",description:"Charger un fichier de raccourcis dans le client"},combat_log:{name:"Basculer journal de combat",description:"Activer/désactiver l'enregistrement du journal de combat (1=activé, 0=désactivé)"},missions:{name:"Afficher/Masquer missions",description:"Afficher/masquer le journal des missions"},inventory:{name:"Afficher/Masquer inventaire",description:"Afficher/masquer votre inventaire"},map:{name:"Afficher/Masquer carte",description:"Afficher/masquer la fenêtre de carte"},logout:{name:"Se déconnecter",description:"Se déconnecter du personnage actuel."},quit:{name:"Quitter le jeu",description:"Fermer la fenêtre."},ui_load:{name:"Charger les paramètres UI",description:"Charge le fichier de sauvegarde par défaut des fenêtres UI, généralement Live\\ui_settings.txt"},ui_save:{name:"Sauvegarder les paramètres UI",description:"Sauvegarde la mise en page UI dans le fichier de sauvegarde par défaut des fenêtres UI, généralement Live\\ui_settings.txt"},ui_load_file:{name:"Charger le fichier de paramètres UI",description:"Charge le fichier de sauvegarde des fenêtres UI nommé"},ui_save_file:{name:"Sauvegarder le fichier de paramètres UI",description:"Sauvegarde la mise en page UI dans le fichier de sauvegarde des fenêtres UI nommé"},ui_cancel:{name:"UI Annuler",description:'Répond "Annuler" à une boîte de dialogue ouverte; peut ne pas fonctionner dans tous les dialogues.'},ui_ok:{name:"UI OK",description:'Répond "OK" à une boîte de dialogue ouverte; peut ne pas fonctionner dans tous les dialogues.'},chat_log:{name:"Basculer le journal de chat",description:"Activer/désactiver le journal de chat. 1=activé, 0=désactivé, pas de paramètre=afficher le statut. Préfixer ++ le transforme en bascule"},remember_ui_lists:{name:"Mémoriser les listes UI",description:"S'il faut mémoriser le placement et la largeur des colonnes des listes UI."},ui_remember_positions:{name:"Mémoriser les positions UI",description:"S'il faut mémoriser les tailles et positions UI. Activé par défaut."},safe_login:{name:"Connexion sécurisée",description:"Si vrai, alors connecte le joueur à sa carte statique la plus récente au lieu de n'importe quoi d'autre."},goto_character_select:{name:"Aller à la sélection de personnage",description:"Aller à l'écran de sélection de personnage sans se déconnecter."},ui_gen_layers_reset:{name:"Réinitialiser la mise en page UI",description:"Réinitialise la mise en page, utilisé quand le serveur met à jour les positions des fenêtres mobiles"},ui_resolution:{name:"Afficher la résolution UI",description:"Affiche la résolution d'écran UI actuelle."},ui_tooltip_delay:{name:"Définir le délai d'infobulle",description:"Définit le délai supplémentaire, en secondes, avant que les infobulles apparaissent"},show_game_ui:{name:"Afficher l'UI du jeu",description:"Afficher l'UI du jeu"},show_game_ui_no_extra_keybinds:{name:"Afficher l'UI du jeu (sans raccourcis supplémentaires)",description:"Cette commande n'ajoute aucun raccourci pour afficher l'UI quand l'utilisateur appuie sur échap"},change_instance:{name:"Changer d'instance",description:"Changer vers une instance déjà créée de la même carte. Ne fonctionne que quand pas en alerte rouge."},aim:{name:"Viser/Lunette",description:"Activer/désactiver la lunette. En mode lunette le joueur fait plus de dégâts. Peut être utilisé comme bascule ou appuyer et maintenir"},holster:{name:"Ranger l'arme",description:"Tenter de ranger votre arme active"},holster_toggle:{name:"Basculer ranger l'arme",description:"Tenter de ranger ou dégainer vos armes"},unholster:{name:"Dégainer l'arme",description:"Tenter de dégainer votre arme active"},toggle_shooter_mode:{name:"Basculer le mode tireur",description:"Activer/désactiver le mode tireur"},shooter_primary:{name:"Tireur primaire",description:"Action primaire du mode tireur"},shooter_secondary:{name:"Tireur secondaire",description:"Action secondaire du mode tireur"},shooter_tertiary:{name:"Tireur tertiaire",description:"Action tertiaire du mode tireur"},shooter_clear_offset_tray_binds:{name:"Effacer les liaisons de plateau de décalage du tireur",description:"Effacer l'emplacement de départ et le mouvement de la boîte d'action jaune qui apparaît sur le plateau en mode tireur"},shooter_clear_overlay_tray_binds:{name:"Effacer les liaisons de plateau superposé du tireur",description:"Effacer les liaisons de plateau superposé pour le mode tireur"},shooter_set_offset_tray_binds:{name:"Définir les liaisons de plateau de décalage du tireur",description:"Définir l'emplacement de départ et le mouvement de la boîte d'action jaune qui apparaît sur le plateau en mode tireur"},shooter_set_overlay_tray_binds:{name:"Définir les liaisons de plateau superposé du tireur",description:"Définir les liaisons de plateau superposé pour le mode tireur"},setrallypoint:{name:"Définir Point de Ralliement",description:"Définit un point de ralliement pour votre cible actuelle"},setrallypointconsole:{name:"Définir Point de Ralliement (Console)",description:"Définit un point de ralliement pour votre cible actuelle (variante console)"},clearrallypoint:{name:"Effacer Point de Ralliement",description:"Efface le point de ralliement pour votre cible actuelle"},clearallrallypoints:{name:"Effacer Tous les Points de Ralliement",description:"Efface tous les points de ralliement"},assist:{name:"Assister",description:"Assister '<name>': Assiste l'entité portant le nom correspondant. Si aucun nom n'est donné, assiste votre cible actuelle."},net_timing_graph:"Graphique de Timing Réseau",net_timing_graph_alpha:"Graphique de Timing Réseau Alpha",net_timing_graph_paused:"Graphique de Timing Réseau Pausé",netgraph:"Graphique Réseau",bridge_officer_command:"Commande d'Officier de Pont",select_bridge_officer_command:"Sélectionnez une commande d'officier de pont",entity_name_optional:"Nom de l'entité (optionnel)",entity_name_optional_placeholder:"Entrez le nom de l'entité (optionnel)"},category_descriptions:{targeting:"Sélection et gestion des cibles",combat:"Tir d'armes et actions de combat",tray:"Exécuter des capacités depuis les plateaux d'action",power:"Gestion de l'énergie et distribution des boucliers",movement:"Mouvement et navigation du vaisseau",camera:"Contrôle de caméra et gestion de vue",communication:"Chat et communication d'équipe",system:"Commandes UI et système"},no_aliases:"Aucun alias",no_aliases_defined:"Aucun alias défini",create_alias_to_get_started:"Créez un alias pour commencer",create_aliases_hint:"Créez des alias de commandes pour simplifier les séquences de commandes complexes.",alias_deleted:'Alias "{{alias}}" supprimé',please_select_a_key_first:"Veuillez d'abord sélectionner une touche",alias_added_to_key:'Alias "{{alias}}" ajouté à {{key}}',no_active_profile:"Aucun profil actif",alias_exists:"Un alias avec ce nom existe déjà",alias_template_exists:'L\'alias "{{alias}}" existe déjà',alias_created_from_template:'Alias "{{alias}}" créé à partir du modèle',template_not_found:"Modèle non trouvé",alias_not_found:"Alias non trouvé",alias_created:'Alias "{{alias}}" créé',alias_updated:'Alias "{{alias}}" mis à jour',no_profile_selected_for_import:"Aucun profil sélectionné pour l'importation",no_keybinds_found_in_file:"Aucun raccourci trouvé dans le fichier",import_failed:"Échec de l'importation : {{error}}",no_aliases_found_in_file:"Aucun alias trouvé dans le fichier",failed_to_get_profile_for_import:"Échec de l'obtention du profil pour l'importation",import_completed_keybinds:"Importation terminée : {{count}} raccourcis",import_completed_keybinds_with_aliases:"Importation terminée : {{keyCount}} raccourcis ({{aliasCount}} alias ignorés - utilisez Importer les alias)",import_completed_aliases:"Importation terminée : {{count}} alias",no_profile_selected_to_export:"Aucun profil sélectionné pour l'exportation",keybind_file_exported:"Fichier de raccourcis exporté avec succès",failed_to_export_keybind_file:"Échec de l'exportation du fichier de raccourcis : {{error}}",profile_exported_json:"Profil exporté en JSON",failed_to_export_profile:"Échec de l'exportation du profil : {{error}}",complete_project_exported:"Projet complet exporté",failed_to_export_project:"Échec de l'exportation du projet : {{error}}",data_exported_csv:"Données exportées en CSV",failed_to_export_csv:"Échec de l'exportation CSV : {{error}}",html_report_exported:"Rapport HTML exporté",failed_to_export_html_report:"Échec de l'exportation du rapport HTML : {{error}}",no_command_to_copy:"Aucune commande à copier",no_profiles_to_export:"Aucun profil à exporter",exporting_profiles:"Exportation de {{count}} profils...",aliases_exported_successfully:"Alias exportés avec succès",failed_to_export_aliases:"Échec de l'exportation des alias : {{error}}",sync_folder_set:"Dossier de synchronisation sélectionné",failed_to_set_sync_folder:"Échec de la sélection du dossier de synchronisation : {{error}}",no_sync_folder_selected:"Aucun dossier de synchronisation sélectionné",project_synced_successfully:"Projet synchronisé avec succès",permission_denied_to_folder:"Permission refusée pour écrire dans le dossier",failed_to_sync_project:"Échec de la synchronisation du projet : {{error}}",general:"Général",synchronization:"Synchronisation",appearance:"Apparence",advanced:"Avancé",general_settings:"Paramètres généraux",synchronization_settings:"Paramètres de synchronisation",appearance_settings:"Paramètres d'apparence",language_settings:"Paramètres de langue",advanced_settings:"Paramètres avancés",auto_save:"Sauvegarde automatique",auto_save_description:"Sauvegarder automatiquement les modifications pendant le travail",validation_mode:"Mode de validation",validation_mode_description:"Niveau de validation des commandes et raccourcis",strict:"Strict",lenient:"Souple",disabled:"Désactivé",sync_folder_description:"Choisissez un dossier pour synchroniser automatiquement vos projets",auto_sync:"Synchronisation automatique",auto_sync_description:"Synchroniser automatiquement les modifications avec le dossier sélectionné",auto_sync_interval:"Intervalle de synchronisation automatique",auto_sync_interval_description:"À quelle fréquence synchroniser automatiquement vos modifications",after_every_change:"Après chaque modification",every_1_minute:"Chaque minute",every_2_minutes:"Toutes les 2 minutes",every_5_minutes:"Toutes les 5 minutes",auto_sync_completed:"Synchronisation automatique terminée",selected_folder:"Dossier sélectionné",theme:"Thème",theme_description:"Choisissez entre les thèmes clair et sombre",light_theme:"Clair",dark_theme:"Sombre",compact_mode:"Mode compact",compact_mode_description:"Utiliser une disposition d'interface plus compacte",interface_language:"Langue de l'interface",language_description:"Choisissez la langue de l'interface",debug_mode:"Mode débogage",debug_mode_description:"Activer la journalisation de débogage et les outils de développement",backup_interval:"Intervalle de sauvegarde",backup_interval_description:"Fréquence de sauvegarde automatique de votre travail",every_15_minutes:"Toutes les 15 minutes",every_30_minutes:"Toutes les 30 minutes",every_hour:"Toutes les heures",preferences_saved:"Préférences sauvegardées avec succès",failed_to_save_preferences:"Échec de la sauvegarde des préférences",vfx_manager_description:"Sélectionnez les effets visuels à désactiver en utilisant les alias dynFxSetFXExlusionList. Les effets sont organisés par environnement.",app_description:"Un outil web complet pour créer, éditer et gérer les configurations de raccourcis de Star Trek Online avec édition visuelle et fonctionnalités avancées.",csv_header:"Touche,Commande,Type,Description,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Sélectionnez une construction Espace/Sol ou des Alias pour prévisualiser l'exportation.",or_capture_keys:"Ou capturer les touches :",click_here_then_press_keys:"Cliquez ici, puis appuyez sur la combinaison de touches",press_key_combination_now:"Appuyez sur la combinaison de touches maintenant...",supports_single_modifier_plus_key_combinations:"Prend en charge les combinaisons modificateur unique + touche (ex. Ctrl+A, Alt+1, Shift+Space)",alias_mode:"Mode alias",alias_options:"Options d'alias",create:"Créer",create_new_alias:"Créer un nouvel alias",cycle_type:"Type de cycle",filter_aliases:"Filtrer les alias",select_an_alias_to_edit:"Sélectionnez un alias à modifier",select_an_alias_to_see_the_generated_command:"Sélectionnez un alias pour voir la commande générée",select_options:"Sélectionner les options",toggle_type:"Type de basculement",no_alias_selected:"Aucun alias sélectionné",select_alias_from_left_panel:"Sélectionnez un alias dans le panneau de gauche pour afficher et modifier sa chaîne de commandes.",select_key_from_left_panel:"Sélectionnez une touche dans le panneau de gauche pour afficher et modifier sa chaîne de commandes.",validation_error:"Erreur de validation",failed_to_load_application:"Impossible de charger l'application",profile_created:'Profil "{{name}}" créé',failed_to_create_profile:"Impossible de créer le profil",failed_to_clone_profile:"Impossible de cloner le profil",cannot_delete_the_last_profile:"Impossible de supprimer le dernier profil",profile_deleted:'Profil "{{profileName}}" supprimé',failed_to_delete_profile:"Impossible de supprimer le profil",invalid_key_name:"Nom de touche invalide",key_added:'Touche "{{keyName}}" ajoutée',key_already_exists:'La touche "{{keyName}}" existe déjà',key_deleted:'Touche "{{keyName}}" supprimée',command_added_to_alias:"Commande ajoutée à l'alias",commands_added:"{{count}} commandes ajoutées",command_added:"Commande ajoutée",command_deleted_from_alias:"Commande supprimée de l'alias",command_deleted:"Commande supprimée",switched_to_mode:"Passé au mode {{mode}}",alias_already_exists:'L\'alias "{{name}}" existe déjà',commands_cleared_for_key:"Commandes effacées pour {{keyName}}",project_loaded_successfully:"Projet chargé avec succès",failed_to_load_project_file:"Impossible de charger le fichier de projet",invalid_project_file:"Fichier de projet invalide",project_exported_successfully:"Projet exporté avec succès",no_commands_to_duplicate:"Aucune commande à dupliquer",key_duplicated:'Touche "{{keyName}}" dupliquée en "{{newKeyName}}"',template_system_coming_soon:"Système de modèles bientôt disponible",no_commands_to_validate:"Aucune commande à valider",command_chain_is_valid:"Chaîne de commandes valide",please_configure_a_command:"Veuillez configurer une commande",command_updated_successfully:"Commande mise à jour avec succès",error_message:"Erreur : {{error}}",failed_to_select_all_space_effects:"Impossible de sélectionner tous les effets d'espace",failed_to_select_all_ground_effects:"Impossible de sélectionner tous les effets de sol",space_preview_error:"Erreur de prévisualisation d'espace : {{error}}",ground_preview_error:"Erreur de prévisualisation de sol : {{error}}",space_alias_error:"Erreur d'alias d'espace : {{error}}",failed_to_generate_space_alias:"Impossible de générer l'alias d'espace",ground_alias_error:"Erreur d'alias de sol : {{error}}",failed_to_generate_ground_alias:"Impossible de générer l'alias de sol",no_profile_selected:"Aucun profil sélectionné",no_profile_found:"Aucun profil trouvé",switched_to_theme:"Passé à {{themeName}}",language_updated:"Langue mise à jour",auto_sync_failed:"Synchronisation automatique échouée : {{error}}",nothing_to_copy:"Rien à copier",content_copied_to_clipboard:"Contenu copié dans le presse-papiers",failed_to_generate_export:"Impossible de générer l'export",no_profile_selected_to_clone:"Aucun profil sélectionné pour cloner",no_profile_selected_to_rename:"Aucun profil sélectionné pour renommer",profile_name_is_required:"Le nom du profil est requis",profile_name_too_long:"Le nom du profil est trop long (max 50 caractères)",profile_name_already_exists:"Un profil avec ce nom existe déjà",failed_to_save_profile:"Impossible de sauvegarder le profil : {{error}}",no_profile_selected_to_delete:"Aucun profil sélectionné pour supprimer",no_keybinds_to_export:"Aucun raccourci à exporter",no_aliases_to_export:"Aucun alias à exporter",failed_to_reset_application:"Impossible de réinitialiser l'application : {{error}}",default_demo_data_loaded:"Données de démonstration par défaut chargées avec succès",failed_to_load_default_data:"Impossible de charger les données par défaut",failed_to_load_default_data_with_error:"Impossible de charger les données par défaut : {{error}}",failed_to_create_profile_from_template:"Impossible de créer le profil à partir du modèle",profile_exported:'Profil "{{profileName}}" exporté',failed_to_import_profile:"Impossible d'importer le profil : {{error}}",application_reset_successfully:"Application réinitialisée avec succès",clear_commands:"Effacer les commandes",command_info:"Commande : {{command}}\nType : {{type}}",commands_updated_successfully:"{{count}} commandes mises à jour avec succès",confirm_clear_commands:'Êtes-vous sûr de vouloir effacer toutes les commandes pour "{{keyName}}" ?',confirm_delete_alias:'Êtes-vous sûr de vouloir supprimer l\'alias "{{aliasName}}" ?',confirm_delete_key:'Êtes-vous sûr de vouloir supprimer la touche "{{keyName}}" et toutes ses commandes ?',confirm_delete_profile:'Êtes-vous sûr de vouloir supprimer le profil "{{profileName}}" ?\n\nCette action ne peut pas être annulée.',confirm_reset_application:"Êtes-vous sûr de vouloir réinitialiser l'application ?\n\nCela supprimera tous les profils, raccourcis et paramètres. Cette action ne peut pas être annulée.",delete_alias:"Supprimer l'alias",delete_key:"Supprimer la touche",failed_to_copy_to_clipboard:"Échec de la copie dans le presse-papiers",failed_to_import_aliases_generic:"Impossible d'importer les alias : {{error}}",failed_to_import_keybind_file:"Impossible d'importer le fichier de raccourcis : {{error}}",failed_to_import_keybind_file_generic:"Impossible d'importer le fichier de raccourcis : {{error}}",generated_vertigo_aliases:"{{count}} alias Vertigo généré{{plural}} ! Vérifiez la liste des alias.",keybinds_exported_successfully:"Raccourcis {{environment}} exportés avec succès",no_effects_selected:"Aucun effet sélectionné. Veuillez sélectionner au moins un effet pour générer des alias.",profile_created_from:'Profil "{{newName}}" créé à partir de "{{sourceProfile}}"',profile_created_from_current:'Profil "{{name}}" créé à partir du profil actuel "{{currentProfile}}"',profile_created_from_template_generic:'Profil "{{profileName}}" créé à partir du modèle',profile_imported_successfully:'Profil "{{profileName}}" importé avec succès',profile_renamed:'Profil renommé de "{{oldName}}" à "{{name}}"',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager chargé avec succès",switched_to_profile:"Passé au profil : {{name}} ({{environment}})",yes:"Oui",no:"Non",active:"Actif",inactive:"Inactif",active_state:"État Actif",no_aliases_available:"Aucun alias disponible",no_commands:"Aucune commande",profile_not_found:"Profil introuvable",click_add_command_to_start_building_your_command_chain:"Cliquez sur 'Ajouter une commande' pour commencer à construire votre chaîne de commandes pour",click_add_command_to_start_building_your_alias_chain:"Cliquez sur 'Ajouter une commande' pour commencer à construire votre chaîne d'alias pour",create_aliases_in_the_alias_manager_first:"Créez d'abord des alias dans le Gestionnaire d'alias",enter_sto_command:"Entrez la commande STO",enter_the_exact_sto_command_syntax:"Entrez la syntaxe exacte de la commande STO",enter_your_message:"Entrez votre message",maximum_100_characters:"Maximum 100 caractères",replaced_with_your_current_targets_name:"Remplacé par le nom de votre cible actuelle",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Cet alias basculera automatiquement entre ses états marche/arrêt lorsqu'il sera exécuté",select_an_alias:"Sélectionner un alias",select_targeting_command:"Sélectionner une commande de ciblage",select_combat_command:"Sélectionner une commande de combat",select_shield_command:"Sélectionner une commande de bouclier",select_movement_command:"Sélectionner une commande de mouvement",select_camera_command:"Sélectionner une commande de caméra",select_system_command:"Sélectionner une commande système",select_communication_type:"Sélectionner le type de communication",create_alias:"Créer un Alias",alias_commands:"Commandes d'Alias",available_aliases:"Alias Disponibles",common_commands:"Commandes Communes",sto_variables:"Variables STO",example:"Exemple",message:"Message",display_text:"Texte d'Affichage",descriptive_name_for_this_command:"Nom descriptif pour cette commande",filename:"Nom de fichier",position:"Position",distance:"Distance",amount:"Quantité",state:"État",command:"Commande",command_variant:"Variante de Commande",communication_type:"Type de Communication",combat_command:"Commande de Combat",movement_command:"Commande de Mouvement",camera_command:"Commande de Caméra",shield_command:"Commande de Bouclier",system_command:"Commande Système",targeting_command:"Commande de Ciblage",tray_number:"Numéro de Plateau",slot_number:"Numéro d'Emplacement",start_tray:"Plateau de Début",end_tray:"Plateau de Fin",start_slot:"Emplacement de Début",end_slot:"Emplacement de Fin",backup_tray:"Plateau de Sauvegarde",backup_slot:"Emplacement de Sauvegarde",backup_start_tray:"Plateau de Début de Sauvegarde",backup_end_tray:"Plateau de Fin de Sauvegarde",backup_start_slot:"Emplacement de Début de Sauvegarde",backup_end_slot:"Emplacement de Fin de Sauvegarde",backup_configuration:"Configuration de Sauvegarde",range_configuration:"Configuration de Plage",backup_range_configuration:"Configuration de Plage de Sauvegarde",single_tray_slot:"Emplacement de Plateau Unique",single_tray_with_backup:"Plateau Unique avec Sauvegarde",tray_range:"Plage de Plateau",tray_range_with_backup:"Plage de Plateau avec Sauvegarde",whole_tray:"Plateau Complet",whole_tray_with_backup:"Plateau Complet avec Sauvegarde",configure_command_options_to_see_preview:"Configurez les options de commande pour voir l'aperçu",key:"touche",no_profile:"Aucun profil",stotrayexecbytray_description:"STOTrayExecByTray (affiche la liaison de touche dans l'UI)",trayexecbytray_description:"TrayExecByTray (aucune indication d'UI)",parameter_configuration:"Configuration des paramètres",modifier_1:"Modificateur 1",modifier_2:"Modificateur 2",first_modifier:"Premier modificateur",second_modifier:"Deuxième modificateur",cosmetic_command:"Commande Cosmétique",select_cosmetic_command:"Sélectionnez une commande cosmétique",tray_command:"Commande de Plateau",vfx_aliases:"Alias VFX",create_command_aliases:"Créer des Alias de Commandes",on:"Activé",off:"Désactivé",delay_seconds:"Délai (secondes)",net_timing_graph:"Graphique de timing réseau",net_timing_graph_alpha:"Graphique de timing réseau alpha",net_timing_graph_paused:"Graphique de timing réseau en pause",netgraph:"Graphique réseau",delete_selected_key:"Supprimer la touche sélectionnée",duplicate_selected_key:"Dupliquer la touche sélectionnée",show_all_keys:"Afficher toutes les touches"},ie={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Abrir",save:"Guardar",explorer:"Explorador",keybinds:"Atajos de teclado",import_keybinds:"Importar atajos de teclado",export_keybinds:"Exportar atajos de teclado",aliases:"Alias",import_aliases:"Importar alias",export_aliases:"Exportar alias",import:"Importar",import_menu:"Importar",backup:"Respaldo",backup_menu:"Respaldo",backup_application_state:"Respaldar estado de la aplicación",restore_application_state:"Restaurar estado de la aplicación",preferences:"Preferencias",language:"Idioma",sync_folder_label:"Carpeta de sincronización:",no_folder_selected:"Ninguna carpeta seleccionada",download:"Descargar",vfx:"VFX",dark_mode:"Modo oscuro",light_mode:"Modo claro",load_default_data:"Cargar datos predeterminados",reset_application:"Restablecer aplicación",set_sync_folder:"Establecer carpeta de sincronización",sync_now:"Sincronizar ahora",about:"Acerca de",new:"Nuevo",clone:"Clonar",rename:"Renombrar",delete:"Eliminar",space:"Espacio",ground:"Suelo",modified:"Modificado",valid:"Válido",keys:"teclas",keys_firstupper:"Teclas",key_singular:"tecla",all:"Todo",add_key:"Agregar tecla",copy:"Copiar",select_a_key_to_edit:"Selecciona una tecla para editar",commands:"comandos",command_singular:"comando",stabilize_execution_order:"Estabilizar orden de ejecución",validate:"Validar",clear:"Limpiar",no_key_selected:"Ninguna tecla seleccionada",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Selecciona una tecla del panel izquierdo para ver y editar su cadena de comandos.",generated_command:"Comando generado:",select_a_key_to_see_the_generated_command:"Selecciona una tecla para ver el comando generado",add_command:"Agregar comando",from_template:"Desde plantilla",add_alias:"Agregar alias",copy_from_key:"Copiar desde tecla",command_library:"Biblioteca de comandos",add_new_key:"Agregar nueva tecla",key_name:"Nombre de la tecla:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Use nombres de teclas estándar como F1, Ctrl+A, Shift+Space, etc.",or_capture_keys:"O capturar teclas:",click_here_then_press_keys:"Haga clic aquí, luego presione la combinación de teclas",press_key_combination_now:"Presione la combinación de teclas ahora...",supports_single_modifier_plus_key_combinations:"Admite combinaciones de modificador único + tecla (ej. Ctrl+A, Alt+1, Shift+Space)",common_keys:"Teclas comunes:",ctrl:"Ctrl",alt:"Alt",shift:"Mayús",cancel:"Cancelar",command_type:"Tipo de comando:",select_command_type:"Seleccionar tipo de comando...",targeting:"Apuntado",combat:"Combate",tray_execution:"Ejecución de bandeja",shield_management:"Gestión de escudos",movement:"Movimiento",camera:"Cámara",communication:"Comunicación",system:"Sistema",alias:"Alias",custom_command:"Comando personalizado",select_a_command_type_to_see_preview:"Selecciona un tipo de comando para ver vista previa",profile:"Perfil",profile_name:"Nombre del perfil:",description_optional:"Descripción (opcional):",command_alias_manager:"Gestor de alias de comandos",new_alias:"Nuevo alias",edit_alias:"Editar alias",alias_name:"Nombre del alias:",use_alphanumeric_characters_only_no_spaces:"Use solo caracteres alfanuméricos, sin espacios",description:"Descripción:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Ejemplo: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Use en comandos de comunicación para incluir nombre del objetivo",preview:"Vista previa:",alias_myalias_command_sequence:'alias MiAlias "secuencia de comandos"',save_alias:"Guardar alias",select_key:"Seleccionar Tecla",select_key_dialog_title:"Seleccionar Tecla",select_key_dialog_description:"Elija de las teclas disponibles a continuación:",key_combination:"Combinación de Teclas:",capture_key:"Capturar Tecla",select_this_key:"Seleccionar Esta Tecla",select_modifier_key:"Seleccionar Modificador + Tecla",step_1_select_modifiers_optional:"Paso 1: Seleccionar Modificadores (Opcional)",step_2_select_key:"Paso 2: Seleccionar Tecla",common:"Común",letters:"Letras",numbers:"Números",function:"Función",arrows:"Flechas",symbols:"Símbolos",mouse:"Ratón",gamepad:"Gamepad",common_keys1:"Teclas comunes",find_other_keys:"Encontrar otras teclas...",vfx_manager:"Gestor VFX",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Selecciona efectos visuales para desactivar usando alias dynFxSetFXExlusionList. Los efectos están organizados por entorno.",space_effects:"Efectos de espacio",select_all:"Seleccionar Todo",clear_all:"Limpiar Todo",selected:"seleccionado",ground_effects:"Efectos de suelo",generated_aliases:"Alias generados:",space_alias:"Alias de espacio:",no_space_effects_selected:"No hay efectos espaciales seleccionados",ground_alias:"Alias de suelo:",no_ground_effects_selected:"No hay efectos terrestres seleccionados",show_player_say:"Mostrar Decir del Jugador",generate_aliases:"Generar Alias",about_sto_tools_keybind_manager:"Acerca de STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Una herramienta web integral para crear, editar y gestionar configuraciones de atajos de teclado de Star Trek Online con edición visual y características avanzadas.",features:"Características:",visual_keybind_editor:"Editor visual de atajos de teclado",sto_command_library_with_search_and_categorization:"Biblioteca de comandos STO con búsqueda y categorización",multiple_profile_management_create_clone_rename_delete:"Gestión de múltiples perfiles (crear, clonar, renombrar, eliminar)",custom_alias_system_for_complex_command_sequences:"Sistema de alias personalizado para secuencias de comandos complejas",vertigo_inspired_vfx_manager_for_visual_effects_control:"Gestor VFX inspirado en VERTIGO para control de efectos visuales",import_export_keybind_and_alias_files_and_project_backups:"Importar/exportar archivos de atajos y alias, y respaldos de proyecto",real_time_validation_and_command_preview:"Validación en tiempo real y vista previa de comandos",quick_start:"Inicio rápido:",create_a_new_profile_or_use_the_default_profile:"Crea un nuevo perfil o usa el perfil predeterminado",select_keys_from_the_grid_and_add_commands_from_the_library:"Selecciona teclas de la cuadrícula y agrega comandos desde la biblioteca",use_the_command_chain_editor_to_build_complex_sequences:"Usa el editor de cadenas de comandos para construir secuencias complejas",export_your_keybinds_as_txt_files_for_use_in_sto:"Exporta tus atajos como archivos .txt para usar en STO",resources:"Recursos:",copyright:"© 2025 STO Tools. Todos los derechos reservados.",got_it:"¡Entendido!",file_explorer:"Explorador de archivos",select_an_item_on_the_left_to_preview_export:"Selecciona un elemento a la izquierda para previsualizar exportación",close:"Cerrar",select_export_format:"Seleccionar formato de exportación",export_as:"Exportar como:",sto_keybind_file_txt:"Archivo de atajos STO (.txt)",json_profile_json:"Perfil JSON (.json)",complete_project_json:"Proyecto completo (.json)",csv_data_csv:"Datos CSV (.csv)",html_report_html:"Reporte HTML (.html)",alias_file_txt:"Archivo de alias (.txt)",environment:"Entorno:",export:"Exportar",filter_keys:"Filtrar teclas...",search_commands:"Buscar comandos...",e_g_f5_ctrl_a_shift_1:"ej. F5, Ctrl+A, Mayús+1",enter_profile_name:"Ingresa nombre del perfil",describe_this_keybind_profile:"Describe este perfil de atajos de teclado",myalias:"MiAlias",brief_description_of_what_this_alias_does:"Breve descripción de lo que hace este alias",enter_command_sequence_use_to_separate_commands:"Ingresa secuencia de comandos (usa $$ para separar comandos)",search_keys:"Buscar teclas...",open_project_json:"Abrir JSON del proyecto",save_project_json:"Guardar JSON del proyecto",keybind_operations:"Operaciones de atajos",alias_operations:"Operaciones de alias",settings:"Configuración",select_profile:"Seleccionar perfil",new_profile:"Nuevo perfil",clone_profile:"Clonar perfil",rename_profile:"Renombrar perfil",delete_profile:"Eliminar perfil",space_mode:"Modo espacio",ground_mode:"Modo suelo",unsaved_changes:"Cambios no guardados",validation_status:"Estado de validación",bound_keys:"Teclas vinculadas",toggle_between_grid_and_categorized_view:"Alternar entre vista de cuadrícula y categorizada",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Asegura orden de ejecución consistente reflejando comandos (Fase 1: izquierda a derecha, Fase 2: derecha a izquierda)",validate_command_chain:"Validar cadena de comandos",clear_all_commands:"Limpiar todos los comandos",copy_to_clipboard:"Copiar al portapapeles",collapse_expand:"Contraer/Expandir",insert_target_variable:"Insertar variable $Target",sto_keybind_report:"Reporte de atajos STO",mode:"Modo:",generated:"Generado:",created_by:"Creado por:",statistics:"Estadísticas",keys_bound:"Teclas vinculadas:",total_commands:"Total de comandos:",aliases_defined:"Alias definidos:",no_keybinds_defined:"No hay atajos de teclado definidos.",command_aliases:"Alias de comandos",vfx_aliases:"Alias VFX",create_command_aliases:"Crear Alias de Comandos",select_bridge_officer_command:{name:"Seleccionar comando de oficial de puente",description:"Selecciona un comando de oficial de puente"},report_footer:"Este reporte fue generado por STO Tools Keybind Manager. Para más información sobre atajos de teclado de Star Trek Online, visita el Wiki de STO.",command_categories:{targeting:"Apuntado",combat:"Combate",cosmetic:"Cosmético",bridge_officer:"Oficial de Puente",tray:"Ejecución de Bandeja",power:"Gestión de Escudos",movement:"Movimiento",camera:"Cámara",communication:"Comunicación",system:"Sistema"},command_definitions:{target:{name:"Apuntar por nombre",description:"Apuntar entidad por nombre (requiere comillas)"},target_enemy_near:{name:"Apuntar enemigo más cercano",description:"Apuntar al enemigo más cercano visible"},target_friend_near:{name:"Apuntar aliado más cercano",description:"Apuntar a la entidad aliada más cercana"},target_self:{name:"Apuntarse a sí mismo",description:"Apuntar a tu propia nave/personaje"},target_clear:{name:"Limpiar objetivo",description:"Eliminar el bloqueo de objetivo actual"},target_teammate_1:{name:"Apuntar compañero 1",description:"Apuntar al primer miembro del equipo"},target_teammate_2:{name:"Apuntar compañero 2",description:"Apuntar al segundo miembro del equipo"},target_teammate_3:{name:"Apuntar compañero 3",description:"Apuntar al tercer miembro del equipo"},target_teammate_4:{name:"Apuntar compañero 4",description:"Apuntar al cuarto miembro del equipo"},fire_all:{name:"Disparar todas las armas",description:"Disparar todas las armas"},fire_phasers:{name:"Disparar armas de energía",description:"Disparar todas las armas de energía"},fire_torps:{name:"Disparar torpedos",description:"Disparar todos los torpedos"},fire_mines:{name:"Disparar minas",description:"Disparar todas las minas"},fire_phasers_torps:{name:"Disparar phasers y torpedos",description:"Disparar phasers y torpedos"},fire_projectiles:{name:"Disparar Proyectiles",description:"Disparar torpedos y minas"},setactivecostume:{name:"Establecer Disfraz Activo",description:"Establece el disfraz activo actual. Requiere dos modificadores."},custom_tray:{name:"Ejecución de bandeja",description:"Ejecutar ranura específica de bandeja"},tray_with_backup:{name:"Ejecución de bandeja con respaldo",description:"Ejecutar ranura específica de bandeja con habilidad de respaldo"},tray_range:{name:"Ejecución de rango de bandeja",description:"Ejecutar un rango de ranuras de bandeja"},tray_range_with_backup:{name:"Rango de bandeja con respaldo",description:"Ejecutar un rango de ranuras de bandeja con habilidades de respaldo"},whole_tray:{name:"Ejecución de bandeja completa",description:"Ejecutar todas las ranuras de una bandeja"},whole_tray_with_backup:{name:"Bandeja completa con respaldo",description:"Ejecutar todas las ranuras de una bandeja con bandeja de respaldo"},distribute_shields:{name:"Distribuir escudos",description:"Distribuye uniformemente los escudos como si hicieras clic en el medio del ícono de nave y escudos"},reroute_shields_rear:{name:"Redirigir escudos traseros",description:"Redirigir energía de escudos hacia atrás"},reroute_shields_left:{name:"Redirigir escudos izquierdos",description:"Redirigir energía de escudos hacia la izquierda"},reroute_shields_right:{name:"Redirigir escudos derechos",description:"Redirigir energía de escudos hacia la derecha"},reroute_shields_forward:{name:"Redirigir escudos delanteros",description:"Redirigir energía de escudos hacia adelante"},full_impulse:{name:"Impulso completo",description:"Activar motor de impulso completo"},reverse:{name:"Reversa",description:"Motores en reversa"},throttle_adjust:{name:"Ajustar acelerador",description:"Aumentar o disminuir el acelerador por cantidad"},throttle_set:{name:"Establecer acelerador",description:"Establecer el acelerador a una posición específica (negativo = reversa, 0 = parar)"},throttle_toggle:{name:"Alternar acelerador",description:"Alternar entre acelerador completo y parada completa"},turn_left:{name:"Girar izquierda",description:"Girar nave a la izquierda (continuo mientras se mantiene)"},turn_right:{name:"Girar derecha",description:"Girar nave a la derecha (continuo mientras se mantiene)"},pitch_up:{name:"Cabecear arriba",description:"Cabecear nariz de nave hacia arriba (cambio de altitud espacial)"},pitch_down:{name:"Cabecear abajo",description:"Cabecear nariz de nave hacia abajo (cambio de altitud espacial)"},strafe_left:{name:"Desplazamiento lateral izquierdo",description:"Desplazar nave lateralmente a la izquierda"},strafe_right:{name:"Desplazamiento lateral derecho",description:"Desplazar nave lateralmente a la derecha"},forward:{name:"Adelante",description:"Moverse adelante"},backward:{name:"Atrás",description:"Moverse atrás"},auto_forward:{name:"Avance automático",description:"El personaje se mueve adelante hasta que se den nuevos comandos de movimiento"},follow:{name:"Seguir objetivo",description:"Seguir a la entidad objetivo"},follow_cancel:{name:"Cancelar seguimiento",description:"Dejar de seguir y olvidar el objetivo"},zoom_in:{name:"Acercar zoom",description:"Acercar la cámara"},zoom_out:{name:"Alejar zoom",description:"Alejar la cámara"},zoom_in_small:{name:"Acercar zoom ligeramente",description:"Acercar la cámara ligeramente"},zoom_out_small:{name:"Alejar zoom ligeramente",description:"Alejar la cámara ligeramente"},cam_distance:{name:"Establecer distancia de cámara",description:"Establecer la distancia de la cámara del jugador"},cam_reset:{name:"Reiniciar cámara",description:"Reiniciar la posición de la cámara por defecto"},cam_target_lock:{name:"Bloquear cámara al objetivo",description:"Bloquear o desbloquear la cámara al objetivo"},cam_cycle_distance:{name:"Alternar distancia de cámara",description:"Alternar la distancia de la cámara entre varios valores preestablecidos"},cam_mouse_look:{name:"Vista de ratón",description:"Activar control de cámara con vista de ratón"},cam_turn_to_face:{name:"Girar hacia la cámara",description:"Girar nave para mirar hacia la dirección de la cámara"},look_up:{name:"Mirar arriba",description:"Cambiar punto de vista para mirar directamente arriba"},look_down:{name:"Mirar abajo",description:"Cambiar punto de vista para mirar directamente abajo"},team_message:{name:"Mensaje de equipo",description:"Enviar mensaje al equipo"},local_message:{name:"Mensaje local",description:"Enviar mensaje al área local"},zone_message:{name:"Mensaje de zona",description:"Enviar mensaje a la zona"},toggle_hud:{name:"Alternar HUD",description:"Alternar visibilidad del HUD"},screenshot:{name:"Captura de pantalla",description:"Tomar una captura de pantalla"},screenshot_jpg:{name:"Captura de pantalla JPG",description:"Guardar una captura de pantalla como JPG"},autofire_toggle:{name:"Alternar disparo automático",description:"Alternar disparo automático de armas"},bind_save_file:{name:"Guardar atajos a archivo",description:"Guardar todos tus atajos en un archivo de texto"},bind_load_file:{name:"Cargar atajos desde archivo",description:"Cargar un archivo de atajos en el cliente"},combat_log:{name:"Alternar registro de combate",description:"Activar/desactivar grabación del registro de combate (1=activado, 0=desactivado)"},missions:{name:"Mostrar/Ocultar misiones",description:"Mostrar/ocultar el diario de misiones"},inventory:{name:"Mostrar/Ocultar inventario",description:"Mostrar/ocultar tu inventario"},map:{name:"Mostrar/Ocultar mapa",description:"Mostrar/ocultar la ventana del mapa"},logout:{name:"Cerrar sesión",description:"Cerrar sesión del personaje actual."},quit:{name:"Salir del juego",description:"Cerrar la ventana."},ui_load:{name:"Cargar configuración de UI",description:"Carga el archivo de guardado predeterminado de ventanas de UI, generalmente Live\\ui_settings.txt"},ui_save:{name:"Guardar configuración de UI",description:"Guarda el diseño de UI en el archivo de guardado predeterminado de ventanas de UI, generalmente Live\\ui_settings.txt"},ui_load_file:{name:"Cargar archivo de configuración de UI",description:"Carga archivo de guardado de ventanas de UI con nombre"},ui_save_file:{name:"Guardar archivo de configuración de UI",description:"Guarda el diseño de UI en archivo de guardado de ventanas de UI con nombre"},ui_cancel:{name:"UI Cancelar",description:'Responde "Cancelar" a un cuadro de diálogo abierto; puede no funcionar en todos los diálogos.'},ui_ok:{name:"UI OK",description:'Responde "OK" a un cuadro de diálogo abierto; puede no funcionar en todos los diálogos.'},chat_log:{name:"Alternar registro de chat",description:"Activar/desactivar registro de chat. 1=activado, 0=desactivado, sin parámetro=imprimir estado. Anteponer ++ lo convierte en alternador"},remember_ui_lists:{name:"Recordar listas de UI",description:"Si se deben recordar la colocación y ancho de columnas de listas de UI."},ui_remember_positions:{name:"Recordar posiciones de UI",description:"Si se deben recordar tamaños y posiciones de UI. Activado por defecto."},safe_login:{name:"Inicio de sesión seguro",description:"Si es verdadero, entonces inicia sesión al jugador en su mapa estático más reciente en lugar de cualquier otra cosa."},goto_character_select:{name:"Ir a selección de personaje",description:"Ir a la pantalla de selección de personaje sin cerrar sesión."},ui_gen_layers_reset:{name:"Restablecer diseño de UI",description:"Restablece el diseño, usado cuando el servidor actualiza posiciones de ventanas movibles"},ui_resolution:{name:"Imprimir resolución de UI",description:"Imprime la resolución de pantalla de UI actual."},ui_tooltip_delay:{name:"Establecer retraso de tooltip",description:"Establece el retraso adicional, en segundos, antes de que aparezcan los tooltips"},show_game_ui:{name:"Mostrar UI del juego",description:"Mostrar la UI del juego"},show_game_ui_no_extra_keybinds:{name:"Mostrar UI del juego (sin keybinds extra)",description:"Este comando no agrega ningún keybind para mostrar la UI cuando el usuario presiona escape"},change_instance:{name:"Cambiar instancia",description:"Cambiar a una instancia ya creada del mismo mapa. Solo funciona cuando no está en alerta roja."},aim:{name:"Apuntar/Mira",description:"Activar/desactivar mira. En modo mira el jugador hace más daño. Puede usarse como alternador o presionar y mantener"},holster:{name:"Enfundar arma",description:"Intentar enfundar tu arma activa"},holster_toggle:{name:"Alternar enfundar arma",description:"Intentar enfundar o desenfundar tus armas"},unholster:{name:"Desenfundar arma",description:"Intentar desenfundar tu arma activa"},toggle_shooter_mode:{name:"Alternar modo tirador",description:"Activar/desactivar modo tirador"},shooter_primary:{name:"Tirador primario",description:"Acción primaria del modo tirador"},shooter_secondary:{name:"Tirador secundario",description:"Acción secundaria del modo tirador"},shooter_tertiary:{name:"Tirador terciario",description:"Acción terciaria del modo tirador"},shooter_clear_offset_tray_binds:{name:"Limpiar enlaces de bandeja de compensación del tirador",description:"Limpiar la ubicación inicial y movimiento de la caja de acción amarilla que aparece en la bandeja en modo tirador"},shooter_clear_overlay_tray_binds:{name:"Limpiar enlaces de bandeja superpuesta del tirador",description:"Limpiar enlaces de bandeja superpuesta para modo tirador"},shooter_set_offset_tray_binds:{name:"Establecer enlaces de bandeja de compensación del tirador",description:"Establecer la ubicación inicial y movimiento de la caja de acción amarilla que aparece en la bandeja en modo tirador"},shooter_set_overlay_tray_binds:{name:"Establecer enlaces de bandeja superpuesta del tirador",description:"Establecer enlaces de bandeja superpuesta para modo tirador"},setrallypoint:{name:"Establecer Punto de Encuentro",description:"Establece un punto de encuentro para tu objetivo actual"},setrallypointconsole:{name:"Establecer Punto de Encuentro (Consola)",description:"Establece un punto de encuentro para tu objetivo actual (variante consola)"},clearrallypoint:{name:"Borrar Punto de Encuentro",description:"Borra el punto de encuentro para tu objetivo actual"},clearallrallypoints:{name:"Borrar Todos los Puntos de Encuentro",description:"Borra todos los puntos de encuentro"},assist:{name:"Asistir",description:"Asistir '<name>': Asiste a la entidad con el nombre coincidente. Si no se da un nombre, asiste a tu objetivo actual."},net_timing_graph:{name:"Gráfico de Tiempo de Red",description:"Activar o desactivar el gráfico de tiempo de red (0=desactivar, 1=activar)"},net_timing_graph_alpha:{name:"Gráfico de Tiempo de Red Alpha",description:"Establecer nivel de transparencia para el gráfico de tiempo de red (50=mayor transparencia, 255=sin transparencia)"},net_timing_graph_paused:{name:"Gráfico de Tiempo de Red Pausado",description:"Pausar o reanudar el gráfico de tiempo de red (0=pausa desactivada, 1=pausa activada)"},netgraph:{name:"Gráfico de Red",description:"Mostrar datos de red SND y RCV como texto (1=activado, 0=desactivado)"},entity_name_optional:"Nombre de entidad (opcional)",entity_name_optional_placeholder:"Introduce el nombre de la entidad (opcional)",bridge_officer_command:{name:"Comando de Oficial de Puente",description:"Ejecuta una orden de oficial de puente"},select_bridge_officer_command:{name:"Seleccionar comando de oficial de puente",description:"Selecciona un comando de oficial de puente"}},category_descriptions:{targeting:"Selección y gestión de objetivos",combat:"Disparo de armas y acciones de combate",tray:"Ejecutar habilidades desde bandejas de acción",power:"Gestión de energía y distribución de escudos",movement:"Movimiento y navegación de nave",camera:"Control de cámara y gestión de vista",communication:"Chat y comunicación de equipo",system:"Comandos de UI y sistema"},no_aliases:"Sin alias",no_aliases_defined:"Sin alias definidos",create_alias_to_get_started:"Crea un alias para comenzar",create_aliases_hint:"Crea alias de comandos para simplificar secuencias de comandos complejas.",alias_deleted:'Alias "{{alias}}" eliminado',please_select_a_key_first:"Por favor selecciona una tecla primero",alias_added_to_key:'Alias "{{alias}}" agregado a {{key}}',no_active_profile:"Sin perfil activo",alias_exists:"Ya existe un alias con este nombre",alias_template_exists:'El alias "{{alias}}" ya existe',alias_created_from_template:'Alias "{{alias}}" creado desde plantilla',template_not_found:"Plantilla no encontrada",alias_not_found:"Alias no encontrado",alias_created:'Alias "{{alias}}" creado',alias_updated:'Alias "{{alias}}" actualizado',no_profile_selected_for_import:"Ningún perfil seleccionado para importar",no_keybinds_found_in_file:"No se encontraron atajos en el archivo",import_failed:"Importación falló: {{error}}",no_aliases_found_in_file:"No se encontraron alias en el archivo",failed_to_get_profile_for_import:"Falló al obtener perfil para importar",import_completed_keybinds:"Importación completada: {{count}} atajos",import_completed_keybinds_with_aliases:"Importación completada: {{keyCount}} atajos ({{aliasCount}} alias ignorados - usa Importar Alias)",import_completed_aliases:"Importación completada: {{count}} alias",no_profile_selected_to_export:"Ningún perfil seleccionado para exportar",keybind_file_exported:"Archivo de atajos exportado exitosamente",failed_to_export_keybind_file:"Falló al exportar archivo de atajos: {{error}}",profile_exported_json:"Perfil exportado como JSON",failed_to_export_profile:"Falló al exportar perfil: {{error}}",complete_project_exported:"Proyecto completo exportado",failed_to_export_project:"Falló al exportar proyecto: {{error}}",data_exported_csv:"Datos exportados como CSV",failed_to_export_csv:"Falló al exportar CSV: {{error}}",html_report_exported:"Reporte HTML exportado",failed_to_export_html_report:"Falló al exportar reporte HTML: {{error}}",no_command_to_copy:"Ningún comando para copiar",no_profiles_to_export:"Ningún perfil para exportar",exporting_profiles:"Exportando {{count}} perfiles...",aliases_exported_successfully:"Alias exportados exitosamente",failed_to_export_aliases:"Falló al exportar alias: {{error}}",sync_folder_set:"Carpeta de sincronización seleccionada",failed_to_set_sync_folder:"Falló al seleccionar carpeta de sincronización: {{error}}",no_sync_folder_selected:"Ninguna carpeta de sincronización seleccionada",project_synced_successfully:"Proyecto sincronizado exitosamente",permission_denied_to_folder:"Permiso denegado para escribir en la carpeta",failed_to_sync_project:"Falló al sincronizar proyecto: {{error}}",general:"General",synchronization:"Sincronización",appearance:"Apariencia",advanced:"Avanzado",general_settings:"Configuración general",synchronization_settings:"Configuración de sincronización",appearance_settings:"Configuración de apariencia",language_settings:"Configuración de idioma",advanced_settings:"Configuración avanzada",auto_save:"Guardado automático",auto_save_description:"Guardar automáticamente los cambios mientras trabajas",validation_mode:"Modo de validación",validation_mode_description:"Qué tan estrictamente validar comandos y atajos",strict:"Estricto",lenient:"Permisivo",disabled:"Deshabilitado",sync_folder_description:"Elige una carpeta para sincronizar automáticamente tus proyectos",auto_sync:"Sincronización automática",auto_sync_description:"Sincronizar automáticamente los cambios con la carpeta seleccionada",auto_sync_interval:"Intervalo de sincronización automática",auto_sync_interval_description:"Con qué frecuencia sincronizar automáticamente sus cambios",after_every_change:"Después de cada cambio",every_1_minute:"Cada minuto",every_2_minutes:"Cada 2 minutos",every_5_minutes:"Cada 5 minutos",auto_sync_completed:"Sincronización automática completada",selected_folder:"Carpeta seleccionada",theme:"Tema",theme_description:"Elige entre temas claro y oscuro",light_theme:"Claro",dark_theme:"Oscuro",compact_mode:"Modo compacto",compact_mode_description:"Usar un diseño de interfaz más compacto",interface_language:"Idioma de la interfaz",language_description:"Elige el idioma para la interfaz",debug_mode:"Modo de depuración",debug_mode_description:"Habilitar registro de depuración y herramientas de desarrollador",backup_interval:"Intervalo de respaldo",backup_interval_description:"Con qué frecuencia respaldar automáticamente tu trabajo",every_15_minutes:"Cada 15 minutos",every_30_minutes:"Cada 30 minutos",every_hour:"Cada hora",preferences_saved:"Preferencias guardadas exitosamente",failed_to_save_preferences:"Falló al guardar las preferencias",vfx_manager_description:"Selecciona efectos visuales para desactivar usando alias de dynFxSetFXExlusionList. Los efectos están organizados por entorno.",app_description:"Una herramienta integral basada en web para crear, editar y gestionar configuraciones de atajos de Star Trek Online con edición visual y características avanzadas.",csv_header:"Tecla,Comando,Tipo,Descripción,Posición",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Selecciona una construcción de Espacio/Tierra o Alias para previsualizar la exportación.",alias_mode:"Modo de alias",alias_options:"Opciones de alias",create:"Crear",create_new_alias:"Crear nuevo alias",cycle_type:"Tipo de ciclo",filter_aliases:"Filtrar alias",select_an_alias_to_edit:"Selecciona un alias para editar",select_an_alias_to_see_the_generated_command:"Selecciona un alias para ver el comando generado",select_options:"Seleccionar opciones",toggle_type:"Tipo de alternancia",no_alias_selected:"Ningún alias seleccionado",select_alias_from_left_panel:"Selecciona un alias del panel izquierdo para ver y editar su cadena de comandos.",select_key_from_left_panel:"Selecciona una tecla del panel izquierdo para ver y editar su cadena de comandos.",validation_error:"Error de validación",failed_to_load_application:"No se pudo cargar la aplicación",profile_created:'Perfil "{{name}}" creado',failed_to_create_profile:"No se pudo crear el perfil",failed_to_clone_profile:"No se pudo clonar el perfil",cannot_delete_the_last_profile:"No se puede eliminar el último perfil",profile_deleted:'Perfil "{{profileName}}" eliminado',failed_to_delete_profile:"No se pudo eliminar el perfil",invalid_key_name:"Nombre de tecla inválido",key_added:'Tecla "{{keyName}}" agregada',key_already_exists:'La tecla "{{keyName}}" ya existe',key_deleted:'Tecla "{{keyName}}" eliminada',command_added_to_alias:"Comando agregado al alias",commands_added:"{{count}} comandos agregados",command_added:"Comando agregado",command_deleted_from_alias:"Comando eliminado del alias",command_deleted:"Comando eliminado",switched_to_mode:"Cambiado a modo {{mode}}",alias_already_exists:'El alias "{{name}}" ya existe',commands_cleared_for_key:"Comandos limpiados para {{keyName}}",project_loaded_successfully:"Proyecto cargado exitosamente",failed_to_load_project_file:"No se pudo cargar el archivo del proyecto",invalid_project_file:"Archivo de proyecto inválido",project_exported_successfully:"Proyecto exportado exitosamente",no_commands_to_duplicate:"No hay comandos para duplicar",key_duplicated:'Tecla "{{keyName}}" duplicada como "{{newKeyName}}"',template_system_coming_soon:"Sistema de plantillas próximamente",no_commands_to_validate:"No hay comandos para validar",command_chain_is_valid:"Cadena de comandos es válida",please_configure_a_command:"Por favor configura un comando",command_updated_successfully:"Comando actualizado exitosamente",error_message:"Error: {{error}}",failed_to_select_all_space_effects:"No se pudieron seleccionar todos los efectos de espacio",failed_to_select_all_ground_effects:"No se pudieron seleccionar todos los efectos de suelo",space_preview_error:"Error de vista previa de espacio: {{error}}",ground_preview_error:"Error de vista previa de suelo: {{error}}",space_alias_error:"Error de alias de espacio: {{error}}",failed_to_generate_space_alias:"No se pudo generar el alias de espacio",ground_alias_error:"Error de alias de suelo: {{error}}",failed_to_generate_ground_alias:"No se pudo generar el alias de suelo",no_profile_selected:"Ningún perfil seleccionado",no_profile_found:"No se encontró el perfil",switched_to_theme:"Cambiado a {{themeName}}",language_updated:"Idioma actualizado",auto_sync_failed:"Auto-sincronización falló: {{error}}",nothing_to_copy:"Nada que copiar",content_copied_to_clipboard:"Contenido copiado al portapapeles",failed_to_generate_export:"No se pudo generar la exportación",no_profile_selected_to_clone:"Ningún perfil seleccionado para clonar",no_profile_selected_to_rename:"Ningún perfil seleccionado para renombrar",profile_name_is_required:"El nombre del perfil es requerido",profile_name_too_long:"El nombre del perfil es muy largo (máx. 50 caracteres)",profile_name_already_exists:"Ya existe un perfil con este nombre",failed_to_save_profile:"No se pudo guardar el perfil: {{error}}",no_profile_selected_to_delete:"Ningún perfil seleccionado para eliminar",no_keybinds_to_export:"No hay atajos para exportar",no_aliases_to_export:"No hay alias para exportar",failed_to_reset_application:"No se pudo restablecer la aplicación: {{error}}",default_demo_data_loaded:"Datos de demostración predeterminados cargados exitosamente",failed_to_load_default_data:"No se pudieron cargar los datos predeterminados",failed_to_load_default_data_with_error:"No se pudieron cargar los datos predeterminados: {{error}}",failed_to_create_profile_from_template:"No se pudo crear el perfil desde la plantilla",profile_exported:'Perfil "{{profileName}}" exportado',failed_to_import_profile:"No se pudo importar el perfil: {{error}}",application_reset_successfully:"Aplicación restablecida exitosamente",clear_commands:"Limpiar comandos",command_info:"Comando: {{command}}\nTipo: {{type}}",commands_updated_successfully:"{{count}} comandos actualizados exitosamente",confirm_clear_commands:'¿Estás seguro de que quieres limpiar todos los comandos para "{{keyName}}"?',confirm_delete_alias:'¿Estás seguro de que quieres eliminar el alias "{{aliasName}}"?',confirm_delete_key:'¿Estás seguro de que quieres eliminar la tecla "{{keyName}}" y todos sus comandos?',confirm_delete_profile:'¿Estás seguro de que quieres eliminar el perfil "{{profileName}}"?\n\nEsta acción no se puede deshacer.',confirm_reset_application:"¿Estás seguro de que quieres restablecer la aplicación?\n\nEsto eliminará todos los perfiles, atajos y configuraciones. Esta acción no se puede deshacer.",delete_alias:"Eliminar alias",delete_key:"Eliminar tecla",failed_to_copy_to_clipboard:"Falló al copiar al portapapeles",failed_to_import_aliases_generic:"No se pudieron importar los alias: {{error}}",failed_to_import_keybind_file:"No se pudo importar el archivo de atajos: {{error}}",failed_to_import_keybind_file_generic:"No se pudo importar el archivo de atajos: {{error}}",generated_vertigo_aliases:"¡{{count}} alias de Vertigo generado{{plural}}! Revisa la lista de alias.",keybinds_exported_successfully:"Atajos de {{environment}} exportados exitosamente",no_effects_selected:"No hay efectos seleccionados. Por favor selecciona al menos un efecto para generar alias.",profile_created_from:'Perfil "{{newName}}" creado desde "{{sourceProfile}}"',profile_created_from_current:'Perfil "{{name}}" creado desde el perfil actual "{{currentProfile}}"',profile_created_from_template_generic:'Perfil "{{profileName}}" creado desde plantilla',profile_imported_successfully:'Perfil "{{profileName}}" importado exitosamente',profile_renamed:'Perfil renombrado de "{{oldName}}" a "{{name}}"',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager cargado exitosamente",switched_to_profile:"Cambiado al perfil: {{name}} ({{environment}})",yes:"Sí",no:"No",active:"Activo",inactive:"Inactivo",active_state:"Estado Activo",no_aliases_available:"No hay alias disponibles",no_commands:"No hay comandos",profile_not_found:"Perfil no encontrado",click_add_command_to_start_building_your_command_chain:"Haga clic en 'Agregar Comando' para comenzar a construir su cadena de comandos para",click_add_command_to_start_building_your_alias_chain:"Haga clic en 'Agregar Comando' para comenzar a construir su cadena de alias para",create_aliases_in_the_alias_manager_first:"Cree alias en el Administrador de Alias primero",enter_sto_command:"Ingrese comando STO",enter_the_exact_sto_command_syntax:"Ingrese la sintaxis exacta del comando STO",enter_your_message:"Ingrese su mensaje",maximum_100_characters:"Máximo 100 caracteres",replaced_with_your_current_targets_name:"Reemplazado con el nombre de su objetivo actual",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Este alias cambiará automáticamente entre sus estados encendido/apagado cuando se ejecute",select_an_alias:"Seleccionar un alias",select_targeting_command:"Seleccionar comando de objetivo",select_combat_command:"Seleccionar comando de combate",select_shield_command:"Seleccionar comando de escudo",select_movement_command:"Seleccionar comando de movimiento",select_camera_command:"Seleccionar comando de cámara",select_system_command:"Seleccionar comando de sistema",select_communication_type:"Seleccionar tipo de comunicación",create_alias:"Crear Alias",alias_commands:"Comandos de Alias",available_aliases:"Alias Disponibles",common_commands:"Comandos Comunes",sto_variables:"Variables STO",example:"Ejemplo",message:"Mensaje",display_text:"Texto de Visualización",descriptive_name_for_this_command:"Nombre descriptivo para este comando",filename:"Nombre de archivo",position:"Posición",distance:"Distancia",amount:"Cantidad",state:"Estado",command:"Comando",command_variant:"Variante de Comando",communication_type:"Tipo de Comunicación",combat_command:"Comando de Combate",movement_command:"Comando de Movimiento",camera_command:"Comando de Cámara",shield_command:"Comando de Escudo",system_command:"Comando de Sistema",targeting_command:"Comando de Objetivo",tray_number:"Número de Bandeja",slot_number:"Número de Ranura",start_tray:"Bandeja de Inicio",end_tray:"Bandeja Final",start_slot:"Ranura de Inicio",end_slot:"Ranura Final",backup_tray:"Bandeja de Respaldo",backup_slot:"Ranura de Respaldo",backup_start_tray:"Bandeja de Inicio de Respaldo",backup_end_tray:"Bandeja Final de Respaldo",backup_start_slot:"Ranura de Inicio de Respaldo",backup_end_slot:"Ranura Final de Respaldo",backup_configuration:"Configuración de Respaldo",range_configuration:"Configuración de Rango",backup_range_configuration:"Configuración de Rango de Respaldo",single_tray_slot:"Ranura de Bandeja Única",single_tray_with_backup:"Bandeja Única con Respaldo",tray_range:"Rango de Bandeja",tray_range_with_backup:"Rango de Bandeja con Respaldo",whole_tray:"Bandeja Completa",whole_tray_with_backup:"Bandeja Completa con Respaldo",configure_command_options_to_see_preview:"Configure las opciones del comando para ver la vista previa",key:"tecla",no_profile:"Sin perfil",stotrayexecbytray_description:"STOTrayExecByTray (muestra el enlace de tecla en la UI)",trayexecbytray_description:"TrayExecByTray (sin indicación de UI)",parameter_configuration:"Configuración de parámetros",modifier_1:"Modificador 1",modifier_2:"Modificador 2",first_modifier:"Primer modificador",second_modifier:"Segundo modificador",cosmetic_command:"Comando Cosmético",select_cosmetic_command:"Selecciona un comando cosmético",tray_command:"Comando de Bandeja",on:"Activado",off:"Desactivado",delay_seconds:"Retraso (segundos)",bridge_officer:"Oficial de Puente",net_graph:"Gráfico de Red",net_graph_command:"Comando de Gráfico de Red",select_net_graph_command:"Selecciona un comando de gráfico de red",net_timing_graph:"Gráfico de Tiempo de Red",net_timing_graph_alpha:"Gráfico de Tiempo de Red Alpha",net_timing_graph_paused:"Gráfico de Tiempo de Red Pausado",netgraph:"Gráfico de Red",enable_disable:"Activar/Desactivar",transparency_level:"Nivel de Transparencia",pause_state:"Estado de Pausa",delete_selected_key:"Eliminar tecla seleccionada",duplicate_selected_key:"Duplicar tecla seleccionada",show_all_keys:"Mostrar todas las teclas"};function ae(){return`${Date.now()}_${Math.random().toString(36).slice(2,10)}`}function ne(e=r,t,i,a=5e3){"undefined"!=typeof window&&console.log(`[requestResponse] request → ${t}`,i);const n=ae(),s=`${t}::reply::${n}`;return new Promise((o,r)=>{const c=setTimeout(()=>{d(),r(new Error("Request timed out"))},a);function l(e){d(),e&&Object.prototype.hasOwnProperty.call(e,"error")?r(new Error(e.error)):o(e?e.data:void 0)}function d(){clearTimeout(c),e.off(s,l)}e.on(s,l),e.emit(`rpc:${t}`,{requestId:n,replyTopic:s,payload:i})})}function se(e=r,t,i){async function a(a){if(!a)return;const{requestId:n,replyTopic:s,payload:o}=a;if(s)try{const a=await i(o);"undefined"!=typeof window&&console.log(`[requestResponse] respond ← ${t}`,a),e.emit(s,{requestId:n,data:a})}catch(t){const i=t&&t.message?t.message:String(t);e.emit(s,{requestId:n,error:i})}}return e.on(`rpc:${t}`,a),()=>e.off(`rpc:${t}`,a)}var oe=Object.freeze({__proto__:null,makeRequestId:ae,request:ne,respond:se});class re{constructor(e=null){this.eventBus=e,this.initialized=!1,this.destroyed=!1,this.eventListeners=new Map,this.componentName=this.constructor.name}init(){this.initialized||(this.initialized=!0,this.destroyed=!1,this.addEventListener("component:register",this.i.bind(this)),this.o=`component:registered:reply:${this.getComponentName()}:${Date.now()}`,this.addEventListener(this.o,this.l.bind(this)),"undefined"!=typeof window&&console.log(`[ComponentBase] ${this.getComponentName()} sending component:register`),this.emit("component:register",{name:this.getComponentName(),replyTopic:this.o}),this.onInit())}destroy(){this.destroyed?console.warn(`${this.constructor.name} is already destroyed`):(this.destroyed=!0,this.initialized=!1,this.cleanupEventListeners(),this.onDestroy())}onInit(){}onDestroy(){}addEventListener(e,t,i=null){this.eventBus&&(this.eventBus.on(e,t,i),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push({handler:t,context:i}))}removeEventListener(e,t){if(!this.eventBus)return;this.eventBus.off(e,t);const i=this.eventListeners.get(e);if(i){const e=i.findIndex(e=>e.handler===t);-1!==e&&i.splice(e,1)}}emit(e,t=null){if("undefined"!=typeof window&&console.log(`[${this.getComponentName()}] emit → ${e}`,t),this.eventBus&&"function"==typeof this.eventBus.emit)this.eventBus.emit(e,t);else if(!this.eventBus)return;const i=this.eventListeners.get(e);i&&i.length>0&&i.forEach(({handler:e,context:i})=>{try{e.call(i||this,t)}catch(e){console.error("ComponentBase emit handler error",e)}})}cleanupEventListeners(){if(this.eventBus){for(const[e,t]of this.eventListeners)t.forEach(({handler:t})=>{this.eventBus.off(e,t)});this.eventListeners.clear()}}isInitialized(){return this.initialized&&!this.destroyed}isDestroyed(){return this.destroyed}getComponentName(){return this.componentName||this.constructor.name}i({name:e,replyTopic:t}={}){e!==this.getComponentName()&&("undefined"!=typeof window&&console.log(`[ComponentBase] ${this.getComponentName()} received component:register from ${e} → replying on ${t}`),this.initialized&&!this.destroyed&&this.emit(t,{sender:this.getComponentName(),state:this.getCurrentState()}))}l({sender:e,state:t}={}){"undefined"!=typeof window&&console.log(`[ComponentBase] ${this.getComponentName()} received initial state from ${e}`,t),"function"==typeof this.handleInitialState&&this.handleInitialState(e,t)}getCurrentState(){return null}handleInitialState(e,t){}async request(e,t={}){return"undefined"!=typeof window&&console.log(`[${this.getComponentName()}] request → ${e}`,t),await ne(this.eventBus,e,t)}respond(e,t){return"undefined"!=typeof window&&console.log(`[${this.getComponentName()}] respond ← ${e} (handler registered)`),se(this.eventBus,e,async i=>("undefined"!=typeof window&&console.log(`[${this.getComponentName()}] respond handler → ${e}`,i),await t(i)))}}class ce extends re{constructor({storage:e,eventBus:t,i18n:i=Y}={}){super(t),this.componentName="PreferencesService",this.storage=e,this.i18n=i,this.defaultSettings={theme:"default",autoSave:!0,showTooltips:!0,confirmDeletes:!0,maxUndoSteps:50,defaultMode:"space",compactView:!1,language:"en",syncFolderName:null,syncFolderPath:null,autoSync:!1,autoSyncInterval:"change"},this.settings={...this.defaultSettings},this.eventBus&&(this.respond("preferences:init",()=>this.init()),this.respond("preferences:load-settings",()=>this.loadSettings()),this.respond("preferences:save-settings",()=>this.saveSettings()),this.respond("preferences:get-settings",()=>this.getSettings()),this.respond("preferences:set-setting",({key:e,value:t})=>this.setSetting(e,t)),this.respond("preferences:get-setting",({key:e})=>this.getSetting(e)),this.respond("preferences:reset-settings",()=>this.resetSettings()),this.respond("i18n:translate",({key:e,params:t={}})=>this.i18n&&this.i18n.t?this.i18n.t(e,t):e)),this.setupEventListeners()}setupEventListeners(){this.eventBus&&(this.eventBus.on("theme:toggle",()=>{this.toggleTheme()}),this.eventBus.on("language:change",({language:e})=>{e&&this.changeLanguage(e)}))}init(){this.loadSettings(),this.applySettings()}loadSettings(){try{if(!this.storage)return;const e=this.storage.getSettings();this.settings={...this.defaultSettings,...e},this.emit("preferences:loaded",{settings:this.getSettings()})}catch(e){console.error("[PreferencesService] loadSettings failed",e),this.settings={...this.defaultSettings}}}saveSettings(){if(!this.storage)return!1;const e=this.storage.saveSettings(this.settings);return e&&this.emit("preferences:saved",{settings:this.getSettings()}),e}getSettings(){return{...this.settings}}getSetting(e){return this.settings[e]}setSetting(e,t){this.settings[e]=t,this.saveSettings(),this.applySettings(),this.emit("preferences:changed",{key:e,value:t})}setSettings(e={}){this.settings={...this.defaultSettings,...e},this.saveSettings(),this.applySettings()}resetSettings(){this.settings={...this.defaultSettings},this.saveSettings(),this.applySettings()}applySettings(){this.applyTheme(),this.applyLanguage(),this.applyOtherSettings()}applyTheme(){if("undefined"==typeof document)return;const e=this.settings.theme||"default";"dark"===e?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme"),this.updateThemeToggleButton(e)}async applyLanguage(){const e=this.settings.language||"en";this.i18n&&this.i18n.language!==e&&await this.i18n.changeLanguage(e),"undefined"!=typeof window&&"function"==typeof window.applyTranslations&&window.applyTranslations(),this.updateLanguageFlag(e)}applyOtherSettings(){if("undefined"!=typeof document&&(this.settings.compactView?document.body.classList.add("compact-view"):document.body.classList.remove("compact-view")),"undefined"!=typeof window&&window.app){const e=window.app;"autoSave"in e&&(e.autoSave=this.settings.autoSave),"maxUndoSteps"in e&&(e.maxUndoSteps=this.settings.maxUndoSteps)}}toggleTheme(){const e="dark"===(this.settings.theme||"default")?"default":"dark";this.setSetting("theme",e);const t="dark"===e?"Dark Mode":"Light Mode";if(this.i18n){const e=this.i18n.t("switched_to_theme",{themeName:t})||`Switched to ${t}`;this.emit("toast:show",{message:e,type:"success"})}}updateThemeToggleButton(e){if("undefined"==typeof document)return;const t=document.getElementById("themeToggleBtn"),i=document.getElementById("themeToggleText"),a=t?.querySelector("i");t&&i&&a&&("dark"===e?(a.className="fas fa-sun",i.textContent=this.i18n?.t("light_mode")||"Light Mode"):(a.className="fas fa-moon",i.textContent=this.i18n?.t("dark_mode")||"Dark Mode"))}async changeLanguage(e){if(this.setSetting("language",e),"undefined"!=typeof window&&window.localizeCommandData&&window.localizeCommandData(),this.emit("language:changed",{language:e}),this.i18n){const e=this.i18n.t("language_updated")||"Language updated";this.emit("toast:show",{message:e,type:"success"})}}updateLanguageFlag(e){if("undefined"==typeof document)return;const t=document.getElementById("languageFlag");t&&(t.className={en:"fi fi-gb",de:"fi fi-de",es:"fi fi-es",fr:"fi fi-fr"}[e]||"fi fi-gb")}detectBrowserLanguage(){try{if("undefined"==typeof navigator)return"en";const e=navigator.languages&&navigator.languages[0]||navigator.language;if(!e)return"en";const t=e.toLowerCase().split(/[-_]/)[0];return["en","de","es","fr"].includes(t)?t:"en"}catch(e){return console.error("Error detecting browser language:",e),"en"}}}class le extends re{constructor({storage:e=null,ui:t=null,exportManager:i=null,i18n:a=null,app:n=null,eventBus:s=null}={}){super(s),this.componentName="ProjectManagementService",this.storage=e,this.ui=t,this.exportManager=i,this.i18n=a,this.app=n}async exportProject(){try{const e=this.storage.exportData(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),i=URL.createObjectURL(t),a=document.createElement("a");return a.href=i,a.download=`sto-keybinds-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i),this.emit("project-exported",{data:e}),{success:!0,data:e}}catch(e){return console.error("[ProjectManagementService] exportProject failed",e),this.emit("project-export-failed",{error:e}),{success:!1,error:e.message}}}async importProject(e){try{const t=await e.text(),i=JSON.parse(t);if(!i||"object"!=typeof i)throw new Error("Invalid project file format");if(!this.storage.importData(t))throw new Error("Failed to import project data");return this.emit("project-imported",{data:i}),{success:!0,data:i}}catch(e){return console.error("[ProjectManagementService] importProject failed",e),this.emit("project-import-failed",{error:e}),{success:!1,error:e.message}}}async loadProjectFromFile(){try{const e=document.createElement("input");return e.type="file",e.accept=".json",await new Promise(t=>{e.onchange=async e=>{const i=e.target.files[0];if(!i)return void t({success:!1,error:"No file selected"});const a=await this.importProject(i);t(a)},e.oncancel=()=>{t({success:!1,error:"File selection cancelled"})},e.click()})}catch(e){return console.error("[ProjectManagementService] loadProjectFromFile failed",e),{success:!1,error:e.message}}}async saveProjectToFile(){try{return await this.exportProject()}catch(e){return console.error("[ProjectManagementService] saveProjectToFile failed",e),{success:!1,error:e.message}}}validateProjectData(e){try{if(!e||"object"!=typeof e)return{valid:!1,error:"Invalid data format"};if(!e.profiles||"object"!=typeof e.profiles)return{valid:!1,error:"Missing profiles data"};if(!e.currentProfile)return{valid:!1,error:"Missing current profile"};for(const[t,i]of Object.entries(e.profiles)){if(!i||"object"!=typeof i)return{valid:!1,error:`Invalid profile structure for ${t}`};if(!i.name||"string"!=typeof i.name)return{valid:!1,error:`Missing profile name for ${t}`}}return{valid:!0}}catch(e){return{valid:!1,error:e.message}}}openProject(){const e=document.getElementById("fileInput")||document.createElement("input");e.id||(e.id="fileInput"),e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const i=new FileReader;i.onload=e=>{try{this.exportManager.importJSONFile(e.target.result)?(this.app?.loadData?.(),this.app?.renderProfiles?.(),this.app?.renderKeyGrid?.(),this.ui?.showToast(this.i18n?.t("project_loaded_successfully")??"Project loaded","success")):this.ui?.showToast(this.i18n?.t("failed_to_load_project_file")??"Failed to load project","error")}catch(e){this.ui?.showToast(this.i18n?.t("invalid_project_file")??"Invalid project file","error")}},i.readAsText(t)},e.click()}saveProject(){const e=this.storage.exportData(),t="string"==typeof e?e:JSON.stringify(e,null,2),i=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(i),n=document.createElement("a");n.href=a,n.download="sto_keybinds.json",n.click(),URL.revokeObjectURL(a),this.ui?.showToast(this.i18n?.t("project_exported_successfully")??"Project exported","success"),this.emit("project-saved")}exportKeybinds(){const e=this.app?.getCurrentProfile?.();if(!e)return;const t=this.app?.currentEnvironment||"space",i=this.exportManager.generateSTOKeybindFile(e,{environment:t}),a=new Blob([i],{type:"text/plain"}),n=URL.createObjectURL(a),s=document.createElement("a");s.href=n;const o=e.name.replace(/[^a-zA-Z0-9]/g,"_");s.download=`${o}_${t}_keybinds.txt`,s.click(),URL.revokeObjectURL(n),this.ui?.showToast(this.i18n?.t("keybinds_exported_successfully",{environment:t})??"Keybinds exported","success")}static#e=null;static getInstance(){return this.#e||(this.#e=new le),this.#e}}class de extends re{constructor({eventBus:e,storage:t,syncManager:i,ui:a}={}){super(e),this.storage=t,this.syncManager=i,this.ui=a,this.isEnabled=!1,this.interval="change",this.m=null,this.lastSync=null,this.h=()=>this.sync()}onInit(){this.setupFromSettings()}setupFromSettings(){if(!this.storage)return;const e=this.storage.getSettings();e.autoSync&&this.enable(e.autoSyncInterval||"change")}enable(e="change"){if(this.disable(),this.isEnabled=!0,this.interval=e,"change"===e)this.eventBus.on("storage:data-changed",this.h);else{const t=parseInt(e,10);if(isNaN(t)||t<=0)console.warn(`[AutoSync] Invalid interval '${e}', falling back to 'change' mode`),this.interval="change",this.eventBus.on("storage:data-changed",this.h);else{const e=1e3*t;this.m=setInterval(()=>this.sync(),e)}}this.u(!0)}disable(){this.isEnabled=!1,this.eventBus.off("storage:data-changed",this.h),this.m&&(clearInterval(this.m),this.m=null),this.u(!1)}u(e){if(!this.storage)return;const t=this.storage.getSettings();t.autoSync=e,e&&(t.autoSyncInterval=this.interval),this.storage.saveSettings(t)}async sync(){if(this.isEnabled&&this.syncManager)try{await this.syncManager.syncProject(),this.lastSync=new Date,this.p("synced")}catch(e){console.error("[AutoSync] sync failed",e),this.p("error")}}getStatus(){return{enabled:this.isEnabled,interval:this.interval,lastSync:this.lastSync}}p(e){if(!this.ui||"undefined"==typeof document)return;const t=document.getElementById("modifiedIndicator");if(t)switch(t.classList.remove("syncing","synced","error"),e){case"synced":t.style.display="inline",t.classList.add("synced"),t.innerHTML='<i class="fas fa-check"></i> Synced',setTimeout(()=>{t.style.display="none",t.classList.remove("synced")},2e3);break;case"error":t.style.display="inline",t.classList.add("error"),t.innerHTML='<i class="fas fa-exclamation-triangle"></i> Sync Error',setTimeout(()=>{t.style.display="none",t.classList.remove("error")},5e3)}}}class me extends re{constructor({storage:e,eventBus:t,i18n:i,dataCoordinator:a}){super(t),this.componentName="ProfileService",this.i18n=i,this.dataCoordinator=a,this.currentProfile=null,this.currentEnvironment="space",this.isModified=!1,this.profilesCache={},this.eventBus&&(this.respond("profile:switch",({id:e}={})=>this.switchProfile(e)),this.respond("profile:create",({name:e,description:t,mode:i}={})=>this.createProfile(e,t,i)),this.respond("profile:delete",({id:e}={})=>this.deleteProfile(e)),this.respond("profile:list",()=>this.getAllProfiles()),this.respond("profile:clone",({sourceId:e,newName:t}={})=>this.cloneProfile(e,t)),this.respond("profile:rename",({id:e,newName:t,description:i}={})=>this.renameProfile(e,t,i)),this.respond("profile:save",({profile:e}={})=>this.saveSpecificProfile(e)))}async init(){super.init(),this.setupEventListeners()}setupEventListeners(){this.addEventListener("profile:switched",({profileId:e,environment:t})=>{this.currentProfile=e,this.currentEnvironment=t,this.isModified=!1}),this.addEventListener("environment:changed",({environment:e})=>{this.currentEnvironment=e}),this.addEventListener("profile:created",({profile:e})=>{e&&e.id&&(this.profilesCache[e.id]=e)}),this.addEventListener("profile:deleted",({profileId:e})=>{this.profilesCache[e]&&delete this.profilesCache[e]}),this.addEventListener("profile:updated",({profile:e})=>{e&&e.id&&(this.profilesCache[e.id]=e)})}async loadData(){try{return this.currentProfile&&this.emit("profile-switched",{profileId:this.currentProfile,profile:this.currentProfile,environment:this.currentEnvironment}),{currentProfile:this.currentProfile,currentEnvironment:this.currentEnvironment,profiles:this.profilesCache}}catch(e){throw new Error(this.i18n.t("failed_to_load_profile_data")||"Failed to load profile data")}}async saveProfile(){try{if(!this.currentProfile)throw new Error(this.i18n.t("no_profile_to_save")||"No profile to save");return await this.request("data:update-profile",{profileId:this.currentProfile,properties:{currentEnvironment:this.currentEnvironment}}),this.isModified=!1,{success:!0,message:this.i18n.t("profile_saved")||"Profile saved"}}catch(e){throw new Error(this.i18n.t("failed_to_save_profile")||"Failed to save profile")}}async saveSpecificProfile(e){try{if(!e)throw new Error(this.i18n.t("no_profile_to_save")||"No profile to save");const t=e.id||this.currentProfile;return await this.request("data:update-profile",{profileId:t,properties:e}),this.setModified(!0),{success:!0,message:this.i18n.t("profile_saved")||"Profile saved"}}catch(e){throw console.error("Failed to save specific profile:",e),new Error(this.i18n.t("failed_to_save_profile")||"Failed to save profile")}}async saveData(){try{return this.setModified(!1),{success:!0,message:this.i18n.t("data_saved")||"Data saved"}}catch(e){throw e}}async saveCurrentProfile(){try{return{success:!0}}catch(e){throw e}}setModified(e=!0){return this.isModified=e,e&&this.emit("profile-modified"),{modified:e,success:!0}}getCurrentBuild(e){return console.warn("[ProfileService] getCurrentBuild is deprecated - use getCurrentProfile() instead"),e}async switchProfile(e){try{const t=await this.request("data:switch-profile",{profileId:e});return t.success&&t.switched&&(this.currentProfile=e,this.currentEnvironment=t.profile?.environment||"space",this.isModified=!1),t.message&&this.i18n&&(t.switched?t.message=this.i18n.t("switched_to_profile",{name:t.profile?.name,environment:this.currentEnvironment})||t.message:t.message=this.i18n.t("already_on_profile")||t.message),t}catch(e){if(e.message.includes("not found")&&this.i18n)throw new Error(this.i18n.t("profile_not_found")||e.message);throw e}}async createProfile(e,t="",i="space"){try{const a=await this.request("data:create-profile",{name:e,description:t,mode:i});return a.message&&this.i18n&&(a.message=this.i18n.t("profile_created",{name:e})||a.message),a}catch(t){if(this.i18n)throw t.message.includes("already exists")?new Error(this.i18n.t("profile_already_exists",{name:e})||t.message):new Error(this.i18n.t("failed_to_create_profile")||t.message);throw t}}async cloneProfile(e,t){try{const i=await this.request("data:clone-profile",{sourceId:e,newName:t});return i.message&&this.i18n&&(i.message=this.i18n.t("profile_created_from",{newName:t,sourceProfile:e})||i.message),i}catch(e){if(this.i18n)throw e.message.includes("not found")?new Error(this.i18n.t("source_profile_not_found")||e.message):new Error(this.i18n.t("failed_to_clone_profile")||e.message);throw e}}async deleteProfile(e){try{const t=await this.request("data:delete-profile",{profileId:e});return t.success&&t.switchedProfile&&(this.currentProfile=t.switchedProfile.id||Object.keys(await this.request("data:get-all-profiles"))[0],this.currentEnvironment=t.switchedProfile.environment||"space",this.isModified=!1),t.message&&this.i18n&&(t.message=this.i18n.t("profile_deleted",{profileName:t.deletedProfile?.name||"Unknown"})||t.message),t}catch(e){if(this.i18n)throw e.message.includes("not found")?new Error(this.i18n.t("profile_not_found")||e.message):e.message.includes("last profile")?new Error(this.i18n.t("cannot_delete_the_last_profile")||e.message):new Error(this.i18n.t("failed_to_delete_profile")||e.message);throw e}}async saveCurrentBuild(){try{if(!this.currentProfile)throw new Error(this.i18n.t("no_profile_or_build_data")||"No profile or build data");return await this.request("data:update-profile",{profileId:this.currentProfile,properties:{currentEnvironment:this.currentEnvironment}}),{success:!0}}catch(e){throw e}}async generateProfileId(e){const t=e.toLowerCase().replace(/[^a-z0-9]/g,"_");let i=t,a=1;const n=await this.request("data:get-all-profiles");for(;n[i];)i=`${t}_${a}`,a++;return i}getCurrentProfileId(){return this.currentProfile}getCurrentEnvironment(){return this.currentEnvironment}setCurrentEnvironment(e){this.currentEnvironment=e}getModified(){return this.isModified}async getCurrentState(){return{currentProfile:this.currentProfile,currentEnvironment:this.currentEnvironment,profiles:{...this.profilesCache},modified:this.isModified}}async handleInitialState(e,t){if("DataCoordinator"===t&&e.currentProfileData){this.currentProfile=e.currentProfile||e.currentProfileData?.id,this.currentEnvironment=e.currentEnvironment||"space",this.isModified=!1,e.profiles&&(this.profilesCache={...e.profiles});try{await this.loadData()}catch(e){console.error(`[${this.componentName}] loadData failed after late-join:`,e)}}else e.currentProfile&&(this.currentProfile=e.currentProfile,this.currentEnvironment=e.currentEnvironment||"space",this.isModified=e.modified||!1,e.profiles&&(this.profilesCache={...e.profiles}))}async getAllProfiles(){return{...this.profilesCache}}async renameProfile(e,t,i=""){try{const a=await this.request("data:rename-profile",{profileId:e,newName:t,description:i});return a.message&&this.i18n&&(a.message=this.i18n.t("profile_renamed",{name:t})||a.message),a}catch(e){if(this.i18n)throw e.message.includes("required")?new Error(this.i18n.t("profile_id_required")||e.message):e.message.includes("not found")?new Error(this.i18n.t("profile_not_found")||e.message):new Error(this.i18n.t("failed_to_rename_profile")||e.message);throw e}}}function he(e,t={},i=!0){let a="";return i&&t.description&&(a+=`; ${t.description}\n`),a+=`alias ${e} <& ${t.commands} &>\n`,a}class ue extends re{constructor({storage:e,eventBus:t,i18n:i,ui:a,modalManager:n}){if(super(t),this.componentName="CommandLibraryService",this._=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.storage=e,this.i18n=i,this.ui=a,this.modalManager=n,this.currentProfile=null,this.currentEnvironment="space",this.selectedKey=null,this.selectedAlias=null,this.cache={currentProfile:null,currentEnvironment:"space",profile:null,keys:{},aliases:{}},this.v=[],this.eventBus&&this.v.push(this.respond("command:get-for-selected-key",async()=>await this.getCommandsForSelectedKey()),this.respond("command:get-empty-state-info",async()=>await this.getEmptyStateInfo()),this.respond("command:find-definition",({command:e})=>this.findCommandDefinition(e)),this.respond("command:get-warning",({command:e})=>this.getCommandWarning(e)),this.respond("command:get-categories",()=>this.getCommandCategories()),this.respond("command:generate-id",()=>this.generateCommandId()),this.respond("command:filter-library",()=>(this.filterCommandLibrary(),!0))),"undefined"!=typeof vi&&"function"==typeof vi.fn&&!vi.isMockFunction?.(this.emit)){const e=this.emit.bind(this);this.emit=vi.fn((...t)=>e(...t))}}async init(){super.init(),this.setupEventListeners(),this.setupRequestResponseEndpoints()}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&this.updateCacheFromProfile(t)}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfile=e,this.cache.currentProfile=e,this.currentEnvironment=i,this.cache.currentEnvironment=i,this.updateCacheFromProfile(t),this.selectedKey=null,this.selectedAlias=null}),this.addEventListener("key-selected",e=>{this.selectedKey=e.key,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{"undefined"!=typeof window&&console.log("[CommandLibraryService] alias-selected event received. data:",e,`setting selectedAlias to: ${e.name}`),this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;"undefined"!=typeof window&&console.log("[CommandLibraryService] environment:changed event received. data:",e,`parsed env: ${t}, current selectedAlias: ${this.selectedAlias}`),t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,"alias"!==t&&(this.selectedAlias=null),"alias"===t&&(this.selectedKey=null),this.filterCommandLibrary(),"undefined"!=typeof window&&console.log(`[CommandLibraryService] after environment change to ${t}. selectedKey: ${this.selectedKey}, selectedAlias: ${this.selectedAlias}`))}),this.addEventListener("language:changed",()=>{})}updateCacheFromProfile(e){if(!e)return;this.cache.profile=e,this.cache.aliases=e.aliases||{};const t=e.builds?.[this.cache.currentEnvironment];this.cache.keys=t?.keys||{}}async getCommandsForSelectedKey(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return[];const t=this.getCurrentProfile();if(!t)return[];if("alias"===this.currentEnvironment){const i=t.aliases&&t.aliases[e];return i&&i.commands?(await this.request("parser:parse-command-string",{commandString:i.commands})).commands.map((e,t)=>({...e,id:`alias_${t}`,type:e.category,text:e.displayText})):[]}return t.keys&&t.keys[e]?t.keys[e]:[]}getCurrentProfile(){return this.cache.profile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[this.currentEnvironment]||(e.builds[this.currentEnvironment]={keys:{}}),e.builds[this.currentEnvironment].keys||(e.builds[this.currentEnvironment].keys={}),{...e,keys:e.builds[this.currentEnvironment].keys,aliases:e.aliases||{}}):null}async findCommandDefinition(e){try{if(e&&e.isUserAlias)return{name:e.text||e.command,description:e.description||`User-defined alias: ${e.command}`,command:e.command,type:"alias",icon:"🎭",commandId:e.command,categoryId:"aliases"};if(console.log("[CommandLibraryService] findCommandDefinition",{command:e}),e&&"string"==typeof e.command&&e.command.startsWith("dynFxSetFXExlusionList_"))return{name:e.text||e.command,description:e.description||`VFX alias: ${e.command}`,command:e.command,type:"vfx-alias",icon:"🎭️",commandId:e.command,categoryId:"vfx-alias"};if(!await this.request("data:has-commands"))return null;if(e&&"string"==typeof e.command&&e.command.includes("TrayExec")){const t=await this.request("data:get-tray-category");if(t){const i="tray";if(e.command.includes("TrayExecByTrayWithBackup")){if(e.command.includes("$$")){const e=t.commands.tray_range_with_backup;if(e)return{...e,commandId:"tray_range_with_backup",categoryId:i}}const a=t.commands.tray_with_backup;if(a)return{...a,commandId:"tray_with_backup",categoryId:i}}if(e.command.includes("STOTrayExecByTray")||e.command.includes("TrayExecByTray")&&!e.command.includes("WithBackup")){if(e.command.includes("$$")){const e=t.commands.tray_range;if(e)return{...e,commandId:"tray_range",categoryId:i}}const a=t.commands.custom_tray;if(a)return{...a,commandId:"custom_tray",categoryId:i}}}}const t=await this.request("data:get-commands");for(const[i,a]of Object.entries(t))for(const[t,n]of Object.entries(a.commands))if(n.command===e.command||n.name===e.text)return{...this.translateCommandDefinition(n,t),commandId:t,categoryId:i};for(const[i,a]of Object.entries(t))for(const[t,n]of Object.entries(a.commands))if(e.command&&e.command.includes(n.command)){const a=e.command.includes("TrayExec"),s=e.command.startsWith(n.command);if(a||s)return{...this.translateCommandDefinition(n,t),commandId:t,categoryId:i}}return null}catch(e){return null}}translateCommandDefinition(e,t){if(!this.i18n)return e;const i={...e},a=`command_definitions.${t}.name`;this.i18n.exists&&this.i18n.exists(a)&&(i.name=this.i18n.t(a));const n=`command_definitions.${t}.description`;return this.i18n.exists&&this.i18n.exists(n)&&(i.description=this.i18n.t(n)),i}async getCommandWarning(e){try{if(!await this.request("data:has-commands"))return null;const t=await this.request("data:get-commands");for(const[i,a]of Object.entries(t))for(const[t,i]of Object.entries(a.commands))if(i.command===e.command||i.name===e.text)return i.warning||null;for(const[i,a]of Object.entries(t))for(const[t,i]of Object.entries(a.commands))if(e.command&&e.command.includes(i.command)){const t=e.command.includes("TrayExec"),a=e.command.startsWith(i.command);if(t||a)return i.warning||null}return null}catch(e){return null}}async addCommand(e,t){if(!this.selectedKey)return this.ui.showToast(this.i18n.t("please_select_a_key_first"),"warning"),!1;const i=this.getCurrentProfile();if(!i)return this.ui.showToast(this.i18n.t("no_valid_profile"),"error"),!1;try{let a={};if("alias"===this.currentEnvironment){const n=i.aliases&&i.aliases[e],s=n&&n.commands?n.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0):[];if(Array.isArray(t))t.forEach(e=>{const t=e.command;t&&s.push(t)});else{const e=t.command;e&&s.push(e)}const o=s.join(" $$ "),r={...i.aliases};r[e]||(r[e]={}),r[e].commands=o,a.aliases=r}else{const n={...i.builds};n[this.currentEnvironment]||(n[this.currentEnvironment]={keys:{}}),n[this.currentEnvironment].keys||(n[this.currentEnvironment].keys={});const s={...n[this.currentEnvironment].keys};s[e]||(s[e]=[]),s[e]=[...s[e],t],n[this.currentEnvironment].keys=s,a.builds=n}return(await this.request("data:update-profile",{profileId:this.cache.currentProfile,modify:a})).success?(this.emit("command-added",{key:e,command:t}),!0):(this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1)}catch(e){return console.error("Error adding command:",e),this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1}}async deleteCommand(e,t){const i=this.getCurrentProfile();if(!i)return!1;try{const a="alias"===this.currentEnvironment||i.aliases&&Object.prototype.hasOwnProperty.call(i.aliases,e);console.log("isAliasContext",a);let n={};if(a){const a=i.aliases&&i.aliases[e];if(!a||!a.commands)return!1;const s=a.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t>=0&&t<s.length){s.splice(t,1);const a={...i.aliases};a[e].commands=s.join(" $$ "),n.aliases=a}}else if(i.keys[e]&&i.keys[e][t]){const a={...i.builds};a[this.currentEnvironment]||(a[this.currentEnvironment]={keys:{}});const s={...a[this.currentEnvironment].keys};s[e]=[...s[e]],s[e].splice(t,1),a[this.currentEnvironment].keys=s,n.builds=a}return(await this.request("data:update-profile",{profileId:this.cache.currentProfile,modify:n})).success?(this.emit("command-deleted",{key:e,index:t}),!0):(this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1)}catch(e){return console.error("Error deleting command:",e),this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1}}async moveCommand(e,t,i){const a=this.getCurrentProfile();if(!a)return!1;try{let n={};if("alias"===this.currentEnvironment){const s=a.aliases&&a.aliases[e];if(!s||!s.commands)return!1;const o=s.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t>=0&&t<o.length&&i>=0&&i<o.length){const[s]=o.splice(t,1);o.splice(i,0,s);const r=o.join(" $$ "),c={...a.aliases};c[e].commands=r,n.aliases=c}}else if(a.keys[e]&&t>=0&&t<a.keys[e].length&&i>=0&&i<a.keys[e].length){const s={...a.builds};s[this.currentEnvironment]||(s[this.currentEnvironment]={keys:{}});const o={...s[this.currentEnvironment].keys};o[e]=[...o[e]];const[r]=o[e].splice(t,1);o[e].splice(i,0,r),s[this.currentEnvironment].keys=o,n.builds=s}return(await this.request("data:update-profile",{profileId:this.cache.currentProfile,modify:n})).success?(this.emit("command-moved",{key:e,fromIndex:t,toIndex:i}),!0):(this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1)}catch(e){return console.error("Error moving command:",e),this.ui.showToast(this.i18n.t("failed_to_save_profile"),"error"),!1}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async getCommandCategories(){try{return await this.request("data:has-commands")?await this.request("data:get-commands"):{}}catch(e){return{}}}async filterCommandLibrary(){try{if(!await this.request("data:has-commands"))return;const e=document.querySelectorAll(".command-item"),t=await this.request("data:get-commands");e.forEach(e=>{const i=e.dataset.command;if(!i)return;let a=null;for(const[e,n]of Object.entries(t))if(n.commands[i]){a=n.commands[i];break}if(a){let t;t="alias"===this.currentEnvironment||!a.environment||a.environment===this.currentEnvironment,e.dataset.envHidden=(!t).toString(),t?""!==e.style.display&&"none"!==e.style.display||(e.style.display="flex"):e.style.display="none"}}),document.querySelectorAll(".category").forEach(e=>{const t=e.querySelectorAll('.command-item:not([style*="display: none"])').length>0;e.style.display=t?"block":"none"})}catch(e){console.warn("CommandLibraryService: filterCommandLibrary failed:",e)}}async getCommandChainPreview(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_see_the_generated_command"):this.i18n.t("select_a_key_to_see_the_generated_command");const t=await this.getCommandsForSelectedKey();if(0===t.length)return"alias"===this.currentEnvironment?he(e,{commands:""}).trim():`${e} ""`;if("alias"===this.currentEnvironment)return he(e,{commands:t.map(e=>e.command).join(" $$ ")}).trim();{const i=document.getElementById("stabilizeExecutionOrder");let a;return a=i&&i.checked&&t.length>1?await this.generateMirroredCommandString(t):t.map(e=>e.command).join(" $$ "),`${e} "${a}"`}}async generateMirroredCommandString(e){return await this.request("fileops:generate-mirrored-commands",{commands:e})}async getEmptyStateInfo(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return{title:"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_edit")||"Select an alias to edit":this.i18n.t("select_a_key_to_edit")||"Select a key to edit",preview:"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_see_the_generated_command")||"Select an alias to see the generated command":this.i18n.t("select_a_key_to_see_the_generated_command")||"Select a key to see the generated command",icon:"alias"===this.currentEnvironment?"fas fa-mask":"fas fa-keyboard",emptyTitle:"alias"===this.currentEnvironment?this.i18n.t("no_alias_selected")||"No Alias Selected":this.i18n.t("no_key_selected")||"No Key Selected",emptyDesc:"alias"===this.currentEnvironment?this.i18n.t("select_alias_from_left_panel")||"Select an alias from the left panel to view and edit its command chain.":this.i18n.t("select_key_from_left_panel")||"Select a key from the left panel to view and edit its command chain.",commandCount:"0"};const t=await this.getCommandsForSelectedKey(),i="alias"===this.currentEnvironment?"Alias Chain":"Command Chain";if(0===t.length){const t="alias"===this.currentEnvironment?`${this.i18n.t("click_add_command_to_start_building_your_alias_chain")||'Click "Add Command" to start building your alias chain for'} ${e}.`:`${this.i18n.t("click_add_command_to_start_building_your_command_chain")||'Click "Add Command" to start building your command chain for'} ${e}.`;return{title:`${i} for ${e}`,preview:await this.getCommandChainPreview(),icon:"fas fa-plus-circle",emptyTitle:this.i18n.t("no_commands")||"No Commands",emptyDesc:t,commandCount:"0"}}return{title:`${i} for ${e}`,preview:await this.getCommandChainPreview(),commandCount:t.length.toString()}}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfile=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.updateCacheFromProfile(e)}"KeyService"===e&&t.selectedKey&&(this.selectedKey=t.selectedKey),"AliasBrowserService"===e&&t.selectedAliasName&&(this.selectedAlias=t.selectedAliasName)}}destroy(){this.v&&(this.v.forEach(e=>{"function"==typeof e&&e()}),this.v=[]),super.destroy&&"function"==typeof super.destroy&&super.destroy()}setupRequestResponseEndpoints(){this.v||(this.v=[]),this.v.push(this.respond("command-library:get-data",()=>({commandCategories:this.commandCategories,userCommands:this.userCommands})))}}class pe extends re{constructor({storage:e,eventBus:t,i18n:i,profileService:a=null,modalManager:n=null}){super(t),this.componentName="CommandService",this.storage=e,this.i18n=i,this.profileService=a,this.modalManager=n,this.currentProfile=null,this.currentEnvironment="space",this.selectedKey=null,this.selectedAlias=null,this.cache={currentProfile:null,currentEnvironment:"space",profile:null,builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},keys:{}},this.v=[],this.eventBus&&this.v.push(this.respond("command:add",async({command:e,key:t,position:i})=>this.addCommand(t,e,i)),this.respond("command:edit",async({key:e,index:t,updatedCommand:i})=>this.editCommand(e,t,i)),this.respond("command:validate",({command:e})=>this.validateCommand(e)))}async init(){super.init(),this.setupEventListeners()}onInit(){}getCurrentProfileId(){return this.currentProfile}getCurrentProfile(){return this.cache.currentProfile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){if(!e)return null;const t=this.cache.builds||{space:{keys:{}},ground:{keys:{}}};return t[this.currentEnvironment]||(t[this.currentEnvironment]={keys:{}}),t[this.currentEnvironment].keys||(t[this.currentEnvironment].keys={}),{...e,keys:t[this.currentEnvironment].keys,aliases:this.cache.aliases||{}}}async addCommand(e,t){if(!e)return this.ui?.showToast?.(this.i18n?.t?.("please_select_a_key_first")||"Please select a key first","warning"),!1;const i=this.getCurrentProfile();if(!i)return this.ui?.showToast?.(this.i18n.t("no_valid_profile"),"error"),!1;const a=this.cache.aliases&&this.cache.aliases[e],n=a&&a.commands?a.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0):[];if(Array.isArray(t))t.forEach(e=>{const t=e.command;t&&n.push(t)});else{const e=t.command;e&&n.push(e)}const s=n.join(" $$ "),o=this.cache.keys[e]||[];let r=[];r=Array.isArray(t)?t:[t];const c=[...o,...r];try{const a={};return"alias"===this.currentEnvironment?i.aliases?.[e]?a.modify={aliases:{[e]:{...i.aliases[e]||{},commands:s}}}:a.add={aliases:{[e]:{commands:s,description:"",type:"alias"}}}:i.builds?.[this.currentEnvironment]?.keys?.[e]?a.modify={builds:{[this.currentEnvironment]:{keys:{[e]:c}}}}:a.add={builds:{[this.currentEnvironment]:{keys:{[e]:c}}}},await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),this.emit("command-added",{key:e,command:t}),!0}catch(e){return console.error("Failed to add command:",e),this.ui?.showToast?.("Failed to add command","error"),!1}}async deleteCommand(e,t){if(!this.getCurrentProfile())return!1;if(!e||void 0===t)return!1;let i=null;if("alias"===this.currentEnvironment||this.cache.aliases&&Object.prototype.hasOwnProperty.call(this.cache.aliases,e)){const a=this.cache.aliases[e];if(!a||!a.commands)return!1;const n=a.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t<0||t>=n.length)return!1;n.splice(t,1),i=0===n.length?{delete:{aliases:[e]}}:{modify:{aliases:{[e]:{...a,commands:n.join(" $$ ")}}}}}else{const a=this.cache.keys[e]||[];if(!a[t])return!1;const n=[...a];n.splice(t,1),i=0===n.length?{delete:{builds:{[this.currentEnvironment]:{keys:[e]}}}}:{modify:{builds:{[this.currentEnvironment]:{keys:{[e]:n}}}}}}try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...i}),this.emit("command-deleted",{key:e,index:t}),!0}catch(e){return console.error("Failed to delete command:",e),!1}}async moveCommand(e,t,i){if(!this.getCurrentProfile())return!1;let a=null;if("alias"===this.currentEnvironment){const n=this.cache.aliases&&this.cache.aliases[e];if(!n||!n.commands)return!1;const s=n.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t<0||t>=s.length||i<0||i>=s.length)return!1;const[o]=s.splice(t,1);s.splice(i,0,o),a={modify:{aliases:{[e]:{...n,commands:s.join(" $$ ")}}}}}else{const n=this.cache.keys[e]||[];if(t<0||t>=n.length||i<0||i>=n.length)return!1;const s=[...n],[o]=s.splice(t,1);s.splice(i,0,o),a={modify:{builds:{[this.currentEnvironment]:{keys:{[e]:s}}}}}}try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),this.emit("command-moved",{key:e,fromIndex:t,toIndex:i}),!0}catch(e){return console.error("Failed to move command:",e),!1}}async editCommand(e,t,i){if(console.log("[CommandService] editCommand called with:",{key:e,index:t,updatedCommand:i}),!e||void 0===t||!i)return console.warn("CommandService: Cannot edit command - missing key, index, or updated command"),!1;if(!this.getCurrentProfile())return this.ui?.showToast?.("No valid profile","error"),!1;let a=null;if("alias"===this.currentEnvironment){const n=this.cache.aliases[e];if(!n||!n.commands)return!1;const s=n.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t<0||t>=s.length)return!1;const o=i.command||i;s[t]=o,a={modify:{aliases:{[e]:{...n,commands:s.join(" $$ ")}}}}}else{const n=this.cache.keys[e]||[];if(t<0||t>=n.length)return!1;const s=[...n];s[t]=i,a={modify:{builds:{[this.currentEnvironment]:{keys:{[e]:s}}}}}}console.log("[CommandService] editCommand updates:",a);try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),console.log("[CommandService] editCommand completed successfully"),this.emit("command-edited",{key:e,index:t,updatedCommand:i}),!0}catch(e){return console.error("Failed to edit command:",e),this.ui?.showToast?.("Failed to update command","error"),!1}}async findCommandDefinition(e){try{if(!await this.request("data:has-commands"))return null;if(e.command&&e.command.includes("TrayExec")){const t=await this.request("data:get-tray-category");if(t){if(e.command.includes("TrayExecByTrayWithBackup")&&e.command.includes("$$"))return{commandId:"tray_range_with_backup",...t.commands.tray_range_with_backup};if((e.command.includes("STOTrayExecByTray")||e.command.includes("TrayExecByTray"))&&e.command.includes("$$")&&!e.command.includes("WithBackup"))return{commandId:"tray_range",...t.commands.tray_range};if(e.command.includes("TrayExecByTrayWithBackup"))return{commandId:"tray_with_backup",...t.commands.tray_with_backup};if(e.command.includes("STOTrayExecByTray")||e.command.includes("TrayExecByTray")&&!e.command.includes("WithBackup"))return{commandId:"custom_tray",...t.commands.custom_tray}}}const t=await this.request("data:get-command-category",{categoryId:e.type});if(!t)return null;for(const[i,a]of Object.entries(t.commands))if(a.command===e.command)return{commandId:i,...a};for(const[i,a]of Object.entries(t.commands))if(a.customizable&&e.command.startsWith(a.command.split(" ")[0]))return{commandId:i,...a};return null}catch(e){return null}}async getCommandWarning(e){try{if(!await this.request("data:has-commands"))return null;const t=await this.request("data:get-commands");for(const[i,a]of Object.entries(t))for(const[t,i]of Object.entries(a.commands))if(i.command===e.command||i.name===e.text||e.command&&e.command.includes(i.command))return i.warning||null;return null}catch(e){return null}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&this.updateCacheFromProfile(t)}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfile=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.updateCacheFromProfile(t)}),this.addEventListener("key-selected",e=>{this.selectedKey=e.key,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,this.cache.keys=this.cache.builds[t]?.keys||{},this.selectedKey=null,this.selectedAlias=null)}),this.addEventListener("command:add",async e=>{console.log("[CommandService] command:add received:",e);const{command:t,key:i,position:a}=e;console.log("[CommandService] extracted:",{command:t,key:i,position:a});const n=await this.addCommand(i,t,a);console.log("[CommandService] addCommand result:",n)}),this.addEventListener("command:edit",async e=>{console.log("[CommandService] command:edit received:",e);const{key:t,index:i,updatedCommand:a}=e;console.log("[CommandService] extracted:",{key:t,index:i,updatedCommand:a});const n=await this.editCommand(t,i,a);console.log("[CommandService] editCommand result:",n)})}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.aliases=e.aliases||{},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{})}getCommandsForKey(e){if("alias"===this.currentEnvironment){const t=this.cache.aliases&&this.cache.aliases[e];return t&&t.commands?t.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0):[]}return this.cache.keys[e]||[]}validateCommand(e){return e?{valid:!0}:{valid:!1,reason:"empty"}}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfile=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.updateCacheFromProfile(e),console.log(`[${this.componentName}] Received initial state from DataCoordinator`)}"CommandService"===e&&(this.selectedKey=t.selectedKey??this.selectedKey,this.selectedAlias=t.selectedAlias??this.selectedAlias),"KeyService"===e&&t.selectedKey&&(this.selectedKey=t.selectedKey)}}destroy(){this.v&&(this.v.forEach(e=>{"function"==typeof e&&e()}),this.v=[]),super.destroy&&"function"==typeof super.destroy&&super.destroy()}}class _e extends re{constructor({eventBus:e,storage:t,profileService:i,app:a}){super(e),this.componentName="InterfaceModeService",this.storage=t,this.profileService=i,this.app=a,this.S="space",this.C=null,this.T=!1,this.A=null,this.I=null,this.eventBus&&(this.I=this.respond("environment:switch",async({mode:e}={})=>e?(await this.switchMode(e),{success:!0,mode:this.S}):{success:!1,error:"No mode provided"}))}init(){super.init(),this.setupEventListeners()}get currentMode(){return this.S}set currentMode(e){this.switchMode(e).catch(e=>{console.error("[InterfaceModeService] Error in currentMode setter:",e)})}get currentEnvironment(){return this.S}set currentEnvironment(e){this.switchMode(e).catch(e=>{console.error("[InterfaceModeService] Error in currentEnvironment setter:",e)})}setupEventListeners(){this.T||(this.A=e=>{e.profileId&&(this.C=e.profileId,"undefined"!=typeof window&&console.log(`[InterfaceModeService] Updated cached profile ID from profile switch: ${this.C}`)),e.environment&&this.switchMode(e.environment).catch(e=>{console.error("[InterfaceModeService] Error in profile switched handler:",e)})},this.eventBus.on("profile:switched",this.A),this.T=!0)}async switchMode(e){if(e!==this.S){"undefined"!=typeof window&&console.log(`[InterfaceModeService] switchMode from ${this.S} to ${e}`),this.S,this.S=e;try{await this.updateProfileMode(e)}catch(e){console.error("[InterfaceModeService] Failed to persist environment change:",e)}this.emit("environment:changed",{environment:e})}}async updateProfileMode(e){if(this.C){console.log(`[InterfaceModeService] updateProfileMode called with mode: ${e}`),console.log(`[InterfaceModeService] Current profile ID: ${this.C}`);try{const t=await this.request("data:update-profile",{profileId:this.C,properties:{currentEnvironment:e}});t?.success?console.log(`[InterfaceModeService] Environment persisted to storage: ${e} for profile: ${this.C}`):console.error("[InterfaceModeService] Failed to persist environment:",t)}catch(e){console.error("[InterfaceModeService] Error updating profile mode:",e)}}else console.warn("[InterfaceModeService] Cannot update profile mode: no current profile ID")}getCurrentMode(){return this.S}async setCurrentMode(e){await this.switchMode(e)}initializeFromProfile(e){e?.currentEnvironment&&(this.S,this.S=e.currentEnvironment,"undefined"!=typeof window&&console.log(`[InterfaceModeService] Broadcasting initial environment: ${this.S} (from profile initialization)`),this.emit("environment:changed",{environment:this.S,isInitialization:!0}))}destroy(){this.T&&(this.eventBus.off("profile:switched",this.A),this.T=!1),this.I&&(this.I(),this.I=null),super.destroy()}getCurrentState(){return{currentMode:this.S,environment:this.S,currentEnvironment:this.S}}handleInitialState(e,t){t&&("DataCoordinator"!==e&&"ProfileService"!==e||!t.currentEnvironment||(t.currentProfile&&(this.C=t.currentProfile,"undefined"!=typeof window&&console.log(`[InterfaceModeService] Cached profile ID from ${e}: ${this.C}`)),this.S,this.S=t.currentEnvironment,"undefined"!=typeof window&&console.log(`[InterfaceModeService] Broadcasting initial environment: ${this.S} (from ${e} late-join handshake)`),this.emit("environment:changed",{environment:this.S,isInitialization:!0})))}}const fe="sync-folder";class ye extends re{constructor({dbName:e="sto-sync-handles",storeName:t="directories",eventBus:i}={}){super(i),this.componentName="FileSystemService",this.dbName=e,this.storeName=t}openDB(){return new Promise((e,t)=>{const i=indexedDB.open(this.dbName,1);i.onupgradeneeded=()=>{i.result.createObjectStore(this.storeName)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async saveDirectoryHandle(e,t){const i=await this.openDB(),a=i.transaction(this.storeName,"readwrite");a.objectStore(this.storeName).put(t,e),await new Promise((e,t)=>{a.oncomplete=()=>e(),a.onerror=()=>t(a.error),a.onabort=()=>t(a.error)}),i.close()}async getDirectoryHandle(e){const t=await this.openDB(),i=t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e),a=await new Promise((e,t)=>{i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)});return t.close(),a||null}async writeFile(e,t,i){const a=t.split("/"),n=a.pop();let s=e;for(const e of a)s=await s.getDirectoryHandle(e,{create:!0});const o=await s.getFileHandle(n,{create:!0}),r=await o.createWritable();await r.write(i),await r.close()}static#e=null;static $(){return this.#e||(this.#e=new ye),this.#e}static saveDirectoryHandle(e,t){return this.$().saveDirectoryHandle(e,t)}static getDirectoryHandle(e){return this.$().getDirectoryHandle(e)}static writeFile(e,t,i){return this.$().writeFile(e,t,i)}}const ge=(...e)=>ye.writeFile(...e);class ve extends re{constructor(e={}){if(super(r),this.componentName="SyncService",e&&"function"==typeof e.getSettings)this.storage=e,this.ui=global.stoUI;else{const{storage:t,ui:i,fs:a}=e;this.storage=t,this.ui=i,this.fs=a||new ye({eventBus:r})}this.fs||(this.fs=new ye({eventBus:r})),this.eventBus&&(this.respond("sync:sync-project",()=>this.syncProject()),this.respond("sync:set-sync-folder",({autoSync:e}={})=>this.setSyncFolder(e)),this.respond("sync:get-sync-folder-handle",()=>this.getSyncFolderHandle()))}async setSyncFolder(e=!1){try{const t=await window.showDirectoryPicker();await this.fs.saveDirectoryHandle(fe,t);const i=t.name;if(this.storage){const t=this.storage.getSettings();t.syncFolderName=i,t.syncFolderPath=`Selected folder: ${i}`,t.autoSync=e,this.storage.saveSettings(t)}return this.ui?.showToast(Y.t("sync_folder_set"),"success"),this.emit("sync:folder-set",{handle:t}),t}catch(e){return"AbortError"!==e?.name&&this.ui?.showToast(Y.t("failed_to_set_sync_folder",{error:e.message}),"error"),null}}async getSyncFolderHandle(){try{return await this.fs.getDirectoryHandle(fe)}catch(e){return console.error("[SyncService] getSyncFolderHandle failed",e),null}}async ensurePermission(e){if(!e)return!1;try{const t={mode:"readwrite"};return"granted"===await e.queryPermission(t)||"granted"===await e.requestPermission(t)}catch(e){return console.error("[SyncService] ensurePermission failed",e),!1}}async syncProject(){const e=await this.getSyncFolderHandle();if(e)if(await this.ensurePermission(e))try{await(window.stoExport?.syncToFolder(e));const t=window.app?.autoSyncManager;t?.isEnabled&&"change"===t?.interval||this.ui?.showToast(Y.t("project_synced_successfully"),"success"),r.emit("project-synced")}catch(e){this.ui?.showToast(Y.t("failed_to_sync_project",{error:e.message}),"error")}else this.ui?.showToast(Y.t("permission_denied_to_folder"),"error");else this.ui?.showToast(Y.t("no_sync_folder_selected"),"warning")}}class be extends re{constructor({storage:e,eventBus:t,i18n:i,ui:a}={}){super(t),this.componentName="KeyService",this.storage=e,this.i18n=i,this.ui=a,this.selectedKey=null,this.currentEnvironment="space",this.currentProfile=null,this.cache={currentProfile:null,currentEnvironment:"space",keys:{},builds:{space:{keys:{}},ground:{keys:{}}},aliases:{}},this.validKeys=this.generateValidKeys(),this.eventBus&&(this.respond("key:get-selected",()=>this.selectedKey),this.respond("key:add",({key:e}={})=>this.addKey(e)),this.addEventListener("key:delete",({key:e}={})=>this.deleteKey(e)))}async init(){super.init(),this.setupEventListeners()}setSelectedKey(e){this.selectedKey=e}setCurrentEnvironment(e){this.currentEnvironment=e,this.cache.currentEnvironment=e,this.cache.keys=this.cache.builds[e]?.keys||{}}setCurrentProfile(e){this.currentProfile=e,this.cache.currentProfile=e}getCurrentProfileId(){return this.currentProfile}setupEventListeners(){this.eventBus&&(this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("keys:changed",{keys:this.cache.keys}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.cache.currentProfile=e,this.currentProfile=e,this.cache.currentEnvironment=i||"space",this.currentEnvironment=this.cache.currentEnvironment,this.selectedKey=null,this.updateCacheFromProfile(t),this.emit("keys:changed",{keys:this.cache.keys})}),this.addEventListener("environment:changed",({environment:e})=>{e&&(this.cache.currentEnvironment=e,this.currentEnvironment=e,this.cache.keys=this.cache.builds[e]?.keys||{},this.emit("keys:changed",{keys:this.cache.keys}))}),this.addEventListener("key-selected",({key:e,name:t}={})=>{this.selectedKey=e||t||null}))}updateCacheFromProfile(e){e&&(this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{},this.cache.aliases=e.aliases||{})}getCurrentProfile(){return this.cache.currentProfile?{id:this.cache.currentProfile,builds:this.cache.builds,keys:this.cache.keys,aliases:this.cache.aliases,environment:this.cache.currentEnvironment}:null}async addKey(e){if(!await this.isValidKeyName(e))return this.ui?.showToast?.(this.i18n?.t?.("invalid_key_name")||"Invalid key name","error"),!1;if(!this.cache.currentProfile)return this.ui?.showToast?.(this.i18n?.t?.("no_profile_selected")||"No active profile","error"),!1;if(this.cache.keys[e])return this.ui?.showToast?.(this.i18n?.t?.("key_already_exists",{keyName:e})||"Key already exists","warning"),!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{builds:{[this.cache.currentEnvironment]:{keys:{[e]:[]}}}}}),this.selectedKey=e,this.emit("key-added",{key:e}),this.ui?.showToast?.(this.i18n?.t?.("key_added")||"Key added","success"),!0}catch(e){return console.error("[KeyService] Failed to add key:",e),this.ui?.showToast?.(this.i18n?.t?.("failed_to_add_key")||"Failed to add key","error"),!1}}async deleteKey(e){if(!this.cache.currentProfile||!this.cache.keys[e])return!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,delete:{builds:{[this.cache.currentEnvironment]:{keys:[e]}}}}),this.selectedKey===e&&(this.selectedKey=null),this.emit("key-deleted",{key:e}),!0}catch(e){return console.error("[KeyService] Failed to delete key:",e),!1}}async duplicateKey(e){if(!this.cache.currentProfile||!this.cache.keys[e])return!1;const t=this.cache.keys[e];if(!t||0===t.length)return!1;try{let i=`${e}_copy`,a=1;for(;this.cache.keys[i];)i=`${e}_copy_${a}`,a++;const n=t.map(e=>({...e,id:this.generateKeyId()}));return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{builds:{[this.cache.currentEnvironment]:{keys:{[i]:n}}}}}),this.emit("key-duplicated",{from:e,to:i}),!0}catch(e){return console.error("[KeyService] Failed to duplicate key:",e),!1}}async isValidKeyName(e){if(!e||"string"!=typeof e)return!1;try{return(await this.request("data:get-key-name-pattern")||/^[A-Za-z0-9_]+$/).test(e)&&e.length<=20}catch(t){return/^[A-Za-z0-9_]+$/.test(e)&&e.length<=20}}async isValidAliasName(e){try{return(await this.request("data:get-alias-name-pattern")||/^[A-Za-z0-9_]+$/).test(e)}catch(t){return/^[A-Za-z0-9_]+$/.test(e)}}isValidKey(e){return!(!e||"string"!=typeof e||!Array.isArray(this.validKeys))&&this.validKeys.some(t=>t.toLowerCase()===e.toLowerCase())}generateValidKeys(){const e=[];for(let t=1;t<=12;t++)e.push(`F${t}`),e.push(`Alt+F${t}`);e.push("Space","Tab","Enter","Shift+Space");for(let t=65;t<=90;t++){const i=String.fromCharCode(t);e.push(i),e.push(`Ctrl+${i}`),e.push(`Control+${i}`),e.push(`Alt+${i}`),e.push(`Shift+${i}`)}for(let t=0;t<=9;t++)e.push(String(t)),e.push(`Ctrl+${t}`),e.push(`Alt+${t}`),e.push(`Shift+${t}`);return e.push("Lbutton","Rbutton","Button4","Wheelplus"),e}generateKeyId(){return`key_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}onInit(){}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateMirroredCommandString(e){return ne(this.eventBus,"fileops:generate-mirrored-commands",{commands:e})}detectAndUnmirrorCommands(e){return ne(this.eventBus,"fileops:detect-unmirror-commands",{commandString:e})}parseCommandString(e){return ne(this.eventBus,"parser:parse-command-string",{commandString:e}).then(e=>e.commands)}parseKeybindFile(e){return ne(this.eventBus,"fileops:parse-keybind-file",{content:e})}importKeybindFile(e){const t=this.currentProfile,i=this.currentEnvironment||"space";return ne(this.eventBus,"import:keybind-file",{content:e,profileId:t,environment:i})}importAliasFile(e){const t=this.currentProfile;return ne(this.eventBus,"import:alias-file",{content:e,profileId:t})}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const n=/^\d+$/.test(e),s=/^\d+$/.test(t);if(n&&s)return parseInt(e)-parseInt(t);if(n&&!s)return-1;if(!n&&s)return 1;const o=/^[A-Z]$/.test(e),r=/^[A-Z]$/.test(t);if(o&&r)return e.localeCompare(t);if(o&&!r)return-1;if(!o&&r)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}exportProfile(e){return ne(this.eventBus,"fileops:generate-keybind-file",{profile:e})}validateKeybind(e,t=[]){const i=[];return this.isValidKey(e)||i.push(`Invalid key name: ${e}`),Array.isArray(t)&&0!==t.length?(t.length>20&&i.push("Too many commands (max 20)"),t.forEach((e,t)=>{e&&"string"==typeof e.command&&e.command.trim()||i.push(`Command ${t+1} is empty`)})):i.push("At least one command is required"),{valid:0===i.length,errors:i}}suggestKeys(e=""){if(!Array.isArray(this.validKeys)||0===this.validKeys.length)return[];const t=e.toLowerCase();return this.validKeys.filter(e=>e.toLowerCase().includes(t)).sort(this.compareKeys.bind(this)).slice(0,20)}getCommonKeys(){return["Space","Tab","Enter","Escape","F1","F2","F3","Ctrl+1","Ctrl+2","Ctrl+3"].filter(e=>this.validKeys.includes(e)).sort(this.compareKeys.bind(this))}generateKeybindId(){return`keybind_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}cloneKeybind(e){return JSON.parse(JSON.stringify(e))}getProfileStats(e={}){const t=e.keys||{},i=e.aliases||{},a={totalKeys:Object.keys(t).length,totalCommands:0,totalAliases:Object.keys(i).length,commandTypes:{},mostUsedCommands:{}};return Object.values(t).forEach(e=>{Array.isArray(e)&&(a.totalCommands+=e.length,e.forEach(e=>{if(!e)return;const t=e.command||"",i=e.category||e.type||"unknown";a.commandTypes[i]=(a.commandTypes[i]||0)+1,t&&(a.mostUsedCommands[t]=(a.mostUsedCommands[t]||0)+1)}))}),a}handleKeybindFileImport(e){if(!e||!e.target||!e.target.files||0===e.target.files.length)return;const t=e.target.files[0],i=new FileReader;i.onload=e=>{const t=e.target.result;this.importKeybindFile(t)},i.readAsText(t),e.target.value=""}async detectCommandType(e){if(!e||"string"!=typeof e)return"custom";try{const t=await this.request("parser:parse-command-string",{commandString:e.trim(),options:{generateDisplayText:!1}});if(t.commands&&t.commands.length>0)return t.commands[0].category||"custom"}catch(e){console.warn("[KeyService] detectCommandType failed, falling back to custom:",e)}return"custom"}getCurrentState(){return{selectedKey:this.selectedKey,currentProfile:this.cache.currentProfile,currentEnvironment:this.cache.currentEnvironment,keys:this.getKeys()}}getKeys(){return Object.keys(this.cache.keys)}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.cache.currentProfile=e.id,this.currentProfile=e.id,this.cache.currentEnvironment=e.environment||"space",this.currentEnvironment=this.cache.currentEnvironment,this.updateCacheFromProfile(e),this.emit("keys:changed",{keys:this.cache.keys}),console.log(`[${this.componentName}] Received initial state from DataCoordinator`)}"KeyService"===e&&(this.selectedKey=t.selectedKey??this.selectedKey)}}}const we=globalThis.STO_DATA||{};class ke{constructor(){this.keybindPatterns={standard:/^([a-zA-Z0-9_+\-\s\[\]]+)\s+"([^"]*)"(?:\s+"([^"]*)")?$/,bind:/^\/bind\s+([a-zA-Z0-9_+\-\s\[\]]+)\s+(.+)$/,alias:/^alias\s+([a-zA-Z_][a-zA-Z0-9_]*)\s+(?:"([^"]+)"|<&\s+(.+?)\s+&>)$/,comment:/^[#;].*$/},this.validKeys=this.generateValidKeys()}generateValidKeys(){const e=new Set;for(let t=1;t<=12;t++)e.add(`F${t}`);for(let t=0;t<=9;t++)e.add(t.toString());for(let t=65;t<=90;t++)e.add(String.fromCharCode(t));["Space","Tab","Enter","Escape","Backspace","Delete","Insert","Home","End","PageUp","PageDown","Up","Down","Left","Right","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","NumPadEnter","NumPadPlus","NumPadMinus","NumPadMultiply","NumPadDivide","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","divide","multiply","Button4","Button5","Button6","Button7","Button8","Lbutton","Rbutton","Mbutton","Leftdrag","Rightdrag","Middleclick","Mousechord","Wheelplus","Wheelminus","Semicolon","Equals","Comma","Minus","Period","Slash","Grave","LeftBracket","Backslash","RightBracket","Quote","[","]"].forEach(t=>e.add(t));const t=Array.from(e);return["Ctrl","Alt","Shift","Control"].forEach(i=>{t.forEach(t=>e.add(`${i}+${t}`))}),e.add("Ctrl+Alt"),e.add("Ctrl+Shift"),e.add("Alt+Shift"),e.add("Control+Alt"),e.add("Control+Shift"),t.forEach(t=>{e.add(`Ctrl+Alt+${t}`),e.add(`Ctrl+Shift+${t}`),e.add(`Alt+Shift+${t}`),e.add(`Control+Alt+${t}`),e.add(`Control+Shift+${t}`)}),Array.from(e).sort()}parseKeybindFile(e){const t=e.split("\n"),i={keybinds:{},aliases:{},comments:[],errors:[]};return t.forEach((e,t)=>{const a=e.trim();if(a)try{if(this.keybindPatterns.comment.test(a))i.comments.push({line:t+1,content:a});else if(this.keybindPatterns.alias.test(a)){const e=a.match(this.keybindPatterns.alias);if(e){const[,a,n,s]=e,o=n||s;i.aliases[a]={name:a,commands:o,line:t+1}}}else if(this.keybindPatterns.standard.test(a)){const e=a.match(this.keybindPatterns.standard);if(e){const[,a,n,s]=e,o=this.parseCommandString(n);i.keybinds[a]={key:a,commands:o,line:t+1,raw:n,optionalParam:s||null}}}else if(this.keybindPatterns.bind.test(a)){const e=a.match(this.keybindPatterns.bind);if(e){const[,a,n]=e,s=n.replace(/^"(.*)"$/,"$1"),o=this.parseCommandString(s);i.keybinds[a]={key:a,commands:o,line:t+1,raw:s}}}else i.errors.push({line:t+1,content:a,error:"Invalid keybind format"})}catch(e){i.errors.push({line:t+1,content:a,error:e.message})}}),i}generateMirroredCommandString(e){if(!e||e.length<=1)return(e||[]).map(e=>e.command||e).join(" $$ ");const t=e.map(e=>e.command||e),i=[...t].slice(0,-1).reverse();return[...t,...i].join(" $$ ")}detectAndUnmirrorCommands(e){if(!e||"string"!=typeof e)return{isMirrored:!1,originalCommands:[]};const t=e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e);if(t.length<=1)return{isMirrored:!1,originalCommands:t};if(t.length<3||t.length%2==0)return{isMirrored:!1,originalCommands:t};const i=Math.floor(t.length/2),a=t.slice(0,i+1),n=t.slice(i+1),s=a.slice(0,-1).reverse();return n.length===s.length&&n.every((e,t)=>e===s[t])?{isMirrored:!0,originalCommands:a}:{isMirrored:!1,originalCommands:t}}parseCommandString(e){return e.split(/\s*\$\$\s*/).map(e=>e.trim()).map((e,t)=>{const i={command:e,type:this.detectCommandType(e),icon:this.getCommandIcon(e),text:this.getCommandText(e),id:`imported_${Date.now()}_${t}`};if(/TrayExecByTray/.test(e)){const t=e.match(/(?:\+)?(?:STO)?TrayExecByTray\s+(\d+)\s+(\d+)/i);if(t){const e=parseInt(t[1]),a=parseInt(t[2]);i.parameters={tray:e,slot:a},i.text=`Execute Tray ${e+1} Slot ${a+1}`}}else if(e.includes('"')){const t=e.match(/^(\w+)\s+"([^"]+)"$/);t&&(i.parameters={message:t[2]},i.text=`${i.text}: ${t[2]}`)}return i})}detectCommandType(e){if(!e||"string"!=typeof e)return"custom";const t=e.toLowerCase().trim();return t.includes("+stotrayexecbytray")?"tray":t.startsWith("say ")||t.startsWith("team ")||t.startsWith("zone ")||t.startsWith("tell ")||t.includes('"')?"communication":t.includes("+power_exec")||t.includes("distribute_shields")||t.includes("reroute_shields")?"power":t.includes("+fullimpulse")||t.includes("+reverse")||t.includes("throttle")||t.includes("+turn")||t.includes("+up")||t.includes("+down")||t.includes("+left")||t.includes("+right")||t.includes("+forward")||t.includes("+backward")||t.includes("follow")?"movement":t.includes("cam")||t.includes("look")||t.includes("zoom")?"camera":t.includes("fire")||t.includes("attack")||"fireall"===t||"firephasers"===t||"firetorps"===t||"firephaserstorps"===t?"combat":t.includes("target")||"target_enemy_near"===t||"target_self"===t||"target_friend_near"===t||"target_clear"===t?"targeting":t.includes("+gentoggle")||"screenshot"===t||t.includes("hud")||"interactwindow"===t?"system":"custom"}getCommandIcon(e){return{targeting:"🎯",combat:"🔥",tray:"⚡",power:"🔋",communication:"💬",movement:"🚀",camera:"📹",system:"⚙️"}[this.detectCommandType(e)]||"⚙️"}getCommandText(e){if(e.includes("+STOTrayExecByTray")){const t=e.match(/\+STOTrayExecByTray\s+(\d+)\s+(\d+)/);if(t)return`Execute Tray ${parseInt(t[1])+1} Slot ${parseInt(t[2])+1}`}if(we.commands)for(const[,t]of Object.entries(we.commands))for(const[,i]of Object.entries(t.commands))if(i.command===e)return i.name;return e.replace(/[_+]/g," ").replace(/([A-Z])/g," $1").trim()}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const n=/^\d+$/.test(e),s=/^\d+$/.test(t);if(n&&s)return parseInt(e)-parseInt(t);if(n&&!s)return-1;if(!n&&s)return 1;const o=/^[A-Z]$/.test(e),r=/^[A-Z]$/.test(t);if(o&&r)return e.localeCompare(t);if(o&&!r)return-1;if(!o&&r)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}getProfileStats(e){const t={totalKeys:Object.keys(e.keys||{}).length,totalCommands:0,totalAliases:Object.keys(e.aliases||{}).length,commandTypes:{},mostUsedCommands:{}};return Object.values(e.keys||{}).forEach(e=>{t.totalCommands+=e.length,e.forEach(e=>{t.commandTypes[e.type]=(t.commandTypes[e.type]||0)+1,t.mostUsedCommands[e.command]=(t.mostUsedCommands[e.command]||0)+1})}),t}generateFileHeader(e,t=null){const i=(new Date).toLocaleString(),a=this.getProfileStats(e),n=t||this.generateFileName(e,"txt");return`; ================================================================\n; ${e.name} - STO Keybind Configuration\n; ================================================================\n; Mode: ${(e.currentEnvironment||"space").toUpperCase()}\n; Generated: ${i}\n; Created by: STO Tools Keybind Manager v${we.settings.version}\n;\n; Keybind Statistics:\n; - Keys bound: ${a.totalKeys}\n; - Total commands: ${a.totalCommands}\n;\n; Note: Aliases are exported separately\n; To use this file in Star Trek Online:\n; 1. Save this file to your STO Live folder\n; 2. In game, type: /bind_load_file ${n}\n; ================================================================\n\n`}generateAliasFile(e){if(!e||0===Object.keys(e).length)return"";let t="; Command Aliases\n; ================================================================\n; Aliases allow you to create custom commands that execute\n; multiple commands in sequence. Use them in keybinds like any\n; other command.\n; ================================================================\n\n";return Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,i])=>{t+=he(e,i),t+="\n"}),t}generateKeybindSection(e,t={}){if(!e||0===Object.keys(e).length)return"; No keybinds defined\n\n";let i="; Keybind Commands\n; ================================================================\n; Each line binds a key to one or more commands.\n; Multiple commands are separated by $$";t.stabilizeExecutionOrder&&(i+="\n; EXECUTION ORDER STABILIZATION: ON\n; Commands are mirrored to ensure consistent execution order\n; Phase 1: left-to-right, Phase 2: right-to-left"),i+="\n; ================================================================\n\n";const a=Object.keys(e).sort(this.compareKeys.bind(this));if(t.groupByType){const n=this.groupKeysByType(a,e);Object.entries(n).forEach(([a,n])=>{0!==n.length&&(i+=`; ${a}\n; ${"-".repeat(a.length)}\n`,n.forEach(a=>{i+=this.B(a,e[a],t)}),i+="\n")})}else a.forEach(a=>{i+=this.B(a,e[a],t)});return i+="\n",i}B(e,t,i={}){if(!t||0===t.length)return"";const a=Array.isArray(t)?t.filter(e=>e&&("string"==typeof e.command||"string"==typeof e)):[];if(0===a.length)return"";let n,s=!1;if(i.profile&&i.profile.keybindMetadata&&i.environment&&i.profile.keybindMetadata[i.environment]){const t=i.profile.keybindMetadata[i.environment];s=!!(t&&t[e]&&t[e].stabilizeExecutionOrder)}return n=i.stabilizeExecutionOrder||s?this.generateMirroredCommandString(a):a.map(e=>e.command||e).join(" $$ "),`${e} "${n}"\n`}groupKeysByType(e,t){const i={"Function Keys":[],"Number Keys":[],"Letter Keys":[],"Special Keys":[],"Modifier Combinations":[]};return e.forEach(e=>{/^F\d+$/.test(e)?i["Function Keys"].push(e):/^\d+$/.test(e)?i["Number Keys"].push(e):/^[A-Z]$/.test(e)?i["Letter Keys"].push(e):e.includes("+")?i["Modifier Combinations"].push(e):i["Special Keys"].push(e)}),i}generateFileFooter(){return"; ================================================================\n; End of keybind file\n; ================================================================\n;\n; Additional STO Commands Reference:\n;\n; Targeting:\n;   target_nearest_enemy    - Target closest hostile\n;   target_nearest_friend   - Target closest friendly\n;   target_self            - Target your own ship\n;\n; Combat:\n;   FireAll               - Fire all weapons\n;   FirePhasers          - Fire beam weapons only\n;   FireTorps            - Fire torpedo weapons only\n;\n; Shield Management:\n;   +power_exec <ability> - Execute bridge officer ability\n;   Examples: +power_exec Distribute_Shields\n;\n; Tray Execution:\n;   +STOTrayExecByTray <tray> <slot> - Execute ability from tray\n;   Example: +STOTrayExecByTray 0 0  (Tray 1, Slot 1)\n;\n; For more commands and help, visit the STO Wiki or community forums.\n; ================================================================\n"}generateFileName(e,t,i){const a=(new Date).toISOString().replace(/[:.]/g,"-"),n=i||e.currentEnvironment||"space";return`${e.name.replace(/\s+/g,"_")}_${n}_${a}.${t}`}generateKeybindFile(e,t={}){let i="";return i+=this.generateFileHeader(e,t.syncFilename),i+=this.generateKeybindSection(e.keys,{...t,profile:e,environment:t.environment||e.currentEnvironment||"space"}),i+=this.generateFileFooter(),i}}class Se extends re{constructor({eventBus:e,storage:t,i18n:i,ui:a}={}){super(e),this.componentName="ImportService",this.storage=t,this.i18n=i,this.ui=a,this.fileHandler=new ke}setupRequestHandlers(){this.eventBus&&(this.respond("import:keybind-file",({content:e,profileId:t,environment:i,options:a={}})=>this.importKeybindFile(e,t,i,a)),this.respond("import:alias-file",({content:e,profileId:t,options:i={}})=>this.importAliasFile(e,t,i)),this.respond("import:profile-file",({content:e,options:t={}})=>this.importProfileFile(e,t)),this.respond("import:project-file",({content:e,options:t={}})=>this.importProjectFile(e,t)),this.respond("import:from-file",({file:e})=>this.importFromFile(e)),this.respond("import:validate-keybind-file",({content:e})=>this.validateKeybindFile(e)),this.respond("import:validate-profile-file",({content:e})=>this.validateProfileFile(e)))}async parseKeybindFile(e){const t={},i={},a=[];if(!e||"string"!=typeof e)return{keybinds:t,aliases:i,errors:["Invalid file content"]};const n=e.split("\n");for(let e=0;e<n.length;e++){const s=n[e].trim();if(s&&!s.startsWith(";")&&!s.startsWith("#"))try{const n=s.match(/^(\S+)\s+"([^"]+)"/);if(n){const[,e,i]=n,a=await this.request("parser:parse-command-string",{commandString:i});t[e]={raw:i,commands:a.commands};continue}const o=s.match(/^alias\s+(\w+)\s+"([^"]+)"/);if(o){const[,e,t]=o;i[e]={commands:t};continue}const r=s.match(/^alias\s+(\w+)\s+<&\s*(.+?)\s*&>/);if(r){const[,e,t]=r;i[e]={commands:t};continue}s.length>0&&a.push(`Line ${e+1}: Unrecognized format: ${s}`)}catch(t){a.push(`Line ${e+1}: Parse error: ${t.message}`)}}return{keybinds:t,aliases:i,errors:a}}async importKeybindFile(e,t,i,a={}){try{const a=await this.parseKeybindFile(e),n=Object.keys(a.keybinds).length;if(0===n)return this.showToast(this.i18n?.t?.("no_keybinds_found_in_file")||"No keybinds found","warning"),{success:!1,error:"No keybinds found"};if(!this.storage)return{success:!1,error:"Storage not available"};if(!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};let s=this.storage.getProfile(t)||{builds:{space:{keys:{}},ground:{keys:{}}}};s.builds||(s.builds={space:{keys:{}},ground:{keys:{}}});const o=i||"space";s.builds[o]||(s.builds[o]={keys:{}});const r=s.builds[o].keys;for(const[e,t]of Object.entries(a.keybinds)){const i=t.raw;if((await this.request("parser:parse-command-string",{commandString:i})).isMirrored){const t=this.extractOriginalFromMirrored(i),a=await this.request("parser:parse-command-string",{commandString:t.join(" $$ ")});r[e]=a.commands,s.keybindMetadata||(s.keybindMetadata={}),s.keybindMetadata[o]||(s.keybindMetadata[o]={}),s.keybindMetadata[o][e]||(s.keybindMetadata[o][e]={}),s.keybindMetadata[o][e].stabilizeExecutionOrder=!0}else r[e]=t.commands}this.storage.saveProfile(t,s),this.emit("profile-updated",{profileId:t,environment:o}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0);const c=Object.keys(a.aliases).length,l=c>0?this.i18n?.t?.("import_completed_with_ignored_aliases",{keyCount:n,ignoredAliases:c})||`Import completed: ${n} keybinds (${c} aliases ignored - use Import Aliases)`:this.i18n?.t?.("import_completed",{keyCount:n})||`Import completed: ${n} keybinds`;return this.showToast(l,"success"),{success:!0,imported:{keys:n},errors:a.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_keybind_file",{error:e.message})||`Failed to import keybind file: ${e.message}`,"error"),{success:!1,error:e.message}}}async importAliasFile(e,t,i={}){try{const i=await this.parseKeybindFile(e),a=Object.keys(i.aliases).length;if(0===a)return this.showToast(this.i18n?.t?.("no_aliases_found_in_file")||"No aliases found","warning"),{success:!1,error:"No aliases found"};if(!this.storage||!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};const n=this.storage.getProfile(t)||{aliases:{}};return n.aliases||(n.aliases={}),Object.entries(i.aliases).forEach(([e,t])=>{n.aliases[e]={commands:t.commands,description:t.description||""}}),this.storage.saveProfile(t,n),this.emit("profile-updated",{profileId:t}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("aliases_imported_successfully",{aliasCount:a})||`Successfully imported ${a} aliases`,"success"),{success:!0,imported:{aliases:a},errors:i.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_aliases",{error:e.message})||`Failed to import aliases: ${e.message}`,"error"),{success:!1,error:e.message}}}async importProfileFile(e,t={}){try{const i=JSON.parse(e);if(!i.name)throw new Error("Invalid profile file: missing profile name");const a=t.profileId||this.generateProfileId(i.name),n=this.sanitizeProfileData(i);return this.storage.saveProfile(a,n),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("profile_imported_successfully",{profileName:n.name})||`Profile "${n.name}" imported successfully`,"success"),{success:!0,profileId:a,profile:n}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_profile",{error:e.message})||`Failed to import profile: ${e.message}`,"error"),{success:!1,error:e.message}}}async importProjectFile(e,t={}){try{const i=JSON.parse(e);if(!i.data||"project"===!i.type)throw new Error("Invalid project file format");const a=i.data;let n=0,s=!1;if(a.profiles)for(const[e,t]of Object.entries(a.profiles)){const i=this.sanitizeProfileData(t);this.storage.saveProfile(e,i),n++}if(a.settings&&!1!==t.importSettings){const e=this.storage.getSettings()||{},t={...e,...a.settings,version:e.version||a.settings.version,firstRun:e.firstRun};this.storage.saveSettings(t),s=!0}return"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("project_imported_successfully",{profileCount:n})||`Project imported: ${n} profiles${s?" and settings":""}`,"success"),{success:!0,imported:{profiles:n,settings:s}}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_project",{error:e.message})||`Failed to import project: ${e.message}`,"error"),{success:!1,error:e.message}}}async importFromFile(e){const t=await e.text(),i=e.name.toLowerCase();if(!i.endsWith(".json")){if(i.endsWith(".txt")){const e=this.getCurrentProfileId();if(!e)throw new Error(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected for import");return this.importKeybindFile(t,e)}throw new Error(this.i18n?.t?.("import_failed_unsupported_format")||"Unsupported file format")}try{const e=JSON.parse(t);if("project"===e.type)return this.importProjectFile(t);if(e.name)return this.importProfileFile(t);throw new Error("Unknown JSON file format")}catch(e){throw new Error(this.i18n?.t?.("import_failed_invalid_json")||"Invalid JSON file format")}}async validateKeybindFile(e){try{const t=await this.parseKeybindFile(e);return{valid:!0,stats:{keybinds:Object.keys(t.keybinds).length,aliases:Object.keys(t.aliases).length,errors:t.errors.length},errors:t.errors}}catch(e){return{valid:!1,error:e.message}}}async validateProfileFile(e){try{const t=JSON.parse(e);return t.name?{valid:!0,profile:{name:t.name,mode:t.mode||t.currentEnvironment||"space",hasKeybinds:!!(t.builds||t.keys||t.keybinds),hasAliases:!!(t.aliases&&Object.keys(t.aliases).length>0)}}:{valid:!1,error:"Missing profile name"}}catch(e){return{valid:!1,error:"Invalid JSON format"}}}sanitizeProfileData(e){const t={name:e.name,currentEnvironment:e.currentEnvironment||e.mode||"space",builds:{space:{keys:{},aliases:{}},ground:{keys:{},aliases:{}}},aliases:{},keybindMetadata:{}};if(e.builds)e.builds.space&&(t.builds.space={keys:e.builds.space.keys||{},aliases:e.builds.space.aliases||{}}),e.builds.ground&&(t.builds.ground={keys:e.builds.ground.keys||{},aliases:e.builds.ground.aliases||{}});else if(e.keys||e.keybinds){const i=e.keys||e.keybinds||{};t.builds.space.keys=i}return e.aliases&&(t.aliases=e.aliases),e.keybindMetadata&&(t.keybindMetadata=e.keybindMetadata),t}generateProfileId(e){return`${e.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${Date.now()}`}getCurrentProfileId(){if("undefined"!=typeof globalThis&&globalThis.app?.getCurrentProfileId)return globalThis.app.getCurrentProfileId();const e=this.storage?.getSettings?.();return e?.currentProfile}extractOriginalFromMirrored(e){const t=e.split(/\s*\$\$\s*/);if(t.length<3||t.length%2==0)return t;const i=Math.floor(t.length/2);return t.slice(0,i+1)}showToast(e,t="info"){this.ui?.showToast?this.ui.showToast(e,t):"undefined"!=typeof window&&window.stoUI?.showToast&&window.stoUI.showToast(e,t)}onInit(){this.setupRequestHandlers(),this.emit("import-service-ready")}}const xe=globalThis.STO_DATA||{};class Ce extends re{constructor({eventBus:e,storage:t}={}){super(e),this.componentName="ExportService",this.storage=t,this.fileHandler=new ke}onInit(){this.setupRequestHandlers()}setupRequestHandlers(){this.respond("export:generate-keybind-file",async({profile:e,options:t={}})=>await this.generateSTOKeybindFile(e,t)),this.respond("export:generate-alias-file",async({profile:e})=>await this.generateAliasFile(e)),this.respond("export:generate-filename",async({profile:e,extension:t,environment:i})=>await this.generateFileName(e,t,i)),this.respond("export:generate-alias-filename",({profile:e,extension:t})=>this.generateAliasFileName(e,t)),this.respond("export:generate-csv-data",({profile:e})=>this.generateCSVData(e)),this.respond("export:generate-html-report",({profile:e})=>this.generateHTMLReport(e)),this.respond("export:import-from-file",async({file:e})=>await this.importFromFile(e)),this.respond("export:sanitize-profile",({profile:e})=>this.sanitizeProfileForExport(e)),this.respond("export:extract-keys",({profile:e,environment:t})=>this.extractKeys(e,t))}async generateSTOKeybindFile(e,t={}){const{environment:i="space",syncMode:a=!1}=t,n=this.extractKeys(e,i),s=n&&Object.keys(n).length>0,o=e.aliases&&Object.keys(e.aliases).length>0;if(!s&&!o)return"; No keybinds or aliases defined for this environment\n";const r=a?`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_${i}.txt`:null;let c=await this.generateFileHeader(e,r);return e.aliases&&Object.keys(e.aliases).length>0&&(c+=this.generateAliasSection(e.aliases)),c+=await this.generateKeybindSection(n,{environment:i,profile:e,syncMode:a}),c+=this.generateFileFooter(),c}async generateFileHeader(e,t=null){const i=(new Date).toLocaleString(),a=e.currentEnvironment||"space",n=Object.keys(this.extractKeys(e,a)).length,s=Object.keys(e.aliases||{}).length;let o=`; ================================================================\n; ${e.name} - STO Keybind Configuration\n; ================================================================\n; Environment: ${a.toUpperCase()}\n; Generated: ${i}\n; Created by: STO Tools Keybind Manager v${xe?.settings?.version??"unknown"}\n;\n; Keybind Statistics:\n; - Total keybinds: ${n}\n; - Total aliases: ${s}\n;\n; To use this keybind file in Star Trek Online:\n; 1. Save this file in your STO Live folder as a .txt file\n; 2. In-game, type: /bind_load_file <filename>\n; 3. Your keybinds will be applied immediately\n;\n; File Structure:\n; - Aliases (if any) are defined first\n; - Keybinds follow, organized by key\n; ================================================================\n\n`;return t&&(o+=`; This file is part of a synchronized profile set\n; Load file: ${t}\n; ================================================================\n\n`),o}generateAliasSection(e){if(!e||0===Object.keys(e).length)return"";let t="; Command Aliases\n; ================================================================\n; Aliases allow you to create custom commands that execute\n; multiple commands in sequence. Use them in keybinds like any\n; other command.\n; ================================================================\n\n";return Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,i])=>{t+=he(e,i),t+="\n"}),t}async generateKeybindSection(e,t={}){const{environment:i="space",syncMode:a=!1,profile:n}=t;if(!e||0===Object.keys(e).length)return"; No keybinds defined\n";let s="; ==============================================================================\n";if(s+=`; ${i.toUpperCase()} KEYBINDS\n`,s+="; ==============================================================================\n\n",a&&n){const e=n.name.replace(/[^a-zA-Z0-9_-]/g,"_");s+=`bind_load_file ${e}_${i}.txt\n\n`}return Object.entries(e).forEach(([e,t])=>{s+=function(e,t=[]){if(!t||0===t.length)return"";const i=t.filter(e=>e&&"string"==typeof e.command&&e.command.trim().length).map(e=>e.command.trim());return 0===i.length?"":`${e} "${i.join(" $$ ")}"\n`}(e,t)}),s+="\n",s}generateFileFooter(){return"; ================================================================\n; End of keybind file\n; ================================================================\n; \n; To use this keybind file:\n; 1. Copy this file to your Star Trek Online Live folder\n; 2. In-game, type: /bind_load_file <filename>\n; 3. Or place it in your STO directory and restart the game\n;\n; For more information visit: https://stowiki.net/wiki/Key_binds\n; ================================================================\n"}generateCSVData(e){const t=[],i=e.currentEnvironment||"space",a=this.extractKeys(e,i);Object.entries(a).forEach(([e,i])=>{i.forEach((i,a)=>{t.push({key:e,order:a+1,command:i.command,type:i.type||"",description:i.text||""})})}),e.aliases&&Object.values(e.aliases).forEach(e=>{t.push({key:"ALIAS",order:"",command:e.name,type:"alias",description:e.description||""})});const n=[["Key","Command","Type","Description","Position"].join(",")];return t.forEach(e=>{n.push([this.escapeCSV(e.key),this.escapeCSV(e.command),this.escapeCSV(e.type),this.escapeCSV(e.description),this.escapeCSV(e.order)].join(","))}),n.join("\n")}escapeCSV(e){if(null==e)return"";const t=e.toString();return/[",\n]/.test(t)?'"'+t.replace(/"/g,'""')+'"':t}generateHTMLReport(e){const t=e.currentEnvironment||"space",i=this.extractKeys(e,t),a=`${e.name} – ${Y.t("html_report_title")}`;return`<!DOCTYPE html>\n<html lang="${Y.language}">\n<head>\n  <meta charset="utf-8" />\n  <title>${a}</title>\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <style>\n    body { font-family: Arial, sans-serif; margin: 20px; }\n    h1 { font-size: 24px; margin-bottom: 10px; }\n    h2 { font-size: 20px; margin-top: 20px; }\n    table { border-collapse: collapse; width: 100%; margin-top: 10px; }\n    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }\n    th { background-color: #f2f2f2; }\n    code { background-color: #eee; padding: 2px 4px; }\n    .keybind { margin-bottom: 10px; }\n    .command { background-color:#e0e0e0; padding:2px 4px; margin:1px; display:inline-block; }\n  </style>\n</head>\n<body>\n  <h1>${a}</h1>\n\n  <h2>${Y.t("keybinds")}</h2>\n  ${this.generateHTMLKeybindSection(i)}\n\n  <h2>${Y.t("aliases")}</h2>\n  ${this.generateHTMLAliasSection(e.aliases)}\n</body>\n</html>`}generateHTMLKeybindSection(e){if(!e||0===Object.keys(e).length)return"<p>No keybinds defined</p>";let t="<table><thead><tr><th>Key</th><th>Commands</th></tr></thead><tbody>";return Object.entries(e).forEach(([e,i])=>{const a=i.filter(e=>e&&e.command).map(e=>`<span class="command">${e.command}</span>`).join(" ");t+=`<tr><td><code>${e}</code></td><td>${a}</td></tr>`}),t+="</tbody></table>",t}generateHTMLAliasSection(e){if(!e||0===Object.keys(e).length)return"<p>No aliases defined</p>";let t="<table><thead><tr><th>Alias</th><th>Commands</th><th>Description</th></tr></thead><tbody>";return Object.values(e).forEach(e=>{t+=`<tr>\n        <td><code>${e.name}</code></td>\n        <td><code>${e.commands}</code></td>\n        <td>${e.description||""}</td>\n      </tr>`}),t+="</tbody></table>",t}async importFromFile(e){return await this.request("import:from-file",{file:e})}importJSONFile(e){try{const t=JSON.parse(e);if("project"===t.type)return this.request("import:project-file",{content:e});if(t.name)return this.request("import:profile-file",{content:e});throw new Error(Y.t("import_failed_invalid_format"))}catch(e){throw new Error(Y.t("import_failed_invalid_json"))}}async generateAliasFile(e){const t=e.aliases||{};if(0===Object.keys(t).length)return"; No aliases defined\n";let i=await this.generateAliasFileHeader(e);return Object.entries(t).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,t])=>{i+=he(e,t),i+="\n"}),i}async generateAliasFileHeader(e){const t=(new Date).toLocaleString(),i=Object.keys(e.aliases||{}).length,a=e.currentEnvironment||"space";return`; ================================================================\n; ${e.name} - STO Alias Configuration\n; ================================================================\n; Mode: ${a.toUpperCase()}\n; Generated: ${t}\n; Created by: STO Tools Keybind Manager v${xe?.settings?.version??"unknown"}\n;\n; Alias Statistics:\n; - Total aliases: ${i}\n;\n; To use these aliases in Star Trek Online:\n; 1. Save this file as "CommandAliases.txt" (exactly, without quotes)\n; 2. Place it in your STO directory:\n;    [STO Install]\\Star Trek Online\\Live\\localdata\\CommandAliases.txt\n; 3. The aliases will be available when you start the game\n;\n; Alternative: You can append these aliases to an existing CommandAliases.txt\n; file if you already have one with other aliases.\n;\n; Common STO installation paths:\n; - Steam: C:\\Program Files (x86)\\Steam\\steamapps\\common\\Star Trek Online\n; - Epic: C:\\Program Files\\Epic Games\\Star Trek Online  \n; - Arc: C:\\Program Files (x86)\\Perfect World Entertainment\\Arc Games\\Star Trek Online\n; ================================================================\n\n`}async syncToFolder(e){const t=this.storage.getAllData(),i=t.profiles||{};try{for(const[t,a]of Object.entries(i)){if(!a||!a.name)continue;const t=a.name.replace(/[^a-zA-Z0-9_-]/g,"_"),i=`${t}`;for(const n of["space","ground"])if(a.builds?.[n]?.keys&&Object.keys(a.builds[n].keys).length>0){const s=await this.generateSTOKeybindFile(a,{environment:n,profile:a,syncMode:!0}),o=`${i}/${t}_${n}.txt`;await ge(e,o,s)}if(a.aliases&&Object.keys(a.aliases).length>0){const n=await this.generateAliasFile(a),s=`${i}/${t}_aliases.txt`;await ge(e,s,n)}}const a={version:xe?.settings?.version||"1.0.0",exported:(new Date).toISOString(),type:"project",data:{profiles:i,settings:t.settings||{},currentProfile:t.currentProfile}};await ge(e,"project.json",JSON.stringify(a,null,2)),this.emit("toast:show",{message:Y.t("sync_completed"),type:"success"})}catch(e){throw this.emit("toast:show",{message:Y.t("sync_failed",{error:e.message}),type:"error"}),e}}generateFileName(e,t,i=e.currentEnvironment||"space"){return`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_${i}_${(new Date).toISOString().split("T")[0]}.${t}`}generateAliasFileName(e,t){return`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_aliases.${t}`}sanitizeProfileForExport(e){const t=JSON.parse(JSON.stringify(e)),i=(e=[])=>e.map(e=>{if(!e||"object"!=typeof e)return e;const{id:t,...i}=e;return i});return t.keybinds&&Object.keys(t.keybinds).forEach(e=>{t.keybinds[e]&&Object.keys(t.keybinds[e]).forEach(a=>{t.keybinds[e][a]=i(t.keybinds[e][a])})}),t.builds&&Object.keys(t.builds).forEach(e=>{t.builds[e]&&t.builds[e].keys&&Object.keys(t.builds[e].keys).forEach(a=>{t.builds[e].keys[a]=i(t.builds[e].keys[a])})}),t}extractKeys(e={},t="space"){return e.keys&&!e.builds?e.keys:e.builds&&e.builds[t]&&e.builds[t].keys?e.builds[t].keys:e.keybinds&&e.keybinds[t]?e.keybinds[t]:{}}}class Te extends re{constructor(e){super(e),this.componentName="UIUtilityService",this.dragState={isDragging:!1,dragElement:null,dragData:null},this.setupEventListeners(),this.setupTooltips()}onDestroy(){this.requestDetachers&&(this.requestDetachers.forEach(e=>e()),this.requestDetachers=[]),super.onDestroy()}setupEventListeners(){this.eventBus.on("ui:copy-to-clipboard",this.handleCopyToClipboard.bind(this)),this.eventBus.on("ui:validate-form",this.handleValidateForm.bind(this)),this.eventBus.on("ui:validate-email",this.handleValidateEmail.bind(this)),this.eventBus.on("ui:init-drag-drop",this.handleInitDragDrop.bind(this)),this.eventBus.on("ui:fade-in",this.handleFadeIn.bind(this)),this.eventBus.on("ui:fade-out",this.handleFadeOut.bind(this)),this.eventBus.on("ui:show-tooltip",this.handleShowTooltip.bind(this)),this.eventBus.on("ui:hide-tooltip",this.handleHideTooltip.bind(this)),this.setupRequestHandlers()}setupRequestHandlers(){this.requestDetachers=[],this.requestDetachers.push(this.respond("ui:copy-to-clipboard",this.copyToClipboard.bind(this))),this.requestDetachers.push(this.respond("ui:validate-form",this.validateForm.bind(this))),this.requestDetachers.push(this.respond("ui:validate-email",this.isValidEmail.bind(this))),this.requestDetachers.push(this.respond("ui:debounce",this.debounce.bind(this))),this.requestDetachers.push(this.respond("ui:throttle",this.throttle.bind(this)))}async handleCopyToClipboard({text:e}){const t=await this.copyToClipboard(e);this.emit("ui:clipboard-result",{success:t,text:e})}async handleValidateForm({formElement:e,formId:t}){const i=e||document.getElementById(t),a=this.validateForm(i);this.emit("ui:form-validated",{result:a,formId:t})}async handleValidateEmail({email:e}){const t=this.isValidEmail(e);this.emit("ui:email-validated",{email:e,isValid:t})}async handleInitDragDrop({container:e,containerId:t,options:i={}}){const a=e||document.getElementById(t);this.initDragAndDrop(a,i),this.emit("ui:drag-drop-initialized",{containerId:t,options:i})}async handleFadeIn({element:e,elementId:t,duration:i=300}){const a=e||document.getElementById(t);this.fadeIn(a,i),this.emit("ui:fade-in-complete",{elementId:t,duration:i})}async handleFadeOut({element:e,elementId:t,duration:i=300}){const a=e||document.getElementById(t);this.fadeOut(a,i),this.emit("ui:fade-out-complete",{elementId:t,duration:i})}async handleShowTooltip({element:e,elementId:t,text:i}){const a=e||document.getElementById(t);this.showTooltip(a,i),this.emit("ui:tooltip-shown",{elementId:t,text:i})}async handleHideTooltip(){this.hideTooltip(),this.emit("ui:tooltip-hidden")}async copyToClipboard(e){try{return await navigator.clipboard.writeText(e),this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("content_copied_to_clipboard"):"Content copied to clipboard",type:"success"}),!0}catch(t){const i=document.createElement("textarea");i.value=e,document.body.appendChild(i),i.select();try{return document.execCommand("copy"),this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("content_copied_to_clipboard"):"Content copied to clipboard",type:"success"}),!0}catch(e){return this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("failed_to_copy_to_clipboard"):"Failed to copy to clipboard",type:"error"}),!1}finally{document.body.removeChild(i)}}}validateForm(e){if(!e)return{isValid:!1,errors:["Form element not found"]};const t=[];return e.querySelectorAll("input[required], textarea[required], select[required]").forEach(e=>{e.value.trim()||t.push(`${e.name||e.id||"Field"} is required`),"email"===e.type&&e.value&&!this.isValidEmail(e.value)&&t.push(`${e.name||e.id||"Email"} is not valid`)}),{isValid:0===t.length,errors:t}}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}initDragAndDrop(e,t={}){if(!e)return;const{draggableSelector:i=".draggable",onDragStart:a=null,onDragEnd:n=null,onDrop:s=null}=t;e.addEventListener("dragstart",e=>{e.target.matches(i)&&(this.dragState.isDragging=!0,this.dragState.dragElement=e.target,this.dragState.dragData=e.target.dataset,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.outerHTML),a&&a(e,this.dragState))}),e.addEventListener("dragend",e=>{e.target.matches(i)&&(this.dragState.isDragging=!1,this.dragState.dragElement=null,this.dragState.dragData=null,n&&n(e,this.dragState))}),e.addEventListener("dragover",e=>{e.preventDefault()}),e.addEventListener("drop",e=>{e.preventDefault(),s&&s(e,this.dragState)})}fadeIn(e,t=300){if(!e)return;e.style.opacity="0",e.style.display="block";let i=null;const a=n=>{i||(i=n);const s=n-i,o=Math.min(s/t,1);e.style.opacity=o,s<t&&requestAnimationFrame(a)};requestAnimationFrame(a)}fadeOut(e,t=300){if(!e)return;let i=null;const a=n=>{i||(i=n);const s=n-i,o=Math.max(1-s/t,0);e.style.opacity=o,s<t?requestAnimationFrame(a):e.style.display="none"};requestAnimationFrame(a)}debounce(e,t){let i;return function(...a){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),e(...a)},t)}}throttle(e,t){let i;return function(){const a=arguments;i||(e.apply(this,a),i=!0,setTimeout(()=>i=!1,t))}}setupTooltips(){document.addEventListener("mouseenter",e=>{e.target&&"function"==typeof e.target.hasAttribute&&e.target.hasAttribute("title")&&e.target.getAttribute("title").trim()&&this.showTooltip(e.target,e.target.getAttribute("title"))},!0),document.addEventListener("mouseleave",e=>{e.target&&"function"==typeof e.target.hasAttribute&&e.target.hasAttribute("title")&&this.hideTooltip()},!0)}showTooltip(e,t){if(!e||!t)return;this.hideTooltip();const i=document.createElement("div");i.className="tooltip",i.textContent=t,i.id="active-tooltip",document.body.appendChild(i);const a=e.getBoundingClientRect(),n=i.getBoundingClientRect();let s=a.left+a.width/2-n.width/2,o=a.top-n.height-8;s<8&&(s=8),s+n.width>window.innerWidth-8&&(s=window.innerWidth-n.width-8),o<8&&(o=a.bottom+8,i.classList.add("tooltip-bottom")),i.style.left=s+"px",i.style.top=o+"px",requestAnimationFrame(()=>{i.classList.add("show")})}hideTooltip(){const e=document.getElementById("active-tooltip");e&&e.remove()}}class Ae extends re{constructor({eventBus:e=null,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="KeyCaptureService",this.document=t,this.isCapturing=!1,this.pressedCodes=new Set,this.currentContext="keySelectionModal",this.hasCapturedValidKey=!1,this.boundHandleKeyDown=this.handleKeyDown.bind(this),this.boundHandleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("keycapture:start",({context:e}={})=>this.startCapture(e)),this.addEventListener("keycapture:stop",()=>this.stopCapture())}startCapture(e="keySelectionModal"){this.isCapturing||(this.resetState(),this.currentContext=e,this.isCapturing=!0,this.document.addEventListener("keydown",this.boundHandleKeyDown),this.document.addEventListener("keyup",this.boundHandleKeyUp),this.emit("capture-start",{context:e}))}stopCapture(){this.isCapturing&&(this.isCapturing=!1,this.document.removeEventListener("keydown",this.boundHandleKeyDown),this.document.removeEventListener("keyup",this.boundHandleKeyUp),this.pressedCodes.clear(),this.hasCapturedValidKey=!1,this.emit("capture-stop",{context:this.currentContext}),this.currentContext="keySelectionModal")}resetState(){this.pressedCodes.clear(),this.hasCapturedValidKey=!1}handleKeyDown(e){if(!this.isCapturing)return;if(this.isPureModifier(e.code))return this.pressedCodes.add(e.code),void this.emit("update",{chord:this.chordToString(this.pressedCodes),codes:[...this.pressedCodes],context:this.currentContext});this.pressedCodes.add(e.code);const t=this.chordToString(this.pressedCodes);this.emit("chord-captured",{chord:t,context:this.currentContext}),this.hasCapturedValidKey=!0,e.preventDefault()}handleKeyUp(e){this.isCapturing&&(this.hasCapturedValidKey||(this.pressedCodes.delete(e.code),this.emit("update",{chord:this.chordToString(this.pressedCodes),codes:[...this.pressedCodes],context:this.currentContext})))}isPureModifier(e){return["ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","MetaLeft","MetaRight"].includes(e)}chordToString(e){return[...e].sort().map(e=>{if(e.startsWith("Control"))return"Ctrl";if(e.startsWith("Alt"))return"Alt";if(e.startsWith("Shift"))return"Shift";if(e.startsWith("Meta"))return"Meta";const t=e.match(/^Digit(\d)$/);if(t)return t[1];const i=e.match(/^Key([A-Z])$/);if(i)return i[1];if(e.startsWith("F")&&/^F\d+$/.test(e))return e;const a={Space:"Space",Enter:"Enter",Tab:"Tab",Escape:"Escape",Backspace:"Backspace",Delete:"Delete",Home:"Home",End:"End",PageUp:"PageUp",PageDown:"PageDown",ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:"'",Comma:",",Period:".",Slash:"/",Backslash:"\\",Minus:"-",Equal:"=",Backquote:"`",IntlBackslash:"\\"};return a[e]?a[e]:e.replace(/^Key/,"")}).join("+")}}class Ee extends re{constructor(e){super(e),this.componentName="ModalManagerService",this.overlayId="modalOverlay",this.regenerateCallbacks={},this.isInitialized=!1,this.registerAllModalCallbacks(),this.setupEventListeners(),"undefined"!=typeof window&&(window.modalManager=this),"undefined"!=typeof window&&window.i18next&&window.i18next.on("languageChanged",()=>{const e=document.querySelector(".modal.active");if(!e)return;const t=e.id;this.regenerateCallbacks[t]?(this.regenerateCallbacks[t](),this.emit("modal:regenerated",{modalId:t})):"function"==typeof window.applyTranslations&&window.applyTranslations(e)})}async init(){this.isInitialized?console.log(`[${this.componentName}] Already initialized`):(this.isInitialized=!0,console.log(`[${this.componentName}] Initialized`))}setupEventListeners(){this.eventBus.on("modal:show",this.handleShowModal.bind(this)),this.eventBus.on("modal:hide",this.handleHideModal.bind(this)),this.eventBus.on("modal:toggle",this.handleToggleModal.bind(this)),this.eventBus.on("modal:register-callback",this.handleRegisterCallback.bind(this)),this.eventBus.on("modal:unregister-callback",this.handleUnregisterCallback.bind(this)),this.setupGlobalModalEventListeners()}setupGlobalModalEventListeners(){document.addEventListener("click",e=>{const t=e.target.closest("[data-modal]");if(t){const i=t.getAttribute("data-modal");i&&(this.hide(i),e.preventDefault(),e.stopPropagation())}}),document.addEventListener("keydown",e=>{if("Escape"===e.key){const e=document.querySelector(".modal.active");e&&this.hide(e.id)}}),document.addEventListener("click",e=>{if(e.target.id===this.overlayId||e.target.classList.contains("modal-overlay")){const e=document.querySelector(".modal.active");e&&this.hide(e.id)}})}async handleShowModal({modalId:e}){const t=this.show(e);return this.emit("modal:shown",{modalId:e,success:t}),t}async handleHideModal({modalId:e}){const t=this.hide(e);return this.emit("modal:hidden",{modalId:e,success:t}),t}async handleToggleModal({modalId:e}){const t="string"==typeof e?document.getElementById(e):e;if(!t)return!1;const i=t.classList.contains("active"),a=i?this.hide(e):this.show(e);return this.emit("modal:toggled",{modalId:e,isActive:!i,success:a}),a}async handleRegisterCallback({modalId:e,callback:t}){this.registerRegenerateCallback(e,t),console.log(`[${this.componentName}] Registered callback for modal: ${e}`)}async handleUnregisterCallback({modalId:e}){this.unregisterRegenerateCallback(e),console.log(`[${this.componentName}] Unregistered callback for modal: ${e}`)}getOverlay(){return document.getElementById(this.overlayId)}show(e){const t="string"==typeof e?document.getElementById(e):e,i=this.getOverlay();if(!i||!t)return!1;i.classList.add("active"),t.classList.add("active"),document.body.classList.add("modal-open"),"function"==typeof window.applyTranslations&&window.applyTranslations(t);const a=t.querySelector("input, textarea, select");return a&&setTimeout(()=>a.focus(),100),!0}hide(e){const t="string"==typeof e?document.getElementById(e):e,i=this.getOverlay();return!(!i||!t||(t.classList.remove("active"),document.querySelector(".modal.active")||(i.classList.remove("active"),document.body.classList.remove("modal-open")),0))}registerRegenerateCallback(e,t){this.regenerateCallbacks[e]=t}unregisterRegenerateCallback(e){delete this.regenerateCallbacks[e]}registerAllModalCallbacks(){this.registerRegenerateCallback("addCommandModal",()=>{window.stoCommands?.regenerateModalContent&&window.stoCommands.regenerateModalContent()}),this.registerRegenerateCallback("parameterModal",()=>{if(window.app?.populateParameterModal){const e=document.getElementById("parameterModal"),t=e?.getAttribute("data-command-def");if(t)try{window.app.populateParameterModal(JSON.parse(t))}catch(e){}}}),this.registerRegenerateCallback("keySelectionModal",()=>{const e=document.getElementById("keySelectionModal"),t=e?.querySelector(".tab-content .tab-pane.active");if(t){const e=t.id.replace("Tab","");window.app?.populateKeyTab?.(e)}}),this.registerRegenerateCallback("vertigoModal",()=>{this.eventBus?this.emit("vfx:modal-regenerate-requested"):window.app?.populateVertigoModal?.()}),this.registerRegenerateCallback("profileModal",()=>{const e=document.getElementById("profileModal");window.applyTranslations?.(e)}),this.registerRegenerateCallback("preferencesModal",()=>{window.app?.preferencesManager?.populatePreferencesModal?.()}),this.registerRegenerateCallback("fileExplorerModal",()=>{window.stoFileExplorer?.refreshFileList?.()}),this.registerRegenerateCallback("exportModal",()=>{window.stoExport?.populateExportModal?.()}),this.registerRegenerateCallback("aboutModal",()=>{const e=document.getElementById("aboutModal");window.applyTranslations?.(e)}),this.registerRegenerateCallback("addKeyModal",()=>{window.app?.setupKeyCaptureModal?.()})}}class Ie extends re{constructor(e){super(e),this.componentName="VFXManagerService",this.selectedEffects={space:new Set,ground:new Set},this.showPlayerSay=!1,this.currentProfile=null,this.initialState=null,this.isInitialized=!1}async init(){this.isInitialized?console.log(`[${this.componentName}] Already initialized`):(super.init(),this.setupEventListeners(),this.isInitialized=!0,console.log(`[${this.componentName}] Initialized`))}handleInitialState(e,t){t&&"DataCoordinator"===e&&(t.currentProfile&&(this.currentProfile=t.currentProfile,console.log(`[${this.componentName}] Received current profile from DataCoordinator: ${this.currentProfile}`)),t.currentProfileData&&(this.loadState(t.currentProfileData),console.log(`[${this.componentName}] Loaded VFX state from current profile`)))}setupEventListeners(){this.eventBus.on("vfx:show-modal",this.showModal.bind(this)),this.eventBus.on("vfx:save-effects",this.saveEffects.bind(this)),this.eventBus.on("vfx:cancel-effects",this.cancelEffects.bind(this)),this.addEventListener("profile:switched",({profileId:e,profile:t})=>{this.currentProfile=e,t&&(this.loadState(t),console.log(`[${this.componentName}] Loaded VFX state for switched profile: ${e}`))}),this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.currentProfile&&t&&(this.loadState(t),console.log(`[${this.componentName}] Refreshed VFX state for updated profile: ${e}`))})}generateAlias(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);const t=Array.from(this.selectedEffects[e]);if(0===t.length)return"";const i=`dynFxSetFXExlusionList_${e.charAt(0).toUpperCase()+e.slice(1)}`;let a=`dynFxSetFXExlusionList ${t.join(",")}`;return this.showPlayerSay&&(a+=" $$ PlayerSay VFX Suppression Loaded"),he(i,{commands:a}).trim()}generateAliasCommand(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);const t=Array.from(this.selectedEffects[e]);if(0===t.length)return"";let i=`dynFxSetFXExlusionList ${t.join(",")}`;return this.showPlayerSay&&(i+=" $$ PlayerSay VFX Suppression Loaded"),i}getSelectedEffects(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return Array.from(this.selectedEffects[e])}toggleEffect(e,t){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);if(!t)throw new Error(`Invalid effect: ${t} for environment: ${e}`);this.selectedEffects[e].has(t)?this.selectedEffects[e].delete(t):this.selectedEffects[e].add(t)}clearAllEffects(){this.selectedEffects.space.clear(),this.selectedEffects.ground.clear()}selectAllEffects(e){if(!VFX_EFFECTS[e])throw new Error(`Invalid environment: ${e}`);if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);VFX_EFFECTS[e].forEach(t=>{this.selectedEffects[e].add(t.effect)})}getEffectCount(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return this.selectedEffects[e].size}isEffectSelected(e,t){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return this.selectedEffects[e].has(t)}saveState(e){e.vertigoSettings||(e.vertigoSettings={}),e.vertigoSettings={selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay}}loadState(e){if(e&&e.vertigoSettings){const t=e.vertigoSettings;this.selectedEffects.space=new Set(t.selectedEffects?.space||[]),this.selectedEffects.ground=new Set(t.selectedEffects?.ground||[]),this.showPlayerSay=t.showPlayerSay||!1}else this.selectedEffects.space.clear(),this.selectedEffects.ground.clear(),this.showPlayerSay=!1}async showModal(){if(console.log(`[${this.componentName}] Showing VFX modal`),this.currentProfile)try{const e=(await this.request("data:get-all-profiles"))[this.currentProfile];e&&(this.loadState(e),console.log(`[${this.componentName}] Loaded VFX state from profile via DataCoordinator`))}catch(e){console.error(`[${this.componentName}] Failed to load profile state:`,e)}this.initialState={selectedEffects:{space:new Set(this.selectedEffects.space),ground:new Set(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay},this.emit("vfx:modal-populate",{vfxManager:this})}async saveEffects(){if(console.log(`[${this.componentName}] Saving VFX effects`),this.selectedEffects&&this.selectedEffects.space&&this.selectedEffects.ground)if(console.log(`[${this.componentName}] Current selected effects:`,this.selectedEffects),console.log(`[${this.componentName}] Show player say:`,this.showPlayerSay),console.log(`[${this.componentName}] Current profile:`,this.currentProfile),this.isInitialized){if(this.currentProfile)try{const e=(await this.request("data:get-all-profiles"))[this.currentProfile];if(e){console.log(`[${this.componentName}] Retrieved profile via DataCoordinator`);const t={};e.vertigoSettings||(e.vertigoSettings={}),e.vertigoSettings={selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay},t.vertigoSettings=e.vertigoSettings,console.log(`[${this.componentName}] Generating VFX aliases`);const i={...e.aliases||{}};i&&"object"==typeof i?Object.keys(i).forEach(e=>{e.startsWith("dynFxSetFXExlusionList_")&&delete i[e]}):console.error(`[${this.componentName}] ERROR: aliases is not a valid object:`,i),["space","ground"].forEach(e=>{console.log(`[${this.componentName}] Processing environment: ${e}`),console.log(`[${this.componentName}] Selected effects for ${e}:`,Array.from(this.selectedEffects[e]));const t=this.generateAliasCommand(e);if(console.log(`[${this.componentName}] Generated command for ${e}: ${t}`),t){const a=`dynFxSetFXExlusionList_${e.charAt(0).toUpperCase()+e.slice(1)}`;i[a]={command:t,description:`VFX suppression for ${e} environment`,type:"vfx-alias"},console.log(`[${this.componentName}] Generated VFX alias: ${a} = ${t}`)}else console.log(`[${this.componentName}] No command generated for ${e} (no effects selected)`)}),t.aliases=i,await this.request("data:update-profile",{profileId:this.currentProfile,modify:t}),console.log(`[${this.componentName}] VFX effects and aliases saved to profile: ${this.currentProfile}`),this.emit("aliases-changed",{aliases:i})}else console.error(`[${this.componentName}] ERROR: Could not retrieve profile: ${this.currentProfile}`)}catch(e){console.error(`[${this.componentName}] ERROR: Failed to save VFX effects:`,e)}else console.error(`[${this.componentName}] ERROR: No current profile set`);this.emit("modal:hide",{modalId:"vertigoModal"})}else console.error(`[${this.componentName}] ERROR: Service not initialized`);else console.error(`[${this.componentName}] ERROR: selectedEffects not properly initialized:`,this.selectedEffects)}cancelEffects(){console.log(`[${this.componentName}] Cancelling VFX effects`),this.initialState&&(this.selectedEffects.space=new Set(this.initialState.selectedEffects.space),this.selectedEffects.ground=new Set(this.initialState.selectedEffects.ground),this.showPlayerSay=this.initialState.showPlayerSay),this.emit("modal:hide",{modalId:"vertigoModal"})}getCurrentState(){return{currentProfile:this.currentProfile,selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay}}}class $e extends re{constructor({eventBus:e,storage:t,ui:i,fileSystem:a,document:n=window.document}={}){super(e),this.componentName="FileExplorerUI",this.storage=t||window.storageService||null,this.ui=i||window.stoUI||null,this.fileSystem=a||ye.$(),this.document=n,this.modalId="fileExplorerModal",this.treeId="fileTree",this.contentId="fileContent",this.selectedNode=null,this.currentDirectory=null}onInit(){this.setupEventListeners()}setupEventListeners(){this.eventBus.on("file-explorer:open",()=>{this.openExplorer()}),this.eventBus.onDom("fileExplorerBtn","click","fileExplorer-open",()=>{this.openExplorer()}),this.eventBus.onDom(this.treeId,"click","fileExplorer-tree-click",e=>{const t=e.target.closest(".tree-node");t&&this.selectNode(t)}),this.eventBus.onDom("copyFileContentBtn","click","fileExplorer-copy-content",()=>{const e=this.document.getElementById(this.contentId);if(!e)return;const t=e.textContent||"";t.trim()?(this.ui?.copyToClipboard(t),this.ui?.showToast(i18next.t("content_copied_to_clipboard"),"success")):this.ui?.showToast(i18next.t("nothing_to_copy"),"warning")}),this.eventBus.onDom("downloadFileBtn","click","fileExplorer-download",async()=>{if(!this.selectedNode)return;const{type:e,profileId:t,environment:i}=this.selectedNode,a=this.document.getElementById(this.contentId);if(!a)return;const n=a.textContent||"";if(!n.trim())return;let s=i18next.t("default_export_filename");if(this.storage){const a=this.storage.getProfile(t);try{"build"===e?s=await this.request("export:generate-filename",{profile:a,extension:"txt",environment:i}):"aliases"===e&&(s=await this.request("export:generate-alias-filename",{profile:a,extension:"txt"}))}catch(e){console.error("Failed to generate filename via ExportService:",e)}}this.downloadFile(n,s,"text/plain")}),this.addEventListener("file-explorer:save",e=>this.saveFile(e.path,e.content))}openExplorer(){this.buildTree();const e=this.document.getElementById(this.contentId);e&&(e.textContent=i18next.t("select_an_item_on_the_left_to_preview_export")),this.emit("modal:show",{modalId:this.modalId})}buildTree(){const e=this.document.getElementById(this.treeId);if(!e||!this.storage)return;e.innerHTML="";const t=this.storage.getAllData().profiles||{};Object.entries(t).forEach(([t,i])=>{const a=this.createNode("profile",i.name,{profileId:t}),n=this.document.createElement("div");if(n.className="tree-children",i.builds&&i.builds.space){const e=this.createNode("build",i18next.t("space_build")||"Space Build",{profileId:t,environment:"space"});n.appendChild(e)}if(i.builds&&i.builds.ground){const e=this.createNode("build",i18next.t("ground_build")||"Ground Build",{profileId:t,environment:"ground"});n.appendChild(e)}const s=this.createNode("aliases",i18next.t("aliases")||"Aliases",{profileId:t});n.appendChild(s),a.appendChild(n),e.appendChild(a)})}createNode(e,t,i={}){const a=this.document.createElement("div");return a.className=`tree-node ${e}`,a.textContent=t,a.dataset.type=e,Object.entries(i).forEach(([e,t])=>a.setAttribute(`data-${e}`,t)),a}async selectNode(e){const t=this.document.querySelector(".tree-node.selected");t&&t.classList.remove("selected"),e.classList.add("selected");const i=e.dataset.type||e.getAttribute("data-type"),a=e.getAttribute("data-profileid"),n=e.getAttribute("data-environment");if(this.selectedNode={type:i,profileId:a,environment:n},a&&this.storage)try{let e="";e="build"===i?await this.generateBuildExport(a,n):"aliases"===i?await this.generateAliasExport(a):i18next.t("select_a_space_ground_build_or_aliases_to_preview_export");const t=this.document.getElementById(this.contentId);t&&(t.textContent=e||i18next.t("no_content_available"))}catch(e){console.error("Failed to generate export content:",e),this.ui?.showToast(i18next.t("failed_to_generate_export"),"error")}}async generateBuildExport(e,t){const i=this.storage.getProfile(e);if(!i||!i.builds||!i.builds[t])return"";const a=i.builds[t],n={name:`${i.name} ${t}`,mode:t,keybinds:{[t]:a.keys||{}},keybindMetadata:i.keybindMetadata||{},aliases:a.aliases||{},currentEnvironment:t};return await this.request("export:generate-keybind-file",{profile:n,options:{environment:t}}).catch(e=>(console.error("Failed to generate keybind export via ExportService:",e),`; Failed to generate export: ${e.message}`))}async generateAliasExport(e){const t=this.storage.getProfile(e);if(!t)return"";const i={...t.aliases||{},...t.builds?.space?.aliases||{},...t.builds?.ground?.aliases||{}},a={name:t.name,mode:t.currentEnvironment||"space",aliases:i};return await this.request("export:generate-alias-file",{profile:a}).catch(e=>(console.error("Failed to generate alias export via ExportService:",e),`; Failed to generate export: ${e.message}`))}async ensureDirectoryHandle(){return this.currentDirectory||(this.currentDirectory=await this.fileSystem.getDirectoryHandle(fe)),this.currentDirectory}async openFile(e){console.log("[FileExplorerUI] openFile – not implemented yet:",e)}async saveFile(e,t){try{let i=await this.ensureDirectoryHandle();if(!i)return void console.warn("[FileExplorerUI] No directory handle available for saveFile");await this.fileSystem.writeFile(i,e,t),this.ui?.showToast(i18next.t("file_saved_successfully"),"success")}catch(e){console.error("Failed to save file:",e),this.ui?.showToast(i18next.t("failed_to_save_file"),"error")}}downloadFile(e,t,i){const a=new Blob([e],{type:i}),n=URL.createObjectURL(a),s=this.document.createElement("a");s.href=n,s.download=t,this.document.body.appendChild(s),s.click(),this.document.body.removeChild(s),URL.revokeObjectURL(n)}}const Be=new Proxy({currentProfile:null,currentMode:"space",currentEnvironment:"space",selectedKey:null,isModified:!1,undoStack:[],redoStack:[],maxUndoSteps:50,commandIdCounter:0},{set:(e,t,i)=>(e[t]=i,r&&r.emit&&r.emit(`store:${t}`,i),!0)});class Pe extends re{constructor({eventBus:e,ui:t=null,modalManager:i=null,document:a=null,i18n:n=null}={}){super(e),this.componentName="ProfileUI",this.ui=t,this.modalManager=i,this.document=a||("undefined"!=typeof window?window.document:null),this.i18n=n,this.C=null,this.P="space",this.F=!1,this.j=null,this.currentModal=null,this.eventListenersSetup=!1,this.M=this.M.bind(this)}M(e,t){return this.i18n?.t?.(e,t)||e}onInit(){this.setupEventListeners(),this.renderProfiles(),this.updateProfileInfo()}setupEventListeners(){if(this.eventListenersSetup)return;this.eventListenersSetup=!0;const e=this.document.getElementById("profileSelect");e&&e.addEventListener("change",e=>{this.handleProfileSwitch(e.target.value)}),this.eventBus.onDom("newProfileBtn","click","profile-new",()=>{this.showNewProfileModal()}),this.eventBus.onDom("cloneProfileBtn","click","profile-clone",()=>{this.showCloneProfileModal()}),this.eventBus.onDom("renameProfileBtn","click","profile-rename",()=>{this.showRenameProfileModal()}),this.eventBus.onDom("deleteProfileBtn","click","profile-delete",()=>{this.confirmDeleteProfile()}),this.eventBus.onDom("saveProfileBtn","click","profile-save",()=>{this.handleProfileSave()}),this.addEventListener("profile:switched",({profileId:e,environment:t,profile:i}={})=>{e&&(this.C=e),t&&(this.P=t),i&&(this.j=i),this.F=!1,this.renderProfiles(),this.updateProfileInfo()}),this.addEventListener("environment:changed",({environment:e}={})=>{e&&(this.P=e,this.updateProfileInfo())}),this.addEventListener("profile-modified",()=>{this.F=!0,this.updateProfileInfo()}),this.addEventListener("current-profile:updated",({profile:e})=>{e&&(this.j=e,this.updateProfileInfo())})}async handleProfileSwitch(e){try{const t=await this.request("data:switch-profile",{profileId:e});t?.switched&&(this.N=null,this.renderKeyGrid(),this.updateProfileInfo(),this.ui?.showToast?.(t.message,"success"))}catch(e){this.ui?.showToast?.(e.message,"error")}}async renderProfiles(){const e=this.document.getElementById("profileSelect");if(!e)return;const t=await this.request("data:get-all-profiles");e.innerHTML="";const i=Object.entries(t||{});if(0===i.length){const t=this.document.createElement("option");t.value="",t.textContent=this.M("no_profiles_available")||"No profiles available",t.disabled=!0,e.appendChild(t)}else i.forEach(([t,i])=>{const a=this.document.createElement("option");a.value=t,a.textContent=i.name,t===this.C&&(a.selected=!0),e.appendChild(a)});this.updateProfileInfo()}updateProfileInfo(){this.document.querySelectorAll(".mode-btn").forEach(e=>{e.classList.toggle("active",this.j&&e.dataset.mode===this.P),e.disabled=!this.C});const e=this.document.getElementById("keyCount");if(e)if(this.j){const t=this.j.builds?.[this.P],i=Object.keys(t?.keys||{}).length,a=1===i?this.M("key"):this.M("keys");e.textContent=`${i} ${a}`}else e.textContent=this.M("no_profile");const t=this.document.getElementById("modifiedIndicator");t&&(t.style.display=this.F?"inline":"none")}renderKeyGrid(){"undefined"!=typeof app&&app.renderKeyGrid&&app.renderKeyGrid()}renderCommandChain(){}showNewProfileModal(){this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.M("new_profile")),t&&(t.value="",t.placeholder="Enter profile name"),i&&(i.value=""),this.currentModal="new",this.modalManager.show("profileModal")}showCloneProfileModal(){if(!this.j)return void this.ui?.showToast?.(this.M("no_profile_selected_to_clone"),"warning");this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.M("clone_profile")),t&&(t.value=`${this.j.name} Copy`,t.placeholder="Enter new profile name"),i&&(i.value=`Copy of ${this.j.name}`),this.currentModal="clone",this.modalManager.show("profileModal")}showRenameProfileModal(){if(!this.j)return void this.ui?.showToast?.(this.M("no_profile_selected_to_rename"),"warning");this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.M("rename_profile")),t&&(t.value=this.j.name,t.placeholder="Enter profile name"),i&&(i.value=this.j.description||""),this.currentModal="rename",this.modalManager.show("profileModal")}async handleProfileSave(){const e=this.document.getElementById("profileName"),t=this.document.getElementById("profileDescription");if(!e)return;const i=e.value.trim(),a=t?t.value.trim():"";if(i)try{let e;switch(this.currentModal){case"new":e=await this.request("data:create-profile",{name:i,description:a}),e?.success&&(await this.request("data:switch-profile",{profileId:e.profileId}),await this.renderProfiles(),this.renderKeyGrid(),this.updateProfileInfo(),this.ui?.showToast?.(e.message,"success"));break;case"clone":e=await this.request("data:clone-profile",{sourceId:this.C,newName:i}),e?.success&&(await this.renderProfiles(),this.ui?.showToast?.(e.message,"success"));break;case"rename":e=await this.request("data:rename-profile",{profileId:this.C,newName:i,description:a}),e?.success&&(await this.renderProfiles(),this.updateProfileInfo(),this.ui?.showToast?.(e.message||this.M("profile_renamed"),"success"))}this.modalManager.hide("profileModal"),this.currentModal=null}catch(e){this.ui?.showToast?.(e.message,"error")}else this.ui?.showToast?.(this.M("profile_name_required"),"error")}confirmDeleteProfile(){this.j?confirm(this.M("confirm_delete_profile",{name:this.j.name})||`Are you sure you want to delete the profile "${this.j.name}"? This action cannot be undone.`)&&this.deleteCurrentProfile():this.ui?.showToast?.(this.M("no_profile_selected_to_delete"),"warning")}async deleteCurrentProfile(){try{const e=await this.request("data:delete-profile",{profileId:this.C});e.success&&(e.switchedProfile&&(this.N=null,this.renderKeyGrid(),this.updateProfileInfo()),this.renderProfiles(),this.ui?.showToast?.(e.message,"success"))}catch(e){this.ui?.showToast?.(e.message,"error")}}setSelectedKey(e){this.N=e}getSelectedKey(){return this.N}handleInitialState(e,t){t&&("DataCoordinator"===e||"ProfileService"===e||t.currentProfile)&&(t.currentProfile&&(this.C=t.currentProfile),t.currentEnvironment&&(this.P=t.currentEnvironment),"boolean"==typeof t.modified&&(this.F=t.modified),t.profiles&&t.currentProfile&&t.profiles[t.currentProfile]&&(this.j=t.profiles[t.currentProfile]),this.renderProfiles(),this.updateProfileInfo())}getCurrentState(){return{currentProfile:this.C,currentEnvironment:this.P,modified:this.F}}}class Fe{static newToOld(e){return e?{command:e.command,type:e.category,parameters:e.parameters||{},signature:e.signature,baseCommand:e.baseCommand,displayText:e.displayText,icon:e.icon,id:e.id}:null}static oldToNew(e){return e?{command:e.command,category:e.type,parameters:e.parameters||{},signature:e.signature||"Unknown()",baseCommand:e.baseCommand||"Unknown",displayText:e.displayText||e.command,icon:e.icon||"⚙️",id:e.id||`legacy_${Date.now()}`}:null}static getCommandString(e){return e?.command||""}static getCategory(e){return e?.category||e?.type||"custom"}static getParameters(e){return e?.parameters||{}}static isParameterized(e){const t=e?.signature;return!!t&&/\(.+\)/.test(t)&&"UnknownCommand(command: string)"!==t}static normalize(e){return e?e.signature&&e.category?this.newToOld(e):e.command&&e.type?{command:e.command,type:e.type,parameters:e.parameters||{},signature:e.signature,baseCommand:e.baseCommand,displayText:e.displayText||e.command,icon:e.icon||"⚙️",id:e.id}:e:null}}const je={"TrayExecByTray(tray: number, slot: number)":{commandId:"custom_tray",name:"Execute Tray Slot",category:"tray",icon:"⚡",description:"Execute a specific tray slot",parameters:{tray:{type:"number",min:0,max:9,default:0,label:"Tray Number",help:"Tray number (0-9, displays as 1-10 in UI)"},slot:{type:"number",min:0,max:9,default:0,label:"Slot Number",help:"Slot number (0-9, displays as 1-10 in UI)"},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray",label:"Command Type",help:"STOTrayExecByTray shows binding in UI, TrayExecByTray does not"}}},"TrayExecByTrayWithBackup(active: number, tray: number, slot: number, backup_tray: number, backup_slot: number)":{commandId:"tray_with_backup",name:"Execute Tray with Backup",category:"tray",icon:"🔄",description:"Execute tray slot with backup fallback",parameters:{active:{type:"number",min:0,max:1,default:1,label:"Active State",help:"Primary tray state (0 or 1)"},tray:{type:"number",min:0,max:9,default:0,label:"Primary Tray",help:"Primary tray number"},slot:{type:"number",min:0,max:9,default:0,label:"Primary Slot",help:"Primary slot number"},backup_tray:{type:"number",min:0,max:9,default:0,label:"Backup Tray",help:"Backup tray number"},backup_slot:{type:"number",min:0,max:9,default:0,label:"Backup Slot",help:"Backup slot number"}}},"Communication(verb: string, message: string)":{commandId:"communication",name:"Communication Command",category:"communication",icon:"💬",description:"Send message to chat channel",parameters:{verb:{type:"select",options:["say","team","zone","tell"],default:"say",label:"Channel",help:"Chat channel to send message to"},message:{type:"text",default:"",placeholder:"Enter your message...",label:"Message",help:"Message text to send"}}},"Target(entityName: string)":{commandId:"target_entity",name:"Target Entity",category:"targeting",icon:"🎯",description:"Target specific entity by name",parameters:{entityName:{type:"text",default:"",placeholder:"Entity name...",label:"Entity Name",help:"Name of entity to target"}}},"VFXExclusion(effects: string)":{commandId:"vfx_exclusion",name:"VFX Exclusion List",category:"vfx",icon:"✨",description:"Set visual effects exclusion list",parameters:{effects:{type:"text",default:"",placeholder:"Fx_Explosion,Fx_Beam,Fx_Particle...",label:"Effects List",help:"Comma-separated list of effects to exclude"}}},"VFXExclusionAlias(aliasName: string)":{commandId:"vfx_exclusion_alias",name:"VFX Exclusion Alias",category:"vfx",icon:"✨",description:"Use predefined VFX exclusion alias",parameters:{aliasName:{type:"text",default:"",placeholder:"LowVFX, NoParticles, etc...",label:"Alias Name",help:"Name of predefined VFX exclusion alias"}}},"PowerExec(powerName: string)":{commandId:"power_exec",name:"Execute Power",category:"power",icon:"🔋",description:"Execute specific power by name",parameters:{powerName:{type:"text",default:"",placeholder:"Power name...",label:"Power Name",help:"Name of power to execute"}}},"StaticCombat()":{commandId:"static_combat",name:"Combat Command",category:"combat",icon:"🔥",description:"Static combat command",parameters:{commandName:{type:"hidden",default:"",label:"Command Name"}}},"StaticTargeting()":{commandId:"static_targeting",name:"Targeting Command",category:"targeting",icon:"🎯",description:"Static targeting command",parameters:{commandName:{type:"hidden",default:"",label:"Command Name"}}}};function Me(e){return je[e]||null}const Ne=new class extends re{constructor({eventBus:e=r,dataService:t=null}={}){super(e),this.componentName="ParameterCommandService",this.selectedKey=null,this.selectedAlias=null,this.currentEnvironment="space",this.editingContext=null}onInit(){this.addEventListener("key-selected",e=>{this.selectedKey=e.key||e.name,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e.environment;t&&(this.currentEnvironment=t)}),this.addEventListener("parameter-edit:start",e=>{this.editingContext={isEditing:!0,editIndex:e.index,selectedKey:e.key,existingCommand:e.command}}),this.addEventListener("parameter-edit:end",()=>{this.editingContext=null})}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,editingContext:this.editingContext}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.selectedKey=t.selectedKey),void 0!==t.selectedAlias&&(this.selectedAlias=t.selectedAlias),void 0!==t.currentEnvironment&&(this.currentEnvironment=t.currentEnvironment),void 0!==t.editingContext&&(this.editingContext=t.editingContext))}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).slice(2,11)}`}generateTrayRangeCommands(e,t,i,a,n){const s=[];for(let o=t;o<=a;o++){const r=o===a?n:9;for(let a=o===t?i:0;a<=r;a++)s.push(`+${e} ${o} ${a}`)}return s}generateWholeTrayCommands(e,t){const i=[];for(let a=0;a<=9;a++)i.push(`+${e} ${t} ${a}`);return i}generateTrayRangeWithBackupCommands(e,t,i,a,n,s,o,r,c){const l=[];for(let r=t;r<=a;r++){const c=r===a?n:9;for(let a=r===t?i:0;a<=c;a++){const n=s+(r-t),c=o+(a-i);l.push(`TrayExecByTrayWithBackup ${e} ${r} ${a} ${n} ${c}`)}}return l}generateWholeTrayWithBackupCommands(e,t,i){const a=[];for(let n=0;n<=9;n++)a.push(`TrayExecByTrayWithBackup ${e} ${t} ${n} ${i} ${n}`);return a}async parseCommandsToObjects(e){const t=e.map(async e=>{try{const t=await this.request("parser:parse-command-string",{commandString:e});if(t.commands&&t.commands.length>0)return t.commands[0]}catch(t){console.warn("Failed to parse command:",e,t)}return{command:e,category:"tray",displayText:e,id:this.generateCommandId(),parameters:{}}});return Promise.all(t)}async buildParameterizedCommand(e,t,i,a={}){"alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;const n={targeting:e=>"target"===t&&e.entityName?{command:`${i.command} "${e.entityName}"`,text:`Target: ${e.entityName}`}:{command:i.command,text:i.name},tray:async e=>{const a=e.tray||0,n=e.slot||0;if("tray_with_backup"===t){const t=void 0!==e.active?e.active:1,i=e.backup_tray||0,s=e.backup_slot||0;return{command:`TrayExecByTrayWithBackup ${t} ${a} ${n} ${i} ${s}`,text:`Execute Tray ${a+1} Slot ${n+1} (backup: Tray ${i+1} Slot ${s+1})`}}if("tray_range"===t){const t=e.start_tray||0,a=e.start_slot||0,n=e.end_tray||0,s=e.end_slot||0;let o;o=i.baseCommand?i.baseCommand:e.baseCommand?e.baseCommand:e.command_type||"+STOTrayExecByTray";const r=this.generateTrayRangeCommands(o,t,a,n,s);return await this.parseCommandsToObjects(r)}if("tray_range_with_backup"===t){const t=void 0!==e.active?e.active:1,i=e.start_tray||0,a=e.start_slot||0,n=e.end_tray||0,s=e.end_slot||0,o=e.backup_start_tray||0,r=e.backup_start_slot||0,c=e.backup_end_tray||0,l=e.backup_end_slot||0,d=this.generateTrayRangeWithBackupCommands(t,i,a,n,s,o,r,c,l);return await this.parseCommandsToObjects(d)}if("whole_tray"===t){let t;t=i.baseCommand?i.baseCommand:e.baseCommand?e.baseCommand:e.command_type||"+STOTrayExecByTray";const n=this.generateWholeTrayCommands(t,a);return await this.parseCommandsToObjects(n)}if("whole_tray_with_backup"===t){const t=void 0!==e.active?e.active:1,i=e.backup_tray||0,n=this.generateWholeTrayWithBackupCommands(t,a,i);return await this.parseCommandsToObjects(n)}const s=this.editingContext&&this.editingContext.isEditing;let o;if(i.baseCommand)o=`${i.baseCommand} ${a} ${n}`;else if(e.baseCommand)o=`${e.baseCommand} ${a} ${n}`;else if(e.command_type){const t=e.command_type;o=`${t.startsWith("+")?"":"+"}${t} ${a} ${n}`}else o=`+STOTrayExecByTray ${a} ${n}`;if(s){const t=this.editingContext.existingCommand;t&&(t.command.startsWith("TrayExecByTray")||t.command.startsWith("+TrayExecByTray"))&&(o=i.baseCommand?`${i.baseCommand} ${a} ${n}`:e.baseCommand?`${e.baseCommand} ${a} ${n}`:`+TrayExecByTray ${a} ${n}`)}return{command:o,text:`Execute Tray ${a+1} Slot ${n+1}`,parameters:{tray:a,slot:n}}},movement:e=>{let a=i.command;return"throttle_adjust"===t&&void 0!==e.amount?a=`${i.command} ${e.amount}`:"throttle_set"===t&&void 0!==e.position&&(a=`${i.command} ${e.position}`),{command:a,text:i.name}},camera:e=>{let a=i.command;return"cam_distance"===t&&void 0!==e.distance&&(a=`${i.command} ${e.distance}`),{command:a,text:i.name}},communication:e=>{const t=i&&i.command?i.command:"say",a=e.verb||t,n=e.message||"Message text here";return{command:`${a} "${n}"`,text:`${a}: "${n}"`}},vfx:e=>{if("vfx_exclusion"===t){const t=e.effects||"";return{command:`dynFxSetFXExlusionList ${t}`,text:`VFX Exclude: ${t}`}}if("vfx_exclusion_alias"===t){const t=e.aliasName||"";return{command:`dynFxSetFXExlusionList_${t}`,text:`VFX Alias: ${t}`}}return{command:i.command,text:i.name}},targeting:e=>{if("target_entity"===t){const t=e.entityName||"";return{command:`Target "${t}"`,text:`Target "${t}"`}}return{command:i.command,text:i.name}},power:e=>{if("power_exec"===t){const t=e.powerName||"";return{command:`+power_exec ${t}`,text:`Power: ${t}`}}return{command:i.command,text:i.name}},combat:e=>({command:e.commandName||i.command,text:i.name}),system:e=>{let a=i.command;return"bind_save_file"!==t&&"bind_load_file"!==t||!e.filename?"combat_log"===t&&void 0!==e.state&&(a=`${i.command} ${e.state}`):a=`${i.command} ${e.filename}`,{command:a,text:i.name}},alias:e=>{const t=e.alias_name?.trim()||"";return t?{command:t,text:`Alias: ${t}`}:null}}[e];if(!n)return null;const s=await n(a);return s?Array.isArray(s)?s:{command:s.command,type:e,icon:i.icon,displayText:s.text,id:this.generateCommandId(),parameters:a}:null}async findCommandDefinition(e){try{const t=Fe.normalize(e);if(!t)return null;const i=await this.request("parser:parse-command-string",{commandString:t.command});if(!i?.commands?.[0])return null;const a=i.commands[0],n=Me(a.signature);return n&&function(e){const t=Me(e);return!!t&&Object.values(t.parameters||{}).some(e=>"hidden"!==e.type)}(a.signature)?{commandId:n.commandId,categoryId:n.category,name:n.name,description:n.description,icon:n.icon,category:n.category,parameters:n.parameters,signature:a.signature,baseCommand:a.baseCommand,extractedParameters:a.parameters,...a.parameters}:null}catch(e){return console.warn("[ParameterCommandService] Error finding command definition:",e),null}}}({eventBus:r});Ne.init();class De extends re{constructor({modalManager:e=null,i18n:t=null,ui:i=null,document:a=null}={}){super(r),this.componentName="ParameterCommandUI",this.modalManager=e,this.i18n=t,this.ui=i,this.document=a||("undefined"!=typeof window?window.document:null),this.N=null,this.D=null,this.P="space",this.currentParameterCommand=null}onInit(){this.setupEventListeners()}get selectedKey(){return this.N}set selectedKey(e){this.N=e}get selectedAlias(){return this.D}set selectedAlias(e){this.D=e}get currentEnvironment(){return this.P}set currentEnvironment(e){this.P=e}setupEventListeners(){this.addEventListener("key-selected",e=>{this.N=e.key||e.name,this.D=null,this.selectedKey=this.N}),this.addEventListener("alias-selected",e=>{this.D=e.name,this.N=null,this.selectedKey=this.D}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.P=t)}),this.addEventListener("parameter-command:edit",({index:e,command:t,commandDef:i,categoryId:a,commandId:n})=>{i&&a&&n&&this.editParameterizedCommand(e,t,i)})}getCurrentState(){return{selectedKey:this.N,selectedAlias:this.D,currentEnvironment:this.P}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.N=t.selectedKey,this.selectedKey=t.selectedKey),void 0!==t.selectedAlias&&(this.D=t.selectedAlias,this.selectedKey=t.selectedAlias),void 0!==t.currentEnvironment&&(this.P=t.currentEnvironment))}showParameterModal(e,t,i){this.currentParameterCommand={categoryId:e,commandId:t,commandDef:i},this.document.getElementById("parameterModal")||this.createParameterModal();const a=this.document.getElementById("parameterModal");a&&a.setAttribute("data-command-def",JSON.stringify(i)),this.populateParameterModal(i),this.modalManager?.show("parameterModal")}createParameterModal(){const e=this.document.createElement("div");e.className="modal",e.id="parameterModal",e.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3 id="parameterModalTitle">Configure Command Parameters</h3>\n          <button class="modal-close" data-modal="parameterModal">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n        <div class="modal-body">\n          <div id="parameterInputs"></div>\n          <div class="command-preview-modal">\n            <label>Generated Command:</label>\n            <div class="command-preview" id="parameterCommandPreview"></div>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <button class="btn btn-primary" id="saveParameterCommandBtn">Add Command</button>\n          <button class="btn btn-secondary" data-modal="parameterModal">Cancel</button>\n        </div>\n      </div>',this.document.body.appendChild(e),this.eventBus.onDom("saveParameterCommandBtn","click","parameter-command-save",()=>{this.saveParameterCommand()}),e.querySelectorAll('.modal-close, [data-modal="parameterModal"]').forEach(e=>{e.addEventListener("click",()=>this.cancelParameterCommand())})}cancelParameterCommand(){this.emit("parameter-edit:end"),this.currentParameterCommand=null;const e=this.document.getElementById("saveParameterCommandBtn");e&&(e.textContent=this.i18n?.t?.("add_command")||"Add Command"),this.modalManager?.hide("parameterModal")}populateParameterModal(e){const t=this.document.getElementById("parameterInputs"),i=this.document.getElementById("parameterModalTitle");t&&i&&(i.textContent=`Configure: ${e.name}`,t.innerHTML="",this.buildParameterInputs(t,e),this.updateParameterPreview())}editParameterizedCommand(e,t,i){const a="alias"===(this.P||"space")?this.D:this.N;this.emit("parameter-edit:start",{index:e,key:a,command:t,commandDef:i}),this.currentParameterCommand={...i,editIndex:e,isEditing:!0},this.document.getElementById("parameterModal")||this.createParameterModal(),this.populateParameterModalForEdit(i,t.parameters||{});const n=this.document.getElementById("saveParameterCommandBtn");n&&(n.textContent=this.i18n?.t?.("update_command")||"Update Command"),this.modalManager?.show("parameterModal")}populateParameterModalForEdit(e,t={}){const i=this.document.getElementById("parameterInputs"),a=this.document.getElementById("parameterModalTitle");i&&a&&(a.textContent=`Edit: ${e.name}`,i.innerHTML="",this.buildParameterInputs(i,e,t),this.updateParameterPreview())}async updateParameterPreview(){if(!this.currentParameterCommand)return;const{categoryId:e,commandId:t}=this.currentParameterCommand,i=this.currentParameterCommand,a=this.getParameterValues();try{const n=await Ne.buildParameterizedCommand(e,t,i,a),s=this.document.getElementById("parameterCommandPreview");if(!s||!n)return;Array.isArray(n)?s.textContent=n.map(e=>e.command||e).filter(e=>e).join(" $$ "):s.textContent=n.command||n}catch(e){console.error("Error updating parameter preview:",e);const t=this.document.getElementById("parameterCommandPreview");t&&(t.textContent="Error generating command")}}getParameterValues(){const e=this.document.getElementById("parameterInputs");if(!e)return{};const t={};return e.querySelectorAll("input, select").forEach(e=>{const i=e.name;i&&("number"===e.type?t[i]=""===e.value?void 0:Number(e.value):t[i]=e.value)}),t}async saveParameterCommand(...e){const t=this.P||"space",i="alias"===t?this.D:this.N;if(!i||!this.currentParameterCommand){const e="alias"===t?this.i18n?.t?.("please_select_an_alias_first")||"Please select an alias first":this.i18n?.t?.("please_select_a_key_first")||"Please select a key first";return void this.ui?.showToast?.(e,"warning")}const{categoryId:a,commandId:n}=this.currentParameterCommand,s=this.currentParameterCommand,o=this.getParameterValues();try{const e=await Ne.buildParameterizedCommand(a,n,s,o);if(!e)return;this.currentParameterCommand.isEditing&&void 0!==this.currentParameterCommand.editIndex?(console.log("[ParameterCommandUI] emitting command:edit [parameterized]",{key:i,index:this.currentParameterCommand.editIndex,updatedCommand:e}),this.emit("command:edit",{key:i,index:this.currentParameterCommand.editIndex,updatedCommand:e})):Array.isArray(e)?(console.log("[ParameterCommandUI] emitting command:add [bulk parameterized]",{commands:e,key:i}),this.emit("command:add",{command:e,key:i})):(console.log("[ParameterCommandUI] emitting command:add [single parameterized]",{command:e,key:i}),this.emit("command:add",{command:e,key:i}))}catch(e){return console.error("Error building parameterized command:",e),void this.ui?.showToast?.("Error generating command","error")}this.modalManager?.hide("parameterModal"),this.emit("parameter-edit:end"),this.currentParameterCommand=null;const r=this.document.getElementById("saveParameterCommandBtn");r&&(r.textContent=this.i18n?.t?.("add_command")||"Add Command")}async editCommand(e){if("alias"===(this.P||"space")?this.D:this.N)try{const t=await this.request("command:get-for-selected-key");if(!t||!t[e])return;const i=t[e],a=await Ne.findCommandDefinition(i);if(!a)return;this.editParameterizedCommand(e,i,a)}catch(e){console.error("ParameterCommandUI.editCommand failed:",e)}}generateCommandId(...e){return Ne.generateCommandId(...e)}async buildParameterizedCommand(...e){return await Ne.buildParameterizedCommand(...e)}async findCommandDefinition(...e){return await Ne.findCommandDefinition(...e)}formatParameterName(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}getParameterHelp(e,t){return t.help?t.help:{tray:"Tray number (0-9)",slot:"Slot number (0-9)",start_tray:"Starting tray number",end_tray:"Ending tray number",start_slot:"Starting slot number",end_slot:"Ending slot number",backup_tray:"Backup tray number",backup_slot:"Backup slot number",active:"1 to activate immediately, 0 to queue",entityName:"Name of the entity to target",message:"Message text to send",distance:"Camera distance value",amount:"Throttle adjustment amount",position:"Throttle position (0-100)",filename:"File name (without extension)",state:"1 to enable, 0 to disable",verb:"Communication channel (say, team, zone)",alias_name:"Name of the alias to execute"}[e]||"Parameter value"}getOptionLabel(e,t){return"verb"===e?this.i18n?.t?.(`verb.${t}`)||t:"STOTrayExecByTray"===t?"STOTrayExecByTray (shows key binding on UI)":"TrayExecByTray"===t?"TrayExecByTray (no UI indication)":t}buildParameterInputs(e,t,i={}){Object.entries(t.parameters).forEach(([t,a])=>{const n=this.document.createElement("div");n.className="form-group";const s=this.document.createElement("label");let o;s.textContent=this.formatParameterName(t),s.setAttribute("for",`param_${t}`);const r=i[t]??a.default;"select"===a.type?(o=this.document.createElement("select"),o.id=`param_${t}`,o.name=t,a.options.forEach(e=>{const i=this.document.createElement("option");i.value=e,i.textContent=this.getOptionLabel(t,e),e===r&&(i.selected=!0),o.appendChild(i)})):(o=this.document.createElement("input"),o.type="number"===a.type?"number":"text",o.id=`param_${t}`,o.name=t,o.value=r??"",a.placeholder&&(o.placeholder=a.placeholder),"number"===a.type&&(void 0!==a.min&&(o.min=a.min),void 0!==a.max&&(o.max=a.max),void 0!==a.step&&(o.step=a.step)));const c=this.document.createElement("small");c.textContent=this.getParameterHelp(t,a),n.appendChild(s),n.appendChild(o),n.appendChild(c),e.appendChild(n),o.addEventListener("input",()=>this.updateParameterPreview()),"SELECT"===o.tagName&&o.addEventListener("change",()=>this.updateParameterPreview())})}}class Oe extends re{constructor({service:e,eventBus:t,ui:i,modalManager:a,document:n}){super(t),this.componentName="CommandLibraryUI",this.service=e,this.ui=i,this.modalManager=a,this.document=n||("undefined"!=typeof window?window.document:null),this.eventListenersSetup=!1,this.cache={profile:null,aliases:{},currentProfile:null},this.P="space",this.N=null,this.D=null}onInit(){this.setupEventListeners(),this.setupCommandLibrary()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.addEventListener("profile:updated",({profile:e})=>{this.updateCacheFromProfile(e),this.updateCommandLibrary()}),this.addEventListener("profile:switched",({profile:e})=>{this.updateCacheFromProfile(e),this.updateCommandLibrary()}),this.addEventListener("environment:changed",({environment:e})=>{this.P=e;const t=this.document.getElementById("commandSearch"),i=t?t.value:"";this.applySearchFilter(i)}),this.addEventListener("key:selected",({key:e})=>{this.N=e,this.D=null,this.updateChainActions()}),this.addEventListener("alias:selected",({alias:e})=>{this.D=e,this.N=null,this.updateChainActions()}),this.addEventListener("language:changed",()=>{this.setupCommandLibrary()}),this.eventBus.onDom("stabilizeExecutionOrder","change","stabilize-order-change",()=>{}),this.addEventListener("command:filter",({filter:e=""})=>{this.applySearchFilter(e)}))}async setupCommandLibrary(){const e=this.document.getElementById("commandCategories");if(!e)return;e.innerHTML="";const t=await this.request("command:get-categories");Object.entries(t).forEach(([t,i])=>{const a=this.createCategoryElement(t,i);e.appendChild(a)}),this.filterCommandLibrary(),this.updateCommandLibrary()}createCategoryElement(e,t){const i=this.document.createElement("div")||{};i.dataset||(i.dataset={}),i.className="category",i.dataset.category=e;const a=`commandCategory_${e}_collapsed`,n="true"===localStorage.getItem(a);i.innerHTML=`\n      <h4 class="${n?"collapsed":""}" data-category="${e}">\n        <i class="fas fa-chevron-right category-chevron"></i>\n        <i class="${t.icon}"></i> \n        ${t.name}\n        <span class="command-count">(${Object.keys(t.commands).length})</span>\n      </h4>\n      <div class="category-commands ${n?"collapsed":""}">\n        ${Object.entries(t.commands).map(([e,t])=>{const i=`command_definitions.${e}.name`,a=void 0!==Y&&Y.exists(i)?Y.t(i):t.name,n=`command_definitions.${e}.description`,s=void 0!==Y&&Y.exists(n)?Y.t(n):t.description;return`\n            <div class="command-item ${t.customizable?"customizable":""}" data-command="${e}" title="${s}${t.customizable?" (Customizable)":""}">\n              ${t.icon} ${a}${t.customizable?' <span class="param-indicator">⚙️</span>':""}\n            </div>\n          `}).join("")}\n      </div>\n    `;const s=i.querySelector?i.querySelector("h4"):null;return s&&s.addEventListener&&s.addEventListener("click",()=>{this.toggleCommandCategory(e,i)}),i.addEventListener&&i.addEventListener("click",e=>{if(e.target.classList.contains("command-item")){const t=e.target.dataset.command,i=e.target.closest(".category").dataset.category,a=STO_DATA?.commands?.[i]?.commands?.[t];if(!a)return;if(a.customizable)console.log("[CommandLibraryUI] emitting command-add [customizable]",{categoryId:i,commandId:t,commandDef:a}),this.emit("command-add",{categoryId:i,commandId:t,commandDef:a});else{const e={command:a.command,type:i,icon:a.icon,text:a.name,id:`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};console.log("[CommandLibraryUI] emitting command-add [static]",{commandDef:e}),this.emit("command-add",{commandDef:e})}}}),i}toggleCommandCategory(e,t){const i=t.querySelector("h4"),a=t.querySelector(".category-commands"),n=i.querySelector(".category-chevron"),s=`commandCategory_${e}_collapsed`;a.classList.contains("collapsed")?(a.classList.remove("collapsed"),i.classList.remove("collapsed"),n.style.transform="rotate(90deg)",localStorage.setItem(s,"false")):(a.classList.add("collapsed"),i.classList.add("collapsed"),n.style.transform="rotate(0deg)",localStorage.setItem(s,"true"))}createAliasCategoryElement(e,t="aliases",i="command_aliases",a="fas fa-mask"){const n=document.createElement("div");n.className="category",n.dataset.category=t;const s=`commandCategory_${t}_collapsed`,o="true"===localStorage.getItem(s),r="vertigo-aliases"===t,c=r?"👁️":"🎭",l=r?"command-item vertigo-alias-item":"command-item alias-item";return n.innerHTML=`\n            <h4 class="${o?"collapsed":""}" data-category="${t}">\n                <i class="fas fa-chevron-right category-chevron"></i>\n                <i class="${a}"></i>\n                ${void 0!==Y?Y.t(i):i}\n                <span class="command-count">(${e.length})</span>\n            </h4>\n            <div class="category-commands ${o?"collapsed":""}">\n                ${e.map(([e,t])=>`\n                    <div class="${l}" data-alias="${e}" title="${t.description||t.commands}">\n                        ${c} ${e}\n                    </div>\n                `).join("")}\n            </div>\n        `,n.querySelector("h4").addEventListener("click",()=>{this.toggleAliasCategory(t,n)}),n.addEventListener("click",t=>{if(t.target.classList.contains("alias-item")||t.target.classList.contains("vertigo-alias-item")){const i=t.target.dataset.alias,a=e.find(([e])=>e===i);console.log("[CommandLibraryUI] aliasEntry",a);const n=a?a[1]:{},s="vfx-alias"===n.type,o={command:i,type:n.type,icon:"🎭",text:`${i}`,description:n.description,isUserAlias:!0,isVfxAlias:s,id:`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};console.log("[CommandLibraryUI] emitting command:add [alias]",{commandDef:o}),this.emit("command-add",{commandDef:o})}}),n}toggleAliasCategory(e,t){const i=t.querySelector("h4"),a=t.querySelector(".category-commands"),n=i.querySelector(".category-chevron"),s=`commandCategory_${e}_collapsed`;a.classList.contains("collapsed")?(a.classList.remove("collapsed"),i.classList.remove("collapsed"),n.style.transform="rotate(90deg)",localStorage.setItem(s,"false")):(a.classList.add("collapsed"),i.classList.add("collapsed"),n.style.transform="rotate(0deg)",localStorage.setItem(s,"true"))}updateCommandLibrary(){if(!this.cache.profile)return;const e=this.document.getElementById("commandCategories");if(!e)return;const t=e.querySelector('[data-category="aliases"]');t&&t.remove();const i=e.querySelector('[data-category="vertigo-aliases"]');i&&i.remove();const a=Object.entries(this.cache.aliases),n=a.filter(([e])=>!e.startsWith("dynFxSetFXExlusionList_")),s=a.filter(([e])=>e.startsWith("dynFxSetFXExlusionList_"));if(n.length>0){const t=this.createAliasCategoryElement(n,"aliases","command_aliases","fas fa-mask");e.appendChild(t)}if(s.length>0){const t=this.createAliasCategoryElement(s,"vertigo-aliases","vfx_aliases","fas fa-eye-slash");e.appendChild(t)}}filterCommandLibrary(){ne(this.eventBus,"command:filter-library").catch(()=>{})}setupDragAndDrop(){if(window.commandChainUI&&"function"==typeof window.commandChainUI.setupDragAndDrop)return void window.commandChainUI.setupDragAndDrop();const e=this.document.getElementById("commandList");e&&this.ui&&"function"==typeof this.ui.initDragAndDrop&&this.ui.initDragAndDrop(e,{dragSelector:".command-item-row",dropZoneSelector:".command-item-row",onDrop:async(e,t,i)=>{if(!("alias"===this.P?this.D:this.N))return;const a=parseInt(t.dragElement.dataset.index),n=parseInt(i.dataset.index);a!==n&&this.emit("commandchain:move",{fromIndex:a,toIndex:n})}})}updateChainActions(){if(window.commandChainUI&&"function"==typeof window.commandChainUI.updateChainActions)return void window.commandChainUI.updateChainActions();const e=!!("alias"===this.P?this.D:this.N),t=this.document;if("alias"===this.P){["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(i=>{const a=t.getElementById(i);a&&(a.disabled=!e)});const i=t.getElementById("addCommandBtn");i&&(i.disabled=!e.duplicateKeyBtn.forEach(e=>{const i=t.getElementById(e);i&&(i.disabled=!0)}))}else["addCommandBtn","importFromKeyBtn","deleteKeyBtn","duplicateKeyBtn"].forEach(i=>{const a=t.getElementById(i);a&&(a.disabled=!e)}).duplicateAliasChainBtn.forEach(e=>{const i=t.getElementById(e);i&&(i.disabled=!0)})}toggleLibrary(){const e=this.document.getElementById("libraryContent"),t=this.document.getElementById("toggleLibraryBtn");if(e&&t){const i="none"===e.style.display;e.style.display=i?"block":"none";const a=t.querySelector("i");a&&(a.className=i?"fas fa-chevron-up":"fas fa-chevron-down")}}showTemplateModal(){this.ui?.showToast?.(Y.t("template_system_coming_soon"))}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.currentProfile=e.id,this.cache.aliases=e.aliases||{})}getCurrentState(){return{aliases:this.cache.aliases,currentProfile:this.cache.currentProfile,currentEnvironment:this.P,selectedKey:this.N,selectedAlias:this.D}}handleInitialState(e,t){"DataCoordinator"===t&&e.currentProfileData&&(this.updateCacheFromProfile(e.currentProfileData),this.updateCommandLibrary())}async applySearchFilter(e){const t=(e||"").trim().toLowerCase(),i=this.document||("undefined"!=typeof window?window.document:void 0);i&&(i.querySelectorAll(".command-item, .alias-item, .vertigo-alias-item").forEach(e=>{const i="true"===e.dataset.envHidden;if(!t)return void(i||(e.style.display="flex"));const a=(e.textContent||"").toLowerCase().includes(t);e.style.display=a&&!i?"flex":"none"}),i.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item:not([style*="display: none"]), .alias-item:not([style*="display: none"]), .vertigo-alias-item:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"}))}}class ze extends re{constructor({eventBus:e=r,ui:t=null,modalManager:i=null,parameterCommandUI:a=null}={}){super(e),this.componentName="CommandUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.modalManager=i,this.parameterCommandUI=a,this.N=null,this.D=null,this.P="space"}onInit(){this.setupEventListeners(),this.setupUIStateEventListeners(),this.addEventListener("command-add",async(e={})=>{const{categoryId:t,commandId:i,commandDef:a}=e;if(!a||t||i)t&&i&&a&&(this.parameterCommandUI?this.parameterCommandUI.showParameterModal(t,i,a):console.error("CommandUI: parameterCommandUI not available"));else try{const e=this.getSelectedKey();if(!e){const e=this.getCurrentEnvironment(),t="alias"===e?"please_select_an_alias_first":"please_select_a_key_first",i=await this.getI18nMessage(t)||("alias"===e?"Please select an alias first":"Please select a key first");return void await this.showToast(i,"warning")}console.log("[CommandUI] emitting command:add [static]",{commandDef:a,key:e}),this.emit("command:add",{command:a,key:e})}catch(e){console.error("CommandUI: Failed to handle static command:",e)}})}setupUIStateEventListeners(){this.addEventListener("key-selected",e=>{this.N=e.key||e.name,this.D=null}),this.addEventListener("alias-selected",e=>{this.D=e.name,this.N=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.P=t)})}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addCommandBtn","click","command-add-modal",()=>{this.modalManager.show("addCommandModal")}),this.eventBus.onDom("clearChainBtn","click","command-chain-clear",()=>{const e=this.getSelectedKey();e&&this.confirmClearChain(e)}),this.eventBus.onDom("validateChainBtn","click","command-chain-validate",()=>{const e=this.getSelectedKey();e&&this.validateCurrentChain(e)}),this.eventBus.onDomDebounced("commandSearch","input","command-search",e=>{this.filterCommands(e.target.value)},250),this.eventBus.onDom("commandSearch","keydown","command-search-key",e=>{if("Escape"===e.key){const t=e.target;t.value="",t.classList.remove("expanded"),this.emit("command:filter",{filter:""})}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllCommandsBtn","click","command-show-all",()=>{const e=this.document.getElementById("commandSearch");e&&(e.value=""),this.emit("command:filter",{filter:""})}),this.eventBus.onDom("commandSearchBtn","click","command-search-toggle",()=>{this.toggleCommandSearch()}),this.eventBus.onDom("importFromKeyBtn","click","import-from-key",()=>{this.importFromKey()}),this.eventBus.onDom("saveCommandBtn","click","save-command",()=>{this.saveCommand()}))}getSelectedKey(){return"alias"===this.P?this.D:this.N}getCurrentEnvironment(){return this.P}getCurrentState(){return{selectedKey:this.N,selectedAlias:this.D,currentEnvironment:this.P}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.N=t.selectedKey),void 0!==t.selectedAlias&&(this.D=t.selectedAlias),void 0!==t.currentEnvironment&&(this.P=t.currentEnvironment))}async getI18nMessage(e,t={}){try{return await this.request("i18n:translate",{key:e,params:t})}catch(e){return console.error("CommandUI: Failed to get i18n message:",e),null}}async showToast(e,t="info"){try{this.ui?.showToast?this.ui.showToast(e,t):await this.request("ui:show-toast",{message:e,type:t})}catch(t){console.error("CommandUI: Failed to show toast:",t),alert(e)}}async confirmClearChain(e){if(e)try{const t=await this.getI18nMessage("confirm_clear_chain",{key:e})||`Clear command chain for ${e}?`;confirm(t)&&this.emit("command-chain:clear",{key:e})}catch(e){console.error("CommandUI: Failed to confirm clear chain:",e)}}async validateCurrentChain(e){if(e){this.emit("command-chain:validate",{key:e});try{const e=await this.getI18nMessage("command_chain_is_valid")||"Command chain is valid";await this.showToast(e,"success")}catch(e){console.error("CommandUI: Failed to show validation toast:",e)}}}filterCommands(e){this.emit("command:filter",{filter:e})}toggleCommandSearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("commandSearch");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}async importFromKey(){const e=this.getSelectedKey();if(!e){const e=await this.getI18nMessage("please_select_a_key_first")||"Please select a key first";return void await this.showToast(e,"warning")}this.emit("command:import-from-key",{key:e})}async saveCommand(){const e=this.document.getElementById("commandType")?.value,t=this.document.getElementById("modalCommandPreview")?.textContent;if(!e||!t){const e=await this.getI18nMessage("please_complete_command_configuration")||"Please complete the command configuration";return void await this.showToast(e,"warning")}const i=this.getSelectedKey();if(!i){const e=this.getCurrentEnvironment(),t="alias"===e?"please_select_an_alias_first":"please_select_a_key_first",i=await this.getI18nMessage(t)||("alias"===e?"Please select an alias first":"Please select a key first");return void await this.showToast(i,"warning")}this.emit("command:save",{key:i,type:e,command:t}),this.modalManager&&this.modalManager.hide("addCommandModal")}}class Ke extends re{constructor({eventBus:e,ui:t=null,profileUI:i=null,document:a=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="InterfaceModeUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.profileUI=i,this.document=a,this.S="space",this.O=!1,this.K={},this.L={},this.R=null,this.U=null}init(){super.init(),this.setupEventListeners(),this.setupModeButtons()}setupEventListeners(){this.O||(this.R=e=>{const t="string"==typeof e?e:e?.newMode;t&&(this.S=t,this.updateModeUI(t))},this.U=(e={})=>{const t="string"==typeof e?e:e.environment||e.newMode||e.mode;t&&(this.S=t,this.updateModeUI(t))},this.eventBus.on("mode-changed",this.R),this.eventBus.on("environment:changed",this.U),this.O=!0)}setupModeButtons(){this.K.space=this.document.querySelector('[data-mode="space"]'),this.K.ground=this.document.querySelector('[data-mode="ground"]'),this.K.alias=this.document.querySelector('[data-mode="alias"]'),Object.entries(this.K).forEach(([e,t])=>{if(t){const i=()=>{this.handleModeButtonClick(e)};this.L[e]=i,t.addEventListener("click",i)}else console.warn(`[InterfaceModeUI] Mode button for ${e} not found`)})}async handleModeButtonClick(e){try{const t=await this.request("environment:switch",{mode:e});t.success||console.error("[InterfaceModeUI] Failed to switch environment:",t.error)}catch(e){console.error("[InterfaceModeUI] Error switching environment:",e)}}updateModeUI(e){Object.entries(this.K).forEach(([t,i])=>{i&&i.classList.toggle("active",t===e)}),this.updateKeyGridDisplay(e)}updateKeyGridDisplay(e){const t=this.document.querySelector(".key-selector-container"),i=this.document.getElementById("aliasSelectorContainer");"alias"===e?(t&&(t.style.display="none"),i&&(i.style.display="")):(t&&(t.style.display=""),i&&(i.style.display="none"),this.profileUI&&this.profileUI.renderKeyGrid()),this.profileUI}get currentMode(){return this.S}set currentMode(e){this.S=e,ne(this.eventBus,"environment:switch",{mode:e}).catch(e=>{console.error("[InterfaceModeUI] Error switching environment via setter:",e)})}get currentEnvironment(){return this.S}set currentEnvironment(e){this.currentMode=e}getCurrentMode(){return this.currentMode}async setCurrentMode(e){try{const t=await this.request("environment:switch",{mode:e});t.success?(this.S=t.mode,this.updateModeUI(t.mode)):console.error("[InterfaceModeUI] Failed to switch environment:",t.error)}catch(e){console.error("[InterfaceModeUI] Error switching environment:",e)}}destroy(){this.O&&(this.eventBus.off("mode-changed",this.R),this.eventBus.off("environment:changed",this.U),this.O=!1),Object.entries(this.K).forEach(([e,t])=>{t&&this.L[e]&&t.removeEventListener("click",this.L[e])}),this.L={},super.destroy()}handleInitialState(e,t){t&&("InterfaceModeService"===e||t.environment)&&t.environment&&this.updateModeUI(t.environment)}}const Le=["[","\\","]","Add","ALT","LALT","RALT","Down","Left","Right","Up",",","Control","LCTRL","RCTRL","delete","/","End","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24","Home","insert","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","enter","Button1","Button2","Button3","Button4","Button5","Button6","Button7","Button8","Button9","Button10","Lbutton","Rbutton","Middleclick","Wheelminus","Wheelplus","Multiply","0","1","2","3","4","5","6","7","8","9","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","Decimal","Divide","numpadenter","Subtract","Add","PageDown","PageUp",".","Shift","Space","Tab","`","Joy1","Joy2","Joy3","Joy4","Joy5","Joy6","Joy7","Joy8","Joy9","Joy10","Joy11","Joy12","Lstick_down","Lstick_left","Lstick_right","Lstick_up","Rstick_down","Rstick_left","Rstick_right","Rstick_up","Joypad_down","Joypad_left","Joypad_right","Joypad_up"];class Re extends re{constructor({eventBus:e=r,modalManager:t=null,app:i=null,document:a=("undefined"!=typeof window?window.document:void 0),ui:n=null,service:s=null}={}){super(e),this.componentName="KeyCaptureUI",this.eventBus=e,this.modalManager=t||("undefined"!=typeof window?window.modalManager:null),this.app=i||("undefined"!=typeof window?window.app:null),this.document=a,this.ui=n||("undefined"!=typeof window?window.stoUI:null),this.service=s}onInit(){this.addEventListener("capture-start",e=>this.handleCaptureStart(e)),this.addEventListener("update",e=>this.updateCapturedKeysDisplay(e)),this.addEventListener("chord-captured",e=>this.addCapturedKeySelectionButton(e)),this.addEventListener("capture-stop",e=>this.handleCaptureStop(e)),this.eventBus&&this.eventBus.on("modal:shown",({modalId:e})=>{"keySelectionModal"===e&&this.populateKeySelectionModal()}),this.setupEventListeners(),this.populateKeySelectionModal(),this.populateModifierButtons()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addKeyConfirmYesBtn","click","add-key-confirm-yes",()=>{this.confirmAddKey(!0)}),this.eventBus.onDom("addKeyConfirmNoBtn","click","add-key-confirm-no",()=>{this.confirmAddKey(!1)}),this.eventBus.onDom("confirmAddKeyBtn","click","confirm-add-key",()=>{this.addSelectedKey()}),this.eventBus.onDom("keySelectionCaptureBtn","click","key-selection-capture",()=>{this.startCapture("keySelectionModal")}),this.eventBus.onDom("confirmKeySelection","click","key-selection-confirm",()=>{this.addSelectedKey()}),this.eventBus.onDom(".modifier-btn","click","key-selection-modifier-toggle",e=>{const t=e.target.closest(".modifier-btn");if(!t)return;const i="true"===t.dataset.selected;t.dataset.selected=(!i).toString(),this.updateKeyPreview()}),this.eventBus.onDom(".key-item","click","key-selection-item",e=>{const t=e.target.closest(".key-item");t&&(this.document.querySelectorAll(".key-item.selected")?.forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),this.updateKeyPreview())}),this.eventBus.onDom(".tab-btn","click","key-selection-tab",e=>{const t=e.target.closest(".tab-btn");if(!t)return;const i=t.dataset.tab;if(!i)return;this.document.querySelectorAll(".tab-btn")?.forEach(e=>e.classList.remove("active")),t.classList.add("active"),this.document.querySelectorAll(".key-tab")?.forEach(e=>e.classList.remove("active"));const a=this.document.getElementById(`${i}-tab`);a&&a.classList.add("active")}))}startCapture(e="keySelectionModal"){const t="addKeyModal"===e?"addKeyCaptureStatus":"keyCaptureStatus",i="addKeyModal"===e?"addKeyCapturedKeys":"capturedKeys",a="addKeyModal"===e?"addKeyCaptureBtn":"keySelectionCaptureBtn",n=this.document.getElementById(t),s=this.document.getElementById(i),o=this.document.getElementById(a);n&&(n.style.display="block"),s&&(s.textContent="",s.setAttribute("data-placeholder","Press keys...")),o&&(o.disabled=!0);const r=this.document.getElementById(e);r&&r.focus(),this.emit("keycapture:start",{context:e})}stopCapture(){this.emit("keycapture:stop")}handleCaptureStart({context:e}){}handleCaptureStop({context:e}){const t="addKeyModal"===e?"addKeyCaptureStatus":"keyCaptureStatus",i="addKeyModal"===e?"addKeyCaptureBtn":"keySelectionCaptureBtn",a=this.document.getElementById(t),n=this.document.getElementById(i);if(a&&(a.style.display="none"),n&&(n.disabled=!1),"addKeyModal"===e){const e=this.document.getElementById("addKeyConfirmSection");e&&(e.style.display="none")}}updateCapturedKeysDisplay({chord:e,context:t}){const i="addKeyModal"===t?"addKeyCapturedKeys":"capturedKeys",a=this.document.getElementById(i);a&&(a.textContent=e||"")}addCapturedKeySelectionButton({chord:e,context:t}){if(e)if("addKeyModal"===t){const t="addKeyCapturedKeys",i=this.document.getElementById(t);if(!i)return;const a=i.querySelector(".captured-key-select-btn");a&&a.remove();const n=this.document.createElement("button");n.className="btn btn-primary captured-key-select-btn",n.textContent=`Select "${e}"`,n.onclick=()=>{const t=this.document.getElementById("newKeyName");t&&(t.value=e),this.app&&"function"==typeof this.app.addKey&&this.app.addKey(e),this.modalManager?.hide("addKeyModal"),this.stopCapture()},i.appendChild(n)}else{const t=this.document.getElementById("keyPreviewDisplay"),i=this.document.getElementById("confirmKeySelection");t&&(t.innerHTML=`<span class="key-combination">${e}</span>`),i&&(i.disabled=!1),this.selectedKey=e,this.document.querySelectorAll(".modifier-btn")?.forEach(e=>{e.dataset.selected="false"}),this.document.querySelectorAll(".key-item.selected")?.forEach(e=>e.classList.remove("selected")),this.stopCapture()}}confirmAddKey(e){if(e){const e=this.document.getElementById("newKeyName"),t=e?e.value:null;t&&this.app&&"function"==typeof this.app.addKey&&this.app.addKey(t)}this.modalManager?.hide("addKeyModal"),this.stopCapture()}async addSelectedKey(){if(this.selectedKey)try{await this.request("key:add",{key:this.selectedKey}),this.modalManager?.hide("keySelectionModal")}catch(e){console.error("Failed to add key:",e),this.ui?.showToast&&this.ui.showToast("Failed to add key","error")}}populateKeySelectionModal(){if(this.q)return;this.q=!0;const e=new Set(["ALT","LALT","RALT","CONTROL","LCTRL","RCTRL","SHIFT"]),t={common:new Set,letters:new Set,numbers:new Set,function:new Set,arrows:new Set,symbols:new Set,numpad:new Set,mouse:new Set,gamepad:new Set};Le.forEach(i=>{if(e.has(i.toUpperCase()))return;const a=i.toUpperCase();/^[A-Z]$/.test(i)?t.letters.add(i):/^[0-9]$/.test(i)?t.numbers.add(i):/^F\d+$/.test(a)?t.function.add(i):["UP","DOWN","LEFT","RIGHT"].includes(a)?t.arrows.add(i):a.startsWith("NUMPAD")||["DECIMAL","DIVIDE","MULTIPLY","SUBTRACT","ADD","NUMPADENTER"].includes(a)?t.numpad.add(i):/^(BUTTON\d+|LBUTTON|RBUTTON|MIDDLECLICK|WHEELPLUS|WHEELMINUS)$/i.test(i)?t.mouse.add(i):/^(JOY\d+|LSTICK_|RSTICK_|JOYPAD_)/i.test(i)?t.gamepad.add(i):/^[\[\]\\,\.\/'-]$/.test(i)||"`"===i?t.symbols.add(i):t.common.add(i)}),Object.keys(t).forEach(e=>{t[e]=Array.from(t[e])})}updateKeyPreview(){const e=Array.from(this.document.querySelectorAll(".modifier-btn")).filter(e=>"true"===e.dataset.selected).map(e=>e.dataset.modifier),t=this.document.querySelector(".key-item.selected"),i=t?.dataset?.key;if(!i){const e=this.document.getElementById("keyPreviewDisplay");e&&(e.innerHTML='<span class="no-selection" data-i18n="no_key_selected">No key selected</span>');const t=this.document.getElementById("confirmKeySelection");return t&&(t.disabled=!0),void(this.selectedKey=null)}const a=[...e,i].join("+"),n=this.document.getElementById("keyPreviewDisplay");n&&(n.innerHTML=`<span class="key-combination">${a}</span>`);const s=this.document.getElementById("confirmKeySelection");s&&(s.disabled=!1),this.selectedKey=a}populateModifierButtons(){const e=this.document.querySelector(".modifier-buttons");e&&(e.innerHTML="",Le.filter(e=>["ALT","LALT","RALT","CONTROL","LCTRL","RCTRL","SHIFT"].includes(e.toUpperCase())).forEach(t=>{const i=this.document.createElement("button");i.className="modifier-btn",i.dataset.modifier=t,i.dataset.selected="false",i.textContent=t,e.appendChild(i)}))}}class Ue extends re{constructor(e,t){super(e),this.componentName="VFXManagerUI",this.modalManager=t,this.isInitialized=!1,this.vfxManager=null}async init(){this.isInitialized?console.log(`[${this.componentName}] Already initialized`):(this.setupEventListeners(),this.isInitialized=!0,console.log(`[${this.componentName}] Initialized`))}setupEventListeners(){this.eventBus.on("vfx:modal-populate",this.handleModalPopulate.bind(this)),this.setupDOMEventListeners()}handleModalPopulate({vfxManager:e}){console.log(`[${this.componentName}] Populating VFX modal`),this.vfxManager=e,this.populateModal(),this.modalManager.show("vertigoModal")}populateModal(){if(!this.vfxManager)return;const e=document.getElementById("spaceEffectsList");e&&(e.innerHTML="",VFX_EFFECTS.space.forEach(t=>{const i=this.createEffectItem("space",t);e.appendChild(i)}));const t=document.getElementById("groundEffectsList");t&&(t.innerHTML="",VFX_EFFECTS.ground.forEach(e=>{const i=this.createEffectItem("ground",e);t.appendChild(i)})),this.updateCheckboxes("space"),this.updateCheckboxes("ground");const i=document.getElementById("vertigoShowPlayerSay");i&&(i.checked=this.vfxManager.showPlayerSay),this.updateEffectCounts(),this.updatePreview()}createEffectItem(e,t){const i=document.createElement("div");i.className="effect-item";const a=this.vfxManager.isEffectSelected(e,t.effect);return i.innerHTML=`\n      <label class="effect-label">\n        <input type="checkbox" \n               class="effect-checkbox" \n               data-environment="${e}" \n               data-effect="${t.effect}"\n               ${a?"checked":""}>\n        <span class="effect-name">${t.label}</span>\n      </label>\n    `,i}updateCheckboxes(e){document.querySelectorAll(`input[data-environment="${e}"]`).forEach(t=>{const i=t.dataset.effect;t.checked=this.vfxManager.isEffectSelected(e,i)})}updateEffectCounts(){const e=this.vfxManager.getEffectCount("space"),t=document.getElementById("spaceEffectCount");t&&(t.textContent=e);const i=this.vfxManager.getEffectCount("ground"),a=document.getElementById("groundEffectCount");a&&(a.textContent=i)}updatePreview(){const e=document.getElementById("spaceAliasCommand");if(e&&this.vfxManager){const t=this.vfxManager.generateAlias("space");e.textContent=t||"No space effects selected"}const t=document.getElementById("groundAliasCommand");if(t&&this.vfxManager){const e=this.vfxManager.generateAlias("ground");t.textContent=e||"No ground effects selected"}}setupDOMEventListeners(){document.addEventListener("change",e=>{if(e.target.classList.contains("effect-checkbox")){const t=e.target.dataset.environment,i=e.target.dataset.effect;this.vfxManager&&(this.vfxManager.toggleEffect(t,i),this.updateEffectCounts(),this.updatePreview())}}),document.addEventListener("change",e=>{"vertigoShowPlayerSay"===e.target.id&&this.vfxManager&&(this.vfxManager.showPlayerSay=e.target.checked,this.updatePreview())}),this.eventBus.onDom("spaceSelectAll","click","vfx-space-select-all",()=>{this.vfxManager&&(this.vfxManager.selectAllEffects("space"),this.updateCheckboxes("space"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("spaceClearAll","click","vfx-space-clear-all",()=>{this.vfxManager&&(this.vfxManager.selectedEffects.space.clear(),this.updateCheckboxes("space"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("groundSelectAll","click","vfx-ground-select-all",()=>{this.vfxManager&&(this.vfxManager.selectAllEffects("ground"),this.updateCheckboxes("ground"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("groundClearAll","click","vfx-ground-clear-all",()=>{this.vfxManager&&(this.vfxManager.selectedEffects.ground.clear(),this.updateCheckboxes("ground"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("saveVertigoBtn","click","vfx-save",()=>{this.emit("vfx:save-effects")})}}class qe extends re{constructor({eventBus:e=r,app:t=null,modalManager:i=null,document:a=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="KeyBrowserUI",this.app=t||(void 0!==window.app?window.app:null),this.modalManager=i||("undefined"!=typeof window?window.modalManager:null),this.document=a,this.P="space"}onInit(){this.V=null,this.P=null,this.eventBus.on("key:list-changed",()=>this.render()),this.eventBus.on("key-selected",e=>{this.V=e.key||e.name,this.render()}),this.eventBus.on("environment:changed",(e={})=>{console.log("[KeyBrowserUI] environment:changed event received:",e);const t="string"==typeof e?e:e.environment||e.newMode||e.mode;console.log("[KeyBrowserUI] parsed environment:",t),t&&(this.P=t,console.log("[KeyBrowserUI] calling toggleVisibility with env:",t),this.toggleVisibility(t),"alias"!==t&&this.render())}),this.addEventListener("key-view:toggle",()=>this.toggleKeyView()),this.addEventListener("key-view:update-toggle",e=>this.updateViewToggleButton(e?.viewMode)),this.addEventListener("keys:filter",e=>{const t="string"==typeof e?e:e?.value||"";this.filterKeys(t)}),this.addEventListener("commands:filter",e=>{const t="string"==typeof e?e:e?.value||"";this.filterCommands(t)}),this.addEventListener("keys:show-all",()=>this.showAllKeys()),this.addEventListener("key-view:mode-changed",()=>this.render());const e=localStorage.getItem("keyViewMode")||"grid";this.updateViewToggleButton(e),this.setupEventListeners()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addKeyBtn","click","key-add",()=>{this.showKeySelectionModal()}),this.eventBus.onDom("deleteKeyBtn","click","key-delete",()=>{this.V&&this.confirmDeleteKey(this.V)}),this.eventBus.onDom("duplicateKeyBtn","click","key-duplicate",()=>{this.V&&this.duplicateKey(this.V)}),this.eventBus.onDomDebounced("keyFilter","input","key-filter",e=>{this.filterKeys(e.target.value)},250),this.eventBus.onDom("keyFilter","keydown","key-filter-key",e=>{if("Escape"===e.key){e.preventDefault();const t=e.target;t.value="",t.classList.remove("expanded"),this.emit("key:filter",{filter:""})}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllKeysBtn","click","show-all-keys",()=>{this.showAllKeys()}),this.eventBus.onDom("toggleKeyViewBtn","click","toggle-key-view",()=>{this.toggleKeyView()}),this.eventBus.onDom("keySearchBtn","click","key-search-toggle",()=>{this.toggleKeySearch()}),this.addEventListener("key-selected",({key:e}={})=>{this.V=e,this.render()}),this.addEventListener("profile:switched",({profileId:e,environment:t}={})=>{this.C=e,this.P=t,this.render()}),this.addEventListener("environment:changed",({environment:e}={})=>{this.P=e,this.render()}))}async render(){const e=this.document.getElementById("keyGrid");if(!e)return;const t=await this.request("key:get-profile");if(!t)return void(e.innerHTML=`<div class="empty-state"><i class="fas fa-folder-open"></i><h4>${i18next.t("no_profile_selected")||"No Profile Selected"}</h4></div>`);const i=await this.request("key:get-all");this.G=i;const a=Object.keys(i),n={};a.forEach(e=>{const t=i[e];t&&t.length>0&&(n[e]=t)});const s=[...new Set([...a,...Object.keys(n)])];e.innerHTML="";const o=localStorage.getItem("keyViewMode")||"grid";"key-types"===o?this.renderKeyTypeView(e,t,s):"grid"===o?this.renderSimpleGridView(e,s):await this.renderCommandCategoryView(e,n,s)}renderSimpleGridView(e,t){e.classList.remove("categorized"),t.sort(this.compareKeys.bind(this)).forEach(t=>{const i=this.createKeyElement(t);e.appendChild(i)})}async renderCommandCategoryView(e,t,i){e.classList.add("categorized");const a=await this.categorizeKeys(t,i);Object.entries(a).sort(([e,t],[i,a])=>t.priority!==a.priority?t.priority-a.priority:t.name.localeCompare(a.name)).forEach(([t,i])=>{const a=this.createKeyCategoryElement(t,i);e.appendChild(a)})}renderKeyTypeView(e,t,i){e.classList.add("categorized");const a=this.categorizeKeysByType(this.G,i);Object.entries(a).sort(([,e],[,t])=>e.priority-t.priority).forEach(([t,i])=>{const a=this.createKeyCategoryElement(t,i,"key-type");e.appendChild(a)})}async categorizeKeys(e,t){const i={unknown:{name:"Unknown",icon:"fas fa-question-circle",keys:new Set,priority:0}};return Object.entries(STO_DATA.commands).forEach(([e,t])=>{i[e]={name:t.name,icon:t.icon,keys:new Set,priority:1}}),await Promise.all(t.map(async t=>{const a=e[t]||[];if(!a||0===a.length)return void i.unknown.keys.add(t);const n=new Set;await Promise.all(a.map(async e=>{const t=e.category||e.type;if(t&&i[t])n.add(t);else try{const t=await this.request("parser:parse-command-string",{commandString:e.command,options:{generateDisplayText:!1}});if(t.commands&&t.commands.length>0){const e=t.commands[0].category;i[e]&&n.add(e)}}catch(e){i.custom||(i.custom={name:"Custom Commands",icon:"fas fa-cog",keys:new Set,priority:2})}})),n.size>0?n.forEach(e=>i[e].keys.add(t)):(i.custom||(i.custom={name:"Custom Commands",icon:"fas fa-cog",keys:new Set,priority:2}),i.custom.keys.add(t))})),Object.values(i).forEach(e=>{e.keys=Array.from(e.keys).sort(this.compareKeys.bind(this))}),i}detectKeyTypes(e){const t=[];return/^F[0-9]+$/.test(e)&&t.push("function"),/^[A-Z0-9]$/.test(e)&&t.push("alphanumeric"),/^NUMPAD/.test(e)&&t.push("numberpad"),/(Ctrl|Alt|Shift)/.test(e)&&t.push("modifiers"),/(UP|DOWN|LEFT|RIGHT|HOME|END|PGUP|PGDN)/.test(e)&&t.push("navigation"),/(ESC|TAB|CAPS|PRINT|SCROLL|PAUSE|Space|Enter|Escape)/.test(e)&&t.push("system"),/MOUSE|WHEEL/.test(e)&&t.push("mouse"),0===t.length&&/[^A-Za-z0-9]/.test(e)&&t.push("symbols"),0===t.length&&t.push("other"),t}categorizeKeysByType(e,t){const i={function:{name:"Function Keys",icon:"fas fa-keyboard",keys:new Set,priority:1},alphanumeric:{name:"Letters & Numbers",icon:"fas fa-font",keys:new Set,priority:2},numberpad:{name:"Numberpad",icon:"fas fa-calculator",keys:new Set,priority:3},modifiers:{name:"Modifier Keys",icon:"fas fa-hand-paper",keys:new Set,priority:4},navigation:{name:"Navigation",icon:"fas fa-arrows-alt",keys:new Set,priority:5},system:{name:"System Keys",icon:"fas fa-cogs",keys:new Set,priority:6},mouse:{name:"Mouse & Wheel",icon:"fas fa-mouse",keys:new Set,priority:7},symbols:{name:"Symbols & Punctuation",icon:"fas fa-at",keys:new Set,priority:8},other:{name:"Other Keys",icon:"fas fa-question-circle",keys:new Set,priority:9}};return t.forEach(e=>{this.detectKeyTypes(e).forEach(t=>(i[t]||i.other).keys.add(e))}),Object.values(i).forEach(e=>{e.keys=Array.from(e.keys).sort(this.compareKeys.bind(this))}),i}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const n=/^\d+$/.test(e),s=/^\d+$/.test(t);if(n&&s)return parseInt(e)-parseInt(t);if(n&&!s)return-1;if(!n&&s)return 1;const o=/^[A-Z]$/.test(e),r=/^[A-Z]$/.test(t);if(o&&r)return e.localeCompare(t);if(o&&!r)return-1;if(!o&&r)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}formatKeyName(e){return e.replace(/\+/g,"<br>+")}createKeyElement(e){const t=this.G||{},i=t&&t[e]?t[e]:[],a=e===this.V,n=i.filter(e=>"string"==typeof e?""!==e.trim():!(!e||"string"!=typeof e.command)&&""!==e.command.trim()),s=this.document.createElement("div");s.className="key-item "+(a?"active":""),s.dataset.key=e,s.title=`${e}: ${n.length} command${1!==n.length?"s":""}`;const o=this.formatKeyName(e),c=e.length,l=c<=3?"short":c<=5?"medium":c<=8?"long":"extra-long";return s.dataset.length=l,s.innerHTML=`<div class="key-label">${o}</div>${n.length>0?`<div class="activity-bar" style="width:${Math.min(15*n.length,100)}%"></div><div class="command-count-badge">${n.length}</div>`:""}`,s.addEventListener("click",()=>{ne(r,"key:select",{key:e})}),s}createKeyCategoryElement(e,t,i="command"){const a=this.document.createElement("div");a.className="category",a.dataset.category=e;const n="key-type"===i?`keyTypeCategory_${e}_collapsed`:`keyCategory_${e}_collapsed`,s="true"===localStorage.getItem(n);a.innerHTML=`<h4 class="${s?"collapsed":""}" data-category="${e}" data-mode="${i}"><i class="fas fa-chevron-right category-chevron"></i><i class="${t.icon}"></i>${t.name}<span class="key-count">(${t.keys.length})</span></h4><div class="category-commands ${s?"collapsed":""}">${t.keys.map(e=>this.createKeyElement(e).outerHTML).join("")}</div>`,a.querySelector("h4").addEventListener("click",()=>this.toggleKeyCategory(e,a,i));const o=a.querySelector(".category-commands");return o.innerHTML="",t.keys.forEach(e=>o.appendChild(this.createKeyElement(e))),a}toggleKeyCategory(e,t,i="command"){const a="key-type"===i?`keyTypeCategory_${e}_collapsed`:`keyCategory_${e}_collapsed`,n=t.querySelector("h4").classList.toggle("collapsed");t.querySelector(".category-commands").classList.toggle("collapsed"),localStorage.setItem(a,n)}updateViewToggleButton(e){const t=this.document.getElementById("toggleKeyViewBtn");if(!t)return;const i=t.querySelector("i")||t;"categorized"===e?(i.className="fas fa-sitemap",t.title="undefined"!=typeof i18next?i18next.t("switch_to_key_type_view"):"Switch to key type view"):"key-types"===e?(i.className="fas fa-th",t.title="undefined"!=typeof i18next?i18next.t("switch_to_grid_view"):"Switch to grid view"):(i.className="fas fa-list",t.title="undefined"!=typeof i18next?i18next.t("switch_to_command_categories"):"Switch to command categories")}toggleKeyView(){if(this.app&&"alias"===this.app.currentEnvironment)return;const e=localStorage.getItem("keyViewMode")||"grid";let t;t="key-types"===e?"grid":"grid"===e?"categorized":"key-types",localStorage.setItem("keyViewMode",t),this.render(),this.updateViewToggleButton(t),this.emit("key-view:mode-changed",{mode:t})}filterKeys(e=""){const t=(e||"").toString().toLowerCase();this.document.querySelectorAll(".key-item").forEach(e=>{const i=(e.dataset.key||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),this.document.querySelectorAll(".command-item[data-key]").forEach(e=>{const i=(e.dataset.key||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),this.document.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item[data-key]:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"})}filterCommands(e=""){const t=(e||"").toString().toLowerCase();this.document.querySelectorAll(".command-item").forEach(e=>{const i=(e.textContent||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),this.document.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"})}showAllKeys(){this.document.querySelectorAll(".key-item").forEach(e=>{e.style.display="flex"}),this.document.querySelectorAll(".command-item[data-key]").forEach(e=>{e.style.display="flex"}),this.document.querySelectorAll(".category").forEach(e=>{e.style.display="block"});const e=this.document.getElementById("keyFilter");e&&(e.value="")}toggleVisibility(e){const t=()=>{const i=this.document.querySelector(".key-selector-container");i?"alias"!==e?i.style.removeProperty("display"):i.style.setProperty("display","none","important"):setTimeout(t,10)};requestAnimationFrame(t)}handleInitialState(e,t){if(!t)return;const i=t.environment||t.currentEnvironment;i&&(this.P=i,this.toggleVisibility(i),"alias"!==i&&this.render())}showKeySelectionModal(){this.modalManager&&this.modalManager.show("keySelectionModal")}async confirmDeleteKey(e){if(!e)return;const t=this.i18n?.t?.("confirm_delete_key",{key:e})||`Delete key ${e}?`;if(confirm(t))try{return this.emit("key:delete",{key:e}),!0}catch(e){return console.error("Error deleting key:",e),this.ui?.showToast&&this.ui.showToast("Failed to delete key","error"),!1}return!1}duplicateKey(e){e&&this.emit("key:duplicate",{key:e})}toggleKeySearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("keyFilter");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}}class Ve{constructor(e=null,t={}){this.eventBus=e,this.options={enableCache:!0,maxCacheSize:1e3,enablePerformanceMetrics:!1,hotPathThreshold:10,...t},this.parseCache=new Map,this.hotPathCache=new Map,this.frequencyTracker=new Map,this.performanceMetrics=new Map,this.signatures=this.initializeCommandSignatures(),this.eventBus&&this.setupRequestHandlers()}setupRequestHandlers(){se(this.eventBus,"parser:parse-command-string",({commandString:e,options:t})=>this.parseCommandString(e,t)),se(this.eventBus,"parser:validate-command",({signature:e,commandString:t})=>this.validateCommand(e,t)),se(this.eventBus,"parser:get-command-signature",({commandString:e})=>this.getCommandSignature(e)),se(this.eventBus,"parser:extract-parameters",({signature:e,commandString:t})=>this.extractParameters(e,t)),se(this.eventBus,"parser:get-performance-metrics",()=>Array.from(this.performanceMetrics.entries())),se(this.eventBus,"parser:clear-cache",()=>(this.parseCache.clear(),this.hotPathCache.clear(),this.frequencyTracker.clear(),{success:!0}))}initializeCommandSignatures(){return{TrayExecution:{patterns:[{regex:/^(\+?(?:STO)?TrayExecByTray)\s+(\d+)\s+(\d+)$/i,weight:100,signature:"TrayExecByTray(tray: number, slot: number)",extractParams:e=>({tray:parseInt(e[2]),slot:parseInt(e[3]),baseCommand:e[1]}),generateDisplayText:e=>`Execute Tray ${e.tray+1} Slot ${e.slot+1}`}],category:"tray",baseCommand:"TrayExecByTray",icon:"⚡"},TrayWithBackup:{patterns:[{regex:/^TrayExecByTrayWithBackup\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)$/i,weight:90,signature:"TrayExecByTrayWithBackup(active: number, tray: number, slot: number, backup_tray: number, backup_slot: number)",extractParams:e=>({active:parseInt(e[1]),tray:parseInt(e[2]),slot:parseInt(e[3]),backup_tray:parseInt(e[4]),backup_slot:parseInt(e[5])}),generateDisplayText:e=>`Tray Backup (${e.tray+1}.${e.slot+1} → ${e.backup_tray+1}.${e.backup_slot+1})`}],category:"tray",baseCommand:"TrayExecByTrayWithBackup",icon:"🔄"},Communication:{patterns:[{regex:/^(say|team|zone|tell)\s+"([^"]+)"$/i,weight:70,signature:"Communication(verb: string, message: string)",extractParams:e=>({verb:e[1],message:e[2]}),generateDisplayText:e=>`${e.verb}: "${e.message}"`},{regex:/^(say|team|zone|tell)\s+(.+)$/i,weight:65,signature:"Communication(verb: string, message: string)",extractParams:e=>({verb:e[1],message:e[2]}),generateDisplayText:e=>`${e.verb}: ${e.message}`}],category:"communication",baseCommand:"Communication",icon:"💬"},TargetWithName:{patterns:[{regex:/^Target\s+"([^"]+)"$/i,weight:60,signature:"Target(entityName: string)",extractParams:e=>({entityName:e[1]}),generateDisplayText:e=>`Target "${e.entityName}"`}],category:"targeting",baseCommand:"Target",icon:"🎯"},VFXCommands:{patterns:[{regex:/^dynFxSetFXExlusionList\s+(.+)$/i,weight:50,signature:"VFXExclusion(effects: string)",extractParams:e=>({effects:e[1]}),generateDisplayText:e=>`VFX Exclude: ${e.effects}`},{regex:/^dynFxSetFXExlusionList_(.+)$/i,weight:49,signature:"VFXExclusionAlias(aliasName: string)",extractParams:e=>({aliasName:e[1]}),generateDisplayText:e=>`VFX Alias: ${e.aliasName}`}],category:"vfx",baseCommand:"VFXControl",icon:"✨"},StaticCombat:{patterns:[{regex:/^(FireAll|FirePhasers|FireTorps|FireMines|FirePhasersTorps|FireProjectiles)$/i,weight:40,signature:"StaticCombat()",extractParams:e=>({commandName:e[1]}),generateDisplayText:e=>this.getStaticCombatDisplayName(e.commandName)}],category:"combat",baseCommand:"StaticCombat",icon:"🔥"},StaticTargeting:{patterns:[{regex:/^(Target_Enemy_Near|Target_Friend_Near|Target_Self|Target_Clear|Target_Teammate\s+\d+)$/i,weight:35,signature:"StaticTargeting()",extractParams:e=>({commandName:e[1]}),generateDisplayText:e=>this.getStaticTargetingDisplayName(e.commandName)}],category:"targeting",baseCommand:"StaticTargeting",icon:"🎯"},PowerCommands:{patterns:[{regex:/^\+power_exec\s+(.+)$/i,weight:30,signature:"PowerExec(powerName: string)",extractParams:e=>({powerName:e[1]}),generateDisplayText:e=>`Power: ${e.powerName}`}],category:"power",baseCommand:"PowerExec",icon:"🔋"},MovementCommands:{patterns:[{regex:/^\+(fullimpulse|reverse|turn_left|turn_right|up|down|left|right|forward|backward)$/i,weight:25,signature:"Movement(direction: string)",extractParams:e=>({direction:e[1]}),generateDisplayText:e=>`Movement: ${e.direction}`}],category:"movement",baseCommand:"Movement",icon:"🚀"},SystemCommands:{patterns:[{regex:/^(screenshot|interactwindow|\+gentoggle.*)$/i,weight:20,signature:"System(command: string)",extractParams:e=>({command:e[1]}),generateDisplayText:e=>`System: ${e.command}`}],category:"system",baseCommand:"System",icon:"⚙️"},CameraCommands:{patterns:[{regex:/^(.*cam.*|.*look.*|.*zoom.*)$/i,weight:15,signature:"Camera(command: string)",extractParams:e=>({command:e[1]}),generateDisplayText:e=>`Camera: ${e.command}`}],category:"camera",baseCommand:"Camera",icon:"📹"}}}parseCommandString(e,t={}){const i=performance.now();if(this.trackCommandFrequency(e),this.hotPathCache.has(e))return this.updateMetrics("hotpath_hit",i),this.hotPathCache.get(e);if(this.options.enableCache&&this.parseCache.has(e))return this.updateMetrics("cache_hit",i),this.parseCache.get(e);const a=e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e),n=a.map((e,i)=>this.parseIndividualCommand(e,i,t)),s={originalString:e,commands:n,isMirrored:this.detectMirroring(a),parseTime:performance.now()-i,metadata:{totalCommands:n.length,cacheStatus:"miss",parseMethod:"signature-based"}};return this.options.enableCache&&this.cacheResult(e,s),this.updateMetrics("parse_complete",i),s}parseIndividualCommand(e,t,i={}){const a=Object.entries(this.signatures).sort((e,t)=>{const i=Math.max(...e[1].patterns.map(e=>e.weight));return Math.max(...t[1].patterns.map(e=>e.weight))-i});for(const[n,s]of a)for(const a of s.patterns){const o=e.match(a.regex);if(o){const r=a.extractParams(o),c=!1!==i.generateDisplayText&&a.generateDisplayText?a.generateDisplayText(r):e;return{command:e,signature:a.signature,category:s.category,baseCommand:s.baseCommand,icon:s.icon,parameters:r,displayText:c,matchPattern:a,id:`parsed_${Date.now()}_${t}`,parseMetadata:{signatureName:n,patternWeight:a.weight,matchTime:performance.now()}}}}return{command:e,signature:"UnknownCommand(command: string)",category:"custom",baseCommand:"Custom",icon:"⚙️",parameters:{command:e},displayText:e,id:`unknown_${Date.now()}_${t}`,parseMetadata:{signatureName:"fallback",patternWeight:0,matchTime:performance.now()}}}trackCommandFrequency(e){const t=this.frequencyTracker.get(e)||0;if(this.frequencyTracker.set(e,t+1),t>=this.options.hotPathThreshold&&!this.hotPathCache.has(e)){const t=this.options.hotPathThreshold;this.options.hotPathThreshold=1/0;const i=this.parseCommandString(e);this.hotPathCache.set(e,i),this.options.hotPathThreshold=t}}detectMirroring(e){if(e.length<=1)return!1;if(e.length<3||e.length%2==0)return!1;const t=Math.floor(e.length/2),i=e.slice(0,t+1),a=e.slice(t+1),n=i.slice(0,-1).reverse();return a.length===n.length&&a.every((e,t)=>e.trim()===n[t].trim())}cacheResult(e,t){if(this.parseCache.size>=this.options.maxCacheSize){const e=this.parseCache.keys().next().value;this.parseCache.delete(e)}this.parseCache.set(e,t)}updateMetrics(e,t){if(!this.options.enablePerformanceMetrics)return;const i=performance.now()-t,a=this.performanceMetrics.get(e)||{count:0,totalTime:0,avgTime:0};a.count++,a.totalTime+=i,a.avgTime=a.totalTime/a.count,this.performanceMetrics.set(e,a)}validateCommand(e,t){return this.parseCommandString(t).commands.some(t=>t.signature===e)}getCommandSignature(e){return this.parseCommandString(e).commands.map(e=>e.signature)}extractParameters(e,t){const i=this.parseCommandString(t).commands.find(t=>t.signature===e);return i?i.parameters:{}}getStaticCombatDisplayName(e){return{FireAll:"Fire All Weapons",FirePhasers:"Fire Energy Weapons",FireTorps:"Fire Torpedoes",FireMines:"Fire Mines",FirePhasersTorps:"Fire Phasers & Torpedoes",FireProjectiles:"Fire Projectiles"}[e]||e}getStaticTargetingDisplayName(e){if(e.startsWith("Target_Teammate")){const t=e.match(/Target_Teammate\s+(\d+)/);return t?`Target Teammate ${t[1]}`:e}return{Target_Enemy_Near:"Target Nearest Enemy",Target_Friend_Near:"Target Nearest Friend",Target_Self:"Target Self",Target_Clear:"Clear Target"}[e]||e}static createStandalone(e={}){return new Ve(null,e)}}const Ge=Ve.createStandalone(),We=(()=>{const e=function(){const e=new Set;return Object.values(Ge.signatures).forEach(t=>{"vfx"===(t.category||"").toLowerCase()||(t.baseCommand&&e.add(t.baseCommand.toLowerCase()),Array.isArray(t.patterns)&&t.patterns.forEach(t=>{const i=t.regex?.source?.match(/^\^\(([^)]+)\)/);i&&i[1].split("|").forEach(t=>e.add(t.toLowerCase()))}))}),e}();return Object.values(je).forEach(t=>{(t.parameters?.command_type?.options||t.parameters?.verb?.options||[]).forEach(t=>e.add(t.toLowerCase()))}),e})(),Xe=/^[A-Za-z][A-Za-z0-9_]*$/;function He(e=""){return Xe.test(e)}function Ze(e=""){return!!He(e)&&!We.has(e.toLowerCase())}class Je extends re{constructor({eventBus:e=r,modalManager:t=null,document:i=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="AliasBrowserUI",this.modalManager=t||("undefined"!=typeof window?window.modalManager:null),this.document=i}async onInit(){this.W=null,this.setupEventListeners(),this.eventBus.on("aliases-changed",()=>{console.log("[AliasBrowserUI] aliases-changed event received, calling render()"),this.render()}),this.eventBus.on("alias-selected",e=>{"undefined"!=typeof window&&console.log("[AliasBrowserUI] alias-selected event received. data:",e,`setting _selectedAliasName to: ${e.name}`),this.W=e.name,"undefined"!=typeof window&&console.log("[AliasBrowserUI] calling render() after alias-selected. _selectedAliasName:",this.W),this.render()}),this.addEventListener("profile:switched",({profileId:e,environment:t}={})=>{this.W=null,this.render()}),this.eventBus.on("environment:changed",(e={})=>{const t="string"==typeof e?e:e.environment||e.newMode||e.mode;console.log("[AliasBrowserUI] environment:changed event received:",e,"parsed env:",t),this.toggleVisibility(t)}),await this.render()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addAliasChainBtn","click","alias-chain-add",()=>{this.createAliasModal()}),this.eventBus.onDom("deleteAliasChainBtn","click","alias-chain-delete",()=>{this.W&&this.confirmDeleteAlias(this.W)}),this.eventBus.onDom("duplicateAliasChainBtn","click","alias-chain-duplicate",()=>{this.W&&this.duplicateAlias(this.W)}),this.eventBus.onDom("aliasOptionsDropdown","click","alias-options-toggle",e=>{e.stopPropagation(),this.toggleAliasOptionsDropdown()}),["aliasStabilizeOption","aliasToggleOption","aliasCycleOption"].forEach(e=>{this.eventBus.onDom(e,"change",`alias-option-${e}`,()=>{this.updateAliasOptionsLabel()})}),this.eventBus.onDomDebounced("aliasFilter","input","alias-filter",e=>{this.filterAliases(e.target.value)},250),this.eventBus.onDom("aliasFilter","keydown","alias-filter-key",e=>{if("Escape"===e.key){const t=e.target;t.value="",t.classList.remove("expanded"),this.filterAliases("")}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllAliasesBtn","click","alias-show-all",()=>{const e=this.document.getElementById("aliasFilter");e&&(e.value=""),this.filterAliases("")}),this.eventBus.onDom("aliasSearchBtn","click","alias-search-toggle",()=>{this.toggleAliasSearch()}))}confirmDeleteAlias(e){if(!e)return;const t=Y.t("confirm_delete_alias",{alias:e})||`Delete alias ${e}?`;confirm(t)&&this.emit("alias:delete",{name:e})}async duplicateAlias(e){if(!e||!this.modalManager)return;const t=await this.request("alias:get-all"),i=function(e,t={}){let i=`${e}_copy`,a=i,n=1;for(;t[a];)a=`${i}${n}`,n++;return a}(e,t),a=this.document.getElementById("aliasDuplicateModal");if(!a)return;const n=a.querySelector("#duplicateAliasNameInput"),s=a.querySelector("#confirmDuplicateAliasBtn"),o=a.querySelector("#duplicateAliasValidation"),r=()=>{const e=(n.value||"").trim(),i=t[e];let a=null;e&&He(e)?Ze(e)?i&&(a="alias_name_in_use"):a="reserved_command_name":a="invalid_alias_name",o.textContent=a?Y.t(a):"";const r=!!a;o.style.display=r?"":"none",s.disabled=r};n.value=i,o.style.display="none";const c=()=>r();n.removeEventListener("input",c),n.addEventListener("input",c),s.onclick=()=>{const i=n.value.trim();i&&!t[i]&&(this.modalManager.hide("aliasDuplicateModal"),this.emit("alias:duplicate",{from:e,to:i}))},this.modalManager.show("aliasDuplicateModal"),r()}toggleAliasOptionsDropdown(){const e=this.document.getElementById("aliasOptionsDropdown");e&&e.classList.toggle("active")}updateAliasOptionsLabel(){const e=this.document.getElementById("aliasStabilizeOption")?.checked,t=this.document.getElementById("aliasToggleOption")?.checked,i=this.document.getElementById("aliasCycleOption")?.checked;this.emit("alias:options-changed",{stabilize:e,toggle:t,cycle:i})}async render(){const e=this.document.getElementById("aliasGrid");if(!e)return;const t=await this.request("alias:get-all"),i=Object.entries(t);0!==i.length?(e.classList.remove("categorized"),e.innerHTML=i.map(([e,t])=>this.createAliasElement(e,t)).join(""),e.querySelectorAll(".alias-item").forEach(e=>{e.addEventListener("click",()=>{ne(this.eventBus,"alias:select",{name:e.dataset.alias}),this.emit("alias-browser/alias-clicked",{name:e.dataset.alias})})})):e.innerHTML=`\n        <div class="empty-state">\n          <i class="fas fa-mask"></i>\n          <h4 data-i18n="no_aliases_defined">${Y.t("no_aliases_defined")}</h4>\n          <p data-i18n="create_alias_to_get_started">${Y.t("create_alias_to_get_started")}</p>\n        </div>`}createAliasElement(e,t){const i="string"==typeof t.commands&&t.commands.trim()?t.commands.trim().split(/\s*\$\$/).length:0,a=(this.W||null)===e,n=t.description||"";return`\n      <div class="alias-item ${a?"active":""}" data-alias="${e}" data-length="${e.length<=8?"short":e.length<=12?"medium":e.length<=16?"long":"extra-long"}" title="${n}">\n        <div class="alias-name">${e}</div>\n        <div class="alias-command-count">${i} <span data-i18n="commands">${Y.t("commands")}</span></div>\n      </div>`}toggleVisibility(e){const t=this.document.getElementById("aliasSelectorContainer")||this.document.getElementById("aliasGrid")?.parentElement?.parentElement;if(!t)return;const i="alias"===e;console.log("[AliasBrowserUI] toggleVisibility called with env:",e,"shouldShow:",i,"container exists:",!!t),t.style.display=i?"":"none"}handleInitialState(e,t){if(t&&(t.environment||t.currentEnvironment)){const i=t.environment||t.currentEnvironment;console.log("[AliasBrowserUI] handleInitialState from",e,"environment:",i),this.toggleVisibility(i)}}async createAliasModal(){if(!this.modalManager)return;const e=await this.request("alias:get-all"),t=this.document.getElementById("aliasCreationModal");if(!t)return;const i=t.querySelector("#newAliasNameInput"),a=t.querySelector("#confirmCreateAliasBtn"),n=t.querySelector("#createAliasValidation"),s=()=>{const t=(i.value||"").trim();let s=null;t&&He(t)?Ze(t)?e[t]&&(s="alias_name_in_use"):s="reserved_command_name":s="invalid_alias_name",n.textContent=s?Y.t(s):"";const o=!!s;n.style.display=o?"":"none",a.disabled=o};i.value="",n.style.display="none",i.removeEventListener("input",s),i.addEventListener("input",s),a.onclick=()=>{const e=i.value.trim();e&&(this.modalManager.hide("aliasCreationModal"),this.emit("alias:create",{name:e}))},this.modalManager.show("aliasCreationModal"),s()}filterAliases(e=""){const t=(e||"").toString().toLowerCase();this.document.querySelectorAll(".alias-item").forEach(e=>{const i=(e.dataset.alias||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"})}toggleAliasSearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("aliasFilter");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}}class Ye extends re{constructor({eventBus:e,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="HeaderMenuUI",this.document=t}onInit(){this.setupEventListeners()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("settingsBtn","click","settings-toggle",()=>{this.toggleSettingsMenu()}),this.eventBus.onDom("importMenuBtn","click","import-toggle",()=>{this.toggleImportMenu()}),this.eventBus.onDom("backupMenuBtn","click","backup-toggle",()=>{this.toggleBackupMenu()}),this.eventBus.onDom("languageMenuBtn","click","language-toggle",()=>{this.toggleLanguageMenu()}),this.eventBus.onDom("vertigoBtn","click","vfx-open",()=>{this.emit("vfx:show-modal")}),this.eventBus.onDom("fileExplorerBtn","click","file-explorer-open",()=>{this.emit("file-explorer:open")}),this.eventBus.onDom("syncNowBtn","click","sync-now",()=>{this.emit("sync:sync-now")}),this.eventBus.onDom("preferencesBtn","click","preferences-open",()=>{this.emit("preferences:show")}),this.eventBus.onDom("aboutBtn","click","about-open",()=>{this.emit("about:show")}),this.document.addEventListener("click",e=>{e.target.closest(".dropdown")||this.document.querySelectorAll(".dropdown.active").forEach(e=>{e.classList.remove("active")})}),this.eventBus.onDom("openProjectBtn","click","project-open",()=>{this.emit("project:open")}),this.eventBus.onDom("saveProjectBtn","click","project-save",()=>{this.emit("project:save")}),this.eventBus.onDom("exportKeybindsBtn","click","keybinds-export",()=>{this.emit("keybinds:export")}),this.eventBus.onDom("importKeybindsBtn","click","keybinds-import",()=>{this.emit("keybinds:import")}),this.eventBus.onDom("importAliasesBtn","click","aliases-import",()=>{this.emit("aliases:import")}),this.eventBus.onDom("loadDefaultDataBtn","click","data-load-default",()=>{this.emit("data:load-default")}),this.eventBus.onDom("resetAppBtn","click","app-reset",()=>{this.confirmResetApp()}),this.document.querySelectorAll("[data-lang]").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest("[data-lang]"),i=t?t.getAttribute("data-lang"):null;i&&this.emit("language:change",{language:i})})}),this.eventBus.onDom("themeToggleBtn","click","theme-toggle",()=>{this.emit("theme:toggle")}))}toggleSettingsMenu(){this.toggleDropdown("settingsBtn")}toggleImportMenu(){this.toggleDropdown("importMenuBtn")}toggleBackupMenu(){this.toggleDropdown("backupMenuBtn")}toggleLanguageMenu(){this.toggleDropdown("languageMenuBtn")}toggleDropdown(e){const t=this.document.getElementById(e);if(!t)return;const i=t.closest(".dropdown");i&&(this.document.querySelectorAll(".dropdown.active").forEach(e=>{e!==i&&e.classList.remove("active")}),i.classList.toggle("active"))}closeAllMenus(){this.document.querySelectorAll(".dropdown.active").forEach(e=>{e.classList.remove("active")})}async confirmResetApp(){confirm("Are you sure you want to reset the application? This will clear all profiles and data.")&&this.emit("app:reset-confirmed")}}class Qe extends re{constructor({eventBus:e,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="AboutModalUI",this.document=t}onInit(){this.setupEventListeners(),this.populateAboutContent()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.on("about:show",()=>{this.showAboutModal()}),this.eventBus.on("modal:regenerated",({modalId:e})=>{"aboutModal"===e&&this.populateAboutContent()}))}showAboutModal(){this.populateAboutContent(),this.emit("modal:show",{modalId:"aboutModal"})}populateAboutContent(){const t=this.document.getElementById("aboutVersion");t&&(t.textContent=` v${e}`)}}class et extends re{constructor({storage:e,ui:t,eventBus:i}={}){super(i),this.componentName="AliasBrowserService",this.storage=e,this.ui=t,this.currentProfileId=null,this.currentEnvironment="space",this.selectedAliasName=null,this.X=null,this.cache={currentProfile:null,currentEnvironment:"space",aliases:{},profile:null},this.eventBus&&(this.respond("alias:get-all",()=>this.getAliases()),this.respond("alias:select",async({name:e})=>await this.selectAlias(e)),this.addEventListener("alias:delete",({name:e}={})=>this.deleteAlias(e)),this.addEventListener("alias:duplicate",({from:e,to:t,name:i}={})=>{if(e&&t)return this.duplicateAlias(e,t);const a=i||e;return this.duplicateAlias(a)}),this.addEventListener("alias:create",({name:e,description:t=""}={})=>this.createAlias(e,t)))}async init(){super.init(),this.setupEventListeners()}onInit(){}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{"undefined"!=typeof window&&console.log(`[AliasBrowserService] profile:updated received. profileId: ${e}, cache.currentProfile: ${this.cache.currentProfile}, match: ${e===this.cache.currentProfile}`),e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("aliases-changed",{aliases:this.cache.aliases}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{if(this.currentProfileId=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.selectedAliasName=null,this.X=null,this.updateCacheFromProfile(t),this.emit("aliases-changed",{aliases:this.cache.aliases}),"alias"===this.currentEnvironment&&!this.selectedAliasName){const e=Object.keys(this.cache.aliases);e.length&&this.selectAlias(e[0])}}),this.addEventListener("environment:changed",async e=>{const t="string"==typeof e?e:e?.environment;"undefined"!=typeof window&&console.log("[AliasBrowserService] environment:changed received. payload:",e,`parsed env: ${t}`),t&&("alias"===this.currentEnvironment&&this.selectedAliasName&&(this.X=this.selectedAliasName,"undefined"!=typeof window&&console.log(`[AliasBrowserService] Cached alias selection before leaving alias mode: ${this.selectedAliasName}`)),this.currentEnvironment=t,this.cache.currentEnvironment=t,"alias"===t?("undefined"!=typeof window&&console.log("[AliasBrowserService] Switching to alias mode, calling _restoreOrAutoSelectAlias() immediately"),await this.H()):(this.selectedAliasName=null,"undefined"!=typeof window&&console.log("[AliasBrowserService] Switching away from alias mode, cleared selectedAliasName")))})}updateCacheFromProfile(e){e?("undefined"!=typeof window&&console.log("[AliasBrowserService] updateCacheFromProfile called with profile:",e,"aliases:",e.aliases),this.cache.profile=e,this.cache.aliases=e.aliases||{},"undefined"!=typeof window&&console.log("[AliasBrowserService] cache updated. aliases:",this.cache.aliases,"keys:",Object.keys(this.cache.aliases))):"undefined"!=typeof window&&console.log("[AliasBrowserService] updateCacheFromProfile called with null/undefined profile")}async H(){"undefined"!=typeof window&&console.log(`[AliasBrowserService] _restoreOrAutoSelectAlias called. selectedAliasName: ${this.selectedAliasName}`);const e=this.getProfile(),t=e?.selections?.alias,i=this.getAliases();if(t&&i[t])return"undefined"!=typeof window&&console.log(`[AliasBrowserService] Restoring persisted alias selection: ${t}`),void await this.selectAlias(t);if(t&&"undefined"!=typeof window&&console.log(`[AliasBrowserService] Persisted alias ${t} no longer exists`),this.selectedAliasName)"undefined"!=typeof window&&console.log(`[AliasBrowserService] Alias already selected: ${this.selectedAliasName}`);else{const e=Object.keys(i);"undefined"!=typeof window&&console.log(`[AliasBrowserService] Auto-selecting first alias. Available aliases: [${e.join(", ")}]`),e.length>0?(e.sort(),"undefined"!=typeof window&&console.log(`[AliasBrowserService] Auto-selecting first alias: ${e[0]}`),await this.selectAlias(e[0])):"undefined"!=typeof window&&console.log("[AliasBrowserService] No aliases available to auto-select")}}getProfile(){return this.cache.profile}getAliases(){return"undefined"!=typeof window&&console.log("[AliasBrowserService] getAliases() called. cache.aliases:",this.cache.aliases,"keys:",Object.keys(this.cache.aliases||{})),this.cache.aliases||{}}async selectAlias(e){this.selectedAliasName=e,await this.Z(e),this.emit("alias-selected",{name:e})}async Z(e){try{const t=this.getProfile();if(!t)return;"undefined"!=typeof window&&console.log(`[AliasBrowserService] Persisting alias selection: alias -> ${e}`),await this.request("data:update-profile",{profileId:this.currentProfileId,properties:{selections:{...t.selections||{},alias:e}}})}catch(e){console.error("[AliasBrowserService] Failed to persist alias selection:",e)}}async createAlias(e,t=""){if(!this.getProfile())return!1;if(this.cache.aliases[e])return this.ui&&this.ui.showToast(Y.t("alias_already_exists",{name:e}),"error"),!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{aliases:{[e]:{description:t,commands:""}}}}),this.emit("alias-created",{name:e}),await this.selectAlias(e),!0}catch(e){return console.error("[AliasBrowserService] Failed to create alias:",e),this.ui&&this.ui.showToast("Failed to create alias","error"),!1}}async deleteAlias(e){if(!this.cache.aliases[e])return!1;try{return"undefined"!=typeof window&&(console.log(`[AliasBrowserService] deleteAlias: Deleting '${e}' from aliases`),console.log("[AliasBrowserService] deleteAlias: Original aliases:",Object.keys(this.cache.aliases)),console.log("[AliasBrowserService] deleteAlias: Sending delete request to DataCoordinator with profileId:",this.cache.currentProfile)),await this.request("data:update-profile",{profileId:this.cache.currentProfile,delete:{aliases:[e]}}),this.selectedAliasName===e&&(this.selectedAliasName=null),this.emit("alias-deleted",{name:e}),!0}catch(e){return console.error("[AliasBrowserService] Failed to delete alias:",e),this.ui&&this.ui.showToast("Failed to delete alias","error"),!1}}async duplicateAlias(e,t=void 0){const i=this.cache.aliases[e];if(!i)return!1;try{let a=t?.trim();if(a){if(this.cache.aliases[a])return this.ui&&this.ui.showToast(Y.t("alias_name_in_use")||"Alias already exists","error"),!1;if(!/^[A-Za-z0-9_]+$/.test(a))return this.ui&&this.ui.showToast(Y.t("invalid_alias_name")||"Invalid alias name","error"),!1}else{let t=0;do{a=`${e}_copy${t||""}`,t++}while(this.cache.aliases[a])}return Ze(a)?(await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{aliases:{[a]:{description:i.description+" (copy)",commands:i.commands}}}}),this.emit("alias-created",{name:a}),await this.selectAlias(a),!0):(this.ui&&this.ui.showToast(Y.t("reserved_command_name")||"Reserved command name","error"),!1)}catch(e){return console.error("[AliasBrowserService] Failed to duplicate alias:",e),this.ui&&this.ui.showToast("Failed to duplicate alias","error"),!1}}getCurrentState(){return{selectedAliasName:this.selectedAliasName,currentProfileId:this.currentProfileId,currentEnvironment:this.currentEnvironment,cachedAliasSelection:this.X,aliases:this.getAliases()}}handleInitialState(e,t){if("undefined"!=typeof window&&console.log(`[AliasBrowserService] handleInitialState called. sender: ${e}, state:`,t),t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;"undefined"!=typeof window&&console.log("[AliasBrowserService] Processing DataCoordinator state. profile:",e),this.currentProfileId=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.X=null,this.updateCacheFromProfile(e),this.emit("aliases-changed",{aliases:this.cache.aliases}),console.log(`[${this.componentName}] Received initial state from DataCoordinator`)}"AliasBrowserService"===e&&(this.selectedAliasName=t.selectedAliasName??this.selectedAliasName,this.X=t.cachedAliasSelection??this.X)}}}class tt extends re{constructor({i18n:e,eventBus:t=null}={}){super(t),this.componentName="CommandChainService",this.i18n=e,this.selectedKey=null,this.currentEnvironment="space",this.commands=[],this.currentProfile=null,this.cache={profile:null,keys:{},aliases:{},currentProfile:null,currentEnvironment:"space"},this.v=[],this.eventBus&&this.v.push(this.respond("command-chain:add",({key:e,command:t,position:i})=>this.addCommand(e,t,i)),this.respond("command-chain:delete",({key:e,index:t})=>this.deleteCommand(e,t)),this.respond("command-chain:move",({key:e,fromIndex:t,toIndex:i})=>this.moveCommand(e,t,i)),this.respond("command-chain:get",({key:e})=>this.getCommandsForKey(e)),this.respond("command-chain:clear",({key:e})=>this.clearCommandChain(e)))}onInit(){this.setupEventListeners()}setupEventListeners(){this.addEventListener("profile:updated",e=>{if(e?.profile&&e?.profileId){const t={...e.profile,id:e.profileId};this.updateCacheFromProfile(t),this.selectedKey&&this.refreshCommands()}}),this.addEventListener("profile:switched",e=>{this.currentProfile=e.profileId||e.profile||e.id,this.currentEnvironment=e.environment||"space",this.cache.currentProfile=this.currentProfile,this.cache.currentEnvironment=this.currentEnvironment,e.profile&&this.updateCacheFromProfile(e.profile),this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,this.selectedKey&&this.refreshCommands())}),this.addEventListener("key-selected",async({key:e,name:t})=>{var i;if(i={key:e,name:t},"undefined"!=typeof window&&console.log("[CommandChainService] key-selected:",i),"alias"===this.currentEnvironment)return;this.selectedKey=e||t||null;const a=await this.getCommandsForSelectedKey();console.log("[CommandChainService] [key-selected] emitting chain-data-changed with",a.length,"commands"),this.emit("chain-data-changed",{commands:a})}),this.addEventListener("alias-selected",async({name:e})=>{if(!e)return;if("alias"!==this.currentEnvironment)return;this.selectedKey=e;const t=await this.getCommandsForSelectedKey();console.log("[CommandChainService] [alias-selected] emitting chain-data-changed with",t.length,"commands"),this.emit("chain-data-changed",{commands:t})}),this.addEventListener("command-added",async({command:e,key:t})=>{console.log("[CommandChainService] command-added received:",{command:e,key:t});const i=await this.getCommandsForSelectedKey();console.log("[CommandChainService] emitting chain-data-changed with",i.length,"commands"),this.emit("chain-data-changed",{commands:i})}),this.addEventListener("commandlibrary:add",async(e={})=>{const{categoryId:t,commandId:i,commandObj:a}=e;if(t&&i)try{if(a&&this.selectedKey){const e=await this.getCommandsForSelectedKey();await this.request("command-chain:add",{command:a,key:this.selectedKey});const t=await this.getCommandsForSelectedKey();t.length!==e.length&&this.emit("chain-data-changed",{commands:t})}}catch(e){console.error("Failed to add command:",e)}}),this.addEventListener("commandchain:edit",async({index:e})=>{if(void 0===e)return;const t=(await this.getCommandsForSelectedKey())[e];if(!t)return;const i=t.parameters?{...t,parameters:{...t.parameters}}:{...t};if(!i.parameters)try{const e=await this.request("parser:parse-command-string",{commandString:i.command,options:{generateDisplayText:!1}});e.commands&&e.commands[0]&&e.commands[0].parameters&&(i.parameters=e.commands[0].parameters)}catch(e){console.warn("[CommandChainService] Failed to derive parameters from command:",e)}const a=await this.findCommandDefinition(i);a&&a.customizable?this.emit("parameter-command:edit",{index:e,command:i,commandDef:a,categoryId:a.categoryId||i.type,commandId:a.commandId}):"undefined"!=typeof stoUI&&stoUI.showToast&&stoUI.showToast(t.command,"info")}),this.addEventListener("commandchain:delete",async({index:e})=>{if(void 0!==e&&this.selectedKey)try{await this.request("command-chain:delete",{key:this.selectedKey,index:e}),this.emit("chain-data-changed",{commands:await this.getCommandsForSelectedKey()})}catch(e){console.error("Failed to delete command:",e)}}),this.addEventListener("commandchain:move",async({fromIndex:e,toIndex:t})=>{if(this.selectedKey)try{await this.request("command-chain:move",{key:this.selectedKey,fromIndex:e,toIndex:t}),this.emit("chain-data-changed",{commands:await this.getCommandsForSelectedKey()})}catch(e){console.error("Failed to move command:",e)}})}async getCommandsForSelectedKey(){try{return await this.request("command:get-for-selected-key")}catch(e){return console.error("Failed to get commands for selected key:",e),Array.isArray(this.commands)?this.commands:[]}}async getEmptyStateInfo(){try{return await this.request("command:get-empty-state-info")}catch(e){return console.error("Failed to get empty state info:",e),{title:"",preview:"",commandCount:0,icon:"",emptyTitle:"",emptyDesc:""}}}async findCommandDefinition(e){try{return console.log("[CommandChainService] findCommandDefinition command:find-definition",{command:e}),await this.request("command:find-definition",{command:e})}catch(e){return console.error("Failed to find command definition:",e),null}}async getCommandWarning(e){try{return await this.request("command:get-warning",{command:e})}catch(e){return console.error("Failed to get command warning:",e),null}}async addCommand(e,t,i){try{if(!e)return console.warn("CommandChainService: Cannot add command - no key specified"),!1;const a=await this.getCurrentProfile();if(!a)return console.warn("CommandChainService: Cannot add command - no active profile"),!1;if("alias"===this.currentEnvironment){const n=a.aliases&&a.aliases[e],s=n&&n.commands?n.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0):[];if(Array.isArray(t)){let e=i;t.forEach(t=>{const i=t.command;i&&(void 0!==e&&e>=0&&e<=s.length?(s.splice(e,0,i),e++):s.push(i))})}else{const e=t.command;e&&(void 0!==i&&i>=0&&i<=s.length?s.splice(i,0,e):s.push(e))}const o=s.join(" $$ ");a.aliases||(a.aliases={}),a.aliases[e]||(a.aliases[e]={}),a.aliases[e].commands=o}else{a.builds||(a.builds={}),a.builds[this.currentEnvironment]||(a.builds[this.currentEnvironment]={}),a.builds[this.currentEnvironment].keys||(a.builds[this.currentEnvironment].keys={}),a.builds[this.currentEnvironment].keys[e]||(a.builds[this.currentEnvironment].keys[e]=[]);const n=a.builds[this.currentEnvironment].keys[e];void 0!==i&&i>=0&&i<=n.length?n.splice(i,0,t):n.push(t)}if(!this.cache.currentProfile){console.error("CommandChainService: Cannot add command - no current profile ID in cache");try{const e=await this.request("data:get-current-state");if(!e?.currentProfile)return console.error("CommandChainService: No current profile available from DataCoordinator"),!1;this.cache.currentProfile=e.currentProfile,e.currentProfileData&&this.updateCacheFromProfile(e.currentProfileData),console.log("[CommandChainService] Retrieved current profile from DataCoordinator as fallback:",this.cache.currentProfile)}catch(e){return console.error("CommandChainService: Failed to get current profile from DataCoordinator:",e),!1}}const n=await this.request("data:update-profile",{profileId:this.cache.currentProfile,modify:"alias"===this.currentEnvironment?{aliases:{[e]:a.aliases[e]}}:{builds:{[this.currentEnvironment]:{keys:{[e]:a.builds[this.currentEnvironment].keys[e]}}}}});return n?.success?(this.emit("command-added",{key:e,command:t}),!0):(console.error("CommandChainService: Failed to save profile via DataCoordinator"),!1)}catch(e){return console.error("CommandChainService: Failed to add command:",e),!1}}async deleteCommand(e,t){try{if(console.log("[CommandChainService] deleteCommand called:",{key:e,index:t,cacheCurrentProfile:this.cache.currentProfile,currentProfile:this.currentProfile,currentEnvironment:this.currentEnvironment}),!e||void 0===t)return console.warn("CommandChainService: Cannot delete command - invalid parameters"),!1;const i=await this.getCurrentProfile();if(!i)return console.warn("CommandChainService: Cannot delete command - no active profile"),!1;const a="alias"===this.currentEnvironment||i.aliases&&Object.prototype.hasOwnProperty.call(i.aliases,e);if(a){const a=i.aliases&&i.aliases[e];if(!a||!a.commands)return!1;const n=a.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);t>=0&&t<n.length&&(n.splice(t,1),i.aliases[e].commands=n.join(" $$ "))}else{const a=i.builds?.[this.currentEnvironment]?.keys?.[e];a&&a[t]&&a.splice(t,1)}const n=this.cache.currentProfile||this.currentProfile;if(!n)return console.error("CommandChainService: Cannot delete command - no current profile ID available"),!1;const s=await this.request("data:update-profile",{profileId:n,modify:a?{aliases:{[e]:i.aliases[e]}}:{builds:{[this.currentEnvironment]:{keys:{[e]:i.builds[this.currentEnvironment].keys[e]}}}}});return s?.success?(this.emit("command-deleted",{key:e,index:t}),!0):(console.error("CommandChainService: Failed to save profile via DataCoordinator"),!1)}catch(e){return console.error("CommandChainService: Failed to delete command:",e),!1}}async moveCommand(e,t,i){try{if(!e||void 0===t||void 0===i)return console.warn("CommandChainService: Cannot move command - invalid parameters"),!1;const a=await this.getCurrentProfile();if(!a)return console.warn("CommandChainService: Cannot move command - no active profile"),!1;if("alias"===this.currentEnvironment){const n=a.aliases&&a.aliases[e];if(!n||!n.commands)return!1;const s=n.commands.split(/\s*\$\$\s*/).filter(e=>e.trim().length>0);if(t>=0&&t<s.length&&i>=0&&i<s.length){const[n]=s.splice(t,1);s.splice(i,0,n),a.aliases[e].commands=s.join(" $$ ")}}else{const n=a.builds?.[this.currentEnvironment]?.keys?.[e];if(n&&t>=0&&t<n.length&&i>=0&&i<n.length){const[e]=n.splice(t,1);n.splice(i,0,e)}}const n=this.cache.currentProfile||this.currentProfile;if(!n)return console.error("CommandChainService: Cannot move command - no current profile ID available"),!1;const s=await this.request("data:update-profile",{profileId:n,modify:"alias"===this.currentEnvironment?{aliases:{[e]:a.aliases[e]}}:{builds:{[this.currentEnvironment]:{keys:{[e]:a.builds[this.currentEnvironment].keys[e]}}}}});return s?.success?(this.emit("command-moved",{key:e,fromIndex:t,toIndex:i}),!0):(console.error("CommandChainService: Failed to save profile via DataCoordinator"),!1)}catch(e){return console.error("CommandChainService: Failed to move command:",e),!1}}async getCommandsForKey(e){try{if(!e)return[];const t=await this.getCurrentProfile();if(!t)return[];if("alias"===this.currentEnvironment){const i=t.aliases&&t.aliases[e];return i&&i.commands?(await this.request("parser:parse-command-string",{commandString:i.commands})).commands.map((e,t)=>({...e,id:`alias_${t}`,type:e.category,text:e.displayText})):[]}{const i=t.builds?.[this.currentEnvironment]?.keys?.[e];return i||[]}}catch(e){return console.error("CommandChainService: Failed to get commands for key:",e),[]}}async clearCommandChain(e){try{if(!e)return console.warn("CommandChainService: Cannot clear chain - no key specified"),!1;const t=await this.getCurrentProfile();if(!t)return console.warn("CommandChainService: Cannot clear chain - no active profile"),!1;if("alias"===this.currentEnvironment)t.aliases&&t.aliases[e]&&(t.aliases[e].commands="");else{const i=t.builds?.[this.currentEnvironment]?.keys?.[e];i&&(t.builds[this.currentEnvironment].keys[e]=[])}const i=this.cache.currentProfile||this.currentProfile;if(!i)return console.error("CommandChainService: Cannot clear command chain - no current profile ID available"),!1;const a=await this.request("data:update-profile",{profileId:i,modify:"alias"===this.currentEnvironment?{aliases:{[e]:t.aliases[e]}}:{builds:{[this.currentEnvironment]:{keys:{[e]:t.builds[this.currentEnvironment].keys[e]}}}}});return a?.success?(this.emit("command-chain-cleared",{key:e}),!0):(console.error("CommandChainService: Failed to save profile via DataCoordinator"),!1)}catch(e){return console.error("CommandChainService: Failed to clear command chain:",e),!1}}updateCacheFromProfile(e){e?(console.log("[CommandChainService] updateCacheFromProfile called with profile:",{profileId:e.id,environment:this.currentEnvironment,stackTrace:(new Error).stack}),this.cache.profile=e,this.cache.currentProfile=e.id,e.builds&&e.builds[this.currentEnvironment]&&(this.cache.keys=e.builds[this.currentEnvironment].keys||{}),e.aliases&&(this.cache.aliases=e.aliases),console.log("[CommandChainService] Cache updated:",{currentProfile:this.cache.currentProfile,keysCount:Object.keys(this.cache.keys||{}).length,aliasesCount:Object.keys(this.cache.aliases||{}).length})):console.log("[CommandChainService] updateCacheFromProfile called with null/undefined profile")}getCurrentProfile(){return this.cache.profile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[this.currentEnvironment]||(e.builds[this.currentEnvironment]={keys:{}}),e.builds[this.currentEnvironment].keys||(e.builds[this.currentEnvironment].keys={}),{...e,keys:e.builds[this.currentEnvironment].keys,aliases:e.aliases||{}}):null}async refreshCommands(){if(this.selectedKey){const e=await this.getCommandsForSelectedKey();this.emit("chain-data-changed",{commands:e})}}getCurrentState(){return{selectedKey:this.selectedKey,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile,commands:this.commands}}handleInitialState(e,t){"DataCoordinator"===e&&t?.currentProfileData&&(this.updateCacheFromProfile(t.currentProfileData),this.currentProfile=t.currentProfile,this.currentEnvironment=t.currentEnvironment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.cache.currentProfile=this.cache.currentProfile||t.currentProfile,console.log("[CommandChainService] Cache initialized from DataCoordinator:",{profileId:this.cache.currentProfile,environment:this.cache.currentEnvironment}))}destroy(){this.v&&(this.v.forEach(e=>e()),this.v=[]),super.destroy()}}class it extends re{constructor({eventBus:e=r,ui:t=null,document:i=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="CommandChainUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.document=i,this.N=null,this.P="space"}async onInit(){this.N=null,this.D=null,this.P="space",this.J=[],this.J.push(this.eventBus.on("chain-data-changed",({commands:e})=>{console.log("[CommandChainUI] chain-data-changed received with",e.length,"commands"),this.render(e)})),this.J.push(this.eventBus.on("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.P=t,this.updateChainActions(),this.render())})),this.J.push(this.eventBus.on("key-selected",e=>{this.N=e.key||e.name,this.D=null,this.updateChainActions()})),this.J.push(this.eventBus.on("alias-selected",e=>{this.D=e.name,this.N=null,this.updateChainActions()})),this.J.push(this.eventBus.on("language:changed",()=>{this.render()})),this.eventBus.onDom("stabilizeExecutionOrder","change",()=>this.render()),this.setupDragAndDrop(),this.updateChainActions()}async render(e=null){console.log("[CommandChainUI] render() called with:",e?`${e.length} commands`:"no commands arg");const t=this.document.getElementById("commandList"),i=this.document.getElementById("chainTitle"),a=this.document.getElementById("commandPreview"),n=this.document.getElementById("commandCount"),s=this.document.getElementById("emptyState");if(!t||!i||!a)return;let o=e;if(!o){if(!("alias"===this.P?this.D:this.N)){const e=await this.request("command:get-empty-state-info");i.textContent=e.title,a.textContent=e.preview,n&&(n.textContent=e.commandCount);const s=this.document.createElement("div");return s.innerHTML=`\n            <div class="empty-state show" id="emptyState">\n              <i class="${e.icon}"></i>\n              <h4>${e.emptyTitle}</h4>\n              <p>${e.emptyDesc}</p>\n            </div>`,void t.replaceChildren(...s.children)}o=await this.request("command:get-for-selected-key")}console.log("[CommandChainUI] rendering with commands:",o.length,o);const r=await this.request("command:get-empty-state-info");console.log("render getEmptyStateInfo",r);const c="alias"===this.P?this.D:this.N;if(!c||0===o.length){i.textContent=r.title,a.textContent=r.preview,n&&(n.textContent=r.commandCount);const e=this.document.createElement("div");return e.innerHTML=`\n          <div class="empty-state ${c?"":"show"}" id="emptyState">\n            <i class="${r.icon}"></i>\n            <h4>${r.emptyTitle}</h4>\n            <p>${r.emptyDesc}</p>\n          </div>`,void t.replaceChildren(...e.children)}i.textContent=r.title,a.textContent=r.preview,n&&(n.textContent=o.length.toString()),s&&s.classList.remove("show"),console.log("[CommandChainUI] building new command list with",o.length,"commands");const l=[];for(let e=0;e<o.length;e++){const t=await this.createCommandElement(o[e],e,o.length);console.log("[CommandChainUI] created element for command",e,o[e]),l.push(t)}t.replaceChildren(...l),console.log("[CommandChainUI] finished atomic render, container children:",t.children.length)}async createCommandElement(e,t,i){const a=this.document.createElement("div")||{};a.dataset||(a.dataset={}),a.className="command-item-row",a.dataset.index=t,a.draggable=!0,console.log("[CommandChainUI] createCommandElement command:find-definition",{command:e});const n=await this.request("command:find-definition",{command:e}),s=n&&n.customizable;let o=e.text||e.command||e,r=e.icon;if("object"==typeof o&&(o=o.command||o.text||"[Unknown Command]"),n)if(r=n.icon,s&&e.parameters)if("communication"===n.categoryId||"communication"===n.commandId){const t=e.parameters;t.verb&&t.message&&(o=`${t.verb}: "${t.message}"`)}else{const t=e.parameters;o="tray_with_backup"===n.commandId?`${n.name} (${t.active} ${t.tray} ${t.slot} ${t.backup_tray} ${t.backup_slot})`:"custom_tray"===n.commandId?`${n.name} (${t.tray} ${t.slot})`:"target"===n.commandId?`${n.name}: ${t.entityName}`:e.displayText||n.name}else if(s&&!e.parameters&&"custom_tray"===n.commandId){const t=e.command.match(/(?:\+)?(?:STO)?TrayExecByTray\s+(\d+)\s+(\d+)/i);o=t?`${n.name} (${parseInt(t[1])} ${parseInt(t[2])})`:e.displayText||n.name}else o=e.displayText||n.name;else e.displayText&&(o=e.displayText);s&&(a.dataset.parameters="true",a.classList.add("customizable"),a.addEventListener("dblclick",e=>{console.log("[CommandChainUI] DOUBLE-CLICK on command element:",{index:t,target:e.target,targetClass:e.target.className}),this.emit("commandchain:edit",{index:t})}));const c=await this.request("command:get-warning",{command:e}),l=c?`<span class="command-warning-icon" title="${c}"><i class="fas fa-exclamation-triangle"></i></span>`:"",d=s?' <span class="param-indicator" title="Editable parameters">⚙️</span>':"";console.log("[CommandChainUI] command",e),console.log("[CommandChainUI] commandDef",n);let m=e.type||e.category;n&&n.categoryId&&!["vfx-alias","alias"].includes(e.type)&&!["vfx-alias","alias"].includes(e.category)&&(m=n.categoryId),a.innerHTML=`\n      <div class="command-number">${t+1}</div>\n      <div class="command-content">\n        <span class="command-icon">${r}</span>\n        <span class="command-text">${o}${d}</span>\n        ${l}\n      </div>\n      <span class="command-type ${m}">${m}</span>\n      <div class="command-actions">\n        <button class="btn btn-small-icon btn-edit" title="Edit Command"><i class="fas fa-edit"></i></button>\n        <button class="btn btn-small-icon btn-danger btn-delete" title="Delete Command"><i class="fas fa-times"></i></button>\n        <button class="btn btn-small-icon btn-up" title="Move Up" ${0===t?"disabled":""}><i class="fas fa-chevron-up"></i></button>\n        <button class="btn btn-small-icon btn-down" title="Move Down" ${t===i-1?"disabled":""}><i class="fas fa-chevron-down"></i></button>\n      </div>`;const h=a.querySelector(".btn-edit"),u=a.querySelector(".btn-delete"),p=a.querySelector(".btn-up"),_=a.querySelector(".btn-down");return h&&(h.id=`edit-btn-${t}`,h.addEventListener("click",e=>{console.log("[CommandChainUI] EDIT BUTTON CLICKED:",{index:t,buttonId:e.target.id,buttonClass:e.target.className,buttonElement:e.target}),e.preventDefault(),e.stopPropagation(),this.emit("commandchain:edit",{index:t})})),u&&(u.id=`delete-btn-${t}`,u.addEventListener("click",e=>{console.log("[CommandChainUI] DELETE BUTTON CLICKED:",{index:t,buttonId:e.target.id,buttonClass:e.target.className,buttonElement:e.target}),e.preventDefault(),e.stopPropagation(),this.emit("commandchain:delete",{index:t})})),p&&p.addEventListener("click",()=>{this.emit("commandchain:move",{fromIndex:t,toIndex:t-1})}),_&&_.addEventListener("click",()=>{this.emit("commandchain:move",{fromIndex:t,toIndex:t+1})}),a}setupDragAndDrop(){if(!this.ui||"function"!=typeof this.ui.initDragAndDrop)return;const e=this.document.getElementById("commandList");e&&this.ui.initDragAndDrop(e,{dragSelector:".command-item-row",dropZoneSelector:".command-item-row",onDrop:(e,t,i)=>{if(!this.N)return;const a=parseInt(t.dragElement.dataset.index),n=parseInt(i.dataset.index);a!==n&&this.emit("commandchain:move",{fromIndex:a,toIndex:n})}})}async updateChainActions(){const e=!!("alias"===this.P?this.D:this.N);if("alias"===this.P){["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(t=>{const i=this.document.getElementById(t);i&&(i.disabled=!e)});const t=this.document.getElementById("addCommandBtn");t&&(t.disabled=!e),["importFromKeyBtn","deleteKeyBtn","duplicateKeyBtn"].forEach(e=>{const t=this.document.getElementById(e);t&&(t.disabled=!0)})}else["addCommandBtn","importFromKeyBtn","deleteKeyBtn","duplicateKeyBtn"].forEach(t=>{const i=this.document.getElementById(t);i&&(i.disabled=!e)}),["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(e=>{const t=this.document.getElementById(e);t&&(t.disabled=!0)})}destroy(){this.J&&(this.J.forEach(e=>{if("function"==typeof e)try{e()}catch(e){}}),this.J=[])}handleInitialState(e,t){if(t&&(t.environment||t.currentEnvironment)){const e=t.environment||t.currentEnvironment;this.P=e,this.updateChainActions()}}}class at extends re{constructor({storage:e,profileService:t,ui:i}={}){super(r),this.componentName="KeyBrowserService",this.storage=e,this.profileService=t||null,this.ui=i,this.currentProfileId=null,this.currentEnvironment="space",this.selectedKeyName=null,this.Y={space:null,ground:null},this.cache={currentProfile:null,currentEnvironment:"space",keys:{},builds:{space:{keys:{}},ground:{keys:{}}},profile:null},this.eventBus&&(this.respond("key:get-all",()=>this.getKeys()),this.respond("key:get-profile",()=>this.getProfile()),this.respond("key:select",({key:e})=>this.selectKey(e)))}async init(){super.init(),this.setupEventListeners()}onInit(){}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("key:list-changed",{keys:this.getKeys()}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfileId=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.selectedKeyName=null,this.Y={space:null,ground:null},this.updateCacheFromProfile(t),this.emit("key:list-changed",{keys:this.getKeys()})}),this.addEventListener("environment:changed",async e=>{const t="string"==typeof e?e:e?.environment;t&&("alias"!==this.currentEnvironment&&this.selectedKeyName&&(this.Y[this.currentEnvironment]=this.selectedKeyName),this.currentEnvironment=t,this.cache.currentEnvironment=t,this.selectedKeyName=null,this.cache.keys=this.cache.builds[t]?.keys||{},"alias"!==t&&await this.ee(t),this.emit("key:list-changed",{keys:this.getKeys()}))}),this.addEventListener("profile-modified",()=>{this.emit("key:list-changed",{keys:this.getKeys()})}),this.addEventListener("keys:changed",({keys:e})=>{this.cache.keys=e||{},this.emit("key:list-changed",{keys:this.getKeys()})})}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{})}async ee(e){const t=this.getProfile(),i=t?.selections?.[e],a=this.getKeys();if(i&&a[i])return"undefined"!=typeof window&&console.log(`[KeyBrowserService] Restoring persisted key selection for ${e}: ${i}`),void this.selectKey(i);const n=Object.keys(a);n.length>0&&(n.sort(),"undefined"!=typeof window&&console.log(`[KeyBrowserService] Auto-selecting first key for ${e}: ${n[0]}`),this.selectKey(n[0]))}getProfile(){return this.cache.profile}getKeys(){return this.cache.keys||{}}async selectKey(e){return this.selectedKeyName===e||(this.selectedKeyName=e,await this.te(e),this.emit("key-selected",{key:e,name:e}),"undefined"!=typeof window&&window.app&&(window.app.renderKeyGrid&&window.app.renderKeyGrid(),window.app.updateChainActions&&window.app.updateChainActions())),e}async te(e){try{const t=this.getProfile();if(!t||!this.currentEnvironment||"alias"===this.currentEnvironment)return;const i={...t.selections||{},[this.currentEnvironment]:e};"undefined"!=typeof window&&console.log(`[KeyBrowserService] Persisting key selection: ${this.currentEnvironment} -> ${e}`);const{request:a}=await Promise.resolve().then(function(){return oe});await this.request("data:update-profile",{profileId:this.currentProfileId,properties:{selections:i}})}catch(e){console.error("[KeyBrowserService] Failed to persist key selection:",e)}}getValidKeys(){if(this.ie)return this.ie;const e=new Set;for(let t=1;t<=12;t++)e.add(`F${t}`);for(let t=0;t<=9;t++)e.add(t.toString());for(let t=65;t<=90;t++)e.add(String.fromCharCode(t));["Space","Tab","Enter","Escape","Backspace","Delete","Insert","Home","End","PageUp","PageDown","Up","Down","Left","Right","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","NumPadEnter","NumPadPlus","NumPadMinus","NumPadMultiply","NumPadDivide","Button4","Button5","Button6","Button7","Button8","Lbutton","Rbutton","Mbutton","Leftdrag","Rightdrag","Middleclick","Mousechord","Wheelplus","Wheelminus","Semicolon","Equals","Comma","Minus","Period","Slash","Grave","LeftBracket","Backslash","RightBracket","Quote","[","]"].forEach(t=>e.add(t));const t=Array.from(e);return["Ctrl","Alt","Shift","Control"].forEach(i=>t.forEach(t=>e.add(`${i}+${t}`))),this.ie=Array.from(e).sort(),this.ie}getCurrentState(){return{selectedKeyName:this.selectedKeyName,currentProfileId:this.currentProfileId,currentEnvironment:this.currentEnvironment,cachedSelections:{...this.Y},keys:this.getKeys()}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfileId=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.Y={space:null,ground:null},this.updateCacheFromProfile(e),this.emit("key:list-changed",{keys:this.getKeys()}),console.log(`[${this.componentName}] Received initial state from DataCoordinator`)}"KeyBrowserService"===e&&(this.selectedKeyName=t.selectedKeyName??this.selectedKeyName,this.Y={...this.Y,...t.cachedSelections})}}}class nt extends re{constructor({ui:e=null,document:t=null}={}){super(r),this.componentName="PreferencesUI",this.ui=e,this.document=t||("undefined"!=typeof window?window.document:null),this.eventsSetup=!1,this.settingDefinitions={theme:{type:"select",element:"themeSelect"},language:{type:"select",element:"languageSelect"},autoSave:{type:"boolean",element:"autoSaveCheckbox"},compactView:{type:"boolean",element:"compactViewCheckbox"},autoSync:{type:"boolean",element:"autoSyncCheckbox"},autoSyncInterval:{type:"select",element:"autoSyncInterval"}}}async init(){await this.request("preferences:init"),this.populatePreferencesModal(),this.setupEventListeners()}setupEventListeners(){this.eventBus.on("preferences:show",()=>{this.showPreferences()}),document.querySelectorAll(".category-item").forEach(e=>{r.onDom(e,"click","pref-cat",e=>{const t=e.currentTarget.dataset.category;this.switchCategory(t)})}),r.onDom("savePreferencesBtn","click","pref-save",()=>{this.saveAllSettings(!0)}),this.setupSettingControls();const e=document.getElementById("setSyncFolderBtn");e&&e.addEventListener("click",async()=>{if(window.stoSync?.setSyncFolder)try{await window.stoSync.setSyncFolder(!0)&&(await this.request("preferences:load-settings"),this.updateFolderDisplay())}catch(e){console.error("[PreferencesUI] setSyncFolder failed",e)}})}setupSettingControls(){Object.entries(this.settingDefinitions).forEach(([e,t])=>{const i=document.getElementById(t.element);if(i)switch(t.type){case"boolean":r.onDom(i,"change",`pref-${e}`,t=>{this.updateSetting(e,t.target.checked)});break;case"select":r.onDom(i,"change",`pref-${e}`,t=>{this.updateSetting(e,t.target.value)})}})}switchCategory(e){document.querySelectorAll(".category-item").forEach(e=>e.classList.remove("active"));const t=document.querySelector(`[data-category="${e}"]`);t&&t.classList.add("active"),document.querySelectorAll(".settings-panel").forEach(e=>e.classList.remove("active"));const i=document.getElementById(`${e}-settings`);i&&i.classList.add("active")}async updateSetting(e,t){await this.setSetting(e,t),"syncFolderName"!==e&&"syncFolderPath"!==e||this.updateFolderDisplay()}updateUI(e,t){const i=this.settingDefinitions[e];if(!i)return;const a=document.getElementById(i.element);a&&("boolean"===i.type?a.checked=!!t:"select"===i.type&&(a.value=t))}async saveAllSettings(e=!0){await this.saveSettings()&&e&&this.ui?.showToast&&this.ui.showToast(Y.t("preferences_saved"),"success"),this.emit("modal:hide",{modalId:"preferencesModal"})}async showPreferences(){await this.request("preferences:load-settings");const e=await this.request("preferences:get-settings");Object.entries(e).forEach(([e,t])=>this.updateUI(e,t)),this.updateFolderDisplay(),this.emit("modal:show",{modalId:"preferencesModal"})}async populatePreferencesModal(){await this.request("preferences:load-settings"),this.updatePreferencesFromStorage(),this.setupPreferencesEventListeners()}async updateFolderDisplay(){const e=await this.request("preferences:get-settings"),{syncFolderName:t,syncFolderPath:i}=e,a=this.document.getElementById("syncFolderName"),n=this.document.getElementById("syncFolderPath");a&&(a.textContent=t||"No folder selected"),n&&(n.textContent=i||"")}async setSetting(e,t){await this.request("preferences:set-setting",{key:e,value:t}),this.updateUI(e,t)}async saveSettings(){return await this.request("preferences:save-settings")}updatePreferencesFromStorage(){}setupPreferencesEventListeners(){}toggleSettingsMenu(){const e=this.document.getElementById("settingsBtn"),t=e?.closest(".dropdown");t&&t.classList.toggle("active")}}class st extends re{constructor({eventBus:e=r}={}){super(e||r),this.eventBus||(this.eventBus=r),this.currentProfile=null}onInit(){this.setupEventListeners(),this.setupStateListeners()}setupEventListeners(){this.eventBus.onDom("exportKeybindsBtn","click","exportKeybinds",()=>{this.showExportOptions()}),this.eventBus.onDom("confirmExportBtn","click","export-confirm",()=>{this.performExport()}),this.eventBus.onDom("copyPreviewBtn","click","copyPreview",()=>{this.copyCommandPreview()})}setupStateListeners(){this.addEventListener("profile:switched",({profile:e}={})=>{this.currentProfile=e}),this.addEventListener("profile-updated",({profile:e}={})=>{this.currentProfile&&e&&this.currentProfile.id===e.id&&(this.currentProfile=e)})}showExportOptions(){this.currentProfile?this.emit("modal:show",{modalId:"exportModal"}):this.emit("toast:show",{message:Y.t("no_profile_selected_to_export"),type:"warning"})}populateExportModal(){const e=document.getElementById("exportModal");e&&"function"==typeof window.applyTranslations&&window.applyTranslations(e)}performExport(){if(!this.currentProfile)return void this.emit("toast:show",{message:Y.t("no_profile_selected_to_export"),type:"warning"});const e=document.getElementById("exportFormat")?.value||"sto_keybind",t=document.getElementById("exportEnvironment")?.value||this.currentProfile.currentEnvironment||"space";switch(e){case"sto_keybind":this.exportSTOKeybindFile(this.currentProfile,t);break;case"json_profile":this.exportJSONProfile(this.currentProfile,t);break;case"json_project":this.exportCompleteProject();break;case"csv_data":this.exportCSVData(this.currentProfile,t);break;case"html_report":this.exportHTMLReport(this.currentProfile,t);break;case"alias_file":this.exportAliases(this.currentProfile)}this.emit("modal:hide",{modalId:"exportModal"})}async exportSTOKeybindFile(e,t="space"){try{const i=await this.request("export:generate-keybind-file",{profile:e,options:{environment:t}}),a=await this.request("export:generate-filename",{profile:e,extension:"txt",environment:t});this.downloadFile(i,a,"text/plain"),this.emit("toast:show",{message:Y.t("keybind_file_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_keybind_file",{error:e.message}),type:"error"})}}async exportJSONProfile(e,t="space"){try{const i=await this.request("export:sanitize-profile",{profile:e}),a={version:STO_DATA.settings.version,exported:(new Date).toISOString(),type:"profile",profile:i},n=JSON.stringify(a,null,2),s=await this.request("export:generate-filename",{profile:e,extension:"json",environment:t});this.downloadFile(n,s,"application/json"),this.emit("toast:show",{message:Y.t("profile_exported_json"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_profile",{error:e.message}),type:"error"})}}async exportCompleteProject(){try{const e=await this.request("storage:get-all-data"),t={version:STO_DATA.settings.version,exported:(new Date).toISOString(),type:"project",data:e},i=JSON.stringify(t,null,2),a=`STO_Tools_Keybinds_Project_${(new Date).toISOString().split("T")[0]}.json`;this.downloadFile(i,a,"application/json"),this.emit("toast:show",{message:Y.t("complete_project_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_project",{error:e.message}),type:"error"})}}async exportCSVData(e,t="space"){try{const i=await this.request("export:generate-csv-data",{profile:e}),a=await this.request("export:generate-filename",{profile:e,extension:"csv",environment:t});this.downloadFile(i,a,"text/csv"),this.emit("toast:show",{message:Y.t("data_exported_csv"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_csv",{error:e.message}),type:"error"})}}async exportHTMLReport(e,t="space"){try{const i=await this.request("export:generate-html-report",{profile:e}),a=await this.request("export:generate-filename",{profile:e,extension:"html",environment:t});this.downloadFile(i,a,"text/html"),this.emit("toast:show",{message:Y.t("html_report_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_html_report",{error:e.message}),type:"error"})}}async exportAliases(e){try{const t=await this.request("export:generate-alias-file",{profile:e}),i=await this.request("export:generate-alias-filename",{profile:e,extension:"txt"});this.downloadFile(t,i,"text/plain"),this.emit("toast:show",{message:Y.t("aliases_exported_successfully"),type:"success"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_aliases",{error:e.message}),type:"error"})}}async exportAllProfiles(){try{const e=(await this.request("storage:get-all-data")).profiles;if(!e||0===Object.keys(e).length)return void this.emit("toast:show",{message:Y.t("no_profiles_to_export"),type:"warning"});Object.values(e).forEach((e,t)=>{setTimeout(()=>this.exportSTOKeybindFile(e),100*t)}),this.emit("toast:show",{message:Y.t("exporting_profiles",{count:Object.keys(e).length}),type:"info"})}catch(e){this.emit("toast:show",{message:Y.t("failed_to_export_profiles",{error:e.message}),type:"error"})}}async copyCommandPreview(){const e=document.getElementById("commandPreview");if(e){if(!e.textContent.trim())try{const t=await this.request("command:get-chain-preview");t&&(e.textContent=t)}catch(e){}e.textContent.trim()?this.emit("ui:copy-to-clipboard",{text:e.textContent}):this.emit("toast:show",{message:Y.t("no_command_to_copy"),type:"warning"})}}downloadFile(e,t,i){const a=new Blob([e],{type:i}),n=URL.createObjectURL(a),s=document.createElement("a");s.href=n,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}}class ot{constructor(){this.store=Be,this.eventListeners=new Map,this.autoSyncManager=null,this.dataService=null,this.profileService=null,this.profileUI=null,this.aliasService=null,this.aliasUI=null,this.commandService=null,this.commandLibraryService=null,this.keyBrowserService=null,this.keyBrowserUI=null,this.commandUI=null,this.keyService=null,this.fileOperationsService=null,this.keyCaptureService=null,this.keyCaptureUI=null,this.projectManagementService=null}get currentMode(){return this.interfaceModeService?this.interfaceModeService.currentMode:this.store?.currentMode}set currentMode(e){this.store&&(this.store.currentMode=e),this.interfaceModeService&&(this.interfaceModeService.currentMode=e)}get undoStack(){return(this&&this.store?this.store:Be).undoStack}set undoStack(e){(this&&this.store?this.store:Be).undoStack=e}get redoStack(){return(this&&this.store?this.store:Be).redoStack}set redoStack(e){(this&&this.store?this.store:Be).redoStack=e}get maxUndoSteps(){return(this&&this.store?this.store:Be).maxUndoSteps}set maxUndoSteps(e){(this&&this.store?this.store:Be).maxUndoSteps=e}get commandIdCounter(){return(this&&this.store?this.store:Be).commandIdCounter}set commandIdCounter(e){(this&&this.store?this.store:Be).commandIdCounter=e}async init(){try{if("undefined"==typeof storageService||"undefined"==typeof stoUI)throw new Error("Required dependencies not loaded");this.modalManagerService=new Ee(r),this.modalManagerService.init();const e=this.modalManagerService;if(this.stoCommandParser=new Ve(r),window.stoCommandParser=this.stoCommandParser,this.dataService=window.dataService,!this.dataService)throw new Error("DataService not available - it should be initialized in main.js before app.init()");this.profileService=new me({storage:storageService,eventBus:r,i18n:i18next});try{this.profileUI=new Pe({service:this.profileService,eventBus:r,ui:stoUI,modalManager:e,document:document})}catch(e){throw e}this.aliasBrowserService=new et({storage:storageService,ui:stoUI,eventBus:r}),this.aliasBrowserService.init(),this.aliasBrowserUI=new Je({eventBus:r,modalManager:e,document:document}),this.aliasBrowserUI.init(),this.keyBrowserService=new at({storage:storageService,profileService:this.profileService,ui:stoUI}),this.keyBrowserUI=new qe({service:this.keyBrowserService,eventBus:r,document:document,modalManager:e}),this.keyService=new be({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI}),this.keyService.init(),this.importService=new Se({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI}),this.importService.init(),this.exportService=new Ce({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI}),this.exportService.init(),this.exportUI=new st({eventBus:r}),this.exportUI.init(),this.keyCaptureService=new Ae({eventBus:r}),this.keyCaptureService.init(),this.keyCaptureUI=new Re({eventBus:r,modalManager:e,document:document}),this.keyCaptureUI.init(),this.commandService=new pe({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI}),this.commandService.init(),this.commandLibraryService=new ue({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI,modalManager:e}),this.commandLibraryUI=new Oe({service:this.commandLibraryService,eventBus:r,ui:stoUI,modalManager:e,document:document}),this.commandChainService=new tt({eventBus:r,i18n:i18next}),this.commandChainUI=new it({eventBus:r,ui:stoUI,document:document}),this.parameterCommandUI=new De({eventBus:r,modalManager:e,i18n:i18next,ui:stoUI}),this.commandUI=new ze({eventBus:r,ui:stoUI,modalManager:e,parameterCommandUI:this.parameterCommandUI}),this.headerMenuUI=new Ye({eventBus:r,document:document}),this.aboutModalUI=new Qe({eventBus:r,document:document}),this.interfaceModeService=new _e({eventBus:r,storage:storageService,profileService:this.profileService,app:this}),this.interfaceModeUI=new Ke({eventBus:r,ui:stoUI,profileUI:this.profileUI,document:document}),this.profileService.init(),await this.profileService.loadData(),this.commandLibraryService&&this.profileService&&(this.commandLibraryService.currentProfile=this.profileService.getCurrentProfileId()),window.stoAliases=this.aliasBrowserUI,this.aliasBrowserService.init(),this.aliasBrowserUI.init(),this.commandLibraryService.init(),this.commandLibraryUI.init(),this.commandChainService.init(),this.commandChainUI.init(),this.keyBrowserService.init(),this.keyBrowserUI.init(),this.commandUI.init(),this.parameterCommandUI.init(),this.preferencesService=new ce({storage:storageService,eventBus:r,i18n:i18next,ui:stoUI}),this.preferencesUI=new nt({service:this.preferencesService,ui:stoUI}),this.preferencesManager=this.preferencesUI,this.preferencesService.init(),this.preferencesUI.init(),this.vfxManagerService=new Ie(r),this.vfxManagerUI=new Ue(r,e),this.vfxManagerService.init(),this.vfxManagerUI.init(),this.autoSyncManager=new de({eventBus:r,storage:storageService,syncManager:window.stoSync,ui:stoUI}),this.autoSyncManager.init(),this.profileUI.init();try{this.interfaceModeService.init()}catch(e){throw e}await new Promise(e=>setTimeout(e,10));try{this.headerMenuUI.init()}catch(e){throw e}try{this.aboutModalUI.init()}catch(e){throw e}try{this.interfaceModeUI.init()}catch(e){throw e}this.profileUI.renderProfiles(),this.profileUI.updateProfileInfo(),this.checkAndShowWelcomeMessage(),stoUI.showToast(i18next.t("sto_tools_keybind_manager_loaded_successfully"),"success"),this.initialized=!0,r.emit("sto-app-ready",{app:this}),window.commandChainUI=this.commandChainUI,window.keyBrowserUI=this.keyBrowserUI,window.keyBrowserService=this.keyBrowserService,this.projectManagementService=new le({storage:storageService,ui:stoUI,exportManager:window.stoExport,i18n:i18next,app:this,eventBus:r})}catch(e){throw"undefined"!=typeof stoUI&&stoUI.showToast&&stoUI.showToast("undefined"!=typeof i18next?i18next.t("failed_to_load_application"):"Failed to load application","error"),r.emit("sto-app-error",{error:e}),e}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}isFirstTime(){return!localStorage.getItem("sto_keybind_manager_visited")}checkAndShowWelcomeMessage(){this.isFirstTime()&&(localStorage.setItem("sto_keybind_manager_visited","true"),"undefined"!=typeof modalManager&&modalManager.show("aboutModal"))}}const rt=new class extends re{constructor({eventBus:e=r,storageKey:t="sto_keybind_manager",backupKey:i="sto_keybind_manager_backup",settingsKey:a="sto_keybind_settings",version:n="1.0.0",dataService:s=null,data:o={}}={}){super(e),this.componentName="StorageService",this.storageKey=t,this.backupKey=i,this.settingsKey=a,this.version=n,this.dataService=s,this.data=o||{}}onInit(){this.migrateData(),this.ensureStorageStructure(),this.emit("storage:ready",{service:this})}getAllData(e=!1){if(!e&&this.ae)return this.ae;try{const e=localStorage.getItem(this.storageKey),t=localStorage.getItem("sto_app_reset");if(!e)return t?(localStorage.removeItem("sto_app_reset"),this.getEmptyData()):this.getDefaultData();const i=JSON.parse(e);return this.isValidDataStructure(i,!0)?(this.ae=i,i):this.getDefaultData()}catch(e){console.error("Error loading data from storage:",e);const t=this.getDefaultData();return this.ae=t,t}}saveAllData(e){try{this.createBackup();const t={...e,version:this.version,lastModified:(new Date).toISOString(),lastBackup:(new Date).toISOString()};return localStorage.setItem(this.storageKey,JSON.stringify(t)),this.ae=t,this.emit("storage:data-changed",{data:t}),!0}catch(e){return console.error("Error saving data to storage:",e),!1}}getProfile(e){return this.getAllData().profiles[e]||null}saveProfile(e,t){const i=this.getAllData(!0);return i.profiles[e]={...t,lastModified:(new Date).toISOString()},this.saveAllData(i)}deleteProfile(e){const t=this.getAllData();if(t.profiles[e]){if(delete t.profiles[e],t.currentProfile===e){const e=Object.keys(t.profiles);t.currentProfile=e.length>0?e[0]:null}return this.saveAllData(t)}return!1}getSettings(){try{const e=localStorage.getItem(this.settingsKey);if(!e)return this.getDefaultSettings();const t=JSON.parse(e);return{...this.getDefaultSettings(),...t}}catch(e){return console.error("Error loading settings:",e),this.getDefaultSettings()}}saveSettings(e){try{const t={...this.getSettings(),...e};return localStorage.setItem(this.settingsKey,JSON.stringify(t)),this.emit("storage:settings-changed",{settings:t}),!0}catch(e){return console.error("Error saving settings:",e),!1}}createBackup(){try{const e=localStorage.getItem(this.storageKey);if(e){const t={data:e,timestamp:(new Date).toISOString(),version:this.version};localStorage.setItem(this.backupKey,JSON.stringify(t)),this.emit("storage:backup-created",{backup:t})}}catch(e){console.error("Error creating backup:",e)}}restoreFromBackup(){try{const e=localStorage.getItem(this.backupKey);if(e){const t=JSON.parse(e);return localStorage.setItem(this.storageKey,t.data),this.emit("storage:backup-restored",{backup:t}),!0}}catch(e){console.error("Error restoring from backup:",e)}return!1}exportData(){const e=this.getAllData();return JSON.stringify(e,null,2)}importData(e){try{const t=JSON.parse(e);if(!this.isValidDataStructure(t))return!1;const i=this.saveAllData(t);return i&&this.emit("storage:data-imported",{data:t}),i}catch(t){return t instanceof SyntaxError&&e.includes("invalid")||console.error("Error importing data:",t),!1}}clearAllData(){try{return localStorage.removeItem(this.storageKey),localStorage.removeItem(this.backupKey),localStorage.removeItem(this.settingsKey),localStorage.setItem("sto_app_reset","true"),this.emit("storage:data-cleared"),!0}catch(e){return console.error("Error clearing data:",e),!1}}getStorageInfo(){try{const e=localStorage.getItem(this.storageKey)?.length||0,t=localStorage.getItem(this.backupKey)?.length||0,i=localStorage.getItem(this.settingsKey)?.length||0;return{totalSize:e+t+i,dataSize:e,backupSize:t,settingsSize:i,available:this.getAvailableStorage()}}catch(e){return console.error("Error getting storage info:",e),null}}getDefaultData(){return{version:this.version,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),currentProfile:null,profiles:{},globalAliases:{},settings:this.getDefaultSettings()}}getEmptyData(){return{version:this.version,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),currentProfile:null,profiles:{},globalAliases:{},settings:this.getDefaultSettings()}}getDefaultSettings(){return{theme:"default",autoSave:!0,showTooltips:!0,confirmDeletes:!0,maxUndoSteps:50,defaultMode:"space",compactView:!1,language:this.detectBrowserLanguage(),syncFolderName:null,syncFolderPath:null,autoSync:!1,autoSyncInterval:"change"}}detectBrowserLanguage(){try{if("undefined"==typeof navigator)return"en";const e=navigator.languages&&navigator.languages[0]||navigator.language;if(!e)return"en";const t=e.toLowerCase().split(/[-_]/)[0];return["en","de","es","fr"].includes(t)?t:"en"}catch(e){return console.error("Error detecting browser language:",e),"en"}}isValidDataStructure(e,t=!1){if(!e||"object"!=typeof e)return!1;const i=["profiles","currentProfile"];for(const t of i)if(!(t in e))return!1;if("object"!=typeof e.profiles)return!1;for(const[i,a]of Object.entries(e.profiles)){const e=this.isValidProfile(a),i=t&&this.needsProfileMigration(a);if(!e&&!i)return!1}return!0}isValidProfile(e){if(!e||"object"!=typeof e)return!1;if(!e.name)return!1;if(e.builds&&"object"==typeof e.builds){const t=e.builds;if(!t.space&&!t.ground)return!1;for(const[e,i]of Object.entries(t))if("space"===e||"ground"===e){if(!i||"object"!=typeof i)return!1;if(!i.keys||"object"!=typeof i.keys)return!1}return!0}return!(!e.mode||!e.keys||"object"!=typeof e.keys)}ensureStorageStructure(){const e=this.getAllData();e.globalAliases||(e.globalAliases={}),e.settings||(e.settings=this.getDefaultSettings()),Object.keys(e.profiles).length>0&&!e.profiles[e.currentProfile]&&(e.currentProfile=Object.keys(e.profiles)[0]),this.saveAllData(e)}migrateData(){const e=this.getAllData();let t=!1;e.version!==this.version&&(console.log(`Migrating data from ${e.version} to ${this.version}`),t=!0);for(const[i,a]of Object.entries(e.profiles))this.needsProfileMigration(a)&&(console.log(`Migrating profile "${a.name}" from old format to new format`),e.profiles[i]=this.migrateProfile(a),t=!0);t&&(e.version=this.version,this.saveAllData(e),console.log("Data migration completed"))}needsProfileMigration(e){return!(!(e&&e.mode&&e.keys)||e.builds)}migrateProfile(e){console.log(`Migrating profile: ${e.name}`);const t={name:e.name,description:e.description||"",currentEnvironment:this.mapOldModeToEnvironment(e.mode),builds:{space:{keys:{}},ground:{keys:{}}},aliases:e.aliases||{},keybindMetadata:e.keybindMetadata||{},created:e.created||(new Date).toISOString(),lastModified:(new Date).toISOString()},i=this.mapOldModeToEnvironment(e.mode);if(t.builds[i].keys=e.keys||{},e.keybindMetadata&&"object"==typeof e.keybindMetadata){const a=e.keybindMetadata.space||e.keybindMetadata.ground;t.keybindMetadata=a?e.keybindMetadata:{[i]:e.keybindMetadata}}return t}mapOldModeToEnvironment(e){if(!e)return"space";const t=("string"==typeof e?e:String(e)).toLowerCase();return"ground"===t||"ground mode"===t?"ground":"space"}getAvailableStorage(){try{let e="storage_test",t="0",i=0,a=0,n=10485760;for(;a<=n;){let s=Math.floor((a+n)/2);t="0".repeat(s);try{localStorage.setItem(e,t),localStorage.removeItem(e),i=s,a=s+1}catch(e){n=s-1}}return i}catch(e){return 0}}loadDefaultData(){const e=this.getDefaultData();return this.saveAllData(e)}getCurrentState(){return{service:this,isReady:this.isInitialized()}}}({eventBus:r});rt.init();const ct=new class extends re{constructor({eventBus:e,data:t=null}={}){super(e),this.componentName="DataService",this.data=t||{},this.responseHandlers=[]}onInit(){this.responseHandlers.push(this.respond("data:get-commands",()=>this.data.commands||{})),this.responseHandlers.push(this.respond("data:get-command-category",({categoryId:e})=>this.data.commands?.[e]||null)),this.responseHandlers.push(this.respond("data:get-command-definition",({categoryId:e,commandId:t})=>this.data.commands?.[e]?.commands?.[t]||null)),this.responseHandlers.push(this.respond("data:get-validation-patterns",()=>this.data.validation||{})),this.responseHandlers.push(this.respond("data:get-key-name-pattern",()=>this.data.validation?.keyNamePattern||/^[A-Za-z0-9_]+$/)),this.responseHandlers.push(this.respond("data:get-alias-name-pattern",()=>this.data.validation?.aliasNamePattern||/^[A-Za-z0-9_]+$/)),this.responseHandlers.push(this.respond("data:has-commands",()=>!(!this.data||!this.data.commands))),this.responseHandlers.push(this.respond("data:get-tray-category",()=>this.data.commands?.tray||null)),this.responseHandlers.push(this.respond("data:get-communication-category",()=>this.data.commands?.communication||null)),this.responseHandlers.push(this.respond("data:get-combat-category",()=>this.data.commands?.combat||null)),this.responseHandlers.push(this.respond("data:get-default-profiles",()=>this.data.defaultProfiles||{})),this.responseHandlers.push(this.respond("data:get-default-profile",({profileId:e})=>this.data.defaultProfiles?.[e]||null))}onDestroy(){this.responseHandlers.forEach(e=>{"function"==typeof e&&e()}),this.responseHandlers=[]}updateData(e){this.data=e||{},this.emit("data:updated",{data:this.data})}getCurrentState(){return{defaultProfiles:this.data.defaultProfiles||{},hasCommands:!(!this.data||!this.data.commands),dataAvailable:Object.keys(this.data).length>0}}}({eventBus:r,data:"undefined"!=typeof globalThis?globalThis.STO_DATA:null});ct.init();const lt=new class extends re{constructor({eventBus:e,storage:t}){super(e),this.componentName="DataCoordinator",this.storage=t,this.state={currentProfile:null,currentEnvironment:"space",profiles:{},settings:{},metadata:{lastModified:null,version:"1.0.0"}},this.setupRequestHandlers()}async init(){super.init(),console.log(`[${this.componentName}] Initializing...`),await this.loadInitialState(),console.log(`[${this.componentName}] Initialization complete`)}setupRequestHandlers(){this.respond("data:get-all-profiles",()=>this.getAllProfiles()),this.respond("data:switch-profile",({profileId:e})=>this.switchProfile(e)),this.respond("data:create-profile",({name:e,description:t,mode:i})=>this.createProfile(e,t,i)),this.respond("data:clone-profile",({sourceId:e,newName:t})=>this.cloneProfile(e,t)),this.respond("data:delete-profile",({profileId:e})=>this.deleteProfile(e)),this.respond("data:rename-profile",({profileId:e,newName:t,description:i})=>this.renameProfile(e,t,i)),this.respond("data:update-profile",({profileId:e,...t})=>this.updateProfile(e,t)),this.respond("data:set-environment",({environment:e})=>this.setEnvironment(e)),this.respond("data:get-settings",()=>this.getSettings()),this.respond("data:update-settings",({settings:e})=>this.updateSettings(e)),this.respond("data:load-default-data",()=>this.loadDefaultData())}async loadInitialState(){try{const e=this.storage.getAllData();if(this.state.currentProfile=e.currentProfile,this.state.profiles=e.profiles||{},this.state.settings=e.settings||{},0===Object.keys(this.state.profiles).length&&(this.needsDefaultProfiles=!0,console.log(`[${this.componentName}] No profiles found, will create defaults when DataService is available`),this.tryCreateDefaultProfiles()),!this.state.currentProfile&&Object.keys(this.state.profiles).length>0){this.state.currentProfile=Object.keys(this.state.profiles)[0];const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e)}this.state.currentProfile&&this.state.profiles[this.state.currentProfile]&&(this.state.currentEnvironment=this.state.profiles[this.state.currentProfile].currentEnvironment||"space"),this.state.metadata={lastModified:e.lastModified,version:e.version||"1.0.0"},console.log(`[${this.componentName}] Loaded initial state:`,{currentProfile:this.state.currentProfile,environment:this.state.currentEnvironment,profileCount:Object.keys(this.state.profiles).length})}catch(e){throw console.error(`[${this.componentName}] Failed to load initial state:`,e),e}}getCurrentState(){let e=null;if(this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const t=this.state.profiles[this.state.currentProfile];e=this.buildVirtualProfile(t,this.state.currentEnvironment),e.id=this.state.currentProfile}return{currentProfile:this.state.currentProfile,currentEnvironment:this.state.currentEnvironment,profiles:{...this.state.profiles},settings:{...this.state.settings},metadata:{...this.state.metadata},currentProfileData:e}}async getAllProfiles(){return{...this.state.profiles}}buildVirtualProfile(e,t){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[t]||(e.builds[t]={keys:{}}),{...e,keys:e.builds[t].keys||{},aliases:e.aliases||{},environment:t}):null}async switchProfile(e){if(e===this.state.currentProfile){let e=null;if(this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const t=this.state.profiles[this.state.currentProfile];e=this.buildVirtualProfile(t,this.state.currentEnvironment)}return{success:!0,switched:!1,message:"Already on this profile",profile:e}}const t=this.state.profiles[e];if(!t)throw new Error(`Profile ${e} not found`);const i=this.state.currentProfile;this.state.currentProfile=e,this.state.currentEnvironment=t.currentEnvironment||"space";const a=this.storage.getAllData();a.currentProfile=e,await this.storage.saveAllData(a),this.state.metadata.lastModified=(new Date).toISOString();const n=this.buildVirtualProfile(t,this.state.currentEnvironment);return this.emit("profile:switched",{fromProfile:i,toProfile:e,profileId:e,profile:n,environment:this.state.currentEnvironment,timestamp:Date.now()}),{success:!0,switched:!0,profile:n,message:`Switched to ${t.name} (${this.state.currentEnvironment})`}}async createProfile(e,t="",i="space"){if(!e||!e.trim())throw new Error("Profile name is required");const a=this.generateProfileId(e);if(this.state.profiles[a])throw new Error(`Profile with name "${e}" already exists`);const n={name:e.trim(),description:t.trim(),currentEnvironment:i,builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(a,n),this.state.profiles[a]=n,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:created",{profileId:a,profile:n,timestamp:Date.now()}),{success:!0,profileId:a,profile:n,message:`Profile "${e}" created`}}async cloneProfile(e,t){if(!e||!t||!t.trim())throw new Error("Source profile ID and new name are required");const i=this.state.profiles[e];if(!i)throw new Error("Source profile not found");const a=this.generateProfileId(t);if(this.state.profiles[a])throw new Error(`Profile with name "${t}" already exists`);const n={...JSON.parse(JSON.stringify(i)),name:t.trim(),description:`Copy of ${i.name}`,created:(new Date).toISOString(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(a,n),this.state.profiles[a]=n,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:created",{profileId:a,profile:n,clonedFrom:e,timestamp:Date.now()}),{success:!0,profileId:a,profile:n,message:`Profile "${t}" created from "${i.name}"`}}async renameProfile(e,t,i=""){if(!e||!t||!t.trim())throw new Error("Profile ID and new name are required");const a=this.state.profiles[e];if(!a)throw new Error("Profile not found");const n={...a,name:t.trim(),description:i.trim(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(e,n),this.state.profiles[e]=n,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:updated",{profileId:e,profile:n,changes:{name:t,description:i},timestamp:Date.now()}),{success:!0,profile:n,message:`Profile renamed to "${t}"`}}async deleteProfile(e){if(!e)throw new Error("Profile ID is required");const t=this.state.profiles[e];if(!t)throw new Error("Profile not found");if(Object.keys(this.state.profiles).length<=1)throw new Error("Cannot delete the last profile");await this.storage.deleteProfile(e),delete this.state.profiles[e];let i=null;if(this.state.currentProfile===e){const t=Object.keys(this.state.profiles);this.state.currentProfile=t[0];const a=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=a.currentEnvironment||"space";const n=this.storage.getAllData();n.currentProfile=this.state.currentProfile,await this.storage.saveAllData(n),i=this.buildVirtualProfile(a,this.state.currentEnvironment),this.emit("profile:switched",{fromProfile:e,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:i,environment:this.state.currentEnvironment,timestamp:Date.now()})}return this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:deleted",{profileId:e,profile:t,switchedProfile:i,timestamp:Date.now()}),{success:!0,deletedProfile:t,switchedProfile:i,message:`Profile "${t.name}" deleted`}}processUpdateOperations(e,t){const i=JSON.parse(JSON.stringify(e));if(t.delete&&(t.delete.aliases&&t.delete.aliases.forEach(e=>{i.aliases&&delete i.aliases[e]}),t.delete.builds))for(const[e,a]of Object.entries(t.delete.builds))i.builds?.[e]?.keys&&a.keys&&a.keys.forEach(t=>{delete i.builds[e].keys[t]});if(t.add&&(t.add.aliases&&(i.aliases={...i.aliases||{},...t.add.aliases}),t.add.builds)){i.builds=i.builds||{space:{keys:{}},ground:{keys:{}}};for(const[e,a]of Object.entries(t.add.builds))i.builds[e]=i.builds[e]||{keys:{}},a.keys&&(i.builds[e].keys={...i.builds[e].keys||{},...a.keys})}if(t.modify){if(t.modify.aliases){i.aliases=i.aliases||{};for(const[e,a]of Object.entries(t.modify.aliases))i.aliases[e]&&(i.aliases[e]={...i.aliases[e],...a})}if(t.modify.builds){i.builds=i.builds||{space:{keys:{}},ground:{keys:{}}};for(const[e,a]of Object.entries(t.modify.builds))if(i.builds[e]=i.builds[e]||{keys:{}},a.keys){i.builds[e].keys=i.builds[e].keys||{};for(const[t,n]of Object.entries(a.keys))i.builds[e].keys[t]&&(i.builds[e].keys[t]=n)}}}return t.properties&&Object.assign(i,t.properties),i}async updateProfile(e,t){if(!e||!t)throw new Error("Profile ID and updates are required");const i=this.state.profiles[e];if(!i)throw new Error(`Profile ${e} not found`);if(!(t.add||t.delete||t.modify||t.properties))throw new Error("Explicit operations (add/delete/modify/properties) required");const a=this.processUpdateOperations(i,{...t,properties:{...t.properties||{},lastModified:(new Date).toISOString()}});return console.log(`[${this.componentName}] Saving profile ${e} to storage:`,a),await this.storage.saveProfile(e,a),this.state.profiles[e]=a,this.state.metadata.lastModified=(new Date).toISOString(),!!(t.add||t.delete||t.modify)&&this.emit("profile:updated",{profileId:e,profile:a,updates:t,timestamp:Date.now()}),{success:!0,profile:a}}async setEnvironment(e){if(!e||!["space","ground","alias"].includes(e))throw new Error("Invalid environment");const t=this.state.currentEnvironment;if(this.state.currentEnvironment=e,this.state.currentProfile){const t={properties:{currentEnvironment:e}};await this.updateProfile(this.state.currentProfile,t)}return this.emit("environment:changed",{fromEnvironment:t,toEnvironment:e,environment:e,timestamp:Date.now()}),{success:!0,environment:e}}async getSettings(){return{...this.state.settings}}async updateSettings(e){if(!e)throw new Error("Settings are required");return this.state.settings={...this.state.settings,...e},await this.storage.saveSettings(this.state.settings),this.state.metadata.lastModified=(new Date).toISOString(),this.emit("settings:changed",{settings:this.state.settings,updates:e,timestamp:Date.now()}),{success:!0,settings:this.state.settings}}async loadDefaultData(){console.log(`[${this.componentName}] Explicitly loading default data...`);try{const e=await this.request("data:get-default-profiles");return e&&0!==Object.keys(e).length?(await this.createDefaultProfilesFromData(e),console.log(`[${this.componentName}] Successfully loaded default data`),{success:!0,profilesCreated:Object.keys(e).length,currentProfile:this.state.currentProfile}):(console.warn(`[${this.componentName}] No default profiles available from DataService`),{success:!1,error:"No default profiles available"})}catch(e){return console.error(`[${this.componentName}] Failed to load default data:`,e),{success:!1,error:e.message}}}async tryCreateDefaultProfiles(){if(this.needsDefaultProfiles)try{console.log(`[${this.componentName}] Attempting to get default profiles from DataService...`);const e=await this.request("data:get-default-profiles");e&&Object.keys(e).length>0?(console.log(`[${this.componentName}] Got default profiles from DataService, creating...`),await this.createDefaultProfilesFromData(e),this.needsDefaultProfiles=!1):console.log(`[${this.componentName}] No default profiles from DataService, will try again later`)}catch(e){console.log(`[${this.componentName}] DataService not ready yet, will try again later:`,e.message),setTimeout(()=>this.tryCreateDefaultProfiles(),100)}}async handleInitialState(e,t){console.log(`[${this.componentName}] handleInitialState called - sender: "${e}", needsDefaultProfiles: ${this.needsDefaultProfiles}`),console.log(`[${this.componentName}] Received state from ${e}:`,t),"DataService"===e&&this.needsDefaultProfiles&&(console.log(`[${this.componentName}] DataService is now available, trying to create default profiles...`),await this.tryCreateDefaultProfiles())}async createDefaultProfilesFromData(e){if(!e||0===Object.keys(e).length)return console.warn(`[${this.componentName}] No default profiles data available, creating minimal fallback`),void await this.createFallbackProfiles();const t={};for(const[i,a]of Object.entries(e))t[i]={name:a.name,description:a.description||"",currentEnvironment:a.currentEnvironment||"space",builds:a.builds||{space:{keys:{}},ground:{keys:{}}},aliases:a.aliases||{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()};for(const[e,i]of Object.entries(t))await this.storage.saveProfile(e,i),this.state.profiles[e]=i;let i=!1;if(!this.state.currentProfile&&Object.keys(t).length>0){this.state.currentProfile=Object.keys(t)[0],i=!0;const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e);const a=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=a.currentEnvironment||"space"}if(this.state.metadata.lastModified=(new Date).toISOString(),console.log(`[${this.componentName}] Created ${Object.keys(t).length} default profiles from DataService`),this.emit("profiles:initialized",{profiles:this.state.profiles,currentProfile:this.state.currentProfile,timestamp:Date.now()}),i&&this.state.currentProfile){const e=this.state.profiles[this.state.currentProfile],t=this.buildVirtualProfile(e,this.state.currentEnvironment);console.log(`[${this.componentName}] Emitting profile:switched for initial profile activation: ${this.state.currentProfile}`),this.emit("profile:switched",{fromProfile:null,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:t,environment:this.state.currentEnvironment,timestamp:Date.now()})}}async createFallbackProfiles(){const e={default_space:{name:"Default Space",description:"Basic space build profile",currentEnvironment:"space",builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()}};for(const[t,i]of Object.entries(e))await this.storage.saveProfile(t,i),this.state.profiles[t]=i;let t=!1;if(!this.state.currentProfile){this.state.currentProfile="default_space",t=!0;const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e);const i=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=i.currentEnvironment||"space"}if(this.state.metadata.lastModified=(new Date).toISOString(),console.log(`[${this.componentName}] Created ${Object.keys(e).length} fallback profiles`),this.emit("profiles:initialized",{profiles:this.state.profiles,currentProfile:this.state.currentProfile,timestamp:Date.now()}),t&&this.state.currentProfile){const e=this.state.profiles[this.state.currentProfile],t=this.buildVirtualProfile(e,this.state.currentEnvironment);console.log(`[${this.componentName}] Emitting profile:switched for initial fallback profile activation: ${this.state.currentProfile}`),this.emit("profile:switched",{fromProfile:null,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:t,environment:this.state.currentEnvironment,timestamp:Date.now()})}}generateProfileId(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").substring(0,50)}}({eventBus:r,storage:rt});lt.init();const dt=rt.getSettings();(async()=>{function t(e=document){e.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n"),i=e.getAttribute("data-i18n-attr");if(!t)return;const a=Y.t(t);i?e.setAttribute(i,a):e.textContent=a}),e.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const t=e.getAttribute("data-i18n-placeholder");t&&e.setAttribute("placeholder",Y.t(t))}),e.querySelectorAll("[data-i18n-title]").forEach(e=>{const t=e.getAttribute("data-i18n-title");t&&e.setAttribute("title",Y.t(t))}),e.querySelectorAll("[data-i18n-alt]").forEach(e=>{const t=e.getAttribute("data-i18n-alt");t&&e.setAttribute("alt",Y.t(t))})}function i(){t();const i=document.getElementById("appVersion");i&&(i.textContent=e)}await Y.init({lng:dt.language||"en",fallbackLng:"en",resources:{en:{translation:Q},de:{translation:ee},fr:{translation:te},es:{translation:ie}}}),window.i18next=Y,window.localizeCommandData&&window.localizeCommandData(),window.applyTranslations=t,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i();const a=new be,n=new Ce({storage:rt,eventBus:r});new Te(r);const s={showToast:(e,t="info")=>r.emit("toast:show",{message:e,type:t}),confirm:(e,t)=>r.emit("confirm:show",{message:e,callback:t}),showModal:e=>r.emit("modal:show",{modalId:e}),hideModal:e=>r.emit("modal:hide",{modalId:e}),copyToClipboard:e=>r.emit("ui:copy-to-clipboard",{text:e})},o=new $e({eventBus:r,storage:rt,exportManager:n,ui:s});o.init();const c=new ve({storage:rt,ui:s});Object.assign(window,{storageService:rt,dataService:ct,dataCoordinator:lt,stoKeybinds:a,stoExport:n,stoUI:s,stoFileExplorer:o,stoSync:c,eventBus:r});const l=new ot;if("function"!=typeof l.init)console.error("app.init is not a function!");else try{const e=l.init();e&&"function"==typeof e.catch?await e:console.error("TEST: app.init() did not return a Promise")}catch(e){console.error("TEST: app.init() failed:",e)}r.on("sto-app-ready",()=>{a.init(),n.init(),o.isInitialized()||o.init(),console.log("=== Settings Button Debug ===");const e=document.getElementById("settingsBtn"),t=document.getElementById("settingsMenu"),i=document.getElementById("preferencesBtn");console.log("1. Elements exist check:"),console.log("- settingsBtn:",!!e),console.log("- settingsMenu:",!!t),console.log("- preferencesBtn:",!!i),e&&(console.log("\n2. Settings Button properties:"),console.log("- tagName:",e.tagName),console.log("- className:",e.className),console.log("- parent dropdown:",e.closest(".dropdown")?.className),console.log("\n3. Event Listeners:"),console.log("- Has onclick:",!!e.onclick),console.log("- Has click listeners:",!!e.ne),console.log("\n4. Event-based architecture check:"),console.log("- eventBus exists:",!!window.eventBus),console.log("- Settings managed by HeaderMenuUI via events")),t&&(console.log("\n5. Settings Menu properties:"),console.log("- display:",t.style.display),console.log("- visibility:",t.style.visibility),console.log("- parent dropdown active:",e?.closest(".dropdown")?.classList.contains("active")))})})();
//# sourceMappingURL=bundle.js.map
