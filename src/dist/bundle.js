const e="v2025.07.06-beta-3",t=new Map;function i(e,i){return t.has(e)||t.set(e,new Set),t.get(e).add(i),()=>{a(e,i)}}function a(e,i){const a=t.get(e);a&&a.delete(i)}function s(e,i){const a=t.get(e);a&&a.forEach(e=>{try{e(i)}catch(e){}})}function n(e,t,i,a){if("string"==typeof e){"function"==typeof i&&void 0===a&&(a=i,i=t);const n=/^[.#]/.test(e)?e:`#${e}`,r=e=>{if(e.target.closest(n)){if(a)try{a(e)}catch(e){}s(i||t,e)}};return document.addEventListener(t,r,!0),()=>{document.removeEventListener(t,r,!0)}}if(!e||!e.addEventListener)return()=>{};if("function"==typeof i&&(a=i,i=t),i||(i=t),a){const n=e=>{try{a(e)}catch(e){}s(i,e)};return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}{const a=e=>s(i,e);return e.addEventListener(t,a),()=>{e.removeEventListener(t,a)}}}function r(e,t=250){let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>e.apply(this,a),t)}}var o={on:i,off:a,emit:s,onDom:n,onDomDebounced:function(e,t,i,a,s=250){"number"==typeof a&&(s=a,a=void 0);const o=r(a||(()=>{}),s);return n(e,t,i,e=>{o(e)})},debounce:r,once:function(e,t){const s=i=>{a(e,s),t(i)};i(e,s)},clear:function(){t.clear()},getListenerCount:function(e){const i=t.get(e);return i?i.size:0},getAllListenerCounts:function(){const e={};for(const[i,a]of t)e[i]=a.size;return e},get listeners(){return t}};const c={commands:{targeting:{name:"Targeting",icon:"fas fa-crosshairs",description:"Target selection and management",commands:{target:{name:"Target by Name",command:"Target",description:"Target entity by name (requires quotes)",syntax:'Target "EntityName"',icon:"🎯",customizable:!0,parameters:{entityName:{type:"text",default:"EntityName",placeholder:"Enter entity name"}}},target_enemy_near:{name:"Target Nearest Enemy",command:"Target_Enemy_Near",description:"Target the nearest enemy in view",syntax:"Target_Enemy_Near",icon:"🎯"},target_friend_near:{name:"Target Nearest Friend",command:"Target_Friend_Near",description:"Target the nearest friendly entity",syntax:"Target_Friend_Near",icon:"🤝"},target_self:{name:"Target Self",command:"Target_Self",description:"Target your own ship/character",syntax:"Target_Self",icon:"👤"},target_clear:{name:"Clear Target",command:"Target_Clear",description:"Remove current target lock",syntax:"Target_Clear",icon:"❌"},target_teammate_1:{name:"Target Teammate 1",command:"Target_Teammate 1",description:"Target first team member",syntax:"Target_Teammate 1",icon:"👥"},target_teammate_2:{name:"Target Teammate 2",command:"Target_Teammate 2",description:"Target second team member",syntax:"Target_Teammate 2",icon:"👥"},target_teammate_3:{name:"Target Teammate 3",command:"Target_Teammate 3",description:"Target third team member",syntax:"Target_Teammate 3",icon:"👥"},target_teammate_4:{name:"Target Teammate 4",command:"Target_Teammate 4",description:"Target fourth team member",syntax:"Target_Teammate 4",icon:"👥"}}},combat:{name:"Combat",icon:"fas fa-fire",description:"Weapon firing and combat actions",commands:{fire_all:{name:"Fire All Weapons",command:"FireAll",description:"Fire all weapons",syntax:"FireAll",environment:"space",icon:"🔥",warning:"spam_bar_warning"},fire_phasers:{name:"Fire Energy Weapons",command:"FirePhasers",description:"Fire all Energy Weapons",syntax:"FirePhasers",environment:"space",icon:"⚡",warning:"spam_bar_warning"},fire_torps:{name:"Fire Torpedoes",command:"FireTorps",description:"Fire all Torpedos",syntax:"FireTorps",environment:"space",icon:"🚀",warning:"spam_bar_warning"},fire_mines:{name:"Fire Mines",command:"FireMines",description:"Fire all Mines",syntax:"FireMines",environment:"space",icon:"💣",warning:"spam_bar_warning"},fire_phasers_torps:{name:"Fire Phasers & Torpedoes",command:"FirePhasersTorps",description:"Fire phasers & torpedos",syntax:"FirePhasersTorps",environment:"space",icon:"💥",warning:"spam_bar_warning"},fire_projectiles:{name:"Fire Projectiles",command:"FireProjectiles",description:"Fire torpedos & mines",syntax:"FireProjectiles",environment:"space",icon:"🎯",warning:"spam_bar_warning"},aim:{name:"Aim/Scope",command:"aim",description:"Toggle scope on/off. In scope mode the player does more damage. Can either be used as a toggle or a press and hold",syntax:"aim",environment:"ground",icon:"🎯"},holster:{name:"Holster Weapon",command:"Holster",description:"Attempt to holster your active weapon",syntax:"Holster",environment:"ground",icon:"🔫"},holster_toggle:{name:"Holster Toggle",command:"HolsterToggle",description:"Attempt to holster or draw your weapons",syntax:"HolsterToggle",environment:"ground",icon:"🔄"},unholster:{name:"Unholster Weapon",command:"Unholster",description:"Attempt to draw your active weapon",syntax:"Unholster",environment:"ground",icon:"🔫"},toggle_shooter_mode:{name:"Toggle Shooter Mode",command:"ToggleShooterMode",description:"Toggle shooter mode on/off",syntax:"ToggleShooterMode",environment:"ground",icon:"🎮"},shooter_primary:{name:"Shooter Primary",command:"ShooterPrimary",description:"Primary shooter mode action",syntax:"ShooterPrimary",environment:"ground",icon:"🎯"},shooter_secondary:{name:"Shooter Secondary",command:"Shootersecondary",description:"Secondary shooter mode action",syntax:"Shootersecondary",environment:"ground",icon:"🎯"},shooter_tertiary:{name:"Shooter Tertiary",command:"Shootertertiary",description:"Tertiary shooter mode action",syntax:"Shootertertiary",environment:"ground",icon:"🎯"},shooter_clear_offset_tray_binds:{name:"Shooter Clear Offset Tray Binds",command:"ShooterClearOffsetTrayBinds",description:"Clear the starting location and movement of the yellow action box that appears on the tray while in shooter mode",syntax:"ShooterClearOffsetTrayBinds",environment:"ground",icon:"🧹"},shooter_clear_overlay_tray_binds:{name:"Shooter Clear Overlay Tray Binds",command:"ShooterClearOverlayTrayBinds",description:"Clear overlay tray bindings for shooter mode",syntax:"ShooterClearOverlayTrayBinds",environment:"ground",icon:"🧹"},shooter_set_offset_tray_binds:{name:"Shooter Set Offset Tray Binds",command:"ShooterSetOffsetTrayBinds",description:"Set the starting location and movement of the yellow action box that appears on the tray while in shooter mode",syntax:"ShooterSetOffsetTrayBinds",environment:"ground",icon:"⚙️"},shooter_set_overlay_tray_binds:{name:"Shooter Set Overlay Tray Binds",command:"ShooterSetOverlayTrayBinds",description:"Set overlay tray bindings for shooter mode",syntax:"ShooterSetOverlayTrayBinds",environment:"ground",icon:"⚙️"}}},cosmetic:{name:"Cosmetic",icon:"fas fa-palette",description:"Character appearance and customization",commands:{setactivecostume:{name:"Set Active Costume",command:"setactivecostume",description:"Sets current active costume. Requires two modifiers.",syntax:"setactivecostume <modifier1> <modifier2>",environment:"ground",icon:"👕",customizable:!0,parameters:{modifier1:{type:"text",default:"modifier1",placeholder:"First modifier"},modifier2:{type:"text",default:"modifier2",placeholder:"Second modifier"}}}}},bridge_officer:{name:"Bridge Officer",icon:"fas fa-user-friends",description:"Ground bridge officer control commands",commands:{setrallypoint:{name:"Set Rally Point",command:"Setrallypoint",description:"Set a rally point for your current target",syntax:"Setrallypoint",environment:"ground",icon:"📍"},setrallypointconsole:{name:"Set Rally Point (Console)",command:"Setrallypointconsole",description:"Set a rally point for your current target (console variant)",syntax:"Setrallypointconsole",environment:"ground",icon:"🖥️"},clearrallypoint:{name:"Clear Rally Point",command:"Clearrallypoint",description:"Clear the rally point for your current target",syntax:"Clearrallypoint",environment:"ground",icon:"❌"},clearallrallypoints:{name:"Clear All Rally Points",command:"Clearallrallypoints",description:"Clear all the rally points",syntax:"Clearallrallypoints",environment:"ground",icon:"🧹"},assist:{name:"Assist",command:"Assist",description:'Assist "<name>": Assists the Entity with the matching name. If no name is given, assists your current target.',syntax:"Assist <name>",environment:"ground",icon:"🤝",customizable:!0,parameters:{name:{type:"text",default:"",placeholder:"Entity name (optional)"}}}}},tray:{name:"Tray Execution",icon:"fas fa-th",description:"Execute abilities from action trays",commands:{custom_tray:{name:"Tray Execution",command:"+STOTrayExecByTray 0 0",description:"Execute specific tray slot",syntax:"+STOTrayExecByTray <tray> <slot>",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},slot:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},tray_with_backup:{name:"Tray Execution with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute specific tray slot with backup ability",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot>",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},slot:{type:"number",min:0,max:9,default:0},backup_tray:{type:"number",min:0,max:9,default:0},backup_slot:{type:"number",min:0,max:9,default:0}}},tray_range:{name:"Tray Range Execution",command:"+STOTrayExecByTray 0 0",description:"Execute a range of tray slots",syntax:"+STOTrayExecByTray <tray> <slot> $$ ... (range)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},start_tray:{type:"number",min:0,max:9,default:0},start_slot:{type:"number",min:0,max:9,default:0},end_tray:{type:"number",min:0,max:9,default:0},end_slot:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},tray_range_with_backup:{name:"Tray Range with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute a range of tray slots with backup abilities",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot> $$ ... (range)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},start_tray:{type:"number",min:0,max:9,default:0},start_slot:{type:"number",min:0,max:9,default:0},end_tray:{type:"number",min:0,max:9,default:0},end_slot:{type:"number",min:0,max:9,default:0},backup_start_tray:{type:"number",min:0,max:9,default:0},backup_start_slot:{type:"number",min:0,max:9,default:0},backup_end_tray:{type:"number",min:0,max:9,default:0},backup_end_slot:{type:"number",min:0,max:9,default:0}}},whole_tray:{name:"Whole Tray Execution",command:"+STOTrayExecByTray 0 0",description:"Execute all slots in a tray",syntax:"+STOTrayExecByTray <tray> <slot> $$ ... (all slots)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray"}}},whole_tray_with_backup:{name:"Whole Tray with Backup",command:"TrayExecByTrayWithBackup 1 0 0 0 0",description:"Execute all slots in a tray with backup tray",syntax:"TrayExecByTrayWithBackup <active> <tray> <slot> <backup_tray> <backup_slot> $$ ... (all slots)",icon:"⚡",customizable:!0,parameters:{active:{type:"number",min:0,max:1,default:1},tray:{type:"number",min:0,max:9,default:0},backup_tray:{type:"number",min:0,max:9,default:0}}}}},power:{name:"Shield Management",icon:"fas fa-shield-alt",description:"Shield power and distribution management",commands:{distribute_shields:{name:"Distribute Shields",command:"+power_exec Distribute_Shields",description:"Evenly distributes shields as if clicking in the middle of the ship and shields icon",syntax:"+power_exec Distribute_Shields",environment:"space",icon:"🛡️",warning:"spam_bar_warning"},reroute_shields_rear:{name:"Reroute Shields Rear",command:"+power_exec reroute_shields_rear",description:"Route shield power to rear facing",syntax:"+power_exec reroute_shields_rear",environment:"space",icon:"🛡️",warning:"spam_bar_warning"},reroute_shields_left:{name:"Reroute Shields Left",command:"+power_exec reroute_shields_left",description:"Route shield power to left side",syntax:"+power_exec reroute_shields_left",environment:"space",icon:"🛡️",warning:"spam_bar_warning"},reroute_shields_right:{name:"Reroute Shields Right",command:"+power_exec reroute_shields_right",description:"Route shield power to right side",syntax:"+power_exec reroute_shields_right",environment:"space",icon:"🛡️",warning:"spam_bar_warning"},reroute_shields_forward:{name:"Reroute Shields Forward",command:"+power_exec reroute_shields_forward",description:"Route shield power to forward facing",syntax:"+power_exec reroute_shields_forward",environment:"space",icon:"🛡️",warning:"spam_bar_warning"}}},movement:{name:"Movement",icon:"fas fa-arrows-alt",description:"Ship movement and navigation",commands:{full_impulse:{name:"Full Impulse",command:"+fullimpulse",description:"Engage full impulse drive",syntax:"+fullimpulse",environment:"space",icon:"🚀"},reverse:{name:"Reverse",command:"+reverse",description:"Reverse engines",syntax:"+reverse",icon:"⬅️"},throttle_adjust:{name:"Throttle Adjust",command:"ThrottleAdjust",description:"Increase or decrease the throttle by amount",syntax:"ThrottleAdjust <amount>",icon:"⚡",customizable:!0,parameters:{amount:{type:"number",min:-1,max:1,default:.25,step:.05}}},throttle_set:{name:"Throttle Set",command:"ThrottleSet",description:"Set the throttle to a specific position (negative = reverse, 0 = stop)",syntax:"ThrottleSet <position>",icon:"🎛️",customizable:!0,parameters:{position:{type:"number",min:-1,max:1,default:1,step:.1}}},throttle_toggle:{name:"Throttle Toggle",command:"ThrottleToggle",description:"Alternates between full throttle and full stop",syntax:"ThrottleToggle",icon:"🔄"},turn_left:{name:"Turn Left",command:"+turnleft",description:"Turn ship left (continuous while held)",syntax:"+turnleft",icon:"↪️"},turn_right:{name:"Turn Right",command:"+turnright",description:"Turn ship right (continuous while held)",syntax:"+turnright",icon:"↩️"},pitch_up:{name:"Pitch Up",command:"+up",description:"Pitch ship nose up (space altitude change)",syntax:"+up",icon:"⬆️"},pitch_down:{name:"Pitch Down",command:"+down",description:"Pitch ship nose down (space altitude change)",syntax:"+down",icon:"⬇️"},strafe_left:{name:"Strafe Left",command:"+left",description:"Strafe ship left",syntax:"+left",icon:"⬅️"},strafe_right:{name:"Strafe Right",command:"+right",description:"Strafe ship right",syntax:"+right",icon:"➡️"},forward:{name:"Forward",command:"+forward",description:"Move forward",syntax:"+forward",icon:"⬆️"},backward:{name:"Backward",command:"+backward",description:"Move backward",syntax:"+backward",icon:"⬇️"},auto_forward:{name:"Auto Forward",command:"autoForward",description:"Character moves forward until given new movement commands",syntax:"autoForward",environment:"ground",icon:"🏃"},follow:{name:"Follow Target",command:"Follow",description:"Follow the targeted entity",syntax:"Follow",icon:"👥"},follow_cancel:{name:"Cancel Follow",command:"Follow_Cancel",description:"Stop following and forget about the target",syntax:"Follow_Cancel",icon:"❌"}}},camera:{name:"Camera",icon:"fas fa-video",description:"Camera control and view management",commands:{zoom_in:{name:"Zoom In",command:"Camzoomin",description:"Zoom the camera in",syntax:"Camzoomin",icon:"🔍"},zoom_out:{name:"Zoom Out",command:"Camzoomout",description:"Zoom the camera out",syntax:"Camzoomout",icon:"🔎"},zoom_in_small:{name:"Zoom In Small",command:"Camzoominsmall",description:"Zoom the camera in slightly",syntax:"Camzoominsmall",icon:"🔍"},zoom_out_small:{name:"Zoom Out Small",command:"Camzoomoutsmall",description:"Zoom the camera out slightly",syntax:"Camzoomoutsmall",icon:"🔎"},cam_distance:{name:"Set Camera Distance",command:"camdist",description:"Sets the camera distance from the player",syntax:"camdist <distance>",icon:"📏",customizable:!0,parameters:{distance:{type:"number",min:1,max:500,default:50}}},cam_reset:{name:"Reset Camera",command:"CamReset",description:"Reset the camera position to default",syntax:"CamReset",icon:"🔄"},cam_target_lock:{name:"Lock Camera to Target",command:"Camsetlocktotarget",description:"Lock or unlock the camera to the target",syntax:"Camsetlocktotarget",icon:"🎯"},cam_cycle_distance:{name:"Cycle Camera Distance",command:"camCycleDist",description:"Cycle the camera distance between several preset values",syntax:"camCycleDist",icon:"🔄"},cam_mouse_look:{name:"Mouse Look",command:"+camMouseLook",description:"Enable mouse look camera control",syntax:"+camMouseLook",icon:"🖱️"},cam_turn_to_face:{name:"Turn to Face Camera",command:"+camTurnToFace",description:"Turn ship to face camera direction",syntax:"+camTurnToFace",icon:"↪️"},look_up:{name:"Look Up",command:"lookUp",description:"Change point of view to look straight up",syntax:"lookUp",icon:"⬆️"},look_down:{name:"Look Down",command:"lookDown",description:"Change point of view to look straight down",syntax:"lookDown",icon:"⬇️"}}},communication:{name:"Communication",icon:"fas fa-comments",description:"Chat and team communication",commands:{team_message:{name:"Team Message",command:"team",description:"Send message to team",syntax:"team message",icon:"💬",customizable:!0,parameters:{verb:{type:"select",default:"team",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}},local_message:{name:"Local Message",command:"say",description:"Send message to local area",syntax:"say message",icon:"📢",customizable:!0,parameters:{verb:{type:"select",default:"say",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}},zone_message:{name:"Zone Message",command:"zone",description:"Send message to zone",syntax:"zone message",icon:"📡",customizable:!0,parameters:{verb:{type:"select",default:"zone",options:["say","team","zone"]},message:{type:"text",default:"Message text here"}}}}},system:{name:"System",icon:"fas fa-cog",description:"UI and system commands",commands:{toggle_hud:{name:"Toggle HUD",command:"+GenToggleHUD",description:"Toggle HUD visibility",syntax:"+GenToggleHUD",icon:"👁️"},screenshot:{name:"Screenshot",command:"screenshot",description:"Take a screenshot",syntax:"screenshot",icon:"📷"},screenshot_jpg:{name:"Screenshot JPG",command:"screenshot_jpg",description:"Save a screenshot as JPG",syntax:"screenshot_jpg",icon:"📷"},autofire_toggle:{name:"Toggle Autofire",command:"+GenToggleAutofire",description:"Toggle weapon autofire",syntax:"+GenToggleAutofire",icon:"🔁"},bind_save_file:{name:"Save Binds to File",command:"bind_save_file",description:"Save all your binds to a text file",syntax:"bind_save_file <filename>",icon:"💾",customizable:!0,parameters:{filename:{type:"text",default:"my_binds.txt"}}},bind_load_file:{name:"Load Binds from File",command:"bind_load_file",description:"Load a bind file into the client",syntax:"bind_load_file <filename>",icon:"📁",customizable:!0,parameters:{filename:{type:"text",default:"my_binds.txt"}}},combat_log:{name:"Toggle Combat Log",command:"CombatLog",description:"Turn combat log recording on/off (1=on, 0=off)",syntax:"CombatLog <1/0>",icon:"📊",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},chat_log:{name:"Toggle Chat Log",command:"ChatLog",description:"Turn chat log recording on/off (1=on, 0=off)",syntax:"ChatLog <1/0>",icon:"💬",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},missions:{name:"Show/Hide Missions",command:"missions",description:"Show/hide the mission journal",syntax:"missions",icon:"📋"},inventory:{name:"Show/Hide Inventory",command:"Inventory",description:"Show/hide your inventory",syntax:"Inventory",icon:"🎒"},map:{name:"Show/Hide Map",command:"Map",description:"Show/hide the map window",syntax:"Map",icon:"🗺️"},logout:{name:"Logout",command:"logout",description:"Log out the current character",syntax:"logout",icon:"🚪"},quit:{name:"Quit Game",command:"quit",description:"Close the window",syntax:"quit",icon:"❌"},goto_character_select:{name:"Go to Character Select",command:"gotoCharacterSelect",description:"Go to the character select screen without logging out",syntax:"gotoCharacterSelect",icon:"👤"},ui_load:{name:"Load UI Settings",command:"ui_load",description:"Loads default UI Windows save file, usually Live\\ui_settings.txt",syntax:"ui_load",icon:"📂"},ui_load_file:{name:"Load UI Settings File",command:"ui_load_file",description:"Loads named UI Windows save file",syntax:"ui_load_file <filename>",icon:"📂",customizable:!0,parameters:{filename:{type:"text",default:"ui_settings.txt"}}},ui_save:{name:"Save UI Settings",command:"ui_save",description:"Saves UI layout to default UI Window save file, usually Live\\ui_settings.txt",syntax:"ui_save",icon:"💾"},ui_save_file:{name:"Save UI Settings File",command:"ui_save_file",description:"Saves UI layout to named UI Window save file",syntax:"ui_save_file <filename>",icon:"💾",customizable:!0,parameters:{filename:{type:"text",default:"ui_settings.txt"}}},ui_cancel:{name:"UI Cancel",command:"uiCancel",description:'Respond "Cancel" to an open dialog box; may not work in all dialogs',syntax:"uiCancel",icon:"❌"},ui_ok:{name:"UI OK",command:"uiOK",description:'Respond "OK" to an open dialog box; may not work in all dialogs',syntax:"uiOK",icon:"✅"},ui_gen_layers_reset:{name:"Reset UI Layout",command:"ui_GenLayersReset",description:"Resets the layout, used for when the server updates movable window positions",syntax:"ui_GenLayersReset",icon:"🔄"},ui_resolution:{name:"Print UI Resolution",command:"ui_resolution",description:"Print the current UI screen resolution",syntax:"ui_resolution",icon:"📐"},ui_tooltip_delay:{name:"Set Tooltip Delay",command:"ui_TooltipDelay",description:"Sets the additional delay, in seconds, before tooltips appear",syntax:"ui_TooltipDelay <seconds>",icon:"⏱️",customizable:!0,parameters:{seconds:{type:"number",min:0,max:10,default:.5,step:.1}}},remember_ui_lists:{name:"Remember UI Lists",command:"RememberUILists",description:"Whether to remember UI List Column placement and width",syntax:"RememberUILists <1/0>",icon:"📋",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},ui_remember_positions:{name:"Remember UI Positions",command:"UIRememberPositions",description:"Whether to remember UI sizes and positions. On by default",syntax:"UIRememberPositions <1/0>",icon:"📍",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},safe_login:{name:"Safe Login",command:"SafeLogin",description:"If true, then log the player back into their most recent static map instead of anything else",syntax:"SafeLogin <1/0>",icon:"🛡️",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},show_game_ui:{name:"Show Game UI",command:"ShowGameUI",description:"Show the game UI",syntax:"ShowGameUI",icon:"🎮"},show_game_ui_no_extra_keybinds:{name:"Show Game UI (No Extra Keybinds)",command:"ShowGameUINoExtraKeyBinds",description:"This command does not add any keybinds for showing the UI when the user presses escape",syntax:"ShowGameUINoExtraKeyBinds",icon:"🎮"},change_instance:{name:"Change Instance",command:"ChangeInstance",description:"Change to an already created instance of the same map. Only works while not at red alert",syntax:"ChangeInstance",icon:"🔄"},net_timing_graph:{name:"Net Timing Graph",command:"netTimingGraph",description:"Enable or disable the network timing graph (0=disable, 1=enable)",syntax:"netTimingGraph <0/1>",icon:"📊",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}},net_timing_graph_alpha:{name:"Net Timing Graph Alpha",command:"netTimingGraphAlpha",description:"Set transparency level for network timing graph (50=highest transparency, 255=no transparency)",syntax:"netTimingGraphAlpha <50-255>",icon:"🎨",customizable:!0,parameters:{alpha:{type:"number",min:50,max:255,default:255}}},net_timing_graph_paused:{name:"Net Timing Graph Paused",command:"netTimingGraphPaused",description:"Pause or resume the network timing graph (0=pause disabled, 1=pause enabled)",syntax:"netTimingGraphPaused <0/1>",icon:"⏸️",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:0}}},netgraph:{name:"Net Graph",command:"netgraph",description:"Display SND and RCV network data as text (1=enabled, 0=disabled)",syntax:"netgraph <0/1>",icon:"🌐",customizable:!0,parameters:{state:{type:"number",min:0,max:1,default:1}}}}}},templates:{space_combat:{basic_attack:{name:"Basic Attack Sequence",description:"Target enemy and fire all weapons",commands:["Target_Enemy_Near","FireAll"]},defensive_sequence:{name:"Defensive Sequence",description:"Target self and activate defensive abilities",commands:["Target_Self","+power_exec Distribute_Shields"]},alpha_strike:{name:"Alpha Strike",description:"Full offensive sequence with buffs",commands:["Target_Enemy_Near","FireAll"]},healing_sequence:{name:"Emergency Healing",description:"Self-healing and damage control",commands:["Target_Self","+power_exec Distribute_Shields"]}},ground_combat:{basic_ground_attack:{name:"Basic Ground Attack",description:"Target and attack sequence for ground combat",commands:["Target_Enemy_Near","+STOTrayExecByTray 0 0"]}}},defaultProfiles:{default_space:{name:"Default Space",description:"Basic space combat configuration",currentEnvironment:"space",builds:{space:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_1"},{command:"FireAll",type:"combat",icon:"🔥",text:"Fire all weapons",id:"cmd_2"}]}},ground:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_g1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Primary attack",id:"cmd_g2"}]}}},aliases:{AttackCall:{description:"Call out attack target to team",commands:"team Attacking [$Target] - focus fire!"},TargetReport:{description:"Report current target to team",commands:"team Current target: [$Target]"},HealCall:{description:"Request healing for target",commands:"team Need healing on [$Target]!"}}},tactical_space:{name:"Tactical Space",description:"Aggressive DPS-focused space build",currentEnvironment:"space",builds:{space:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Execute Tray 1 Slot 1",id:"cmd_2"},{command:"FireAll",type:"combat",icon:"🔥",text:"Fire all weapons",id:"cmd_3"},{command:"+power_exec Distribute_Shields",type:"power",icon:"🛡️",text:"Distribute shields",id:"cmd_4"}],1:[{command:"+STOTrayExecByTray 1 0",type:"tray",icon:"⚡",text:"Execute Tray 2 Slot 1",id:"cmd_5"}],F1:[{command:"Target_Self",type:"targeting",icon:"👤",text:"Target self",id:"cmd_6"},{command:"+STOTrayExecByTray 2 0",type:"tray",icon:"⚡",text:"Execute Tray 3 Slot 1",id:"cmd_7"}]}},ground:{keys:{Space:[{command:"Target_Enemy_Near",type:"targeting",icon:"🎯",text:"Target nearest enemy",id:"cmd_g1"},{command:"+STOTrayExecByTray 0 0",type:"tray",icon:"⚡",text:"Primary attack",id:"cmd_g2"}],1:[{command:"+STOTrayExecByTray 0 1",type:"tray",icon:"⚡",text:"Secondary attack",id:"cmd_g3"}],F1:[{command:"Target_Self",type:"targeting",icon:"👤",text:"Target self",id:"cmd_g4"},{command:"+STOTrayExecByTray 1 0",type:"tray",icon:"💊",text:"Heal self",id:"cmd_g5"}]}}},aliases:{}}},keys:{common:{name:"Common Keys",description:"Most frequently used keys",keys:[{key:"Space",description:"Spacebar"},{key:"1",description:"Number 1"},{key:"2",description:"Number 2"},{key:"3",description:"Number 3"},{key:"4",description:"Number 4"},{key:"5",description:"Number 5"},{key:"F1",description:"Function Key 1"},{key:"F2",description:"Function Key 2"},{key:"F3",description:"Function Key 3"},{key:"F4",description:"Function Key 4"},{key:"Tab",description:"Tab"},{key:"enter",description:"Main Enter Key"},{key:"Shift",description:"Shift"},{key:"Control",description:"Control"},{key:"ALT",description:"Alt"}]},letters:{name:"Letter Keys",description:"A-Z keyboard letters",keys:[{key:"A",description:"Key A"},{key:"B",description:"Key B"},{key:"C",description:"Key C"},{key:"D",description:"Key D"},{key:"E",description:"Key E"},{key:"F",description:"Key F"},{key:"G",description:"Key G"},{key:"H",description:"Key H"},{key:"I",description:"Key I"},{key:"J",description:"Key J"},{key:"K",description:"Key K"},{key:"L",description:"Key L"},{key:"M",description:"Key M"},{key:"N",description:"Key N"},{key:"O",description:"Key O"},{key:"P",description:"Key P"},{key:"Q",description:"Key Q"},{key:"R",description:"Key R"},{key:"S",description:"Key S"},{key:"T",description:"Key T"},{key:"U",description:"Key U"},{key:"V",description:"Key V"},{key:"W",description:"Key W"},{key:"X",description:"Key X"},{key:"Y",description:"Key Y"},{key:"Z",description:"Key Z"}]},numbers:{name:"Number Keys",description:"Number row and numpad",keys:[{key:"0",description:"Number 0"},{key:"6",description:"Number 6"},{key:"7",description:"Number 7"},{key:"8",description:"Number 8"},{key:"9",description:"Number 9"},{key:"numpad0",description:"Numerical Keypad 0"},{key:"numpad1",description:"Numerical Keypad 1"},{key:"numpad2",description:"Numerical Keypad 2"},{key:"numpad3",description:"Numerical Keypad 3"},{key:"numpad4",description:"Numerical Keypad 4"},{key:"numpad5",description:"Numerical Keypad 5"},{key:"numpad6",description:"Numerical Keypad 6"},{key:"numpad7",description:"Numerical Keypad 7"},{key:"numpad8",description:"Numerical Keypad 8"},{key:"numpad9",description:"Numerical Keypad 9"},{key:"Decimal",description:"Numerical Keypad Decimal"},{key:"Divide",description:"Numerical Keypad Divide"},{key:"Multiply",description:"Multiply (*)"},{key:"Subtract",description:"Subtract (-)"},{key:"Add",description:"Add (+)"},{key:"numpadenter",description:"Numerical Keypad Enter"}]},function:{name:"Function Keys",description:"F1-F24 function keys",keys:[{key:"F5",description:"Function Key 5"},{key:"F6",description:"Function Key 6"},{key:"F7",description:"Function Key 7"},{key:"F8",description:"Function Key 8"},{key:"F9",description:"Function Key 9"},{key:"F10",description:"Function Key 10"},{key:"F11",description:"Function Key 11"},{key:"F12",description:"Function Key 12"},{key:"F13",description:"Function Key 13"},{key:"F14",description:"Function Key 14"},{key:"F15",description:"Function Key 15"},{key:"F16",description:"Function Key 16"},{key:"F17",description:"Function Key 17"},{key:"F18",description:"Function Key 18"},{key:"F19",description:"Function Key 19"},{key:"F20",description:"Function Key 20"},{key:"F21",description:"Function Key 21"},{key:"F22",description:"Function Key 22"},{key:"F23",description:"Function Key 23"},{key:"F24",description:"Function Key 24"}]},arrows:{name:"Arrow & Navigation",description:"Arrow keys and navigation",keys:[{key:"Up",description:"Arrow Key: Up"},{key:"Down",description:"Arrow Key: Down"},{key:"Left",description:"Arrow Key: Left"},{key:"Right",description:"Arrow Key: Right"},{key:"Home",description:"Home"},{key:"End",description:"End"},{key:"PageUp",description:"Page Up"},{key:"PageDown",description:"Page Down"},{key:"insert",description:"Insert"},{key:"delete",description:"Delete"}]},modifiers:{name:"Modifier Keys",description:"Shift, Ctrl, Alt variations",keys:[{key:"ALT",description:"Alt"},{key:"LALT",description:"Alt (Left)"},{key:"RALT",description:"Alt (Right)"},{key:"CTRL",description:"Control"},{key:"LCTRL",description:"Control (Left)"},{key:"RCTRL",description:"Control (Right)"}]},symbols:{name:"Symbol Keys",description:"Punctuation and symbols",keys:[{key:"[",description:"["},{key:"]",description:"]"},{key:"\\",description:"\\"},{key:",",description:"Comma (,)"},{key:".",description:"Period (.)"},{key:"/",description:"Divide (/)"},{key:"`",description:"Tilda Key (~)"}]},mouse:{name:"Mouse Controls",description:"Mouse buttons and scroll",keys:[{key:"Lbutton",description:"Mouse Left Press"},{key:"Rbutton",description:"Mouse Right Press"},{key:"Middleclick",description:"Mouse Middle Click"},{key:"Button1",description:"Mouse Button 1"},{key:"Button2",description:"Mouse Button 2"},{key:"Button3",description:"Mouse Button 3"},{key:"Button4",description:"Mouse Button 4"},{key:"Button5",description:"Mouse Button 5"},{key:"Button6",description:"Mouse Button 6"},{key:"Button7",description:"Mouse Button 7"},{key:"Button8",description:"Mouse Button 8"},{key:"Button9",description:"Mouse Button 9"},{key:"Button10",description:"Mouse Button 10"},{key:"Wheelplus",description:"Mouse Scroll Up"},{key:"Wheelminus",description:"Mouse Scroll Down"}]},gamepad:{name:"Xbox Controller",description:"Xbox/Gamepad controls",keys:[{key:"Joy1",description:"XBOX Contr [Start]"},{key:"Joy2",description:"XBOX Contr [Back]"},{key:"Joy3",description:"XBOX Contr [L Thumb depress]"},{key:"Joy4",description:"XBOX Contr [R Thumb depress]"},{key:"Joy5",description:"XBOX Contr [Left Bumper]"},{key:"Joy6",description:"XBOX Contr [Right Bumper]"},{key:"Joy7",description:"XBOX Contr [Left Trigger]"},{key:"Joy8",description:"XBOX Contr [Right Trigger]"},{key:"Joy9",description:"XBOX Contr [A Button]"},{key:"Joy10",description:"XBOX Contr [B Button]"},{key:"Joy11",description:"XBOX Contr [X Button]"},{key:"Joy12",description:"XBOX Contr [Y Button]"},{key:"Joypad_up",description:"XBOX Contr [Pad up]"},{key:"Joypad_down",description:"XBOX Contr [Pad down]"},{key:"Joypad_left",description:"XBOX Contr [Pad left]"},{key:"Joypad_right",description:"XBOX Contr [Pad right]"},{key:"Lstick_up",description:"XBOX Contr [Left Stick up]"},{key:"Lstick_down",description:"XBOX Contr [Left Stick down]"},{key:"Lstick_left",description:"XBOX Contr [Left Stick left]"},{key:"Lstick_right",description:"XBOX Contr [Left Stick right]"},{key:"Rstick_up",description:"XBOX Contr [Right Stick up]"},{key:"Rstick_down",description:"XBOX Contr [Right Stick down]"},{key:"Rstick_left",description:"XBOX Contr [Right Stick left]"},{key:"Rstick_right",description:"XBOX Contr [Right Stick right]"}]}},validation:{keyNamePattern:/^[a-zA-Z0-9_+\-\s]+$/,aliasNamePattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,maxCommandsPerKey:20,maxKeysPerProfile:100},settings:{version:"1.0.0",autoSave:!0,maxUndoSteps:50,defaultMode:"space",language:"en"},variables:{target:{variable:"$Target",description:"Replaced with the name of your current target",example:"team Target [$Target]",usableIn:["communication","custom","aliases"],notes:"If your target's name is 'froggyMonster', this will output 'Target [froggyMonster]'"}},vfxEffects:{space:[{label:"Advanced inhibiting turret shield bubble",effect:"Fx_Rep_Temporal_Ship_Chroniton_Stabilization_Proc"},{label:"Approaching Agony",effect:"Cfx_Lockboxfx_Cb29_Ship_Agony_Field"},{label:"Attack Pattern Alpha",effect:"Fx_Ship_Tac_Attackpatternalpha"},{label:"Attack Pattern Beta",effect:"Fx_Ship_Tac_Attackpatternbeta"},{label:"Attack Pattern Delta",effect:"Fx_Ship_Tac_Attackpatterndelta"},{label:"Attack Pattern Omega",effect:"Fx_Ship_Tac_Attackpatternomega"},{label:"Beacon of Kahless",effect:"Fx_Er_Bbs_Beacon_Of_Kahless_Flash"},{label:"Boost Morale",effect:"Fx_Ship_Spec_Powers_Command_Boost_Morale_Bufffx,Cfx_Ship_Spec_Powers_Command_Boost_Morale_Activate"},{label:"Brace for Impact",effect:"Fx_Bop_Braceforimpact,Cfx_Ship_Sci_Hazardemitter_Buff"},{label:"Breath of the Dragon",effect:"Fx_Ship_Cp_T6_Hysperian_Dragonbreath"},{label:"Call Emergency Artillery",effect:"Fx_Ships_Boffs_Cmd_Callartillery_Activate,Fx_Ships_Boffs_Cmd_Callartillery_Explosion"},{label:"Competitive Engine Buff Effect",effect:"Fx_Ship_Mod_Haste_Buff_Gen"},{label:"Co-opt Energy Weapons",effect:"Fx_Capt_Powers_Ship_Sci_Coopt_Energy_Wep_Aoe,Cfx_Capt_Powers_Ship_Sci_Coopt_Energy_Wep_Area"},{label:"Concentrate Fire Power",effect:"Fx_Ships_Boff_Cmd_Confire_Activatefx,Cfx_Ships_Boff_Cmd_Confire_Mark"},{label:"Cnidarian Jellyfish AoE",effect:"Cfx_Ship_Sp_T6_Jellyfish_Cnidarian_Defense_Aoe"},{label:"Dark Matter Anomaly",effect:"Cfx_Ship_Console_Dark_Matter_Anamoly_Costumefx"},{label:"Delphic Tear",effect:"Fx_Ships_Consoles_Cb21_Delphictear"},{label:"Destabilising Resonance Beam",effect:"P_Er_Ship_Destabilizing_Resonance_Beam_Aoe_Particles"},{label:"Elachi Walker Combat Pet (3 effects)",effect:"Soundfx_Elachiwalker_Footstep_Pet,Fx_Er_Tfo_Elachi_Walker_Combat_Pet_Deathfx,Soundfx_Elachiwalker_Petsummon"},{label:"Electrified Anomalies Trait",effect:"Fx_Tp_Ship_T6_Risian_Science_Electrified_Anomalies_Arc_Foe,Fx_Tp_Ship_T6_Risian_Science_Electrified_Anomalies_Arc_Friend"},{label:"Emergency Pwr to Shields",effect:"Fx_Ship_Eng_Emergencypowershields"},{label:"Emergency Pwr to Wep",effect:"Fx_Ship_Eng_Emergencypowerweapons"},{label:"Engineering Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Engineering_Teambuff"},{label:"Engineering Team",effect:"Cfx_Ship_Crewteam_Engineeringteam_Buff"},{label:"EPS Power Transfer",effect:"Cfx_Ship_Eng_Epspowertransfer_Target"},{label:"Focus Frenzy",effect:"Fx_Skilltree_Ship_Ffrenzy_Activatefx"},{label:"Go Down Fighting",effect:"Fx_Bop_Godownfighting"},{label:"Hangar Pet Rank Up",effect:"Fx_Ship_Levelup_Fighter_Rankup"},{label:"Hazard Emitters",effect:"Cfx_Ship_Sci_Hazardemitter_Buff"},{label:"Intel Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Intel_Teambuff"},{label:"Intel Team (uses 3 effects)",effect:"Cfx_Ship_Cruiser_Auras_Taunt,Cfx_Spc_Boffpowers_Intel_Intelteam_Buff,Fx_Ships_Intel_Lyinginwait"},{label:"Kemocite on ship animation",effect:"C1_E_Ship_Xindi_Lockboxcb15_Kemocite_Weaponry_Bufffx"},{label:"Kemocite HitFX ring",effect:"Fx_Ship_Xindi_Lockboxcb15_Kemocite_Weaponry_Aoe_Proc"},{label:"Kentari Ferocity Weapons Glow",effect:"P_Trait_Powers_Ship_Lukari_Colony_Kentari_Ferocity_Weapons_Glow"},{label:"Kobayashi Maru powerup silenced",effect:"Fx_Evr_Kmaru_Ship_Dev_Resupply_Drop_Powerup_Bufffx,Fx_Evr_Kmaru_Ship_Dev_Resupply_Drop_Powerup"},{label:"Less Obvious Loot Drop Common",effect:"Cfx_Space_Loot_Drop_Common_Costumefx"},{label:"Less Obvious Loot Drop Uncommon",effect:"Cfx_Space_Loot_Drop_Uncommon_Costumefx"},{label:"Less Obvious Loot Drop Rare",effect:"Cfx_Space_Loot_Drop_Rare_Costumefx"},{label:"Less Obvious Loot Drop Very Rare",effect:"Cfx_Space_Loot_Drop_Veryrare_Costumefx"},{label:"Less Obvious Loot Drop Lock Box",effect:"Cfx_Space_Loot_Drop_Chancebox_Costumefx"},{label:"Less Obvious Loot Drop Dilithium",effect:"Cfx_Space_Loot_Drop_Dilithium_Costumefx"},{label:"Miraculous Repairs",effect:"Fx_Bop_Miracleworker"},{label:"MW - Align Shield Frequencies",effect:"Fx_Spc_Boffpowers_Miracleworker_Alignshieldfrequencies_Hitfx"},{label:"MW - Destabilize Warp Core",effect:"Fx_Spc_Boffpowers_Miracleworker_Destabilizewarpcore"},{label:"MW - Exceed rated limits",effect:"Fx_Spc_Boffpowers_Miracleworker_Energyweaponsexceedratedlimits_Dot_Hitfx,Fx_Spc_Boffpowers_Miracleworker_Energyweaponsexceedratedlimits"},{label:"MW - Fix em up (and other green glows)",effect:"Fx_Ship_Mod_Damage_Buff"},{label:"MW - Mixed Armaments Synergy",effect:"Fx_Spc_Boffpowers_Miracleworker_Mixedarmamentssynergy"},{label:"MW - Narrow Sensor Bands",effect:"Fx_Spc_Boffpowers_Miracleworker_Narrowsensorbands"},{label:"MW - Null Pointer Flood",effect:"Fx_Spc_Boffpowers_Miracleworker_Nullpointerflood"},{label:"MW - Reroute shilds to Hull containment",effect:"Fx_Spc_Boffpowers_Miracleworker_Rerouteshieldstohullcontainment,Cfx_Spc_Boffpowers_Miracleworker_Rerouteshieldstohullcontainment"},{label:"Nadion Inversion",effect:"Fx_Bop_Nadioinversion"},{label:"Nanoprobe Shield Generator (Dyson Rep)",effect:"Cfx_Rp_Dyson_Ship_Reactive_Shielding"},{label:"Neutronic Eddies",effect:"Cfx_Ships_Cp_T6_Risian_Science_Neutronic_Edides_Costumefx"},{label:"Overwhelm Emitters",effect:"Fx_Ships_Boff_Cmd_Owemitters_Activatefx"},{label:"Photonic Officer",effect:"Fx_Bop_Photonicofficer_activate"},{label:"PILOT - Clean Getaway",effect:"Fx_Spc_Boff_Pilot_Cleangetaway_Activate"},{label:"PILOT - Coolant Ignition (mostly)",effect:"Fx_Spc_Boff_Pilot_Coolantinjection_Ignite,Fx_Spc_Boff_Pilot_Coolantinjection_Costumefx"},{label:"PILOT - Deploy Countermeasures",effect:"Fx_Spc_Boff_Pilot_Deploycm"},{label:"PILOT - Fly her apart",effect:"Cfx_Spc_Boff_Pilot_Flyapart_Dot"},{label:"PILOT - Form Up (mostly)",effect:"Fx_Spc_Boff_Pilot_Formup_Teleport,Fx_Spc_Boff_Pilot_Formup_Buff_Wepbuff"},{label:"PILOT - hold Together",effect:"Cfx_Spc_Boff_Pilot_Holdtogether"},{label:"PILOT - Lambda",effect:"Fx_Ship_Mod_Damage_Buff,Fx_Spc_Boff_Pilot_Aplambda_Bufffx,Fx_Spc_Boff_Pilot_Aplambda"},{label:"PILOT - Lock Trajectory",effect:"Fx_Spc_Boff_Pilot_Flares_Switch,Cfx_Spc_Boff_Pilot_Locktrajectory"},{label:"PILOT - Pilot Team",effect:"Cfx_Spc_Boff_Pilot_Pilotteam_Buff"},{label:"PILOT - Reroute Reserves to Weapons",effect:"Fx_Spc_Boff_Pilot_Reroute_Wepbuff,Fx_Spc_Boff_Pilot_Reroute_Activate"},{label:"PILOT - Subspace Boom",effect:"Cfx_Spc_Boff_Pilot_Ssboom_Costumefx_Neverdie,Fx_Spc_Boff_Pilot_Ssboom_Boom"},{label:"Plasma Storm",effect:"Cfx_Ship_Cp_Cb27_Generate_Plasma_Storm_Costumefx"},{label:"Rally Point Marker",effect:"Cfx_Ships_Boff_Cmd_Rallypoint_Marker"},{label:"Reverse Shield Polarity",effect:"Cfx_Ship_Eng_Reverseshieldpolarity_Buff"},{label:"Scattering Field",effect:"Cfx_Ship_Sci_Dampeningfield_Aoe,Cfx_Ship_Sci_Dampeningfield_Shield_Buff"},{label:"Science Team",effect:"Cfx_Ship_Crewteam_Scienceteam_Buff"},{label:"Science Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Science_Teambuff"},{label:"Soliton Wave Generator (uses 4 effects)",effect:"Cfx_Ship_Risa_Loot_Soliton_Wave_Suckfx_Target,Cfx_Ship_Risa_Loot_Soliton_Wave_Suckfx,Cfx_Ship_Risa_Loot_Soliton_Wave_Out,Cfx_Ship_Risa_Loot_Soliton_Wave_In"},{label:"Spore Infused Anomalies",effect:"Fx_Trait_Powers_Ship_T6_Somerville_Sia_Blast"},{label:"Subspace Vortex Teleport Effect",effect:"Fx_Ship_Xindi_Lockboxcb15_Subspace_Vortex_Teleport"},{label:"Suppression Barrage",effect:"Cfx_Ships_Boff_Cmd_Sbarrage_Buff"},{label:"Surgical Strikes",effect:"Fx_Spc_Boffpowers_Int_Sstrikes_Buff"},{label:"Tactical Fleet III",effect:"Fx_Ship_Boff_Fleet_Capt_Tactical_Teambuff"},{label:"Tactical Initiative",effect:"Fx_Bop_Tacticalinitiative"},{label:"Tactical Team",effect:"Cfx_Ship_Crewteam_Tacticalteam_Buff"},{label:"Target Rich Environment",effect:"Fx_Ship_Trait_Cb20_Targetrichenvironment"},{label:"Temporal Anchor",effect:"Cfx_Ship_Trait_Temporal_Anchor_Costumefx"},{label:"Temporal Vortex Probe",effect:"C1_Eventreward_Fcd_Temporal_Vortex_Costumefx,Fx_Eventreward_Fcd_Temporal_Vortex_Blast"},{label:"Timeline Collapse (5 effects!)",effect:"Cfx_Ship_Temp_Tcollapse_Costume,Fx_Ship_Temp_Tcollapse_Hitfx,Fx_Ship_Temp_Tcollapse_Explode,Fx_Ship_Temp_Tcollapse_Beamhitfx,Fx_Ship_Temp_Tcollapse"},{label:"V'Ger Torpedo (Volatile Digital Transformation)",effect:"Fx_Ship_Torpedo_Plasma_Vger_Anniv_Explode,Cfx_Ship_Torpedo_Vger_Disintegrate_In_Tintable"},{label:"Viral Impulse Burst",effect:"Fx_Spc_Boffpowers_int_Viralimpulse"},{label:"Vulcan Jelly Fish Eject Red Matter",effect:"Cfx_ship_jellyfish_eject_red_matter_costumefx"},{label:"Vulnerability Assessment Sweep",effect:"Fx_Capt_Powers_Ship_Tac_Vulnerability_Assessment_Sweep"}],ground:[{label:"Agony Field Generator",effect:"Fx_Ground_Lockboxfx_Cb29_Agony_Field_Generator"},{label:"Anti-time ground",effect:"Cfx_Rep_Temp_Char_Kit_Sci_Antitime_Entanglement_Field_Costumefx"},{label:"Ball Lightning",effect:"Cfx_Char_Kit_Univ_Sum_Ball_Lightning_Costumefx"},{label:"Chaos Blaze",effect:"Cfx_Char_Chaos_Blaze_Aoe"},{label:"Conussive Tachyon Emission",effect:"fx_Char_Delta_Rep_Cte_Aoe"},{label:"Disco Ball (Party Bomb)",effect:"Cfx_Char_Device_Partybomb"},{label:"Dot-7 Drone Support Field",effect:"Cfx_Er_Bbs_char_Dot7_Drone_support_Field"},{label:"Eng Proficiency (Character Glow)",effect:"Cfx_Ground_Kit_Eng_Engineeringproficiency"},{label:"Ever Watchful",effect:"Cfx_Ground_Kit_Tac_Overwatch_Bufffx,Fx_Ground_Kit_Tac_Overwatch_Activatefx"},{label:"Herald AP Beam Projector ground weapon",effect:"Fx_Char_Icoenergy_Rifle_Energyblast,Fx_Char_Icoenergy_Assault_Beam_Lockbox"},{label:"Lava Floor",effect:"Cfx_Char_Kit_Univ_Sum_The_Floor_Is_Lava_Costumefx,Cfx_Char_Kit_Univ_Sum_The_Floor_Is_Lava_Geyser"},{label:"Less Obvious Loot Drop Common",effect:"Cfx_Gnd_Loot_Drop_Common_Costumefx"},{label:"Less Obvious Loot Drop Uncommon",effect:"Cfx_Gnd_Loot_Drop_Uncommon_Costumefx"},{label:"Less Obvious Loot Drop Rare",effect:"Cfx_Gnd_Loot_Drop_Rare_Costumefx"},{label:"Less Obvious Loot Drop Very Rare",effect:"Cfx_Gnd_Loot_Drop_Veryrare_Costumefx"},{label:"Less Obvious Loot Drop Lock Box",effect:"Cfx_Gnd_Loot_Drop_Chancebox_Costumefx"},{label:"Less Obvious Loot Drop Dilithium",effect:"Cfx_Gnd_Loot_Drop_Dilithium_Costumefx"},{label:"Motivation (Tac Kit Module)",effect:"Cfx_Ground_Kit_Tac_Motivation_Buff,Fx_Ground_Kit_Tac_Motivation"},{label:"Orbital Devastation",effect:"Fx_Char_Voth_Orbitalstrike_Chasebeam"},{label:"Pahvan Crystal Prism noisy tether",effect:"Cfx_Er_Tfo_Pahvan_Crystal_Prism_Tether_Beam"},{label:"Rally Cry",effect:"Fx_Ground_Kit_Tac_Rallycry"},{label:"Red Riker Gun Sound effect",effect:"Cfx_Ep_Winterevent_Redriker_Sniper_Chargefx"},{label:"Scientific Aptitude (character glow)",effect:"Cfx_Ground_Kit_Sci_Scientificaptitude"},{label:"Solar Gateway",effect:"Fx_Char_Ico_Capt_Portal,Fx_Char_Ico_Capt_Portal_Sunbeam"},{label:"Smoke Grenade",effect:"Fx_Char_Grenade_smoke_costume,Fx_Char_Grenade_Smoke_Explode"},{label:"Sompek Energy Rebounder",effect:"Fx_Env_Gnd_Qadhos_Arena_Phaserhazard_Cylinder_Turret"},{label:"Strike Team III (character red glow)",effect:"Cfx_Ground_Kit_Tac_Striketeam"},{label:"Symphony of Lightning Char Glow",effect:"Fx_Er_Featured_Char_Kuumaarke_Wristgun_Tir_bufffx"},{label:"Symphony of Lightning Drone AoE",effect:"Cfx_Er_Featured_Char_Kuumaarke_Set_Symphony_Of_Lightning_Drone_Aoe"},{label:"Symphony of Lightning STRIKE",effect:"Fx_Er_Featured_Char_Kuumaarke_Set_Symphony_Of_Lightning_Strike"},{label:"Trajectory Bending",effect:"Cfx_Char_Xindi_Cb15_Tac_Kit_Trajectory_Bending"},{label:"Visual Dampening Field",effect:"Cfx_Char_Trait_Mirror_Vdfield"}]}};window.STO_DATA=c,window.VFX_EFFECTS=c.vfxEffects,window.COMMAND_CATEGORIES=c.commands,window.COMMANDS={},Object.entries(c.commands).forEach(([e,t])=>{Object.entries(t.commands).forEach(([t,i])=>{window.COMMANDS[t]={...i,category:e,key:t}})}),window.KEY_LAYOUTS=c.keyLayouts||{qwerty:{name:"QWERTY",rows:[[{key:"Escape",display:"Esc"},{key:"F1",display:"F1"},{key:"F2",display:"F2"},{key:"F3",display:"F3"},{key:"F4",display:"F4"},{key:"F5",display:"F5"},{key:"F6",display:"F6"},{key:"F7",display:"F7"},{key:"F8",display:"F8"},{key:"F9",display:"F9"},{key:"F10",display:"F10"},{key:"F11",display:"F11"},{key:"F12",display:"F12"}],[{key:"`",display:"`"},{key:"1",display:"1"},{key:"2",display:"2"},{key:"3",display:"3"},{key:"4",display:"4"},{key:"5",display:"5"},{key:"6",display:"6"},{key:"7",display:"7"},{key:"8",display:"8"},{key:"9",display:"9"},{key:"0",display:"0"},{key:"-",display:"-"},{key:"=",display:"="},{key:"Backspace",display:"Backspace"}],[{key:"Tab",display:"Tab"},{key:"Q",display:"Q"},{key:"W",display:"W"},{key:"E",display:"E"},{key:"R",display:"R"},{key:"T",display:"T"},{key:"Y",display:"Y"},{key:"U",display:"U"},{key:"I",display:"I"},{key:"O",display:"O"},{key:"P",display:"P"},{key:"[",display:"["},{key:"]",display:"]"},{key:"\\",display:"\\"}],[{key:"CapsLock",display:"Caps"},{key:"A",display:"A"},{key:"S",display:"S"},{key:"D",display:"D"},{key:"F",display:"F"},{key:"G",display:"G"},{key:"H",display:"H"},{key:"J",display:"J"},{key:"K",display:"K"},{key:"L",display:"L"},{key:";",display:";"},{key:"'",display:"'"},{key:"Enter",display:"Enter"}],[{key:"Shift",display:"Shift"},{key:"Z",display:"Z"},{key:"X",display:"X"},{key:"C",display:"C"},{key:"V",display:"V"},{key:"B",display:"B"},{key:"N",display:"N"},{key:"M",display:"M"},{key:",",display:","},{key:".",display:"."},{key:"/",display:"/"},{key:"Shift",display:"Shift"}],[{key:"Ctrl",display:"Ctrl"},{key:"Alt",display:"Alt"},{key:"Space",display:"Space"},{key:"Alt",display:"Alt"},{key:"Ctrl",display:"Ctrl"}]]}},window.DEFAULT_SETTINGS={keyLayout:"qwerty",autoSave:c.settings?.autoSave||!0,showTooltips:!0,exportFormat:"txt",maxUndoSteps:c.settings?.maxUndoSteps||50,defaultMode:c.settings?.defaultMode||"space",language:c.settings?.language||"en"},window.SAMPLE_PROFILES=Object.values(c.defaultProfiles).map(e=>({id:e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,description:e.description,currentEnvironment:e.currentEnvironment||"space",builds:e.builds||{space:{keys:{}},ground:{keys:{}}},created:(new Date).toISOString(),modified:(new Date).toISOString()})),window.SAMPLE_ALIASES={attack_sequence:{name:"Attack Sequence",commands:["Target_Enemy_Near","FireAll"],description:"Target and attack nearest enemy"},defensive_sequence:{name:"Defensive Sequence",commands:["Target_Self","+power_exec Distribute_Shields"],description:"Self-target and activate defensive abilities"},heal_sequence:{name:"Healing Sequence",commands:["Target_Self","+STOTrayExecByTray 3 0 $$ +STOTrayExecByTray 3 1"],description:"Emergency healing and repair sequence"}},window.TRAY_CONFIG={maxTrays:10,slotsPerTray:10,defaultTray:0,maxCommandsPerSlot:1},window.getCommandsByCategory=function(e){return e&&c.commands[e]?Object.values(c.commands[e].commands):[]},window.localizeCommandData=function(){const e=window.i18next;e&&Object.entries(c.commands).forEach(([t,i])=>{i.name&&(i.name=e.t(`command_categories.${t}`)),i.description&&(i.description=e.t(`category_descriptions.${t}`)),Object.entries(i.commands).forEach(([t,i])=>{i.name&&(i.name=e.t(`command_definitions.${t}.name`)),i.description&&(i.description=e.t(`command_definitions.${t}.description`))})})};class l extends Error{constructor(e,t="STO_ERROR"){super(e),this.name="STOError",this.code=t}}class d extends l{constructor(e,t="VFX_ERROR"){super(e,t),this.name="VertigoError"}}"undefined"!=typeof window&&(window.STOError=l,window.VertigoError=d,window.InvalidEnvironmentError=class extends d{constructor(e){super(`Invalid environment '${e}'. Valid environments are: space, ground`,"INVALID_ENVIRONMENT"),this.environment=e}},window.InvalidEffectError=class extends d{constructor(e,t){super(`Invalid effect '${e}' for environment '${t}'`,"INVALID_EFFECT"),this.effectName=e,this.environment=t}});const m=e=>"string"==typeof e,h=()=>{let e,t;const i=new Promise((i,a)=>{e=i,t=a});return i.resolve=e,i.reject=t,i},u=e=>null==e?"":""+e,p=/###/g,_=e=>e&&e.indexOf("###")>-1?e.replace(p,"."):e,f=e=>!e||m(e),y=(e,t,i)=>{const a=m(t)?t.split("."):t;let s=0;for(;s<a.length-1;){if(f(e))return{};const t=_(a[s]);!e[t]&&i&&(e[t]=new i),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++s}return f(e)?{}:{obj:e,k:_(a[s])}},g=(e,t,i)=>{const{obj:a,k:s}=y(e,t,Object);if(void 0!==a||1===t.length)return void(a[s]=i);let n=t[t.length-1],r=t.slice(0,t.length-1),o=y(e,r,Object);for(;void 0===o.obj&&r.length;)n=`${r[r.length-1]}.${n}`,r=r.slice(0,r.length-1),o=y(e,r,Object),o?.obj&&void 0!==o.obj[`${o.k}.${n}`]&&(o.obj=void 0);o.obj[`${o.k}.${n}`]=i},b=(e,t)=>{const{obj:i,k:a}=y(e,t);if(i&&Object.prototype.hasOwnProperty.call(i,a))return i[a]},w=(e,t,i)=>{for(const a in t)"__proto__"!==a&&"constructor"!==a&&(a in e?m(e[a])||e[a]instanceof String||m(t[a])||t[a]instanceof String?i&&(e[a]=t[a]):w(e[a],t[a],i):e[a]=t[a]);return e},v=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const S=e=>m(e)?e.replace(/[&<>"'\/]/g,e=>k[e]):e,x=[" ",",","?","!",";"],T=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}(20),C=(e,t,i=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const a=t.split(i);let s=e;for(let e=0;e<a.length;){if(!s||"object"!=typeof s)return;let t,n="";for(let r=e;r<a.length;++r)if(r!==e&&(n+=i),n+=a[r],t=s[n],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&r<a.length-1)continue;e+=r-e+1;break}s=t}return s},A=e=>e?.replace("_","-"),E={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){}};class ${constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||E,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,a){return a&&!this.debug?null:(m(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new $(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new $(this.logger,e)}}var F=new $;class B{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);const i=this.observers[e].get(t)||0;this.observers[e].set(t,i+1)}),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([e,i])=>{for(let a=0;a<i;a++)e(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,a])=>{for(let s=0;s<a;s++)i.apply(i,[e,...t])})}}class I extends B{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,a={}){const s=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,n=void 0!==a.ignoreJSONStructure?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let r;e.indexOf(".")>-1?r=e.split("."):(r=[e,t],i&&(Array.isArray(i)?r.push(...i):m(i)&&s?r.push(...i.split(s)):r.push(i)));const o=b(this.data,r);return!o&&!t&&!i&&e.indexOf(".")>-1&&(e=r[0],t=r[1],i=r.slice(2).join(".")),!o&&n&&m(i)?C(this.data?.[e]?.[t],i,s):o}addResource(e,t,i,a,s={silent:!1}){const n=void 0!==s.keySeparator?s.keySeparator:this.options.keySeparator;let r=[e,t];i&&(r=r.concat(n?i.split(n):i)),e.indexOf(".")>-1&&(r=e.split("."),a=t,t=r[1]),this.addNamespaces(t),g(this.data,r,a),s.silent||this.emit("added",e,t,i,a)}addResources(e,t,i,a={silent:!1}){for(const a in i)(m(i[a])||Array.isArray(i[a]))&&this.addResource(e,t,a,i[a],{silent:!0});a.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,a,s,n={silent:!1,skipCopy:!1}){let r=[e,t];e.indexOf(".")>-1&&(r=e.split("."),a=i,i=t,t=r[1]),this.addNamespaces(t);let o=b(this.data,r)||{};n.skipCopy||(i=JSON.parse(JSON.stringify(i))),a?w(o,i,s):o={...o,...i},g(this.data,r,o),n.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var P={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,i,a,s){return e.forEach(e=>{t=this.processors[e]?.process(t,i,a,s)??t}),t}};const D={},j=e=>!m(e)&&"boolean"!=typeof e&&"number"!=typeof e;class N extends B{constructor(e,t={}){var i,a;super(),i=e,a=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach(e=>{i[e]&&(a[e]=i[e])}),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=F.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(null==e)return!1;const a=this.resolve(e,i);return void 0!==a?.res}extractFromKey(e,t){let i=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");const a=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const n=i&&e.indexOf(i)>-1,r=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,i)=>{t=t||"",i=i||"";const a=x.filter(e=>t.indexOf(e)<0&&i.indexOf(e)<0);if(0===a.length)return!0;const s=T.getRegExp(`(${a.map(e=>"?"===e?"\\?":e).join("|")})`);let n=!s.test(e);if(!n){const t=e.indexOf(i);t>0&&!s.test(e.substring(0,t))&&(n=!0)}return n})(e,i,a));if(n&&!r){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:m(s)?[s]:s};const n=e.split(i);(i!==a||i===a&&this.options.ns.indexOf(n[0])>-1)&&(s=n.shift()),e=n.join(a)}return{key:e,namespaces:m(s)?[s]:s}}translate(e,t,i){let a="object"==typeof t?{...t}:t;if("object"!=typeof a&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(a={...a}),a||(a={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const s=void 0!==a.returnDetails?a.returnDetails:this.options.returnDetails,n=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,{key:r,namespaces:o}=this.extractFromKey(e[e.length-1],a),c=o[o.length-1];let l=void 0!==a.nsSeparator?a.nsSeparator:this.options.nsSeparator;void 0===l&&(l=":");const d=a.lng||this.language,h=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===d?.toLowerCase())return h?s?{res:`${c}${l}${r}`,usedKey:r,exactUsedKey:r,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:`${c}${l}${r}`:s?{res:r,usedKey:r,exactUsedKey:r,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:r;const u=this.resolve(e,a);let p=u?.res;const _=u?.usedKey||r,f=u?.exactUsedKey||r,y=void 0!==a.joinArrays?a.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,b=void 0!==a.count&&!m(a.count),w=N.hasDefaultValue(a),v=b?this.pluralResolver.getSuffix(d,a.count,a):"",k=a.ordinal&&b?this.pluralResolver.getSuffix(d,a.count,{ordinal:!1}):"",S=b&&!a.ordinal&&0===a.count,x=S&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${v}`]||a[`defaultValue${k}`]||a.defaultValue;let T=p;g&&!p&&w&&(T=x);const C=j(T),A=Object.prototype.toString.apply(T);if(!(g&&T&&C&&["[object Number]","[object Function]","[object RegExp]"].indexOf(A)<0)||m(y)&&Array.isArray(T))if(g&&m(y)&&Array.isArray(p))p=p.join(y),p&&(p=this.extendTranslation(p,e,a,i));else{let t=!1,s=!1;!this.isValidLookup(p)&&w&&(t=!0,p=x),this.isValidLookup(p)||(s=!0,p=r);const o=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&s?void 0:p,m=w&&x!==p&&this.options.updateMissing;if(s||t||m){if(this.logger.log(m?"updateKey":"missingKey",d,c,r,m?x:p),n){const e=this.resolve(r,{...a,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let i=0;i<t.length;i++)e.push(t[i]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(a.lng||this.language):e.push(a.lng||this.language);const i=(e,t,i)=>{const s=w&&i!==p?i:o;this.options.missingKeyHandler?this.options.missingKeyHandler(e,c,t,s,m,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,c,t,s,m,a),this.emit("missingKey",e,c,t,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&b?e.forEach(e=>{const t=this.pluralResolver.getSuffixes(e,a);S&&a[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach(t=>{i([e],r+t,a[`defaultValue${t}`]||x)})}):i(e,r,x))}p=this.extendTranslation(p,e,a,u,i),s&&p===r&&this.options.appendNamespaceToMissingKey&&(p=`${c}${l}${r}`),(s||t)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${l}${r}`:r,t?p:void 0,a))}else{if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(_,T,{...a,ns:o}):`key '${r} (${this.language})' returned an object instead of string.`;return s?(u.res=e,u.usedParams=this.getUsedParamsDetails(a),u):e}if(n){const e=Array.isArray(T),t=e?[]:{},i=e?f:_;for(const e in T)if(Object.prototype.hasOwnProperty.call(T,e)){const s=`${i}${n}${e}`;t[e]=w&&!p?this.translate(s,{...a,defaultValue:j(x)?x[e]:void 0,joinArrays:!1,ns:o}):this.translate(s,{...a,joinArrays:!1,ns:o}),t[e]===s&&(t[e]=T[e])}p=t}}return s?(u.res=p,u.usedParams=this.getUsedParamsDetails(a),u):p}extendTranslation(e,t,i,a,s){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const n=m(e)&&(void 0!==i?.interpolation?.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let r;if(n){const t=e.match(this.interpolator.nestingRegexp);r=t&&t.length}let o=i.replace&&!m(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(o={...this.options.interpolation.defaultVariables,...o}),e=this.interpolator.interpolate(e,o,i.lng||this.language||a.usedLng,i),n){const t=e.match(this.interpolator.nestingRegexp);r<(t&&t.length)&&(i.nest=!1)}!i.lng&&a&&a.res&&(i.lng=this.language||a.usedLng),!1!==i.nest&&(e=this.interpolator.nest(e,(...e)=>s?.[0]!==e[0]||i.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null),i)),i.interpolation&&this.interpolator.reset()}const n=i.postProcess||this.options.postProcess,r=m(n)?[n]:n;return null!=e&&r?.length&&!1!==i.applyPostProcessor&&(e=P.handle(r,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,a,s,n,r;return m(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(i))return;const o=this.extractFromKey(e,t),c=o.key;a=c;let l=o.namespaces;this.options.fallbackNS&&(l=l.concat(this.options.fallbackNS));const d=void 0!==t.count&&!m(t.count),h=d&&!t.ordinal&&0===t.count,u=void 0!==t.context&&(m(t.context)||"number"==typeof t.context)&&""!==t.context,p=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);l.forEach(e=>{this.isValidLookup(i)||(r=e,D[`${p[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(r)||(D[`${p[0]}-${e}`]=!0,this.logger.warn(`key "${a}" for languages "${p.join(", ")}" won't get resolved as namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(a=>{if(this.isValidLookup(i))return;n=a;const r=[c];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(r,c,a,e,t);else{let e;d&&(e=this.pluralResolver.getSuffix(a,t.count,t));const i=`${this.options.pluralSeparator}zero`,s=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(r.push(c+e),t.ordinal&&0===e.indexOf(s)&&r.push(c+e.replace(s,this.options.pluralSeparator)),h&&r.push(c+i)),u){const a=`${c}${this.options.contextSeparator}${t.context}`;r.push(a),d&&(r.push(a+e),t.ordinal&&0===e.indexOf(s)&&r.push(a+e.replace(s,this.options.pluralSeparator)),h&&r.push(a+i))}}let o;for(;o=r.pop();)this.isValidLookup(i)||(s=o,i=this.getResource(a,e,o,t))}))})}),{res:i,usedKey:a,exactUsedKey:s,usedLng:n,usedNS:r}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,i,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,i,a):this.resourceStore.getResource(e,t,i,a)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!m(e.replace);let a=i?e.replace:e;if(i&&void 0!==e.count&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!i){a={...a};for(const e of t)delete a[e]}return a}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}class M{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=F.create("languageUtils")}getScriptPartFromCode(e){if(!(e=A(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=A(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(m(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(e=>{if(t)return;const i=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(i)||(t=i)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;const i=this.getScriptPartFromCode(e);if(this.isSupportedCode(i))return t=i;const a=this.getLanguagePartFromCode(e);if(this.isSupportedCode(a))return t=a;t=this.options.supportedLngs.find(e=>e===a?e:e.indexOf("-")<0&&a.indexOf("-")<0?void 0:e.indexOf("-")>0&&a.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===a||0===e.indexOf(a)&&a.length>1?e:void 0)}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),m(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),a=[],s=e=>{e&&(this.isSupportedCode(e)?a.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return m(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&s(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&s(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&s(this.getLanguagePartFromCode(e))):m(e)&&s(this.formatLanguageCode(e)),i.forEach(e=>{a.indexOf(e)<0&&s(this.formatLanguageCode(e))}),a}}const O={zero:0,one:1,two:2,few:3,many:4,other:5},K={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class z{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=F.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=A("dev"===e?"en":e),a=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:a});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let n;try{n=new Intl.PluralRules(i,{type:a})}catch(i){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),K;if(!e.match(/-|_/))return K;const a=this.languageUtils.getLanguagePartFromCode(e);n=this.getRule(a,t)}return this.pluralRulesCache[s]=n,n}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(e=>`${t}${e}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((e,t)=>O[e]-O[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t,i={}){const a=this.getRule(e,i);return a?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${a.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const L=(e,t,i,a=".",s=!0)=>{let n=((e,t,i)=>{const a=b(e,i);return void 0!==a?a:b(t,i)})(e,t,i);return!n&&s&&m(i)&&(n=C(e,i,a),void 0===n&&(n=C(t,i,a))),n},R=e=>e.replace(/\$/g,"$$$$");class U{constructor(e={}){this.logger=F.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:a,prefix:s,prefixEscaped:n,suffix:r,suffixEscaped:o,formatSeparator:c,unescapeSuffix:l,unescapePrefix:d,nestingPrefix:m,nestingPrefixEscaped:h,nestingSuffix:u,nestingSuffixEscaped:p,nestingOptionsSeparator:_,maxReplaces:f,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:S,this.escapeValue=void 0===i||i,this.useRawValueToEscape=void 0!==a&&a,this.prefix=s?v(s):n||"{{",this.suffix=r?v(r):o||"}}",this.formatSeparator=c||",",this.unescapePrefix=l?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":l||"",this.nestingPrefix=m?v(m):h||v("$t("),this.nestingSuffix=u?v(u):p||v(")"),this.nestingOptionsSeparator=_||",",this.maxReplaces=f||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,i,a){let s,n,r;const o=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=e=>{if(e.indexOf(this.formatSeparator)<0){const s=L(t,o,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(s,void 0,i,{...a,...t,interpolationkey:e}):s}const s=e.split(this.formatSeparator),n=s.shift().trim(),r=s.join(this.formatSeparator).trim();return this.format(L(t,o,n,this.options.keySeparator,this.options.ignoreJSONStructure),r,i,{...a,...t,interpolationkey:n})};this.resetRegExp();const l=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,d=void 0!==a?.interpolation?.skipOnVariables?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>R(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?R(this.escape(e)):R(e)}].forEach(t=>{for(r=0;s=t.regex.exec(e);){const i=s[1].trim();if(n=c(i),void 0===n)if("function"==typeof l){const t=l(e,s,a);n=m(t)?t:""}else if(a&&Object.prototype.hasOwnProperty.call(a,i))n="";else{if(d){n=s[0];continue}this.logger.warn(`missed to pass in variable ${i} for interpolating ${e}`),n=""}else m(n)||this.useRawValueToEscape||(n=u(n));const o=t.safeValue(n);if(e=e.replace(s[0],o),d?(t.regex.lastIndex+=n.length,t.regex.lastIndex-=s[0].length):t.regex.lastIndex=0,r++,r>=this.maxReplaces)break}}),e}nest(e,t,i={}){let a,s,n;const r=(e,t)=>{const i=this.nestingOptionsSeparator;if(e.indexOf(i)<0)return e;const a=e.split(new RegExp(`${i}[ ]*{`));let s=`{${a[1]}`;e=a[0],s=this.interpolate(s,n);const r=s.match(/'/g),o=s.match(/"/g);((r?.length??0)%2==0&&!o||o.length%2!=0)&&(s=s.replace(/'/g,'"'));try{n=JSON.parse(s),t&&(n={...t,...n})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${i}${s}`}return n.defaultValue&&n.defaultValue.indexOf(this.prefix)>-1&&delete n.defaultValue,e};for(;a=this.nestingRegexp.exec(e);){let o=[];n={...i},n=n.replace&&!m(n.replace)?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let c=!1;if(-1!==a[0].indexOf(this.formatSeparator)&&!/{.*}/.test(a[1])){const e=a[1].split(this.formatSeparator).map(e=>e.trim());a[1]=e.shift(),o=e,c=!0}if(s=t(r.call(this,a[1].trim(),n),n),s&&a[0]===e&&!m(s))return s;m(s)||(s=u(s)),s||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),s=""),c&&(s=o.reduce((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:a[1].trim()}),s.trim())),e=e.replace(a[0],s),this.regexp.lastIndex=0}return e}}const q=e=>{const t={};return(i,a,s)=>{let n=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(n={...n,[s.interpolationkey]:void 0});const r=a+JSON.stringify(n);let o=t[r];return o||(o=e(A(a),s),t[r]=o),o(i)}},V=e=>(t,i,a)=>e(A(i),a)(t);class G{constructor(e={}){this.logger=F.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?q:V;this.formats={number:i((e,t)=>{const i=new Intl.NumberFormat(e,{...t});return e=>i.format(e)}),currency:i((e,t)=>{const i=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>i.format(e)}),datetime:i((e,t)=>{const i=new Intl.DateTimeFormat(e,{...t});return e=>i.format(e)}),relativetime:i((e,t)=>{const i=new Intl.RelativeTimeFormat(e,{...t});return e=>i.format(e,t.range||"day")}),list:i((e,t)=>{const i=new Intl.ListFormat(e,{...t});return e=>i.format(e)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=q(t)}format(e,t,i,a={}){const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(e=>e.indexOf(")")>-1)){const e=s.findIndex(e=>e.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,e)].join(this.formatSeparator)}return s.reduce((e,t)=>{const{formatName:s,formatOptions:n}=(e=>{let t=e.toLowerCase().trim();const i={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const s=a[1].substring(0,a[1].length-1);"currency"===t&&s.indexOf(":")<0?i.currency||(i.currency=s.trim()):"relativetime"===t&&s.indexOf(":")<0?i.range||(i.range=s.trim()):s.split(";").forEach(e=>{if(e){const[t,...a]=e.split(":"),s=a.join(":").trim().replace(/^'+|'+$/g,""),n=t.trim();i[n]||(i[n]=s),"false"===s&&(i[n]=!1),"true"===s&&(i[n]=!0),isNaN(s)||(i[n]=parseInt(s,10))}})}return{formatName:t,formatOptions:i}})(t);if(this.formats[s]){let t=e;try{const r=a?.formatParams?.[a.interpolationkey]||{},o=r.locale||r.lng||a.locale||a.lng||i;t=this.formats[s](e,o,{...n,...a,...r})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${s}`),e},e)}}class W extends B{constructor(e,t,i,a={}){super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=a,this.logger=F.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(i,a.backend,a)}queueLoad(e,t,i,a){const s={},n={},r={},o={};return e.forEach(e=>{let a=!0;t.forEach(t=>{const r=`${e}|${t}`;!i.reload&&this.store.hasResourceBundle(e,t)?this.state[r]=2:this.state[r]<0||(1===this.state[r]?void 0===n[r]&&(n[r]=!0):(this.state[r]=1,a=!1,void 0===n[r]&&(n[r]=!0),void 0===s[r]&&(s[r]=!0),void 0===o[t]&&(o[t]=!0)))}),a||(r[e]=!0)}),(Object.keys(s).length||Object.keys(n).length)&&this.queue.push({pending:n,pendingCount:Object.keys(n).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(s),pending:Object.keys(n),toLoadLanguages:Object.keys(r),toLoadNamespaces:Object.keys(o)}}loaded(e,t,i){const a=e.split("|"),s=a[0],n=a[1];t&&this.emit("failedLoading",s,n,t),!t&&i&&this.store.addResourceBundle(s,n,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const r={};this.queue.forEach(i=>{((e,t,i)=>{const{obj:a,k:s}=y(e,t,Object);a[s]=a[s]||[],a[s].push(i)})(i.loaded,[s],n),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(i,e),t&&i.errors.push(t),0!==i.pendingCount||i.done||(Object.keys(i.loaded).forEach(e=>{r[e]||(r[e]={});const t=i.loaded[e];t.length&&t.forEach(t=>{void 0===r[e][t]&&(r[e][t]=!0)})}),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())}),this.emit("loaded",r),this.queue=this.queue.filter(e=>!e.done)}read(e,t,i,a=0,s=this.retryTimeout,n){if(!e.length)return n(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:i,tried:a,wait:s,callback:n});this.readingCalls++;const r=(r,o)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}r&&o&&a<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,i,a+1,2*s,n)},s):n(r,o)},o=this.backend[i].bind(this.backend);if(2!==o.length)return o(e,t,r);try{const i=o(e,t);i&&"function"==typeof i.then?i.then(e=>r(null,e)).catch(r):r(null,i)}catch(e){r(e)}}prepareLoading(e,t,i={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();m(e)&&(e=this.languageUtils.toResolveHierarchy(e)),m(t)&&(t=[t]);const s=this.queueLoad(e,t,i,a);if(!s.toLoad.length)return s.pending.length||a(),null;s.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),a=i[0],s=i[1];this.read(a,s,"read",void 0,void 0,(i,n)=>{i&&this.logger.warn(`${t}loading namespace ${s} for language ${a} failed`,i),!i&&n&&this.logger.log(`${t}loaded namespace ${s} for language ${a}`,n),this.loaded(e,i,n)})}saveMissing(e,t,i,a,s,n={},r=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=i&&""!==i){if(this.backend?.create){const o={...n,isUpdate:s},c=this.backend.create.bind(this.backend);if(c.length<6)try{let s;s=5===c.length?c(e,t,i,a,o):c(e,t,i,a),s&&"function"==typeof s.then?s.then(e=>r(null,e)).catch(r):r(null,s)}catch(e){r(e)}else c(e,t,i,a,r,o)}e&&e[0]&&this.store.addResource(e[0],t,i,a)}}else this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const H=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),m(e[1])&&(t.defaultValue=e[1]),m(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const i=e[3]||e[2];Object.keys(i).forEach(e=>{t[e]=i[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),X=e=>(m(e.ns)&&(e.ns=[e.ns]),m(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),m(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),Z=()=>{};class J extends B{constructor(e={},t){var i;if(super(),this.options=X(e),this.services={},this.logger=F,this.modules={external:[]},i=this,Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(e=>{"function"==typeof i[e]&&(i[e]=i[e].bind(i))}),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(m(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=H();this.options={...i,...this.options,...X(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const a=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?F.init(a(this.modules.logger),this.options):F.init(null,this.options),e=this.modules.formatter?this.modules.formatter:G;const t=new M(this.options);this.store=new I(this.options.resources,this.options);const s=this.services;s.logger=F,s.resourceStore=this.store,s.languageUtils=t,s.pluralResolver=new z(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(s.formatter=a(e),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new U(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new W(a(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.languageDetector&&(s.languageDetector=a(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=a(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new N(this.services,this.options),this.translator.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Z),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=(...t)=>this.store[e](...t)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=(...t)=>(this.store[e](...t),this)});const s=h(),n=()=>{const e=(e,i)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(i),t(e,i)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?n():setTimeout(n,0),s}loadResources(e,t=Z){let i=t;const a=m(e)?e:this.language;if("function"==typeof e&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===a?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return i();const e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)})};a?t(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>t(e)),this.options.preload?.forEach?.(e=>t(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),i(e)})}else i(null)}reloadResources(e,t,i){const a=h();return"function"==typeof e&&(i=e,e=void 0),"function"==typeof t&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=Z),this.services.backendConnector.reload(e,t,e=>{a.resolve(),i(e)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&P.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=h();this.emit("languageChanging",e);const a=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},s=(s,n)=>{n?this.isLanguageChangingTo===e&&(a(n),this.translator.changeLanguage(n),this.isLanguageChangingTo=void 0,this.emit("languageChanged",n),this.logger.log("languageChanged",n)):this.isLanguageChangingTo=void 0,i.resolve((...e)=>this.t(...e)),t&&t(s,(...e)=>this.t(...e))},n=t=>{e||t||!this.services.languageDetector||(t=[]);const i=m(t)?t:t&&t[0],n=this.store.hasLanguageSomeTranslations(i)?i:this.services.languageUtils.getBestMatchFromCodes(m(t)?[t]:t);n&&(this.language||a(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector?.cacheUserLanguage?.(n)),this.loadResources(n,e=>{s(e,n)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(n):this.services.languageDetector.detect(n):n(e):n(this.services.languageDetector.detect()),i}getFixedT(e,t,i){const a=(e,t,...s)=>{let n;n="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(s)):{...t},n.lng=n.lng||a.lng,n.lngs=n.lngs||a.lngs,n.ns=n.ns||a.ns,""!==n.keyPrefix&&(n.keyPrefix=n.keyPrefix||i||a.keyPrefix);const r=this.options.keySeparator||".";let o;return o=n.keyPrefix&&Array.isArray(e)?e.map(e=>`${n.keyPrefix}${r}${e}`):n.keyPrefix?`${n.keyPrefix}${r}${e}`:e,this.t(o,n)};return m(e)?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=i,a}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],a=!!this.options&&this.options.fallbackLng,s=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;const n=(e,t)=>{const i=this.services.backendConnector.state[`${e}|${t}`];return-1===i||0===i||2===i};if(t.precheck){const e=t.precheck(this,n);if(void 0!==e)return e}return!(!this.hasResourceBundle(i,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!n(i,e)||a&&!n(s,e)))}loadNamespaces(e,t){const i=h();return this.options.ns?(m(e)&&(e=[e]),e.forEach(e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}),this.loadResources(e=>{i.resolve(),t&&t(e)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=h();m(e)&&(e=[e]);const a=this.options.preload||[],s=e.filter(e=>a.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e));return s.length?(this.options.preload=a.concat(s),this.loadResources(e=>{i.resolve(),t&&t(e)}),i):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services?.languageUtils||new M(H());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new J(e,t)}cloneInstance(e={},t=Z){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},s=new J(a);if(void 0===e.debug&&void 0===e.prefix||(s.logger=s.logger.clone(e)),["store","services","language"].forEach(e=>{s[e]=this[e]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i){const e=Object.keys(this.store.data).reduce((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce((i,a)=>(i[a]={...e[t][a]},i),e[t]),e),{});s.store=new I(e,a),s.services.resourceStore=s.store}return s.translator=new N(s.services,a),s.translator.on("*",(e,...t)=>{s.emit(e,...t)}),s.init(a,t),s.translator.options=a,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Q=J.createInstance();Q.createInstance=J.createInstance,Q.createInstance,Q.dir,Q.init,Q.loadResources,Q.reloadResources,Q.use,Q.changeLanguage,Q.getFixedT,Q.t,Q.exists,Q.setDefaultNamespace,Q.hasLoadedNamespace,Q.loadNamespaces,Q.loadLanguages;var Y={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Open",save:"Save",explorer:"Explorer",keybinds:"Keybinds",import_keybinds:"Import Keybinds",export_keybinds:"Export Keybinds",aliases:"Aliases",import_aliases:"Import Aliases",export_aliases:"Export Aliases",import:"Import",import_menu:"Import",backup:"Backup",backup_menu:"Backup",backup_application_state:"Backup Application State",restore_application_state:"Restore Application State",preferences:"Preferences",language:"Language",sync_folder_label:"Synchronization Folder:",no_folder_selected:"No folder selected",download:"Download",vfx:"VFX",dark_mode:"Dark Mode",light_mode:"Light Mode",load_default_data:"Load Default Data",reset_application:"Reset Application",set_sync_folder:"Set Sync Folder",sync_now:"Sync Now",about:"About",new:"New",create:"Create",create_new_alias:"Create New Alias",clone:"Clone",rename:"Rename",delete:"Delete",space:"Space",ground:"Ground",alias:"Alias",modified:"Modified",valid:"Valid",keys:"keys",key_singular:"key",keys_firstupper:"Keys",all:"All",add_key:"Add Key",copy:"Copy",select_a_key_to_edit:"Select a key to edit",select_an_alias_to_edit:"Select an alias to edit",commands:"commands",command_singular:"command",stabilize_execution_order:"Stabilize Execution Order",alias_options:"Alias Options:",select_options:"Select Options",toggle_type:"Toggle Type",cycle_type:"Cycle Type",validate:"Validate",clear:"Clear",no_key_selected:"No Key Selected",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Select a key from the left panel to view and edit its command chain.",generated_command:"Generated Command:",select_a_key_to_see_the_generated_command:"Select a key to see the generated command",select_an_alias_to_see_the_generated_command:"Select an alias to see the generated command",add_command:"Add Command",from_template:"From Template",add_alias:"Add Alias",copy_from_key:"Copy from Key",import_from_key_or_alias:"Import from Key or Alias",select_source_to_import_from:"Select source to import from:",clear_destination_chain_prior_to_import:"Clear destination chain prior to import",no_sources_available:"No sources available",error_loading_sources:"Error loading sources",please_select_a_source:"Please select a source",source_has_no_commands:"Source has no commands to import",commands_imported_successfully:"Imported {{count}} commands from {{source}}",cross_environment_import_warning:"Warning: {{dropped}} {{sourceEnv}}-specific commands were dropped when importing to {{targetEnv}}",no_compatible_commands_to_import:"No compatible commands to import after filtering",command_library:"Command Library",add_new_key:"Add New Key",key_name:"Key Name:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Use standard key names like F1, Ctrl+A, Shift+Space, etc.",or_capture_keys:"Or capture keys:",click_here_then_press_keys:"Click here, then press the key combination",press_key_combination_now:"Press the key combination now...",supports_single_modifier_plus_key_combinations:"Supports single modifier + key combinations (e.g., Ctrl+A, Alt+1, Shift+Space)",common_keys:"Common Keys:",ctrl:"Ctrl",alt:"Alt",shift:"Shift",cancel:"Cancel",command_type:"Command Type:",select_command_type:"Select command type...",targeting:"Targeting",combat:"Combat",tray_execution:"Tray Execution",shield_management:"Shield Management",movement:"Movement",camera:"Camera",communication:"Communication",system:"System",custom_command:"Custom Command",select_a_command_type_to_see_preview:"Select a command type to see preview",profile:"Profile",profile_name:"Profile Name:",description_optional:"Description (optional):",command_alias_manager:"Command Alias Manager",new_alias:"New Alias",edit_alias:"Edit Alias",alias_name:"Alias Name:",alias_command:"Alias Command",enter_alias_name:"Enter alias name",use_alphanumeric_characters_only_no_spaces:"Use alphanumeric characters only, no spaces",description:"Description:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Example: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Use in communication commands to include target name",preview:"Preview:",alias_myalias_command_sequence:'alias MyAlias "command sequence"',save_alias:"Save Alias",select_key:"Select Key",select_key_dialog_title:"Select Key",select_key_dialog_description:"Choose from the available keys below:",key_combination:"Key Combination:",capture_key:"Capture Key",select_this_key:"Select This Key",select_modifier_key:"Select Modifier + Key",step_1_select_modifiers_optional:"Step 1: Select Modifiers (Optional)",step_2_select_key:"Step 2: Select Key",common:"Common",letters:"Letters",numbers:"Numbers",function:"Function",arrows:"Arrows",symbols:"Symbols",mouse:"Mouse",gamepad:"Gamepad",numpad:"Numpad",common_keys1:"Common Keys",find_other_keys:"Find other keys...",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Select visual effects to disable using dynFxSetFXExlusionList aliases. Effects are organized by environment.",space_effects:"Space Effects",selected:"selected",ground_effects:"Ground Effects",generated_aliases:"Generated Aliases:",space_alias:"Space Alias:",ground_alias:"Ground Alias:",about_sto_tools_keybind_manager:"About STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"A comprehensive web-based tool for creating, editing, and managing Star Trek Online keybind configurations with visual editing and advanced features.",features:"Features:",visual_keybind_editor:"Visual keybind editor",sto_command_library_with_search_and_categorization:"STO command library with search and categorization",multiple_profile_management_create_clone_rename_delete:"Multiple profile management (create, clone, rename, delete)",custom_alias_system_for_complex_command_sequences:"Custom alias system for complex command sequences",vertigo_inspired_vfx_manager_for_visual_effects_control:"VERTIGO-inspired VFX Manager for visual effects control",import_export_keybind_and_alias_files_and_project_backups:"Import/export keybind and alias files, and project backups",real_time_validation_and_command_preview:"Real-time validation and command preview",quick_start:"Quick Start:",create_a_new_profile_or_use_the_default_profile:"Create a new profile or use the default profile",select_keys_from_the_grid_and_add_commands_from_the_library:"Select keys from the grid and add commands from the library",use_the_command_chain_editor_to_build_complex_sequences:"Use the command chain editor to build complex sequences",export_your_keybinds_as_txt_files_for_use_in_sto:"Export your keybinds as .txt files for use in STO",resources:"Resources:",copyright:"© 2025 STO Tools. All rights reserved.",got_it:"Got it!",file_explorer:"File Explorer",select_an_item_on_the_left_to_preview_export:"Select an item on the left to preview export",close:"Close",select_export_format:"Select Export Format",export_as:"Export As:",sto_keybind_file_txt:"STO Keybind File (.txt)",json_profile_json:"JSON Profile (.json)",complete_project_json:"Complete Project (.json)",csv_data_csv:"CSV Data (.csv)",html_report_html:"HTML Report (.html)",alias_file_txt:"Alias File (.txt)",environment:"Environment:",export:"Export",filter_keys:"Filter keys...",filter_aliases:"Filter aliases...",search_commands:"Search commands...",e_g_f5_ctrl_a_shift_1:"e.g., F5, Ctrl+A, Shift+1",enter_profile_name:"Enter profile name",describe_this_keybind_profile:"Describe this keybind profile",myalias:"MyAlias",brief_description_of_what_this_alias_does:"Brief description of what this alias does",enter_command_sequence_use_to_separate_commands:"Enter command sequence (use $$ to separate commands)",search_keys:"Search keys...",open_project_json:"Restore Application State",save_project_json:"Backup Application State",keybind_operations:"Keybind Operations",alias_operations:"Alias Operations",settings:"Settings",select_profile:"Select Profile",new_profile:"New Profile",clone_profile:"Clone Profile",rename_profile:"Rename Profile",delete_profile:"Delete Profile",space_mode:"Space Mode",ground_mode:"Ground Mode",alias_mode:"Alias Mode",unsaved_changes:"Unsaved Changes",validation_status:"Validation Status",bound_keys:"Bound Keys",toggle_between_grid_and_categorized_view:"Toggle between grid and categorized view",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Ensures consistent execution order by mirroring commands (Phase 1: left-to-right, Phase 2: right-to-left)",validate_command_chain:"Validate Command Chain",clear_all_commands:"Clear All Commands",copy_to_clipboard:"Copy to Clipboard",collapse_expand:"Collapse/Expand",insert_target_variable:"Insert $Target variable",sto_keybind_report:"STO Keybind Report",mode:"Mode:",generated:"Generated:",created_by:"Created by:",statistics:"Statistics",keys_bound:"Keys Bound:",total_commands:"Total Commands:",aliases_defined:"Aliases Defined:",no_keybinds_defined:"No keybinds defined.",command_aliases:"Command Aliases",vfx_aliases:"VFX Aliases",report_footer:"This report was generated by STO Tools Keybind Manager. For more information about Star Trek Online keybinds, visit the STO Wiki.",command_categories:{targeting:"Targeting",combat:"Combat",cosmetic:"Cosmetic",bridge_officer:"Bridge Officer",tray:"Tray Execution",power:"Shield Management",movement:"Movement",camera:"Camera",communication:"Communication",system:"System"},command_definitions:{target:{name:"Target by Name",description:"Target entity by name (requires quotes)"},target_enemy_near:{name:"Target Nearest Enemy",description:"Target the nearest enemy in view"},target_friend_near:{name:"Target Nearest Friend",description:"Target the nearest friendly entity"},target_self:{name:"Target Self",description:"Target your own ship/character"},target_clear:{name:"Clear Target",description:"Remove current target lock"},target_teammate_1:{name:"Target Teammate 1",description:"Target first team member"},target_teammate_2:{name:"Target Teammate 2",description:"Target second team member"},target_teammate_3:{name:"Target Teammate 3",description:"Target third team member"},target_teammate_4:{name:"Target Teammate 4",description:"Target fourth team member"},fire_all:{name:"Fire All Weapons",description:"Fire all weapons"},fire_phasers:{name:"Fire Energy Weapons",description:"Fire all Energy Weapons"},fire_torps:{name:"Fire Torpedoes",description:"Fire all Torpedos"},fire_mines:{name:"Fire Mines",description:"Fire all Mines"},fire_phasers_torps:{name:"Fire Phasers & Torpedoes",description:"Fire phasers & torpedos"},fire_projectiles:{name:"Fire Projectiles",description:"Fire torpedos & mines"},setactivecostume:{name:"Set Active Costume",description:"Sets current active costume. Requires two modifiers."},custom_tray:{name:"Tray Execution",description:"Execute specific tray slot"},tray_with_backup:{name:"Tray Execution with Backup",description:"Execute specific tray slot with backup ability"},tray_range:{name:"Tray Range Execution",description:"Execute a range of tray slots"},tray_range_with_backup:{name:"Tray Range with Backup",description:"Execute a range of tray slots with backup abilities"},whole_tray:{name:"Whole Tray Execution",description:"Execute all slots in a tray"},whole_tray_with_backup:{name:"Whole Tray with Backup",description:"Execute all slots in a tray with backup tray"},distribute_shields:{name:"Distribute Shields",description:"Evenly distributes shields as if clicking in the middle of the ship and shields icon"},reroute_shields_rear:{name:"Reroute Shields Rear",description:"Route shield power to rear facing"},reroute_shields_left:{name:"Reroute Shields Left",description:"Route shield power to left side"},reroute_shields_right:{name:"Reroute Shields Right",description:"Route shield power to right side"},reroute_shields_forward:{name:"Reroute Shields Forward",description:"Route shield power to forward facing"},full_impulse:{name:"Full Impulse",description:"Engage full impulse drive"},reverse:{name:"Reverse",description:"Reverse engines"},throttle_adjust:{name:"Throttle Adjust",description:"Increase or decrease the throttle by amount"},throttle_set:{name:"Throttle Set",description:"Set the throttle to a specific position (negative = reverse, 0 = stop)"},throttle_toggle:{name:"Throttle Toggle",description:"Alternates between full throttle and full stop"},turn_left:{name:"Turn Left",description:"Turn ship left (continuous while held)"},turn_right:{name:"Turn Right",description:"Turn ship right (continuous while held)"},pitch_up:{name:"Pitch Up",description:"Pitch ship nose up (space altitude change)"},pitch_down:{name:"Pitch Down",description:"Pitch ship nose down (space altitude change)"},strafe_left:{name:"Strafe Left",description:"Strafe ship left"},strafe_right:{name:"Strafe Right",description:"Strafe ship right"},forward:{name:"Forward",description:"Move forward"},backward:{name:"Backward",description:"Move backward"},auto_forward:{name:"Auto Forward",description:"Character moves forward until given new movement commands"},follow:{name:"Follow Target",description:"Follow the targeted entity"},follow_cancel:{name:"Cancel Follow",description:"Stop following and forget about the target"},zoom_in:{name:"Zoom In",description:"Zoom the camera in"},zoom_out:{name:"Zoom Out",description:"Zoom the camera out"},zoom_in_small:{name:"Zoom In Small",description:"Zoom the camera in slightly"},zoom_out_small:{name:"Zoom Out Small",description:"Zoom the camera out slightly"},cam_distance:{name:"Set Camera Distance",description:"Sets the camera distance from the player"},cam_reset:{name:"Reset Camera",description:"Reset the camera position to default"},cam_target_lock:{name:"Lock Camera to Target",description:"Lock or unlock the camera to the target"},cam_cycle_distance:{name:"Cycle Camera Distance",description:"Cycle the camera distance between several preset values"},cam_mouse_look:{name:"Mouse Look",description:"Enable mouse look camera control"},cam_turn_to_face:{name:"Turn to Face Camera",description:"Turn ship to face camera direction"},look_up:{name:"Look Up",description:"Change point of view to look straight up"},look_down:{name:"Look Down",description:"Change point of view to look straight down"},team_message:{name:"Team Message",description:"Send message to team"},local_message:{name:"Local Message",description:"Send message to local area"},zone_message:{name:"Zone Message",description:"Send message to zone"},toggle_hud:{name:"Toggle HUD",description:"Toggle HUD visibility"},screenshot:{name:"Screenshot",description:"Take a screenshot"},screenshot_jpg:{name:"Screenshot JPG",description:"Save a screenshot as JPG"},autofire_toggle:{name:"Toggle Autofire",description:"Toggle weapon autofire"},bind_save_file:{name:"Save Binds to File",description:"Save all your binds to a text file"},bind_load_file:{name:"Load Binds from File",description:"Load a bind file into the client"},combat_log:{name:"Toggle Combat Log",description:"Turn on combat log. 1=on, 0=off, no param=print status. Prepending the command with ++ turns it into a toggle"},missions:{name:"Show/Hide Missions",description:"Show/hide the mission journal"},inventory:{name:"Show/Hide Inventory",description:"Show/hide your inventory"},map:{name:"Show/Hide Map",description:"Show/hide the map window"},logout:{name:"Logout",description:"Log out the current character."},quit:{name:"Quit Game",description:"Close the window."},ui_load:{name:"Load UI Settings",description:"Loads default UI Windows save file, usually Live\\ui_settings.txt"},ui_save:{name:"Save UI Settings",description:"Saves UI layout to default UI Window save file, usually Live\\ui_settings.txt"},ui_load_file:{name:"Load UI Settings File",description:"Loads named UI Windows save file"},ui_save_file:{name:"Save UI Settings File",description:"Saves UI layout to named UI Window save file"},ui_cancel:{name:"UI Cancel",description:'Respond "Cancel" to an open dialog box; may not work in all dialogs.'},ui_ok:{name:"UI OK",description:'Respond "OK" to an open dialog box; may not work in all dialogs.'},chat_log:{name:"Toggle Chat Log",description:"Turn on chat log. 1=on, 0=off, no param=print status. Prepending the command with ++ turns it into a toggle"},remember_ui_lists:{name:"Remember UI Lists",description:"Whether to remember UI List Column placement and width."},ui_remember_positions:{name:"Remember UI Positions",description:"Whether to remember UI sizes and positions. On by default."},safe_login:{name:"Safe Login",description:"If true, then log the player back into their most recent static map instead of anything else."},goto_character_select:{name:"Go to Character Select",description:"Go to the character select screen without logging out."},ui_gen_layers_reset:{name:"Reset UI Layout",description:"Resets the layout, used for when the server updates movable window positions"},ui_resolution:{name:"Print UI Resolution",description:"Print the current UI screen resolution."},ui_tooltip_delay:{name:"Set Tooltip Delay",description:"Sets the additional delay, in seconds, before tooltips appear"},show_game_ui:{name:"Show Game UI",description:"Show the game UI"},show_game_ui_no_extra_keybinds:{name:"Show Game UI (No Extra Keybinds)",description:"This command does not add any keybinds for showing the UI when the user presses escape"},change_instance:{name:"Change Instance",description:"Change to an already created instance of the same map. Only works while not at red alert."},aim:{name:"Aim/Scope",description:"Toggle scope on/off. In scope mode the player does more damage. Can either be used as a toggle or a press and hold"},holster:{name:"Holster Weapon",description:"Attempt to holster your active weapon"},holster_toggle:{name:"Holster Toggle",description:"Attempt to holster or draw your weapons"},unholster:{name:"Unholster Weapon",description:"Attempt to draw your active weapon"},toggle_shooter_mode:{name:"Toggle Shooter Mode",description:"Toggle shooter mode on/off"},shooter_primary:{name:"Shooter Primary",description:"Primary shooter mode action"},shooter_secondary:{name:"Shooter Secondary",description:"Secondary shooter mode action"},shooter_tertiary:{name:"Shooter Tertiary",description:"Tertiary shooter mode action"},shooter_clear_offset_tray_binds:{name:"Shooter Clear Offset Tray Binds",description:"Clear the starting location and movement of the yellow action box that appears on the tray while in shooter mode"},shooter_clear_overlay_tray_binds:{name:"Shooter Clear Overlay Tray Binds",description:"Clear overlay tray bindings for shooter mode"},shooter_set_offset_tray_binds:{name:"Shooter Set Offset Tray Binds",description:"Set the starting location and movement of the yellow action box that appears on the tray while in shooter mode"},shooter_set_overlay_tray_binds:{name:"Shooter Set Overlay Tray Binds",description:"Set overlay tray bindings for shooter mode"},setrallypoint:{name:"Set Rally Point",description:"Set a rally point for your current target"},setrallypointconsole:{name:"Set Rally Point (Console)",description:"Set a rally point for your current target (console variant)"},clearrallypoint:{name:"Clear Rally Point",description:"Clear the rally point for your current target"},clearallrallypoints:{name:"Clear All Rally Points",description:"Clear all the rally points"},assist:{name:"Assist",description:"Assist '<name>': Assists the Entity with the matching name. If no name is given, assists your current target."},net_timing_graph:{name:"Net Timing Graph",description:"Enable or disable the network timing graph (0=disable, 1=enable)"},net_timing_graph_alpha:{name:"Net Timing Graph Alpha",description:"Set transparency level for network timing graph (50=highest transparency, 255=no transparency)"},net_timing_graph_paused:{name:"Net Timing Graph Paused",description:"Pause or resume the network timing graph (0=pause disabled, 1=pause enabled)"},netgraph:{name:"Net Graph",description:"Display SND and RCV network data as text (1=enabled, 0=disabled)"},bridge_officer_command:"Bridge Officer Command",select_bridge_officer_command:"Select a bridge officer command",entity_name_optional:"Entity Name (optional)",entity_name_optional_placeholder:"Enter entity name (optional)"},category_descriptions:{targeting:"Target selection and management",combat:"Weapon firing and combat actions",tray:"Execute abilities from action trays",power:"Shield power and distribution management",movement:"Ship movement and navigation",camera:"Camera control and view management",communication:"Chat and team communication",system:"UI and system commands"},no_aliases:"No Aliases",no_aliases_defined:"No aliases defined",create_alias_to_get_started:"Create an alias to get started",create_aliases_hint:"Create command aliases to simplify complex command sequences.",alias_deleted:'Alias "{{alias}}" deleted',please_select_a_key_first:"Please select a key first",alias_added_to_key:'Alias "{{alias}}" added to {{key}}',no_active_profile:"No active profile",alias_exists:"An alias with this name already exists",alias_template_exists:'Alias "{{alias}}" already exists',alias_created_from_template:'Alias "{{alias}}" created from template',template_not_found:"Template not found",alias_not_found:'Alias "{{alias}}" not found',alias_created:'Alias "{{alias}}" created',alias_updated:'Alias "{{alias}}" updated',no_profile_selected_for_import:"No profile selected for import",no_keybinds_found_in_file:"No keybinds found in file",import_failed:"Import failed: {{error}}",no_aliases_found_in_file:"No aliases found in file",failed_to_get_profile_for_import:"Failed to get profile for import",import_completed_keybinds:"Import completed: {{count}} keybinds",import_completed_keybinds_with_aliases:"Import completed: {{keyCount}} keybinds ({{aliasCount}} aliases ignored - use Import Aliases)",import_completed_aliases:"Import completed: {{count}} aliases",no_profile_selected_to_export:"No profile selected to export",keybind_file_exported:"Keybind file exported successfully",failed_to_export_keybind_file:"Failed to export keybind file: {{error}}",profile_exported_json:"Profile exported as JSON",failed_to_export_profile:"Failed to export profile: {{error}}",complete_project_exported:"Complete project exported",failed_to_export_project:"Failed to export project: {{error}}",data_exported_csv:"Data exported as CSV",failed_to_export_csv:"Failed to export CSV: {{error}}",html_report_exported:"HTML report exported",failed_to_export_html_report:"Failed to export HTML report: {{error}}",no_command_to_copy:"No command to copy",no_profiles_to_export:"No profiles to export",exporting_profiles:"Exporting {{count}} profiles...",aliases_exported_successfully:"Aliases exported successfully",failed_to_export_aliases:"Failed to export aliases: {{error}}",sync_folder_set:"Sync folder selected",failed_to_set_sync_folder:"Failed to select sync folder: {{error}}",no_sync_folder_selected:"No sync folder selected",project_synced_successfully:"Project synchronized successfully",permission_denied_to_folder:"Permission denied to write to folder",failed_to_sync_project:"Failed to sync project: {{error}}",general:"General",synchronization:"Synchronization",appearance:"Appearance",advanced:"Advanced",general_settings:"General Settings",synchronization_settings:"Synchronization Settings",appearance_settings:"Appearance Settings",language_settings:"Language Settings",advanced_settings:"Advanced Settings",auto_save:"Auto Save",auto_save_description:"Automatically save changes as you work",validation_mode:"Validation Mode",validation_mode_description:"How strictly to validate commands and keybinds",strict:"Strict",lenient:"Lenient",disabled:"Disabled",sync_folder_description:"Choose a folder to automatically sync your projects",auto_sync:"Auto Sync",auto_sync_description:"Automatically sync changes to the selected folder",auto_sync_interval:"Auto Sync Interval",auto_sync_interval_description:"How often to automatically sync your changes",after_every_change:"After every change",every_1_minute:"Every 1 minute",every_2_minutes:"Every 2 minutes",every_5_minutes:"Every 5 minutes",auto_sync_completed:"Auto sync completed",selected_folder:"Selected folder",theme:"Theme",theme_description:"Choose between light and dark themes",light_theme:"Light",dark_theme:"Dark",compact_mode:"Compact Mode",compact_mode_description:"Use a more compact interface layout",interface_language:"Interface Language",language_description:"Choose the language for the interface",debug_mode:"Debug Mode",debug_mode_description:"Enable debug logging and developer tools",backup_interval:"Backup Interval",backup_interval_description:"How often to automatically backup your work",every_15_minutes:"Every 15 minutes",every_30_minutes:"Every 30 minutes",every_hour:"Every hour",preferences_saved:"Preferences saved successfully",failed_to_save_preferences:"Failed to save preferences",vfx_manager_description:"Select visual effects to disable using dynFxSetFXExlusionList aliases. Effects are organized by environment.",app_description:"A comprehensive web-based tool for creating, editing, and managing Star Trek Online keybind configurations with visual editing and advanced features.",csv_header:"Key,Command,Type,Description,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Select a Space/Ground build or Aliases to preview export.",no_alias_selected:"No Alias Selected",select_alias_from_left_panel:"Select an alias from the left panel to view and edit its command chain.",select_key_from_left_panel:"Select a key from the left panel to view and edit its command chain.",validation_error:"Validation error",failed_to_load_application:"Failed to load application",profile_created:'Profile "{{name}}" created',failed_to_create_profile:"Failed to create profile",failed_to_clone_profile:"Failed to clone profile",cannot_delete_the_last_profile:"Cannot delete the last profile",profile_deleted:'Profile "{{profileName}}" deleted',failed_to_delete_profile:"Failed to delete profile",invalid_key_name:"Invalid key name",key_added:'Key "{{keyName}}" added',key_already_exists:'Key "{{keyName}}" already exists',key_deleted:'Key "{{keyName}}" deleted',command_added_to_alias:"Command added to alias",commands_added:"{{count}} commands added",command_added:"Command added",command_deleted_from_alias:"Command deleted from alias",command_deleted:"Command deleted",switched_to_mode:"Switched to {{mode}} mode",alias_already_exists:'Alias "{{name}}" already exists',commands_cleared_for_key:"Commands cleared for {{keyName}}",project_loaded_successfully:"Project loaded successfully",failed_to_load_project_file:"Failed to load project file",invalid_project_file:"Invalid project file",project_exported_successfully:"Project exported successfully",no_commands_to_duplicate:"No commands to duplicate",key_duplicated:'Key "{{keyName}}" duplicated as "{{newKeyName}}"',template_system_coming_soon:"Template system coming soon",no_commands_to_validate:"No commands to validate",command_chain_is_valid:"Command chain is valid",please_configure_a_command:"Please configure a command",command_updated_successfully:"Command updated successfully",error_message:"Error: {{error}}",failed_to_select_all_space_effects:"Failed to select all space effects",failed_to_select_all_ground_effects:"Failed to select all ground effects",space_preview_error:"Space preview error: {{error}}",ground_preview_error:"Ground preview error: {{error}}",space_alias_error:"Space alias error: {{error}}",failed_to_generate_space_alias:"Failed to generate space alias",ground_alias_error:"Ground alias error: {{error}}",failed_to_generate_ground_alias:"Failed to generate ground alias",no_profile_selected:"No profile selected",no_profile_found:"No profile found",switched_to_theme:"Switched to {{themeName}}",language_updated:"Language updated",auto_sync_failed:"Auto-sync failed: {{error}}",nothing_to_copy:"Nothing to copy",content_copied_to_clipboard:"Content copied to clipboard",failed_to_generate_export:"Failed to generate export",no_profile_selected_to_clone:"No profile selected to clone",no_profile_selected_to_rename:"No profile selected to rename",profile_name_is_required:"Profile name is required",profile_name_too_long:"Profile name is too long (max 50 characters)",profile_name_already_exists:"A profile with this name already exists",failed_to_save_profile:"Failed to save profile: {{error}}",no_profile_selected_to_delete:"No profile selected to delete",no_keybinds_to_export:"No keybinds to export",no_aliases_to_export:"No aliases to export",failed_to_reset_application:"Failed to reset application: {{error}}",default_demo_data_loaded:"Default demo data loaded successfully",failed_to_load_default_data:"Failed to load default data",failed_to_load_default_data_with_error:"Failed to load default data: {{error}}",failed_to_create_profile_from_template:"Failed to create profile from template",profile_exported:'Profile "{{profileName}}" exported',failed_to_import_profile:"Failed to import profile: {{error}}",sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager loaded successfully",switched_to_profile:"Switched to profile: {{name}} ({{environment}})",profile_created_from:'Profile "{{newName}}" created from "{{sourceProfile}}"',keybinds_exported_successfully:"{{environment}} keybinds exported successfully",commands_updated_successfully:"{{count}} commands updated successfully",command_info:"Command: {{command}}\nType: {{type}}",no_effects_selected:"No effects selected. Please select at least one effect to generate aliases.",generated_vertigo_aliases:"Generated {{count}} Vertigo alias{{plural}}! Check the Alias Manager to bind them to keys.",failed_to_import_keybind_file:"Failed to import keybind file: {{error}}",profile_created_from_current:'Profile "{{name}}" created from "{{currentProfile}}"',profile_renamed:'Profile renamed from "{{oldName}}" to "{{name}}"',failed_to_import_keybind_file_generic:"Failed to import keybind file: {{error}}",failed_to_import_aliases_generic:"Failed to import aliases: {{error}}",application_reset_successfully:"Application reset successfully. All data cleared.",profile_created_from_template_generic:'Profile "{{profileName}}" created from template',profile_imported_successfully:'Profile "{{profileName}}" imported successfully',failed_to_copy_to_clipboard:"Failed to copy to clipboard",confirm_delete_alias:'Are you sure you want to delete the alias "{{aliasName}}"?',confirm_delete_key:'Are you sure you want to delete the key "{{keyName}}" and all its commands?',confirm_clear_commands:'Are you sure you want to clear all commands for "{{keyName}}"?',confirm_delete_profile:'Are you sure you want to delete the profile "{{profileName}}"?\n\nThis action cannot be undone.',confirm_reset_application:"Are you sure you want to reset the application?\n\nThis will delete all profiles, keybinds, and settings. This action cannot be undone.",delete_alias:"Delete Alias",delete_key:"Delete Key",clear_commands:"Clear Commands",yes:"Yes",no:"No",active:"Active",inactive:"Inactive",active_state:"Active State",no_aliases_available:"No aliases available",no_commands:"No commands",profile_not_found:"Profile not found",click_add_command_to_start_building_your_command_chain:"Click 'Add Command' to start building your command chain for",click_add_command_to_start_building_your_alias_chain:"Click 'Add Command' to start building your alias chain for",create_aliases_in_the_alias_manager_first:"Create aliases in the Alias Manager first",enter_sto_command:"Enter STO command",enter_the_exact_sto_command_syntax:"Enter the exact STO command syntax",enter_your_message:"Enter your message",maximum_100_characters:"Maximum 100 characters",replaced_with_your_current_targets_name:"Replaced with your current target's name",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"This alias will automatically toggle between its on/off states when executed",select_an_alias:"Select an alias",select_targeting_command:"Select targeting command",select_combat_command:"Select a combat command",select_shield_command:"Select shield command",select_movement_command:"Select movement command",select_camera_command:"Select camera command",select_system_command:"Select system command",select_communication_type:"Select communication type",create_alias:"Create Alias",alias_commands:"Alias Commands",available_aliases:"Available Aliases",common_commands:"Common Commands",sto_variables:"STO Variables",example:"Example",message:"Message",display_text:"Display Text",descriptive_name_for_this_command:"Descriptive name for this command",filename:"Filename",position:"Position",distance:"Distance",amount:"Amount",state:"State",command:"Command",command_variant:"Command Variant",communication_type:"Communication Type",combat_command:"Combat Command",movement_command:"Movement Command",camera_command:"Camera Command",shield_command:"Shield Command",system_command:"System Command",targeting_command:"Targeting Command",tray_number:"Tray Number",slot_number:"Slot Number",start_tray:"Start Tray",end_tray:"End Tray",start_slot:"Start Slot",end_slot:"End Slot",backup_tray:"Backup Tray",backup_slot:"Backup Slot",backup_start_tray:"Backup Start Tray",backup_end_tray:"Backup End Tray",backup_start_slot:"Backup Start Slot",backup_end_slot:"Backup End Slot",backup_configuration:"Backup Configuration",range_configuration:"Range Configuration",backup_range_configuration:"Backup Range Configuration",single_tray_slot:"Single Tray Slot",single_tray_with_backup:"Single Tray with Backup",tray_range:"Tray Range",tray_range_with_backup:"Tray Range with Backup",whole_tray:"Whole Tray",whole_tray_with_backup:"Whole Tray with Backup",configure_command_options_to_see_preview:"Configure command options to see preview",key:"key",no_profile:"No profile",stotrayexecbytray_description:"STOTrayExecByTray (shows key binding on UI)",trayexecbytray_description:"TrayExecByTray (no UI indication)",on:"On",off:"Off",delay_seconds:"Delay (seconds)",parameter_configuration:"Parameter Configuration",modifier_1:"Modifier 1",modifier_2:"Modifier 2",first_modifier:"First modifier",second_modifier:"Second modifier",cosmetic_command:"Cosmetic Command",select_cosmetic_command:"Select a cosmetic command",tray_command:"Tray Command",create_command_aliases:"Create Command Aliases",bridge_officer:"Bridge Officer",select_bridge_officer_command:"Select a bridge officer command",vfx_manager:"VFX Manager",select_all:"Select All",clear_all:"Clear All",no_space_effects_selected:"No space effects selected",no_ground_effects_selected:"No ground effects selected",show_player_say:"Show Player Say",generate_aliases:"Generate Aliases",net_graph:"Net Graph",net_graph_command:"Net Graph Command",select_net_graph_command:"Select a net graph command",net_timing_graph:"Net Timing Graph",net_timing_graph_alpha:"Net Timing Graph Alpha",net_timing_graph_paused:"Net Timing Graph Paused",netgraph:"Net Graph",enable_disable:"Enable/Disable",transparency_level:"Transparency Level",pause_state:"Pause State",delete_selected_key:"Delete Selected Key",duplicate_selected_key:"Duplicate Selected Key",show_all_keys:"Show All Keys",failed_to_load_profile_data:"Failed to load profile data",no_profile_to_save:"No profile to save",profile_saved:"Profile saved",data_saved:"Data saved",failed_to_save_data:"Failed to save data",failed_to_save_current_profile:"Failed to save current profile",already_on_profile:"Already on this profile",source_profile_not_found:"Source profile not found",no_profile_or_build_data:"No profile or build data",profile_name_required:"Profile name is required",confirm_reset_app:"Are you sure you want to reset the application? This will delete all profiles and data. This action cannot be undone.",switch_to_key_type_view:"Switch to key type view",switch_to_grid_view:"Switch to grid view",switch_to_command_categories:"Switch to command categories",no_profiles_available:"No profiles available",verb:{say:"Say (Local)",team:"Team",zone:"Zone",tell:"Tell"},duplicate_alias:"Duplicate Alias",enter_new_alias_name:"Enter new alias name",alias_name_in_use:"Alias name already exists",duplicate:"Duplicate",invalid_alias_name:"Invalid alias name",reserved_command_name:"Name conflicts with a STO command",backup_created_successfully:"Application backup created successfully",failed_to_create_backup:"Failed to create backup: {{error}}",backup_restored_successfully:"Application state restored successfully",failed_to_restore_backup:"Failed to restore backup: {{error}}",distinguish_left_right_modifiers:"Distinguish left/right modifiers",clear_filter:"Clear filter",warning:"Warning",error:"Error",validation_details:"Validation Details",ok:"OK",command_chain_near_limit:"Command chain is getting long ({{length}} characters). Exceeding 999 may break.",command_chain_too_long:"Command chain is too long ({{length}} characters) and may fail in game.",stabilized_non_tray_warning:"Stabilized execution should be used with tray execution abilities only.",too_many_commands_on_key:"Binding {{count}} commands to one key may fail in game (max recommended 20).",alias_mixed_environment_warning:"Alias contains both space-only and ground-only commands; this is not recommended.",commands_with_internal_warnings:"{{list}}",spam_bar_warning:"Not recommended on spam bars as it interferes with firing cycles",press_any_key_combination:"Press any key combination...",capture_instructions:"Use your keyboard or mouse, or switch to manual to click keys below",switch_to_manual:"Switch to Manual",start_capture:"Start Capture",selected_key:"Selected Key",confirm_selection:"Confirm Selection",quick_suggestions:"Quick Suggestions",modifiers:"Modifiers",keyboard_layout:"Keyboard Layout",mouse_gestures:"Mouse Gestures",suggestion_common:"Common Keys",suggestion_movement:"Movement",suggestion_abilities:"Abilities",suggestion_quickslots:"Quick Slots",suggestion_mouse:"Mouse Actions",key_selection_failed:"Failed to select key"},ee={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Öffnen",save:"Speichern",explorer:"Explorer",keybinds:"Tastaturbelegung",import_keybinds:"Tastaturbelegung importieren",export_keybinds:"Tastaturbelegung exportieren",aliases:"Aliase",import_aliases:"Aliase importieren",export_aliases:"Aliase exportieren",import:"Importieren",import_menu:"Importieren",backup:"Sicherung",backup_menu:"Sicherung",backup_application_state:"Anwendungsstatus sichern",restore_application_state:"Anwendungsstatus wiederherstellen",preferences:"Einstellungen",language:"Sprache",sync_folder_label:"Synchronisationsordner:",no_folder_selected:"Kein Ordner ausgewählt",download:"Herunterladen",vfx:"VFX",dark_mode:"Dunkler Modus",light_mode:"Heller Modus",load_default_data:"Standarddaten laden",reset_application:"Anwendung zurücksetzen",set_sync_folder:"Sync-Ordner festlegen",sync_now:"Jetzt synchronisieren",about:"Über",new:"Neu",clone:"Klonen",rename:"Umbenennen",delete:"Löschen",space:"Weltraum",ground:"Boden",modified:"Geändert",valid:"Gültig",keys:"Tasten",keys_firstupper:"Tasten",key_singular:"Taste",all:"Alle",add_key:"Taste hinzufügen",copy:"Kopieren",select_a_key_to_edit:"Wählen Sie eine Taste zum Bearbeiten",commands:"Befehle",command_singular:"Befehl",stabilize_execution_order:"Ausführungsreihenfolge stabilisieren",validate:"Validieren",clear:"Löschen",no_key_selected:"Keine Taste ausgewählt",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Wählen Sie eine Taste aus dem linken Panel, um ihre Befehlskette anzuzeigen und zu bearbeiten.",generated_command:"Generierter Befehl:",select_a_key_to_see_the_generated_command:"Wählen Sie eine Taste, um den generierten Befehl zu sehen",add_command:"Befehl hinzufügen",from_template:"Aus Vorlage",add_alias:"Alias hinzufügen",copy_from_key:"Von Taste kopieren",command_library:"Befehlsbibliothek",add_new_key:"Neue Taste hinzufügen",key_name:"Tastenname:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Verwenden Sie Standard-Tastennamen wie F1, Strg+A, Umschalt+Leertaste, usw.",common_keys:"Häufige Tasten:",ctrl:"Strg",alt:"Alt",shift:"Umschalt",cancel:"Abbrechen",command_type:"Befehlstyp:",select_command_type:"Befehlstyp auswählen...",targeting:"Zielerfassung",combat:"Kampf",tray_execution:"Tray-Ausführung",shield_management:"Schildverwaltung",movement:"Bewegung",camera:"Kamera",communication:"Kommunikation",system:"System",alias:"Alias",custom_command:"Benutzerdefinierter Befehl",select_a_command_type_to_see_preview:"Wählen Sie einen Befehlstyp für eine Vorschau",profile:"Profil",profile_name:"Profilname:",description_optional:"Beschreibung (optional):",command_alias_manager:"Befehlsalias-Manager",new_alias:"Neuer Alias",edit_alias:"Alias bearbeiten",alias_name:"Alias-Name:",use_alphanumeric_characters_only_no_spaces:"Verwenden Sie nur alphanumerische Zeichen, keine Leerzeichen",description:"Beschreibung:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Beispiel: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Verwenden Sie in Kommunikationsbefehlen, um Zielnamen einzuschließen",preview:"Vorschau:",alias_myalias_command_sequence:'alias MeinAlias "Befehlssequenz"',save_alias:"Alias speichern",select_key:"Taste auswählen",select_key_dialog_title:"Taste auswählen",select_key_dialog_description:"Wählen Sie aus den verfügbaren Tasten unten:",key_combination:"Tastenkombination:",capture_key:"Taste erfassen",select_this_key:"Diese Taste auswählen",select_modifier_key:"Modifikator + Taste auswählen",step_1_select_modifiers_optional:"Schritt 1: Modifikatoren auswählen (Optional)",step_2_select_key:"Schritt 2: Taste auswählen",common:"Häufig",letters:"Buchstaben",numbers:"Zahlen",function:"Funktion",arrows:"Pfeile",symbols:"Symbole",mouse:"Maus",gamepad:"Gamepad",common_keys1:"Häufige Tasten",find_other_keys:"Andere Tasten finden...",vfx_manager:"VFX-Manager",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Wählen Sie visuelle Effekte zum Deaktivieren mit dynFxSetFXExlusionList-Aliasen. Effekte sind nach Umgebung organisiert.",space_effects:"Weltraum-Effekte",select_all:"Alle auswählen",clear_all:"Alle löschen",selected:"ausgewählt",ground_effects:"Boden-Effekte",generated_aliases:"Generierte Aliase:",space_alias:"Weltraum-Alias:",no_space_effects_selected:"Keine Weltraum-Effekte ausgewählt",ground_alias:"Boden-Alias:",no_ground_effects_selected:"Keine Boden-Effekte ausgewählt",show_player_say:"Spieler-Say anzeigen",generate_aliases:"Aliase generieren",about_sto_tools_keybind_manager:"Über STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Ein umfassendes webbasiertes Tool zum Erstellen, Bearbeiten und Verwalten von Star Trek Online Keybind-Konfigurationen mit visueller Bearbeitung und erweiterten Funktionen.",features:"Funktionen:",visual_keybind_editor:"Visueller Keybind-Editor",sto_command_library_with_search_and_categorization:"STO-Befehlsbibliothek mit Suche und Kategorisierung",multiple_profile_management_create_clone_rename_delete:"Mehrfache Profilverwaltung (erstellen, klonen, umbenennen, löschen)",custom_alias_system_for_complex_command_sequences:"Benutzerdefiniertes Alias-System für komplexe Befehlssequenzen",vertigo_inspired_vfx_manager_for_visual_effects_control:"VERTIGO-inspirierter VFX-Manager zur Kontrolle visueller Effekte",import_export_keybind_and_alias_files_and_project_backups:"Import/Export von Keybind- und Alias-Dateien sowie Projekt-Backups",real_time_validation_and_command_preview:"Echtzeit-Validierung und Befehlsvorschau",quick_start:"Schnellstart:",create_a_new_profile_or_use_the_default_profile:"Erstellen Sie ein neues Profil oder verwenden Sie das Standardprofil",select_keys_from_the_grid_and_add_commands_from_the_library:"Wählen Sie Tasten aus dem Raster und fügen Sie Befehle aus der Bibliothek hinzu",use_the_command_chain_editor_to_build_complex_sequences:"Verwenden Sie den Befehlsketten-Editor, um komplexe Sequenzen zu erstellen",export_your_keybinds_as_txt_files_for_use_in_sto:"Exportieren Sie Ihre Keybinds als .txt-Dateien für die Verwendung in STO",resources:"Ressourcen:",copyright:"© 2025 STO Tools. Alle Rechte vorbehalten.",got_it:"Verstanden!",file_explorer:"Datei-Explorer",select_an_item_on_the_left_to_preview_export:"Wählen Sie ein Element links aus, um den Export in der Vorschau anzuzeigen",close:"Schließen",select_export_format:"Exportformat auswählen",export_as:"Exportieren als:",sto_keybind_file_txt:"STO Keybind-Datei (.txt)",json_profile_json:"JSON-Profil (.json)",complete_project_json:"Vollständiges Projekt (.json)",csv_data_csv:"CSV-Daten (.csv)",html_report_html:"HTML-Bericht (.html)",alias_file_txt:"Alias-Datei (.txt)",environment:"Umgebung:",export:"Exportieren",filter_keys:"Tasten filtern...",search_commands:"Befehle suchen...",e_g_f5_ctrl_a_shift_1:"z.B. F5, Strg+A, Umschalt+1",enter_profile_name:"Profilnamen eingeben",describe_this_keybind_profile:"Dieses Keybind-Profil beschreiben",myalias:"MeinAlias",brief_description_of_what_this_alias_does:"Kurze Beschreibung, was dieser Alias tut",enter_command_sequence_use_to_separate_commands:"Befehlssequenz eingeben (verwenden Sie $$ zur Trennung von Befehlen)",search_keys:"Tasten suchen...",open_project_json:"Projekt JSON öffnen",save_project_json:"Projekt JSON speichern",keybind_operations:"Keybind-Operationen",alias_operations:"Alias-Operationen",settings:"Einstellungen",select_profile:"Profil auswählen",new_profile:"Neues Profil",clone_profile:"Profil klonen",rename_profile:"Profil umbenennen",delete_profile:"Profil löschen",space_mode:"Weltraum-Modus",ground_mode:"Boden-Modus",unsaved_changes:"Ungespeicherte Änderungen",validation_status:"Validierungsstatus",bound_keys:"Gebundene Tasten",toggle_between_grid_and_categorized_view:"Zwischen Raster- und kategorisierter Ansicht wechseln",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Gewährleistet konsistente Ausführungsreihenfolge durch Spiegelung der Befehle (Phase 1: links nach rechts, Phase 2: rechts nach links)",validate_command_chain:"Befehlskette validieren",clear_all_commands:"Alle Befehle löschen",copy_to_clipboard:"In Zwischenablage kopieren",collapse_expand:"Einklappen/Ausklappen",insert_target_variable:"$Target-Variable einfügen",sto_keybind_report:"STO Keybind-Bericht",mode:"Modus:",generated:"Generiert:",created_by:"Erstellt von:",statistics:"Statistiken",keys_bound:"Gebundene Tasten:",total_commands:"Gesamtbefehle:",aliases_defined:"Definierte Aliase:",no_keybinds_defined:"Keine Keybinds definiert.",command_aliases:"Befehlsaliase",report_footer:"Dieser Bericht wurde vom STO Tools Keybind Manager generiert. Für weitere Informationen über Star Trek Online Keybinds besuchen Sie das STO Wiki.",command_categories:{targeting:"Zielauswahl",combat:"Kampf",cosmetic:"Kosmetik",bridge_officer:"Brückenoffizier",tray:"Fachausführung",power:"Schildverwaltung",movement:"Bewegung",camera:"Kamera",communication:"Kommunikation",system:"System"},command_definitions:{target:{name:"Ziel nach Name",description:"Ziel nach Namen anvisieren (benötigt Anführungszeichen)"},target_enemy_near:{name:"Nächsten Feind anvisieren",description:"Den nächsten sichtbaren Feind anvisieren"},target_friend_near:{name:"Nächsten Verbündeten anvisieren",description:"Die nächste befreundete Einheit anvisieren"},target_self:{name:"Sich selbst anvisieren",description:"Das eigene Schiff/den eigenen Charakter anvisieren"},target_clear:{name:"Ziel aufheben",description:"Aktuelle Zielerfassung aufheben"},target_teammate_1:{name:"Teammitglied 1 anvisieren",description:"Erstes Teammitglied anvisieren"},target_teammate_2:{name:"Teammitglied 2 anvisieren",description:"Zweites Teammitglied anvisieren"},target_teammate_3:{name:"Teammitglied 3 anvisieren",description:"Drittes Teammitglied anvisieren"},target_teammate_4:{name:"Teammitglied 4 anvisieren",description:"Viertes Teammitglied anvisieren"},fire_all:{name:"Alle Waffen feuern",description:"Alle Waffen feuern"},fire_phasers:{name:"Energiewaffen feuern",description:"Alle Energiewaffen feuern"},fire_torps:{name:"Torpedos feuern",description:"Alle Torpedos feuern"},fire_mines:{name:"Minen feuern",description:"Alle Minen feuern"},fire_phasers_torps:{name:"Phaser & Torpedos feuern",description:"Phaser & Torpedos feuern"},fire_projectiles:{name:"Projektile feuern",description:"Torpedos & Minen feuern"},custom_tray:{name:"Tray-Ausführung",description:"Bestimmten Tray-Slot ausführen"},tray_with_backup:{name:"Tray-Ausführung mit Backup",description:"Bestimmten Tray-Slot mit Backup-Fähigkeit ausführen"},tray_range:{name:"Tray-Bereich-Ausführung",description:"Einen Bereich von Tray-Slots ausführen"},tray_range_with_backup:{name:"Tray-Bereich mit Backup",description:"Einen Bereich von Tray-Slots mit Backup-Fähigkeiten ausführen"},whole_tray:{name:"Gesamtes Tray ausführen",description:"Alle Slots in einem Tray ausführen"},whole_tray_with_backup:{name:"Gesamtes Tray mit Backup",description:"Alle Slots in einem Tray mit Backup-Tray ausführen"},distribute_shields:{name:"Schilde verteilen",description:"Schilde gleichmäßig verteilen, als würde man in die Mitte des Schiff- und Schildsymbols klicken"},reroute_shields_rear:{name:"Schilde nach hinten umleiten",description:"Schildenergie zur Heckseite umleiten"},reroute_shields_left:{name:"Schilde nach links umleiten",description:"Schildenergie zur linken Seite umleiten"},reroute_shields_right:{name:"Schilde nach rechts umleiten",description:"Schildenergie zur rechten Seite umleiten"},reroute_shields_forward:{name:"Schilde nach vorne umleiten",description:"Schildenergie zur Bugseite umleiten"},full_impulse:{name:"Vollimpuls",description:"Vollimpulsantrieb einschalten"},reverse:{name:"Rückwärts",description:"Triebwerke rückwärts"},throttle_adjust:{name:"Schub anpassen",description:"Schub um Betrag erhöhen oder verringern"},throttle_set:{name:"Schub setzen",description:"Schub auf bestimmte Position setzen (negativ = rückwärts, 0 = stopp)"},throttle_toggle:{name:"Schub umschalten",description:"Zwischen Vollschub und Vollstopp wechseln"},turn_left:{name:"Links drehen",description:"Schiff nach links drehen (kontinuierlich während gehalten)"},turn_right:{name:"Rechts drehen",description:"Schiff nach rechts drehen (kontinuierlich während gehalten)"},pitch_up:{name:"Aufwärts neigen",description:"Schiffsnase nach oben neigen (Höhenänderung im Weltraum)"},pitch_down:{name:"Abwärts neigen",description:"Schiffsnase nach unten neigen (Höhenänderung im Weltraum)"},strafe_left:{name:"Links seitlich bewegen",description:"Schiff nach links seitlich bewegen"},strafe_right:{name:"Rechts seitlich bewegen",description:"Schiff nach rechts seitlich bewegen"},forward:{name:"Vorwärts",description:"Vorwärts bewegen"},backward:{name:"Rückwärts",description:"Rückwärts bewegen"},auto_forward:{name:"Auto-Vorwärts",description:"Charakter bewegt sich vorwärts bis neue Bewegungsbefehle gegeben werden"},follow:{name:"Ziel folgen",description:"Der anvisierten Einheit folgen"},follow_cancel:{name:"Folgen abbrechen",description:"Aufhören zu folgen und Ziel vergessen"},zoom_in:{name:"Hineinzoomen",description:"Kamera hineinzoomen"},zoom_out:{name:"Herauszoomen",description:"Kamera herauszoomen"},zoom_in_small:{name:"Leicht hineinzoomen",description:"Kamera leicht hineinzoomen"},zoom_out_small:{name:"Leicht herauszoomen",description:"Kamera leicht herauszoomen"},cam_distance:{name:"Kameraentfernung setzen",description:"Kameraentfernung vom Spieler setzen"},cam_reset:{name:"Kamera zurücksetzen",description:"Kameraposition auf Standard zurücksetzen"},cam_target_lock:{name:"Kamera an Ziel fixieren",description:"Kamera am Ziel fixieren oder lösen"},cam_cycle_distance:{name:"Kameraentfernung wechseln",description:"Kameraentfernung zwischen mehreren voreingestellten Werten wechseln"},cam_mouse_look:{name:"Maus-Blick",description:"Maus-Blick-Kamerasteuerung aktivieren"},cam_turn_to_face:{name:"Zur Kamera drehen",description:"Schiff in Kamerarichtung drehen"},look_up:{name:"Nach oben blicken",description:"Blickwinkel ändern um geradeaus nach oben zu blicken"},look_down:{name:"Nach unten blicken",description:"Blickwinkel ändern um geradeaus nach unten zu blicken"},team_message:{name:"Team-Nachricht",description:"Nachricht an Team senden"},local_message:{name:"Lokale Nachricht",description:"Nachricht an lokalen Bereich senden"},zone_message:{name:"Zonen-Nachricht",description:"Nachricht an Zone senden"},toggle_hud:{name:"HUD umschalten",description:"HUD-Sichtbarkeit umschalten"},screenshot:{name:"Screenshot",description:"Einen Screenshot machen"},screenshot_jpg:{name:"Screenshot JPG",description:"Einen Screenshot als JPG speichern"},autofire_toggle:{name:"Autofeuer umschalten",description:"Waffen-Autofeuer umschalten"},bind_save_file:{name:"Binds in Datei speichern",description:"Alle Binds in eine Textdatei speichern"},bind_load_file:{name:"Binds aus Datei laden",description:"Eine Bind-Datei in den Client laden"},combat_log:{name:"Kampflog umschalten",description:"Kampflog-Aufzeichnung ein-/ausschalten (1=ein, 0=aus)"},missions:{name:"Missionen anzeigen/verbergen",description:"Missionstagebuch anzeigen/verbergen"},inventory:{name:"Inventar anzeigen/verbergen",description:"Inventar anzeigen/verbergen"},map:{name:"Karte",description:"Karte anzeigen/verbergen"},assist:{name:"Unterstützen",description:"Unterstützen '<name>': Unterstützt die Entität mit dem übereinstimmenden Namen. Wenn kein Name angegeben wird, unterstützt Ihr aktuelles Ziel."},net_timing_graph:{name:"Netzwerk-Timing-Graph",description:"Netzwerk-Timing-Graph aktivieren oder deaktivieren (0=deaktivieren, 1=aktivieren)"},net_timing_graph_alpha:{name:"Netzwerk-Timing-Graph Alpha",description:"Transparenzstufe für Netzwerk-Timing-Graph setzen (50=höchste Transparenz, 255=keine Transparenz)"},net_timing_graph_paused:{name:"Netzwerk-Timing-Graph Pausiert",description:"Netzwerk-Timing-Graph pausieren oder fortsetzen (0=Pause deaktiviert, 1=Pause aktiviert)"},netgraph:{name:"Netzwerk-Graph",description:"SND und RCV Netzwerkdaten als Text anzeigen (1=aktiviert, 0=deaktiviert)"},setrallypoint:{name:"Sammelpunkt setzen",description:"Einen Sammelpunkt für Ihr aktuelles Ziel setzen"},setrallypointconsole:{name:"Sammelpunkt setzen (Konsole)",description:"Einen Sammelpunkt für Ihr aktuelles Ziel setzen (Konsolenvariante)"},clearrallypoint:{name:"Sammelpunkt löschen",description:"Den Sammelpunkt für Ihr aktuelles Ziel löschen"},clearallrallypoints:{name:"Alle Sammelpunkte löschen",description:"Alle Sammelpunkte löschen"},bridge_officer_command:"Brückenoffizier-Befehl",select_bridge_officer_command:"Wählen Sie einen Brückenoffizier-Befehl",entity_name_optional:"Entitätsname (optional)",entity_name_optional_placeholder:"Geben Sie den Entitätsnamen ein (optional)",aim:{name:"Zielen",description:"Zielt auf das Ziel"},change_instance:{name:"Instanz wechseln",description:"Wechselt zu einer bereits erstellten Instanz derselben Karte. Funktioniert nur außerhalb des Roten Alarms."},chat_log:{name:"Chat-Log umschalten",description:"Chat-Log-Aufzeichnung ein-/ausschalten (1=an, 0=aus)"},goto_character_select:{name:"Zum Charakterauswahlbildschirm",description:"Zum Charakterauswahlbildschirm wechseln, ohne sich abzumelden."},holster:{name:"Waffe ablegen",description:"Waffe ablegen"},holster_toggle:{name:"Waffe umschalten",description:"Waffe ein-/ausblenden"},logout:{name:"Abmelden",description:"Aktuellen Charakter abmelden"},quit:{name:"Spiel beenden",description:"Fenster schließen"},remember_ui_lists:{name:"UI-Listen merken",description:"Ob die Platzierung und Breite der UI-Listen gemerkt werden soll"},safe_login:{name:"Sicherer Login",description:"Bei Aktivierung wird der Spieler auf die zuletzt besuchte statische Karte eingeloggt"},setactivecostume:{name:"Aktives Kostüm setzen",description:"Setzt das aktuelle aktive Kostüm. Erfordert zwei Modifikatoren."},shooter_clear_offset_tray_binds:{name:"Shooter Offset-Tray-Bindings löschen",description:"Löscht Offset-Tray-Bindings im Shooter-Modus"},shooter_clear_overlay_tray_binds:{name:"Shooter Overlay-Tray-Bindings löschen",description:"Löscht Overlay-Tray-Bindings im Shooter-Modus"},shooter_primary:{name:"Shooter Primär",description:"Primärangriff im Shooter-Modus"},shooter_secondary:{name:"Shooter Sekundär",description:"Sekundärangriff im Shooter-Modus"},shooter_set_offset_tray_binds:{name:"Shooter Offset-Tray-Bindings setzen",description:"Setzt Offset-Tray-Bindings im Shooter-Modus"},shooter_set_overlay_tray_binds:{name:"Shooter Overlay-Tray-Bindings setzen",description:"Setzt Overlay-Tray-Bindings im Shooter-Modus"},shooter_tertiary:{name:"Shooter Tertiär",description:"Tertiärangriff im Shooter-Modus"},show_game_ui:{name:"Spiel-UI anzeigen",description:"Zeigt die Spiel-Benutzeroberfläche an"},show_game_ui_no_extra_keybinds:{name:"Spiel-UI anzeigen (ohne zusätzliche Keybinds)",description:"Zeigt die Spiel-UI ohne zusätzliche Escape-Keybinds an"},toggle_shooter_mode:{name:"Shooter-Modus umschalten",description:"Zwischen Shooter- und RPG-Modus umschalten"},ui_cancel:{name:"UI Abbrechen",description:"Antwortet mit 'Abbrechen' auf ein offenes Dialogfeld; funktioniert nicht in allen Dialogen"},ui_gen_layers_reset:{name:"UI-Layout zurücksetzen",description:"Setzt das Layout zurück, wenn der Server die Position beweglicher Fenster aktualisiert"},ui_load:{name:"UI-Einstellungen laden",description:"Lädt die Standard-UI-Einstellungsdatei, normalerweise Live\\ui_settings.txt"},ui_load_file:{name:"UI-Einstellungsdatei laden",description:"Lädt eine benannte UI-Einstellungsdatei"},ui_ok:{name:"UI OK",description:"Antwortet mit 'OK' auf ein offenes Dialogfeld; funktioniert nicht in allen Dialogen"},ui_remember_positions:{name:"UI-Positionen merken",description:"Ob UI-Größen und -Positionen gemerkt werden sollen. Standardmäßig aktiviert."},ui_resolution:{name:"UI-Auflösung anzeigen",description:"Zeigt die aktuelle UI-Bildschirmauflösung an"},ui_save:{name:"UI-Einstellungen speichern",description:"Speichert das UI-Layout in der Standard-UI-Einstellungsdatei, normalerweise Live\\ui_settings.txt"},ui_save_file:{name:"UI-Einstellungsdatei speichern",description:"Speichert das UI-Layout in einer benannten UI-Einstellungsdatei"},ui_tooltip_delay:{name:"Tooltip-Verzögerung setzen",description:"Setzt die zusätzliche Verzögerung in Sekunden, bevor Tooltips angezeigt werden"},unholster:{name:"Waffe ziehen",description:"Waffe ziehen"}},category_descriptions:{targeting:"Zielauswahl und -verwaltung",combat:"Waffenfeuer und Kampfaktionen",tray:"Fähigkeiten aus Aktions-Trays ausführen",power:"Schildenergie und Verteilungsverwaltung",movement:"Schiffsbewegung und Navigation",camera:"Kamerasteuerung und Ansichtsverwaltung",communication:"Chat und Teamkommunikation",system:"UI- und Systembefehle"},no_aliases:"Keine Aliase",no_aliases_defined:"Keine Aliase definiert",create_alias_to_get_started:"Erstellen Sie einen Alias um zu beginnen",create_aliases_hint:"Erstellen Sie Befehlsaliase um komplexe Befehlssequenzen zu vereinfachen.",alias_deleted:'Alias "{{alias}}" gelöscht',please_select_a_key_first:"Bitte wählen Sie zuerst eine Taste",alias_added_to_key:'Alias "{{alias}}" zu {{key}} hinzugefügt',no_active_profile:"Kein aktives Profil",alias_exists:"Ein Alias mit diesem Namen existiert bereits",alias_template_exists:'Alias "{{alias}}" existiert bereits',alias_created_from_template:'Alias "{{alias}}" aus Vorlage erstellt',template_not_found:"Vorlage nicht gefunden",alias_not_found:"Alias nicht gefunden",alias_created:'Alias "{{alias}}" erstellt',alias_updated:'Alias "{{alias}}" aktualisiert',no_profile_selected_for_import:"Kein Profil für Import ausgewählt",no_keybinds_found_in_file:"Keine Keybinds in Datei gefunden",import_failed:"Import fehlgeschlagen: {{error}}",no_aliases_found_in_file:"Keine Aliase in Datei gefunden",failed_to_get_profile_for_import:"Profil für Import konnte nicht abgerufen werden",import_completed_keybinds:"Import abgeschlossen: {{count}} Keybinds",import_completed_keybinds_with_aliases:"Import abgeschlossen: {{keyCount}} Keybinds ({{aliasCount}} Aliase ignoriert - verwenden Sie Aliase importieren)",import_completed_aliases:"Import abgeschlossen: {{count}} Aliase",no_profile_selected_to_export:"Kein Profil für Export ausgewählt",keybind_file_exported:"Keybind-Datei erfolgreich exportiert",failed_to_export_keybind_file:"Keybind-Datei Export fehlgeschlagen: {{error}}",profile_exported_json:"Profil als JSON exportiert",failed_to_export_profile:"Profil Export fehlgeschlagen: {{error}}",complete_project_exported:"Vollständiges Projekt exportiert",failed_to_export_project:"Projekt Export fehlgeschlagen: {{error}}",data_exported_csv:"Daten als CSV exportiert",failed_to_export_csv:"CSV Export fehlgeschlagen: {{error}}",html_report_exported:"HTML-Bericht exportiert",failed_to_export_html_report:"HTML-Bericht Export fehlgeschlagen: {{error}}",no_command_to_copy:"Kein Befehl zum Kopieren",no_profiles_to_export:"Keine Profile zum Exportieren",exporting_profiles:"Exportiere {{count}} Profile...",aliases_exported_successfully:"Aliase erfolgreich exportiert",failed_to_export_aliases:"Alias Export fehlgeschlagen: {{error}}",sync_folder_set:"Sync-Ordner ausgewählt",failed_to_set_sync_folder:"Sync-Ordner auswählen fehlgeschlagen: {{error}}",no_sync_folder_selected:"Kein Sync-Ordner ausgewählt",project_synced_successfully:"Projekt erfolgreich synchronisiert",permission_denied_to_folder:"Berechtigung zum Schreiben in Ordner verweigert",failed_to_sync_project:"Projekt-Synchronisation fehlgeschlagen: {{error}}",general:"Allgemein",synchronization:"Synchronisation",appearance:"Erscheinungsbild",advanced:"Erweitert",general_settings:"Allgemeine Einstellungen",synchronization_settings:"Synchronisationseinstellungen",appearance_settings:"Erscheinungsbildeinstellungen",language_settings:"Spracheinstellungen",advanced_settings:"Erweiterte Einstellungen",auto_save:"Automatisch speichern",auto_save_description:"Änderungen automatisch während der Arbeit speichern",validation_mode:"Validierungsmodus",validation_mode_description:"Wie streng Befehle und Keybinds validiert werden sollen",strict:"Streng",lenient:"Nachsichtig",disabled:"Deaktiviert",sync_folder_description:"Wählen Sie einen Ordner zum automatischen Synchronisieren Ihrer Projekte",auto_sync:"Automatische Synchronisation",auto_sync_description:"Änderungen automatisch mit dem ausgewählten Ordner synchronisieren",auto_sync_interval:"Auto-Sync-Intervall",auto_sync_interval_description:"Wie oft Ihre Änderungen automatisch synchronisiert werden sollen",after_every_change:"Nach jeder Änderung",every_1_minute:"Jede Minute",every_2_minutes:"Alle 2 Minuten",every_5_minutes:"Alle 5 Minuten",auto_sync_completed:"Auto-Sync abgeschlossen",selected_folder:"Ausgewählter Ordner",theme:"Theme",theme_description:"Wählen Sie zwischen hellem und dunklem Theme",light_theme:"Hell",dark_theme:"Dunkel",compact_mode:"Kompaktmodus",compact_mode_description:"Kompakteres Interface-Layout verwenden",interface_language:"Interface-Sprache",language_description:"Wählen Sie die Sprache für das Interface",debug_mode:"Debug-Modus",debug_mode_description:"Debug-Protokollierung und Entwicklertools aktivieren",backup_interval:"Backup-Intervall",backup_interval_description:"Wie oft Ihre Arbeit automatisch gesichert werden soll",every_15_minutes:"Alle 15 Minuten",every_30_minutes:"Alle 30 Minuten",every_hour:"Jede Stunde",preferences_saved:"Einstellungen erfolgreich gespeichert",failed_to_save_preferences:"Einstellungen konnten nicht gespeichert werden",vfx_manager_description:"Wählen Sie visuelle Effekte aus, die mit dynFxSetFXExlusionList-Aliasen deaktiviert werden sollen. Effekte sind nach Umgebung organisiert.",app_description:"Ein umfassendes webbasiertes Tool zum Erstellen, Bearbeiten und Verwalten von Star Trek Online Keybind-Konfigurationen mit visueller Bearbeitung und erweiterten Funktionen.",csv_header:"Taste,Befehl,Typ,Beschreibung,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Wählen Sie einen Raum-/Boden-Build oder Aliase aus, um die Exportvorschau anzuzeigen.",or_capture_keys:"Oder Tasten erfassen:",click_here_then_press_keys:"Hier klicken, dann Tastenkombination drücken",press_key_combination_now:"Drücken Sie jetzt die Tastenkombination...",supports_single_modifier_plus_key_combinations:"Unterstützt Einzelmodifikator + Tastenkombinationen (z.B. Strg+A, Alt+1, Umschalt+Leertaste)",alias_mode:"Alias-Modus",alias_options:"Alias-Optionen",create:"Erstellen",create_new_alias:"Neuen Alias erstellen",cycle_type:"Zyklus-Typ",filter_aliases:"Aliase filtern",select_an_alias_to_edit:"Wählen Sie einen Alias zum Bearbeiten",select_an_alias_to_see_the_generated_command:"Wählen Sie einen Alias um den generierten Befehl zu sehen",select_options:"Optionen auswählen",toggle_type:"Umschalt-Typ",no_alias_selected:"Kein Alias ausgewählt",select_alias_from_left_panel:"Wählen Sie einen Alias aus dem linken Bereich aus, um seine Befehlssequenz anzuzeigen und zu bearbeiten.",select_key_from_left_panel:"Wählen Sie eine Taste aus dem linken Bereich aus, um ihre Befehlssequenz anzuzeigen und zu bearbeiten.",validation_error:"Validierungsfehler",failed_to_load_application:"Anwendung konnte nicht geladen werden",profile_created:'Profil "{{name}}" erstellt',failed_to_create_profile:"Profil konnte nicht erstellt werden",failed_to_clone_profile:"Profil konnte nicht geklont werden",cannot_delete_the_last_profile:"Das letzte Profil kann nicht gelöscht werden",profile_deleted:'Profil "{{profileName}}" gelöscht',failed_to_delete_profile:"Profil konnte nicht gelöscht werden",invalid_key_name:"Ungültiger Tastenname",key_added:'Taste "{{keyName}}" hinzugefügt',key_already_exists:'Taste "{{keyName}}" existiert bereits',key_deleted:'Taste "{{keyName}}" gelöscht',command_added_to_alias:"Befehl zum Alias hinzugefügt",commands_added:"{{count}} Befehle hinzugefügt",command_added:"Befehl hinzugefügt",command_deleted_from_alias:"Befehl aus Alias gelöscht",command_deleted:"Befehl gelöscht",switched_to_mode:"Zu {{mode}}-Modus gewechselt",alias_already_exists:'Alias "{{name}}" existiert bereits',commands_cleared_for_key:"Befehle für {{keyName}} gelöscht",project_loaded_successfully:"Projekt erfolgreich geladen",failed_to_load_project_file:"Projektdatei konnte nicht geladen werden",invalid_project_file:"Ungültige Projektdatei",project_exported_successfully:"Projekt erfolgreich exportiert",no_commands_to_duplicate:"Keine Befehle zum Duplizieren",key_duplicated:'Taste "{{keyName}}" als "{{newKeyName}}" dupliziert',template_system_coming_soon:"Template-System kommt bald",no_commands_to_validate:"Keine Befehle zu validieren",command_chain_is_valid:"Befehlskette ist gültig",please_configure_a_command:"Bitte konfigurieren Sie einen Befehl",command_updated_successfully:"Befehl erfolgreich aktualisiert",error_message:"Fehler: {{error}}",failed_to_select_all_space_effects:"Alle Weltraum-Effekte konnten nicht ausgewählt werden",failed_to_select_all_ground_effects:"Alle Boden-Effekte konnten nicht ausgewählt werden",space_preview_error:"Weltraum-Vorschau-Fehler: {{error}}",ground_preview_error:"Boden-Vorschau-Fehler: {{error}}",space_alias_error:"Weltraum-Alias-Fehler: {{error}}",failed_to_generate_space_alias:"Weltraum-Alias konnte nicht generiert werden",ground_alias_error:"Boden-Alias-Fehler: {{error}}",failed_to_generate_ground_alias:"Boden-Alias konnte nicht generiert werden",no_profile_selected:"Kein Profil ausgewählt",no_profile_found:"Kein Profil gefunden",switched_to_theme:"Zu {{themeName}} gewechselt",language_updated:"Sprache aktualisiert",auto_sync_failed:"Auto-Sync fehlgeschlagen: {{error}}",nothing_to_copy:"Nichts zu kopieren",content_copied_to_clipboard:"Inhalt in Zwischenablage kopiert",failed_to_generate_export:"Export konnte nicht generiert werden",no_profile_selected_to_clone:"Kein Profil zum Klonen ausgewählt",no_profile_selected_to_rename:"Kein Profil zum Umbenennen ausgewählt",profile_name_is_required:"Profilname ist erforderlich",profile_name_too_long:"Profilname ist zu lang (max. 50 Zeichen)",profile_name_already_exists:"Ein Profil mit diesem Namen existiert bereits",failed_to_save_profile:"Profil konnte nicht gespeichert werden: {{error}}",no_profile_selected_to_delete:"Kein Profil zum Löschen ausgewählt",no_keybinds_to_export:"Keine Keybinds zum Exportieren",no_aliases_to_export:"Keine Aliase zum Exportieren",failed_to_reset_application:"Anwendung konnte nicht zurückgesetzt werden: {{error}}",default_demo_data_loaded:"Standard-Demo-Daten erfolgreich geladen",failed_to_load_default_data:"Standarddaten konnten nicht geladen werden",failed_to_load_default_data_with_error:"Standarddaten konnten nicht geladen werden: {{error}}",failed_to_create_profile_from_template:"Profil konnte nicht aus Template erstellt werden",profile_exported:'Profil "{{profileName}}" exportiert',failed_to_import_profile:"Profil konnte nicht importiert werden: {{error}}",application_reset_successfully:"Anwendung erfolgreich zurückgesetzt",clear_commands:"Befehle löschen",command_info:"Befehl: {{command}}\nTyp: {{type}}",commands_updated_successfully:"{{count}} Befehle erfolgreich aktualisiert",confirm_clear_commands:'Sind Sie sicher, dass Sie alle Befehle für "{{keyName}}" löschen möchten?',confirm_delete_alias:'Sind Sie sicher, dass Sie den Alias "{{aliasName}}" löschen möchten?',confirm_delete_key:'Sind Sie sicher, dass Sie die Taste "{{keyName}}" und alle ihre Befehle löschen möchten?',confirm_delete_profile:'Sind Sie sicher, dass Sie das Profil "{{profileName}}" löschen möchten?\n\nDiese Aktion kann nicht rückgängig gemacht werden.',confirm_reset_application:"Sind Sie sicher, dass Sie die Anwendung zurücksetzen möchten?\n\nDies wird alle Profile, Keybinds und Einstellungen löschen. Diese Aktion kann nicht rückgängig gemacht werden.",delete_alias:"Alias löschen",delete_key:"Taste löschen",failed_to_copy_to_clipboard:"In Zwischenablage kopieren fehlgeschlagen",failed_to_import_aliases_generic:"Aliase konnten nicht importiert werden: {{error}}",failed_to_import_keybind_file:"Keybind-Datei konnte nicht importiert werden: {{error}}",failed_to_import_keybind_file_generic:"Keybind-Datei konnte nicht importiert werden: {{error}}",generated_vertigo_aliases:"{{count}} Vertigo-Alias{{plural}} generiert! Überprüfen Sie die Alias-Liste.",keybinds_exported_successfully:"{{environment}} Keybinds erfolgreich exportiert",no_effects_selected:"Keine Effekte ausgewählt. Bitte wählen Sie mindestens einen Effekt aus, um Aliase zu generieren.",profile_created_from:'Profil "{{newName}}" aus "{{sourceProfile}}" erstellt',profile_created_from_current:'Profil "{{name}}" aus aktuellem Profil "{{currentProfile}}" erstellt',profile_created_from_template_generic:'Profil "{{profileName}}" aus Template erstellt',profile_imported_successfully:'Profil "{{profileName}}" erfolgreich importiert',profile_renamed:'Profil von "{{oldName}}" zu "{{name}}" umbenannt',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager erfolgreich geladen",switched_to_profile:"Zu Profil gewechselt: {{name}} ({{environment}})",yes:"Ja",no:"Nein",active:"Aktiv",inactive:"Inaktiv",active_state:"Aktiver Zustand",no_aliases_available:"Keine Aliase verfügbar",no_commands:"Keine Befehle",profile_not_found:"Profil nicht gefunden",click_add_command_to_start_building_your_command_chain:"Klicken Sie auf 'Befehl hinzufügen', um mit dem Erstellen Ihrer Befehlsfolge für zu beginnen",click_add_command_to_start_building_your_alias_chain:"Klicken Sie auf 'Befehl hinzufügen', um mit dem Erstellen Ihrer Alias-Folge für zu beginnen",create_aliases_in_the_alias_manager_first:"Erstellen Sie zuerst Aliase im Alias-Manager",enter_sto_command:"STO-Befehl eingeben",enter_the_exact_sto_command_syntax:"Geben Sie die genaue STO-Befehlssyntax ein",enter_your_message:"Geben Sie Ihre Nachricht ein",maximum_100_characters:"Maximal 100 Zeichen",replaced_with_your_current_targets_name:"Wird durch den Namen Ihres aktuellen Ziels ersetzt",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Dieser Alias wechselt automatisch zwischen seinen Ein/Aus-Zuständen, wenn er ausgeführt wird",select_an_alias:"Alias auswählen",select_targeting_command:"Zielbefehle auswählen",select_combat_command:"Kampfbefehle auswählen",select_shield_command:"Schildbefehle auswählen",select_movement_command:"Bewegungsbefehle auswählen",select_camera_command:"Kamerabefehle auswählen",select_system_command:"Systembefehle auswählen",select_communication_type:"Kommunikationstyp auswählen",create_alias:"Alias erstellen",alias_commands:"Alias-Befehle",available_aliases:"Verfügbare Aliase",common_commands:"Häufige Befehle",sto_variables:"STO-Variablen",example:"Beispiel",message:"Nachricht",display_text:"Anzeigetext",descriptive_name_for_this_command:"Beschreibender Name für diesen Befehl",filename:"Dateiname",position:"Position",distance:"Entfernung",amount:"Menge",state:"Zustand",command:"Befehl",command_variant:"Befehlsvariante",communication_type:"Kommunikationstyp",combat_command:"Kampfbefehl",movement_command:"Bewegungsbefehl",camera_command:"Kamerabefehl",shield_command:"Schildbefehl",system_command:"Systembefehl",targeting_command:"Zielbefehl",tray_number:"Fachnummer",slot_number:"Slotnummer",start_tray:"Startfach",end_tray:"Endfach",start_slot:"Startslot",end_slot:"Endslot",backup_tray:"Backup-Fach",backup_slot:"Backup-Slot",backup_start_tray:"Backup-Startfach",backup_end_tray:"Backup-Endfach",backup_start_slot:"Backup-Startslot",backup_end_slot:"Backup-Endslot",backup_configuration:"Backup-Konfiguration",range_configuration:"Bereichskonfiguration",backup_range_configuration:"Backup-Bereichskonfiguration",single_tray_slot:"Einzelfach-Slot",single_tray_with_backup:"Einzelfach mit Backup",tray_range:"Fachbereich",tray_range_with_backup:"Fachbereich mit Backup",whole_tray:"Ganzes Fach",whole_tray_with_backup:"Ganzes Fach mit Backup",configure_command_options_to_see_preview:"Konfigurieren Sie Befehlsoptionen, um eine Vorschau zu sehen",key:"Taste",no_profile:"Kein Profil",create_command_aliases:"Befehlsaliase erstellen",bridge_officer:"Brückenoffizier",select_bridge_officer_command:"Wählen Sie einen Brückenoffizier-Befehl",net_graph:"Netzwerk-Graph",net_graph_command:"Netzwerk-Graph-Befehl",select_net_graph_command:"Wählen Sie einen Netzwerk-Graph-Befehl",net_timing_graph:"Netzwerk-Timing-Graph",net_timing_graph_alpha:"Netzwerk-Timing-Graph Alpha",net_timing_graph_paused:"Netzwerk-Timing-Graph Pausiert",netgraph:"Netzwerk-Graph",enable_disable:"Aktivieren/Deaktivieren",transparency_level:"Transparenzstufe",pause_state:"Pausenzustand",cosmetic_command:"Kosmetischer Befehl",delay_seconds:"Verzögerung (Sekunden)",first_modifier:"Erster Modifikator",modifier_1:"Modifikator 1",modifier_2:"Modifikator 2",off:"Aus",on:"An",parameter_configuration:"Parameter-Konfiguration",second_modifier:"Zweiter Modifikator",select_cosmetic_command:"Kosmetischen Befehl auswählen",stotrayexecbytray_description:"Führt Tray-Befehle basierend auf der aktuellen Tray-Nummer aus",tray_command:"Tray-Befehl",trayexecbytray_description:"Führt Befehle basierend auf der aktuellen Tray-Nummer aus",vfx_aliases:"VFX-Aliase",delete_selected_key:"Ausgewählte Taste löschen",duplicate_selected_key:"Ausgewählte Taste duplizieren",show_all_keys:"Alle Tasten anzeigen",duplicate:"Duplizieren",invalid_alias_name:"Ungültiger Alias-Name",reserved_command_name:"Name steht im Konflikt mit einem STO-Befehl",backup_created_successfully:"Anwendungsbackup erfolgreich erstellt",failed_to_create_backup:"Backup erstellen fehlgeschlagen: {{error}}",backup_restored_successfully:"Anwendungsstatus erfolgreich wiederhergestellt",failed_to_restore_backup:"Backup wiederherstellen fehlgeschlagen: {{error}}",import_from_key_or_alias:"Von Taste oder Alias importieren",select_source_to_import_from:"Quelle zum Importieren auswählen:",clear_destination_chain_prior_to_import:"Zielkette vor Import löschen",no_sources_available:"Keine Quellen verfügbar",error_loading_sources:"Fehler beim Laden der Quellen",please_select_a_source:"Bitte wählen Sie eine Quelle",source_has_no_commands:"Quelle hat keine Befehle zum Importieren",commands_imported_successfully:"{{count}} Befehle von {{source}} importiert",cross_environment_import_warning:"Warnung: {{dropped}} {{sourceEnv}}-spezifische Befehle wurden beim Import nach {{targetEnv}} entfernt",no_compatible_commands_to_import:"Keine kompatiblen Befehle zum Importieren nach Filterung",alias_command:"Alias-Befehl",enter_alias_name:"Alias-Namen eingeben",numpad:"Nummernblock",failed_to_load_profile_data:"Fehler beim Laden der Profildaten",no_profile_to_save:"Kein Profil zum Speichern",profile_saved:"Profil gespeichert",data_saved:"Daten gespeichert",failed_to_save_data:"Fehler beim Speichern der Daten",failed_to_save_current_profile:"Fehler beim Speichern des aktuellen Profils",already_on_profile:"Bereits bei diesem Profil",source_profile_not_found:"Quellprofil nicht gefunden",no_profile_or_build_data:"Keine Profil- oder Build-Daten",profile_name_required:"Profilname ist erforderlich",confirm_reset_app:"Sind Sie sicher, dass Sie die Anwendung zurücksetzen möchten? Dies löscht alle Profile und Daten. Diese Aktion kann nicht rückgängig gemacht werden.",switch_to_key_type_view:"Zur Tastentypansicht wechseln",switch_to_grid_view:"Zur Rasteransicht wechseln",switch_to_command_categories:"Zu Befehlskategorien wechseln",no_profiles_available:"Keine Profile verfügbar",verb:{say:"Sagen (Lokal)",team:"Team",zone:"Zone",tell:"Flüstern"},duplicate_alias:"Alias duplizieren",enter_new_alias_name:"Neuen Alias-Namen eingeben",alias_name_in_use:"Alias-Name bereits vorhanden",failed_to_export_profiles:"Fehler beim Exportieren der Profile: {{error}}",failed_to_rename_profile:"Fehler beim Umbenennen des Profils: {{error}}",failed_to_save_file:"Fehler beim Speichern der Datei: {{error}}",file_saved_successfully:"Datei erfolgreich gespeichert",ground_build:"Boden-Build",html_report_title:"STO Keybind-Bericht",import_failed_invalid_format:"Import fehlgeschlagen: Ungültiges Dateiformat",import_failed_invalid_json:"Import fehlgeschlagen: Ungültiges JSON-Format",no_content_available:"Kein Inhalt verfügbar",no_valid_profile:"Kein gültiges Profil verfügbar",profile_already_exists:"Profil existiert bereits",profile_id_required:"Profil-ID ist erforderlich",space_build:"Weltraum-Build",sync_completed:"Synchronisation erfolgreich abgeschlossen",sync_failed:"Synchronisation fehlgeschlagen: {{error}}",syncing:"Synchronisiere...",add_new_alias:"Neuen Alias hinzufügen",delete_selected_alias:"Ausgewählten Alias löschen",duplicate_selected_alias:"Ausgewählten Alias duplizieren",search_aliases:"Aliase suchen...",show_all_aliases:"Alle Aliase anzeigen",show_all_commands:"Alle Befehle anzeigen",enter_key_name:"Tastenname eingeben...",clear_filter:"Filter löschen",warning:"Warnung",error:"Fehler",validation_details:"Validierungsdetails",ok:"OK",command_chain_near_limit:"Befehlsfolge ist fast zu lang ({{length}} Zeichen). Überschreiten von 999 kann zu Fehlern führen.",command_chain_too_long:"Befehlsfolge ist zu lang ({{length}} Zeichen) und kann im Spiel fehlschlagen.",stabilized_non_tray_warning:"Stabilisierte Ausführung sollte nur mit Tray-Ausführungsfähigkeiten verwendet werden.",too_many_commands_on_key:"Die Zuordnung von {{count}} Befehlen zu einer Taste kann im Spiel fehlschlagen (empfohlene Obergrenze 20).",alias_mixed_environment_warning:"Alias enthält sowohl weltraum- als auch bodenspezifische Befehle; dies ist nicht empfohlen.",commands_with_internal_warnings:"{{list}}",spam_bar_warning:"Nicht für Spam-Leisten empfohlen, da es die Feuerzyklen stört",press_any_key_combination:"Drücken Sie eine beliebige Tastenkombination...",capture_instructions:"Verwende deine Tastatur oder Maus, oder wechsle in den manuellen Modus, um unten Tasten anzuklicken",switch_to_manual:"Manuelle Auswahl",start_capture:"Aufnahme starten",selected_key:"Ausgewählte Taste",confirm_selection:"Auswahl bestätigen",quick_suggestions:"Schnelle Vorschläge",modifiers:"Modifikatoren",keyboard_layout:"Tastaturbelegung",mouse_gestures:"Mausgesten",suggestion_common:"Häufige Tasten",suggestion_movement:"Bewegung",suggestion_abilities:"Fähigkeiten",suggestion_quickslots:"Schnellzugriffe",suggestion_mouse:"Mausaktionen",key_selection_failed:"Tastenauswahl fehlgeschlagen"},te={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Ouvrir",save:"Enregistrer",explorer:"Explorateur",keybinds:"Raccourcis",import_keybinds:"Importer les raccourcis",export_keybinds:"Exporter les raccourcis",aliases:"Alias",import_aliases:"Importer les alias",export_aliases:"Exporter les alias",import:"Importer",import_menu:"Importer",backup:"Sauvegarde",backup_menu:"Sauvegarde",backup_application_state:"Sauvegarder l'état de l'application",restore_application_state:"Restaurer l'état de l'application",preferences:"Préférences",language:"Langue",sync_folder_label:"Dossier de synchronisation :",no_folder_selected:"Aucun dossier sélectionné",download:"Télécharger",vfx:"VFX",dark_mode:"Mode sombre",light_mode:"Mode clair",load_default_data:"Charger les données par défaut",reset_application:"Réinitialiser l'application",set_sync_folder:"Définir dossier de synchronisation",sync_now:"Synchroniser maintenant",about:"À propos",new:"Nouveau",clone:"Cloner",rename:"Renommer",delete:"Supprimer",space:"Espace",ground:"Sol",modified:"Modifié",valid:"Valide",keys:"touches",keys_firstupper:"Touches",key_singular:"touche",all:"Tout",add_key:"Ajouter une touche",copy:"Copier",select_a_key_to_edit:"Sélectionnez une touche à modifier",commands:"commandes",command_singular:"commande",stabilize_execution_order:"Stabiliser l'ordre d'exécution",validate:"Valider",clear:"Effacer",no_key_selected:"Aucune touche sélectionnée",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Sélectionnez une touche dans le panneau de gauche pour voir et modifier sa chaîne de commandes.",generated_command:"Commande générée :",select_a_key_to_see_the_generated_command:"Sélectionnez une touche pour voir la commande générée",add_command:"Ajouter une commande",from_template:"À partir d'un modèle",add_alias:"Ajouter un alias",copy_from_key:"Copier depuis la touche",command_library:"Bibliothèque de commandes",add_new_key:"Ajouter une nouvelle touche",key_name:"Nom de la touche :",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Utilisez des noms de touches standard comme F1, Ctrl+A, Shift+Space, etc.",common_keys:"Touches communes :",ctrl:"Ctrl",alt:"Alt",shift:"Maj",cancel:"Annuler",command_type:"Type de commande :",select_command_type:"Sélectionner le type de commande...",targeting:"Ciblage",combat:"Combat",tray_execution:"Exécution de plateau",shield_management:"Gestion des boucliers",movement:"Mouvement",camera:"Caméra",communication:"Communication",system:"Système",alias:"Alias",custom_command:"Commande personnalisée",select_a_command_type_to_see_preview:"Sélectionnez un type de commande pour voir l'aperçu",profile:"Profil",profile_name:"Nom du profil :",description_optional:"Description (optionnelle) :",command_alias_manager:"Gestionnaire d'alias de commandes",new_alias:"Nouvel alias",edit_alias:"Modifier l'alias",alias_name:"Nom de l'alias :",use_alphanumeric_characters_only_no_spaces:"Utilisez uniquement des caractères alphanumériques, pas d'espaces",description:"Description :",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Exemple : target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Utilisez dans les commandes de communication pour inclure le nom de la cible",preview:"Aperçu :",alias_myalias_command_sequence:'alias MonAlias "séquence de commandes"',save_alias:"Enregistrer l'alias",select_key:"Sélectionner la Touche",select_key_dialog_title:"Sélectionner la Touche",select_key_dialog_description:"Choisissez parmi les touches disponibles ci-dessous :",key_combination:"Combinaison de Touches :",capture_key:"Capturer la Touche",select_this_key:"Sélectionner Cette Touche",select_modifier_key:"Sélectionner Modificateur + Touche",step_1_select_modifiers_optional:"Étape 1 : Sélectionner les Modificateurs (Optionnel)",step_2_select_key:"Étape 2 : Sélectionner la Touche",common:"Commun",letters:"Lettres",numbers:"Chiffres",function:"Fonction",arrows:"Flèches",symbols:"Symboles",mouse:"Souris",gamepad:"Manette",common_keys1:"Touches communes",find_other_keys:"Trouver d'autres touches...",vfx_manager:"Gestionnaire VFX",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Sélectionnez les effets visuels à désactiver en utilisant les alias dynFxSetFXExlusionList. Les effets sont organisés par environnement.",space_effects:"Effets d'espace",select_all:"Tout sélectionner",clear_all:"Tout effacer",selected:"sélectionné",ground_effects:"Effets de sol",generated_aliases:"Alias générés :",space_alias:"Alias d'espace :",no_space_effects_selected:"Aucun effet d'espace sélectionné",ground_alias:"Alias de sol :",no_ground_effects_selected:"Aucun effet de sol sélectionné",show_player_say:"Afficher le Say du joueur",generate_aliases:"Générer des Alias",about_sto_tools_keybind_manager:"À propos de STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Un outil web complet pour créer, modifier et gérer les configurations de raccourcis Star Trek Online avec édition visuelle et fonctionnalités avancées.",features:"Fonctionnalités :",visual_keybind_editor:"Éditeur visuel de raccourcis",sto_command_library_with_search_and_categorization:"Bibliothèque de commandes STO avec recherche et catégorisation",multiple_profile_management_create_clone_rename_delete:"Gestion de profils multiples (créer, cloner, renommer, supprimer)",custom_alias_system_for_complex_command_sequences:"Système d'alias personnalisé pour les séquences de commandes complexes",vertigo_inspired_vfx_manager_for_visual_effects_control:"Gestionnaire VFX inspiré de VERTIGO pour le contrôle des effets visuels",import_export_keybind_and_alias_files_and_project_backups:"Import/export de fichiers de raccourcis et d'alias, et sauvegardes de projet",real_time_validation_and_command_preview:"Validation en temps réel et aperçu des commandes",quick_start:"Démarrage rapide :",create_a_new_profile_or_use_the_default_profile:"Créez un nouveau profil ou utilisez le profil par défaut",select_keys_from_the_grid_and_add_commands_from_the_library:"Sélectionnez des touches dans la grille et ajoutez des commandes depuis la bibliothèque",use_the_command_chain_editor_to_build_complex_sequences:"Utilisez l'éditeur de chaînes de commandes pour construire des séquences complexes",export_your_keybinds_as_txt_files_for_use_in_sto:"Exportez vos raccourcis en fichiers .txt pour utilisation dans STO",resources:"Ressources :",copyright:"© 2025 STO Tools. Tous droits réservés.",got_it:"Compris !",file_explorer:"Explorateur de fichiers",select_an_item_on_the_left_to_preview_export:"Sélectionnez un élément à gauche pour prévisualiser l'export",close:"Fermer",select_export_format:"Sélectionner le format d'export",export_as:"Exporter en :",sto_keybind_file_txt:"Fichier de raccourcis STO (.txt)",json_profile_json:"Profil JSON (.json)",complete_project_json:"Projet complet (.json)",csv_data_csv:"Données CSV (.csv)",html_report_html:"Rapport HTML (.html)",alias_file_txt:"Fichier d'alias (.txt)",environment:"Environnement :",export:"Exporter",filter_keys:"Filtrer les touches...",search_commands:"Rechercher des commandes...",e_g_f5_ctrl_a_shift_1:"ex. F5, Ctrl+A, Maj+1",enter_profile_name:"Entrez le nom du profil",describe_this_keybind_profile:"Décrivez ce profil de raccourcis",myalias:"MonAlias",brief_description_of_what_this_alias_does:"Brève description de ce que fait cet alias",enter_command_sequence_use_to_separate_commands:"Entrez la séquence de commandes (utilisez $$ pour séparer les commandes)",search_keys:"Rechercher des touches...",open_project_json:"Ouvrir le JSON du projet",save_project_json:"Enregistrer le JSON du projet",keybind_operations:"Opérations de raccourcis",alias_operations:"Opérations d'alias",settings:"Paramètres",select_profile:"Sélectionner un profil",new_profile:"Nouveau profil",clone_profile:"Cloner le profil",rename_profile:"Renommer le profil",delete_profile:"Supprimer le profil",space_mode:"Mode espace",ground_mode:"Mode sol",unsaved_changes:"Modifications non enregistrées",validation_status:"Statut de validation",bound_keys:"Touches liées",toggle_between_grid_and_categorized_view:"Basculer entre la vue grille et catégorisée",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Assure un ordre d'exécution cohérent en miroir des commandes (Phase 1 : gauche à droite, Phase 2 : droite à gauche)",validate_command_chain:"Valider la chaîne de commandes",clear_all_commands:"Effacer toutes les commandes",copy_to_clipboard:"Copier dans le presse-papiers",collapse_expand:"Réduire/Développer",insert_target_variable:"Insérer la variable $Target",sto_keybind_report:"Rapport de raccourcis STO",mode:"Mode :",generated:"Généré :",created_by:"Créé par :",statistics:"Statistiques",keys_bound:"Touches liées :",total_commands:"Total des commandes :",aliases_defined:"Alias définis :",no_keybinds_defined:"Aucun raccourci défini.",command_aliases:"Alias de commandes",report_footer:"Ce rapport a été généré par STO Tools Keybind Manager. Pour plus d'informations sur les raccourcis Star Trek Online, visitez le Wiki STO.",bridge_officer:"Officier de pont",enable_disable:"Activer/Désactiver",net_graph:"Graphique réseau",net_graph_command:"Commande de graphique réseau",select_bridge_officer_command:"Sélectionner une commande d'officier de pont",select_net_graph_command:"Sélectionner une commande de graphique réseau",transparency_level:"Niveau de transparence",pause_state:"État de pause",command_categories:{targeting:"Ciblage",combat:"Combat",cosmetic:"Cosmétique",bridge_officer:"Officier de passerelle",tray:"Exécution de Plateau",power:"Gestion des Boucliers",movement:"Mouvement",camera:"Caméra",communication:"Communication",system:"Système"},command_definitions:{target:{name:"Cibler par nom",description:"Cibler une entité par son nom (nécessite des guillemets)"},target_enemy_near:{name:"Cibler l'ennemi le plus proche",description:"Cibler l'ennemi le plus proche en vue"},target_friend_near:{name:"Cibler l'allié le plus proche",description:"Cibler l'entité amie la plus proche"},target_self:{name:"Se cibler soi-même",description:"Cibler votre propre vaisseau/personnage"},target_clear:{name:"Effacer la cible",description:"Supprimer le verrouillage de cible actuel"},target_teammate_1:{name:"Cibler coéquipier 1",description:"Cibler le premier membre de l'équipe"},target_teammate_2:{name:"Cibler coéquipier 2",description:"Cibler le deuxième membre de l'équipe"},target_teammate_3:{name:"Cibler coéquipier 3",description:"Cibler le troisième membre de l'équipe"},target_teammate_4:{name:"Cibler coéquipier 4",description:"Cibler le quatrième membre de l'équipe"},fire_all:{name:"Tirer toutes les armes",description:"Tirer toutes les armes"},fire_phasers:{name:"Tirer armes à énergie",description:"Tirer toutes les armes à énergie"},fire_torps:{name:"Tirer torpilles",description:"Tirer toutes les torpilles"},fire_mines:{name:"Tirer mines",description:"Tirer toutes les mines"},fire_phasers_torps:{name:"Tirer phasers et torpilles",description:"Tirer phasers et torpilles"},fire_projectiles:{name:"Tirer les Projectiles",description:"Tirer les torpilles et mines"},setactivecostume:{name:"Définir le Costume Actif",description:"Définit le costume actif actuel. Nécessite deux modificateurs."},custom_tray:{name:"Exécution de plateau",description:"Exécuter un emplacement de plateau spécifique"},tray_with_backup:{name:"Exécution de plateau avec sauvegarde",description:"Exécuter un emplacement de plateau spécifique avec capacité de sauvegarde"},tray_range:{name:"Exécution de plage de plateau",description:"Exécuter une plage d'emplacements de plateau"},tray_range_with_backup:{name:"Plage de plateau avec sauvegarde",description:"Exécuter une plage d'emplacements de plateau avec capacités de sauvegarde"},whole_tray:{name:"Exécution de plateau entier",description:"Exécuter tous les emplacements d'un plateau"},whole_tray_with_backup:{name:"Plateau entier avec sauvegarde",description:"Exécuter tous les emplacements d'un plateau avec plateau de sauvegarde"},distribute_shields:{name:"Distribuer les boucliers",description:"Distribue uniformément les boucliers comme si on cliquait au milieu de l'icône vaisseau et boucliers"},reroute_shields_rear:{name:"Rediriger boucliers arrière",description:"Rediriger l'énergie des boucliers vers l'arrière"},reroute_shields_left:{name:"Rediriger boucliers gauche",description:"Rediriger l'énergie des boucliers vers la gauche"},reroute_shields_right:{name:"Rediriger boucliers droite",description:"Rediriger l'énergie des boucliers vers la droite"},reroute_shields_forward:{name:"Rediriger boucliers avant",description:"Rediriger l'énergie des boucliers vers l'avant"},full_impulse:{name:"Impulsion maximale",description:"Engager le moteur à impulsion maximale"},reverse:{name:"Marche arrière",description:"Moteurs en marche arrière"},throttle_adjust:{name:"Ajuster les gaz",description:"Augmenter ou diminuer les gaz d'une certaine quantité"},throttle_set:{name:"Régler les gaz",description:"Régler les gaz à une position spécifique (négatif = marche arrière, 0 = arrêt)"},throttle_toggle:{name:"Basculer les gaz",description:"Alterner entre gaz maximum et arrêt complet"},turn_left:{name:"Tourner à gauche",description:"Tourner le vaisseau à gauche (continu tant que maintenu)"},turn_right:{name:"Tourner à droite",description:"Tourner le vaisseau à droite (continu tant que maintenu)"},pitch_up:{name:"Cabrer",description:"Cabrer le nez du vaisseau vers le haut (changement d'altitude dans l'espace)"},pitch_down:{name:"Piquer",description:"Piquer le nez du vaisseau vers le bas (changement d'altitude dans l'espace)"},strafe_left:{name:"Déplacement latéral gauche",description:"Déplacer le vaisseau latéralement à gauche"},strafe_right:{name:"Déplacement latéral droite",description:"Déplacer le vaisseau latéralement à droite"},forward:{name:"Avancer",description:"Avancer"},backward:{name:"Reculer",description:"Reculer"},auto_forward:{name:"Avance automatique",description:"Le personnage avance jusqu'à ce que de nouvelles commandes de mouvement soient données"},follow:{name:"Suivre la cible",description:"Suivre l'entité ciblée"},follow_cancel:{name:"Annuler le suivi",description:"Arrêter de suivre et oublier la cible"},zoom_in:{name:"Zoomer",description:"Zoomer la caméra"},zoom_out:{name:"Dézoomer",description:"Dézoomer la caméra"},zoom_in_small:{name:"Zoomer légèrement",description:"Zoomer légèrement la caméra"},zoom_out_small:{name:"Dézoomer légèrement",description:"Dézoomer légèrement la caméra"},cam_distance:{name:"Définir distance caméra",description:"Définir la distance de la caméra par rapport au joueur"},cam_reset:{name:"Réinitialiser caméra",description:"Réinitialiser la position de la caméra par défaut"},cam_target_lock:{name:"Verrouiller caméra sur cible",description:"Verrouiller ou déverrouiller la caméra sur la cible"},cam_cycle_distance:{name:"Alterner distance caméra",description:"Alterner la distance de la caméra entre plusieurs valeurs prédéfinies"},cam_mouse_look:{name:"Vue souris",description:"Activer le contrôle de caméra par vue souris"},cam_turn_to_face:{name:"Tourner vers la caméra",description:"Tourner le vaisseau pour faire face à la direction de la caméra"},look_up:{name:"Regarder vers le haut",description:"Changer le point de vue pour regarder droit vers le haut"},look_down:{name:"Regarder vers le bas",description:"Changer le point de vue pour regarder droit vers le bas"},team_message:{name:"Message d'équipe",description:"Envoyer un message à l'équipe"},local_message:{name:"Message local",description:"Envoyer un message à la zone locale"},zone_message:{name:"Message de zone",description:"Envoyer un message à la zone"},toggle_hud:{name:"Basculer HUD",description:"Basculer la visibilité du HUD"},screenshot:{name:"Capture d'écran",description:"Prendre une capture d'écran"},screenshot_jpg:{name:"Capture d'écran JPG",description:"Sauvegarder une capture d'écran en JPG"},autofire_toggle:{name:"Basculer tir automatique",description:"Basculer le tir automatique des armes"},bind_save_file:{name:"Sauvegarder raccourcis vers fichier",description:"Sauvegarder tous vos raccourcis dans un fichier texte"},bind_load_file:{name:"Charger raccourcis depuis fichier",description:"Charger un fichier de raccourcis dans le client"},combat_log:{name:"Basculer journal de combat",description:"Activer/désactiver l'enregistrement du journal de combat (1=activé, 0=désactivé)"},missions:{name:"Afficher/Masquer missions",description:"Afficher/masquer le journal des missions"},inventory:{name:"Afficher/Masquer inventaire",description:"Afficher/masquer votre inventaire"},map:{name:"Afficher/Masquer carte",description:"Afficher/masquer la fenêtre de carte"},logout:{name:"Se déconnecter",description:"Se déconnecter du personnage actuel."},quit:{name:"Quitter le jeu",description:"Fermer la fenêtre."},ui_load:{name:"Charger les paramètres UI",description:"Charge le fichier de sauvegarde par défaut des fenêtres UI, généralement Live\\ui_settings.txt"},ui_save:{name:"Sauvegarder les paramètres UI",description:"Sauvegarde la mise en page UI dans le fichier de sauvegarde par défaut des fenêtres UI, généralement Live\\ui_settings.txt"},ui_load_file:{name:"Charger le fichier de paramètres UI",description:"Charge le fichier de sauvegarde des fenêtres UI nommé"},ui_save_file:{name:"Sauvegarder le fichier de paramètres UI",description:"Sauvegarde la mise en page UI dans le fichier de sauvegarde des fenêtres UI nommé"},ui_cancel:{name:"UI Annuler",description:'Répond "Annuler" à une boîte de dialogue ouverte; peut ne pas fonctionner dans tous les dialogues.'},ui_ok:{name:"UI OK",description:'Répond "OK" à une boîte de dialogue ouverte; peut ne pas fonctionner dans tous les dialogues.'},chat_log:{name:"Basculer le journal de chat",description:"Activer/désactiver le journal de chat. 1=activé, 0=désactivé, pas de paramètre=afficher le statut. Préfixer ++ le transforme en bascule"},remember_ui_lists:{name:"Mémoriser les listes UI",description:"S'il faut mémoriser le placement et la largeur des colonnes des listes UI."},ui_remember_positions:{name:"Mémoriser les positions UI",description:"S'il faut mémoriser les tailles et positions UI. Activé par défaut."},safe_login:{name:"Connexion sécurisée",description:"Si vrai, alors connecte le joueur à sa carte statique la plus récente au lieu de n'importe quoi d'autre."},goto_character_select:{name:"Aller à la sélection de personnage",description:"Aller à l'écran de sélection de personnage sans se déconnecter."},ui_gen_layers_reset:{name:"Réinitialiser la mise en page UI",description:"Réinitialise la mise en page, utilisé quand le serveur met à jour les positions des fenêtres mobiles"},ui_resolution:{name:"Afficher la résolution UI",description:"Affiche la résolution d'écran UI actuelle."},ui_tooltip_delay:{name:"Définir le délai d'infobulle",description:"Définit le délai supplémentaire, en secondes, avant que les infobulles apparaissent"},show_game_ui:{name:"Afficher l'UI du jeu",description:"Afficher l'UI du jeu"},show_game_ui_no_extra_keybinds:{name:"Afficher l'UI du jeu (sans raccourcis supplémentaires)",description:"Cette commande n'ajoute aucun raccourci pour afficher l'UI quand l'utilisateur appuie sur échap"},change_instance:{name:"Changer d'instance",description:"Changer vers une instance déjà créée de la même carte. Ne fonctionne que quand pas en alerte rouge."},aim:{name:"Viser/Lunette",description:"Activer/désactiver la lunette. En mode lunette le joueur fait plus de dégâts. Peut être utilisé comme bascule ou appuyer et maintenir"},holster:{name:"Ranger l'arme",description:"Tenter de ranger votre arme active"},holster_toggle:{name:"Basculer ranger l'arme",description:"Tenter de ranger ou dégainer vos armes"},unholster:{name:"Dégainer l'arme",description:"Tenter de dégainer votre arme active"},toggle_shooter_mode:{name:"Basculer le mode tireur",description:"Activer/désactiver le mode tireur"},shooter_primary:{name:"Tireur primaire",description:"Action primaire du mode tireur"},shooter_secondary:{name:"Tireur secondaire",description:"Action secondaire du mode tireur"},shooter_tertiary:{name:"Tireur tertiaire",description:"Action tertiaire du mode tireur"},shooter_clear_offset_tray_binds:{name:"Effacer les liaisons de plateau de décalage du tireur",description:"Effacer l'emplacement de départ et le mouvement de la boîte d'action jaune qui apparaît sur le plateau en mode tireur"},shooter_clear_overlay_tray_binds:{name:"Effacer les liaisons de plateau superposé du tireur",description:"Effacer les liaisons de plateau superposé pour le mode tireur"},shooter_set_offset_tray_binds:{name:"Définir les liaisons de plateau de décalage du tireur",description:"Définir l'emplacement de départ et le mouvement de la boîte d'action jaune qui apparaît sur le plateau en mode tireur"},shooter_set_overlay_tray_binds:{name:"Définir les liaisons de plateau superposé du tireur",description:"Définir les liaisons de plateau superposé pour le mode tireur"},setrallypoint:{name:"Définir Point de Ralliement",description:"Définit un point de ralliement pour votre cible actuelle"},setrallypointconsole:{name:"Définir Point de Ralliement (Console)",description:"Définit un point de ralliement pour votre cible actuelle (variante console)"},clearrallypoint:{name:"Effacer Point de Ralliement",description:"Efface le point de ralliement pour votre cible actuelle"},clearallrallypoints:{name:"Effacer Tous les Points de Ralliement",description:"Efface tous les points de ralliement"},assist:{name:"Assister",description:"Assister '<name>': Assiste l'entité portant le nom correspondant. Si aucun nom n'est donné, assiste votre cible actuelle."},net_timing_graph:{name:"Net Timing Graph",description:"Enable or disable the network timing graph (0=disable, 1=enable)"},net_timing_graph_alpha:{name:"Net Timing Graph Alpha",description:"Set transparency level for network timing graph (50=highest transparency, 255=no transparency)"},net_timing_graph_paused:{name:"Net Timing Graph Paused",description:"Pause or resume the network timing graph (0=pause disabled, 1=pause enabled)"},netgraph:{name:"Net Graph",description:"Display SND and RCV network data as text (1=enabled, 0=disabled)"},bridge_officer_command:"Commande d'Officier de Pont",select_bridge_officer_command:"Sélectionnez une commande d'officier de pont",entity_name_optional:"Nom de l'entité (optionnel)",entity_name_optional_placeholder:"Entrez le nom de l'entité (optionnel)"},category_descriptions:{targeting:"Sélection et gestion des cibles",combat:"Tir d'armes et actions de combat",tray:"Exécuter des capacités depuis les plateaux d'action",power:"Gestion de l'énergie et distribution des boucliers",movement:"Mouvement et navigation du vaisseau",camera:"Contrôle de caméra et gestion de vue",communication:"Chat et communication d'équipe",system:"Commandes UI et système"},no_aliases:"Aucun alias",no_aliases_defined:"Aucun alias défini",create_alias_to_get_started:"Créez un alias pour commencer",create_aliases_hint:"Créez des alias de commandes pour simplifier les séquences de commandes complexes.",alias_deleted:'Alias "{{alias}}" supprimé',please_select_a_key_first:"Veuillez d'abord sélectionner une touche",alias_added_to_key:'Alias "{{alias}}" ajouté à {{key}}',no_active_profile:"Aucun profil actif",alias_exists:"Un alias avec ce nom existe déjà",alias_template_exists:'L\'alias "{{alias}}" existe déjà',alias_created_from_template:'Alias "{{alias}}" créé à partir du modèle',template_not_found:"Modèle non trouvé",alias_not_found:"Alias non trouvé",alias_created:'Alias "{{alias}}" créé',alias_updated:'Alias "{{alias}}" mis à jour',no_profile_selected_for_import:"Aucun profil sélectionné pour l'importation",no_keybinds_found_in_file:"Aucun raccourci trouvé dans le fichier",import_failed:"Échec de l'importation : {{error}}",no_aliases_found_in_file:"Aucun alias trouvé dans le fichier",failed_to_get_profile_for_import:"Échec de l'obtention du profil pour l'importation",import_completed_keybinds:"Importation terminée : {{count}} raccourcis",import_completed_keybinds_with_aliases:"Importation terminée : {{keyCount}} raccourcis ({{aliasCount}} alias ignorés - utilisez Importer les alias)",import_completed_aliases:"Importation terminée : {{count}} alias",no_profile_selected_to_export:"Aucun profil sélectionné pour l'exportation",keybind_file_exported:"Fichier de raccourcis exporté avec succès",failed_to_export_keybind_file:"Échec de l'exportation du fichier de raccourcis : {{error}}",profile_exported_json:"Profil exporté en JSON",failed_to_export_profile:"Échec de l'exportation du profil : {{error}}",complete_project_exported:"Projet complet exporté",failed_to_export_project:"Échec de l'exportation du projet : {{error}}",data_exported_csv:"Données exportées en CSV",failed_to_export_csv:"Échec de l'exportation CSV : {{error}}",html_report_exported:"Rapport HTML exporté",failed_to_export_html_report:"Échec de l'exportation du rapport HTML : {{error}}",no_command_to_copy:"Aucune commande à copier",no_profiles_to_export:"Aucun profil à exporter",exporting_profiles:"Exportation de {{count}} profils...",aliases_exported_successfully:"Alias exportés avec succès",failed_to_export_aliases:"Échec de l'exportation des alias : {{error}}",sync_folder_set:"Dossier de synchronisation sélectionné",failed_to_set_sync_folder:"Échec de la sélection du dossier de synchronisation : {{error}}",no_sync_folder_selected:"Aucun dossier de synchronisation sélectionné",project_synced_successfully:"Projet synchronisé avec succès",permission_denied_to_folder:"Permission refusée pour écrire dans le dossier",failed_to_sync_project:"Échec de la synchronisation du projet : {{error}}",general:"Général",synchronization:"Synchronisation",appearance:"Apparence",advanced:"Avancé",general_settings:"Paramètres généraux",synchronization_settings:"Paramètres de synchronisation",appearance_settings:"Paramètres d'apparence",language_settings:"Paramètres de langue",advanced_settings:"Paramètres avancés",auto_save:"Sauvegarde automatique",auto_save_description:"Sauvegarder automatiquement les modifications pendant le travail",validation_mode:"Mode de validation",validation_mode_description:"Niveau de validation des commandes et raccourcis",strict:"Strict",lenient:"Souple",disabled:"Désactivé",sync_folder_description:"Choisissez un dossier pour synchroniser automatiquement vos projets",auto_sync:"Synchronisation automatique",auto_sync_description:"Synchroniser automatiquement les modifications avec le dossier sélectionné",auto_sync_interval:"Intervalle de synchronisation automatique",auto_sync_interval_description:"À quelle fréquence synchroniser automatiquement vos modifications",after_every_change:"Après chaque modification",every_1_minute:"Chaque minute",every_2_minutes:"Toutes les 2 minutes",every_5_minutes:"Toutes les 5 minutes",auto_sync_completed:"Synchronisation automatique terminée",selected_folder:"Dossier sélectionné",theme:"Thème",theme_description:"Choisissez entre les thèmes clair et sombre",light_theme:"Clair",dark_theme:"Sombre",compact_mode:"Mode compact",compact_mode_description:"Utiliser une disposition d'interface plus compacte",interface_language:"Langue de l'interface",language_description:"Choisissez la langue de l'interface",debug_mode:"Mode débogage",debug_mode_description:"Activer la journalisation de débogage et les outils de développement",backup_interval:"Intervalle de sauvegarde",backup_interval_description:"Fréquence de sauvegarde automatique de votre travail",every_15_minutes:"Toutes les 15 minutes",every_30_minutes:"Toutes les 30 minutes",every_hour:"Toutes les heures",preferences_saved:"Préférences sauvegardées avec succès",failed_to_save_preferences:"Échec de la sauvegarde des préférences",vfx_manager_description:"Sélectionnez les effets visuels à désactiver en utilisant les alias dynFxSetFXExlusionList. Les effets sont organisés par environnement.",app_description:"Un outil web complet pour créer, éditer et gérer les configurations de raccourcis de Star Trek Online avec édition visuelle et fonctionnalités avancées.",csv_header:"Touche,Commande,Type,Description,Position",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Sélectionnez une construction Espace/Sol ou des Alias pour prévisualiser l'exportation.",or_capture_keys:"Ou capturer les touches :",click_here_then_press_keys:"Cliquez ici, puis appuyez sur la combinaison de touches",press_key_combination_now:"Appuyez sur la combinaison de touches maintenant...",supports_single_modifier_plus_key_combinations:"Prend en charge les combinaisons modificateur unique + touche (ex. Ctrl+A, Alt+1, Shift+Space)",alias_mode:"Mode alias",alias_options:"Options d'alias",create:"Créer",create_new_alias:"Créer un nouvel alias",cycle_type:"Type de cycle",filter_aliases:"Filtrer les alias",select_an_alias_to_edit:"Sélectionnez un alias à modifier",select_an_alias_to_see_the_generated_command:"Sélectionnez un alias pour voir la commande générée",select_options:"Sélectionner les options",toggle_type:"Type de basculement",no_alias_selected:"Aucun alias sélectionné",select_alias_from_left_panel:"Sélectionnez un alias dans le panneau de gauche pour afficher et modifier sa chaîne de commandes.",select_key_from_left_panel:"Sélectionnez une touche dans le panneau de gauche pour afficher et modifier sa chaîne de commandes.",validation_error:"Erreur de validation",failed_to_load_application:"Impossible de charger l'application",profile_created:'Profil "{{name}}" créé',failed_to_create_profile:"Impossible de créer le profil",failed_to_clone_profile:"Impossible de cloner le profil",cannot_delete_the_last_profile:"Impossible de supprimer le dernier profil",profile_deleted:'Profil "{{profileName}}" supprimé',failed_to_delete_profile:"Impossible de supprimer le profil",invalid_key_name:"Nom de touche invalide",key_added:'Touche "{{keyName}}" ajoutée',key_already_exists:'La touche "{{keyName}}" existe déjà',key_deleted:'Touche "{{keyName}}" supprimée',command_added_to_alias:"Commande ajoutée à l'alias",commands_added:"{{count}} commandes ajoutées",command_added:"Commande ajoutée",command_deleted_from_alias:"Commande supprimée de l'alias",command_deleted:"Commande supprimée",switched_to_mode:"Passé au mode {{mode}}",alias_already_exists:'L\'alias "{{name}}" existe déjà',commands_cleared_for_key:"Commandes effacées pour {{keyName}}",project_loaded_successfully:"Projet chargé avec succès",failed_to_load_project_file:"Impossible de charger le fichier de projet",invalid_project_file:"Fichier de projet invalide",project_exported_successfully:"Projet exporté avec succès",no_commands_to_duplicate:"Aucune commande à dupliquer",key_duplicated:'Touche "{{keyName}}" dupliquée en "{{newKeyName}}"',template_system_coming_soon:"Système de modèles bientôt disponible",no_commands_to_validate:"Aucune commande à valider",command_chain_is_valid:"Chaîne de commandes valide",please_configure_a_command:"Veuillez configurer une commande",command_updated_successfully:"Commande mise à jour avec succès",error_message:"Erreur : {{error}}",failed_to_select_all_space_effects:"Impossible de sélectionner tous les effets d'espace",failed_to_select_all_ground_effects:"Impossible de sélectionner tous les effets de sol",space_preview_error:"Erreur de prévisualisation d'espace : {{error}}",ground_preview_error:"Erreur de prévisualisation de sol : {{error}}",space_alias_error:"Erreur d'alias d'espace : {{error}}",failed_to_generate_space_alias:"Impossible de générer l'alias d'espace",ground_alias_error:"Erreur d'alias de sol : {{error}}",failed_to_generate_ground_alias:"Impossible de générer l'alias de sol",no_profile_selected:"Aucun profil sélectionné",no_profile_found:"Aucun profil trouvé",switched_to_theme:"Passé à {{themeName}}",language_updated:"Langue mise à jour",auto_sync_failed:"Synchronisation automatique échouée : {{error}}",nothing_to_copy:"Rien à copier",content_copied_to_clipboard:"Contenu copié dans le presse-papiers",failed_to_generate_export:"Impossible de générer l'export",no_profile_selected_to_clone:"Aucun profil sélectionné pour cloner",no_profile_selected_to_rename:"Aucun profil sélectionné pour renommer",profile_name_is_required:"Le nom du profil est requis",profile_name_too_long:"Le nom du profil est trop long (max 50 caractères)",profile_name_already_exists:"Un profil avec ce nom existe déjà",failed_to_save_profile:"Impossible de sauvegarder le profil : {{error}}",no_profile_selected_to_delete:"Aucun profil sélectionné pour supprimer",no_keybinds_to_export:"Aucun raccourci à exporter",no_aliases_to_export:"Aucun alias à exporter",failed_to_reset_application:"Impossible de réinitialiser l'application : {{error}}",default_demo_data_loaded:"Données de démonstration par défaut chargées avec succès",failed_to_load_default_data:"Impossible de charger les données par défaut",failed_to_load_default_data_with_error:"Impossible de charger les données par défaut : {{error}}",failed_to_create_profile_from_template:"Impossible de créer le profil à partir du modèle",profile_exported:'Profil "{{profileName}}" exporté',failed_to_import_profile:"Impossible d'importer le profil : {{error}}",application_reset_successfully:"Application réinitialisée avec succès",clear_commands:"Effacer les commandes",command_info:"Commande : {{command}}\nType : {{type}}",commands_updated_successfully:"{{count}} commandes mises à jour avec succès",confirm_clear_commands:'Êtes-vous sûr de vouloir effacer toutes les commandes pour "{{keyName}}" ?',confirm_delete_alias:'Êtes-vous sûr de vouloir supprimer l\'alias "{{aliasName}}" ?',confirm_delete_key:'Êtes-vous sûr de vouloir supprimer la touche "{{keyName}}" et toutes ses commandes ?',confirm_delete_profile:'Êtes-vous sûr de vouloir supprimer le profil "{{profileName}}" ?\n\nCette action ne peut pas être annulée.',confirm_reset_application:"Êtes-vous sûr de vouloir réinitialiser l'application ?\n\nCela supprimera tous les profils, raccourcis et paramètres. Cette action ne peut pas être annulée.",delete_alias:"Supprimer l'alias",delete_key:"Supprimer la touche",failed_to_copy_to_clipboard:"Échec de la copie dans le presse-papiers",failed_to_import_aliases_generic:"Impossible d'importer les alias : {{error}}",failed_to_import_keybind_file:"Impossible d'importer le fichier de raccourcis : {{error}}",failed_to_import_keybind_file_generic:"Impossible d'importer le fichier de raccourcis : {{error}}",generated_vertigo_aliases:"{{count}} alias Vertigo généré{{plural}} ! Vérifiez la liste des alias.",keybinds_exported_successfully:"Raccourcis {{environment}} exportés avec succès",no_effects_selected:"Aucun effet sélectionné. Veuillez sélectionner au moins un effet pour générer des alias.",profile_created_from:'Profil "{{newName}}" créé à partir de "{{sourceProfile}}"',profile_created_from_current:'Profil "{{name}}" créé à partir du profil actuel "{{currentProfile}}"',profile_created_from_template_generic:'Profil "{{profileName}}" créé à partir du modèle',profile_imported_successfully:'Profil "{{profileName}}" importé avec succès',profile_renamed:'Profil renommé de "{{oldName}}" à "{{name}}"',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager chargé avec succès",switched_to_profile:"Passé au profil : {{name}} ({{environment}})",yes:"Oui",no:"Non",active:"Actif",inactive:"Inactif",active_state:"État Actif",no_aliases_available:"Aucun alias disponible",no_commands:"Aucune commande",profile_not_found:"Profil introuvable",click_add_command_to_start_building_your_command_chain:"Cliquez sur 'Ajouter une commande' pour commencer à construire votre chaîne de commandes pour",click_add_command_to_start_building_your_alias_chain:"Cliquez sur 'Ajouter une commande' pour commencer à construire votre chaîne d'alias pour",create_aliases_in_the_alias_manager_first:"Créez d'abord des alias dans le Gestionnaire d'alias",enter_sto_command:"Entrez la commande STO",enter_the_exact_sto_command_syntax:"Entrez la syntaxe exacte de la commande STO",enter_your_message:"Entrez votre message",maximum_100_characters:"Maximum 100 caractères",replaced_with_your_current_targets_name:"Remplacé par le nom de votre cible actuelle",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Cet alias basculera automatiquement entre ses états marche/arrêt lorsqu'il sera exécuté",select_an_alias:"Sélectionner un alias",select_targeting_command:"Sélectionner une commande de ciblage",select_combat_command:"Sélectionner une commande de combat",select_shield_command:"Sélectionner une commande de bouclier",select_movement_command:"Sélectionner une commande de mouvement",select_camera_command:"Sélectionner une commande de caméra",select_system_command:"Sélectionner une commande système",select_communication_type:"Sélectionner le type de communication",create_alias:"Créer un Alias",alias_commands:"Commandes d'Alias",available_aliases:"Alias Disponibles",common_commands:"Commandes Communes",sto_variables:"Variables STO",example:"Exemple",message:"Message",display_text:"Texte d'Affichage",descriptive_name_for_this_command:"Nom descriptif pour cette commande",filename:"Nom de fichier",position:"Position",distance:"Distance",amount:"Quantité",state:"État",command:"Commande",command_variant:"Variante de Commande",communication_type:"Type de Communication",combat_command:"Commande de Combat",movement_command:"Commande de Mouvement",camera_command:"Commande de Caméra",shield_command:"Commande de Bouclier",system_command:"Commande Système",targeting_command:"Commande de Ciblage",tray_number:"Numéro de Plateau",slot_number:"Numéro d'Emplacement",start_tray:"Plateau de Début",end_tray:"Plateau de Fin",start_slot:"Emplacement de Début",end_slot:"Emplacement de Fin",backup_tray:"Plateau de Sauvegarde",backup_slot:"Emplacement de Sauvegarde",backup_start_tray:"Plateau de Début de Sauvegarde",backup_end_tray:"Plateau de Fin de Sauvegarde",backup_start_slot:"Emplacement de Début de Sauvegarde",backup_end_slot:"Emplacement de Fin de Sauvegarde",backup_configuration:"Configuration de Sauvegarde",range_configuration:"Configuration de Plage",backup_range_configuration:"Configuration de Plage de Sauvegarde",single_tray_slot:"Emplacement de Plateau Unique",single_tray_with_backup:"Plateau Unique avec Sauvegarde",tray_range:"Plage de Plateau",tray_range_with_backup:"Plage de Plateau avec Sauvegarde",whole_tray:"Plateau Complet",whole_tray_with_backup:"Plateau Complet avec Sauvegarde",configure_command_options_to_see_preview:"Configurez les options de commande pour voir l'aperçu",key:"touche",no_profile:"Aucun profil",stotrayexecbytray_description:"STOTrayExecByTray (affiche la liaison de touche dans l'UI)",trayexecbytray_description:"TrayExecByTray (aucune indication d'UI)",parameter_configuration:"Configuration des paramètres",modifier_1:"Modificateur 1",modifier_2:"Modificateur 2",first_modifier:"Premier modificateur",second_modifier:"Deuxième modificateur",cosmetic_command:"Commande Cosmétique",select_cosmetic_command:"Sélectionnez une commande cosmétique",tray_command:"Commande de Plateau",vfx_aliases:"Alias VFX",create_command_aliases:"Créer des Alias de Commandes",on:"Activé",off:"Désactivé",delay_seconds:"Délai (secondes)",net_timing_graph:"Graphique de timing réseau",net_timing_graph_alpha:"Graphique de timing réseau alpha",net_timing_graph_paused:"Graphique de timing réseau en pause",netgraph:"Graphique réseau",delete_selected_key:"Supprimer la touche sélectionnée",duplicate_selected_key:"Dupliquer la touche sélectionnée",show_all_keys:"Afficher toutes les touches",duplicate:"Dupliquer",invalid_alias_name:"Nom d'alias invalide",reserved_command_name:"Le nom entre en conflit avec une commande STO",backup_created_successfully:"Sauvegarde de l'application créée avec succès",failed_to_create_backup:"Échec de la création de la sauvegarde : {{error}}",backup_restored_successfully:"État de l'application restauré avec succès",failed_to_restore_backup:"Échec de la restauration de la sauvegarde : {{error}}",import_from_key_or_alias:"Importer depuis Touche ou Alias",select_source_to_import_from:"Sélectionner la source à importer :",clear_destination_chain_prior_to_import:"Effacer la chaîne de destination avant l'import",no_sources_available:"Aucune source disponible",error_loading_sources:"Erreur lors du chargement des sources",please_select_a_source:"Veuillez sélectionner une source",source_has_no_commands:"La source n'a aucune commande à importer",commands_imported_successfully:"{{count}} commandes importées depuis {{source}}",cross_environment_import_warning:"Attention : {{dropped}} commandes spécifiques à {{sourceEnv}} ont été supprimées lors de l'importation vers {{targetEnv}}",no_compatible_commands_to_import:"Aucune commande compatible à importer après filtrage",alias_command:"Commande d'Alias",enter_alias_name:"Entrer le nom de l'alias",numpad:"Pavé numérique",failed_to_load_profile_data:"Échec du chargement des données de profil",no_profile_to_save:"Aucun profil à sauvegarder",profile_saved:"Profil sauvegardé",data_saved:"Données sauvegardées",failed_to_save_data:"Échec de la sauvegarde des données",failed_to_save_current_profile:"Échec de la sauvegarde du profil actuel",already_on_profile:"Déjà sur ce profil",source_profile_not_found:"Profil source non trouvé",no_profile_or_build_data:"Aucune donnée de profil ou de construction",profile_name_required:"Nom de profil requis",confirm_reset_app:"Êtes-vous sûr de vouloir réinitialiser l'application ? Cela supprimera tous les profils et données. Cette action ne peut pas être annulée.",switch_to_key_type_view:"Basculer vers la vue par type de touche",switch_to_grid_view:"Basculer vers la vue grille",switch_to_command_categories:"Basculer vers les catégories de commandes",no_profiles_available:"Aucun profil disponible",verb:{say:"Dire (Local)",team:"Équipe",zone:"Zone",tell:"Chuchoter"},duplicate_alias:"Dupliquer l'Alias",enter_new_alias_name:"Entrer un nouveau nom d'alias",alias_name_in_use:"Le nom d'alias existe déjà",failed_to_export_profiles:"Échec de l'exportation des profils : {{error}}",failed_to_rename_profile:"Échec du renommage du profil : {{error}}",failed_to_save_file:"Échec de la sauvegarde du fichier : {{error}}",file_saved_successfully:"Fichier sauvegardé avec succès",ground_build:"Construction Sol",html_report_title:"Rapport de Raccourcis STO",import_failed_invalid_format:"Importation échouée : Format de fichier invalide",import_failed_invalid_json:"Importation échouée : Format JSON invalide",no_content_available:"Aucun contenu disponible",no_valid_profile:"Aucun profil valide disponible",profile_already_exists:"Le profil existe déjà",profile_id_required:"ID de profil requis",space_build:"Construction Espace",sync_completed:"Synchronisation terminée avec succès",sync_failed:"Synchronisation échouée : {{error}}",syncing:"Synchronisation en cours...",add_new_alias:"Ajouter un Nouvel Alias",delete_selected_alias:"Supprimer l'Alias Sélectionné",duplicate_selected_alias:"Dupliquer l'Alias Sélectionné",search_aliases:"Rechercher des alias...",show_all_aliases:"Afficher Tous les Alias",show_all_commands:"Afficher Toutes les Commandes",enter_key_name:"Entrer le nom de la touche...",clear_filter:"Effacer le filtre",warning:"Avertissement",error:"Erreur",validation_details:"Détails de la validation",ok:"OK",command_chain_near_limit:"La chaîne de commandes devient longue ({{length}} caractères). Dépasser 999 peut échouer.",command_chain_too_long:"La chaîne de commandes est trop longue ({{length}} caractères) et peut échouer dans le jeu.",stabilized_non_tray_warning:"L'exécution stabilisée ne doit être utilisée qu'avec des capacités d'exécution de barre.",too_many_commands_on_key:"Associer {{count}} commandes à une seule touche peut échouer en jeu (maximum recommandé 20).",alias_mixed_environment_warning:"L'alias contient des commandes exclusives espace et sol ; ceci n'est pas recommandé.",commands_with_internal_warnings:"{{list}}",spam_bar_warning:"Non recommandé sur les barres de spam car cela perturbe les cycles de tir",press_any_key_combination:"Appuyez sur n'importe quelle combinaison de touches...",capture_instructions:"Utilisez votre clavier ou votre souris, ou passez en mode manuel pour cliquer sur les touches ci-dessous",switch_to_manual:"Basculer en manuel",start_capture:"Démarrer la capture",selected_key:"Touche sélectionnée",confirm_selection:"Confirmer la sélection",quick_suggestions:"Suggestions rapides",modifiers:"Modificateurs",keyboard_layout:"Disposition du clavier",mouse_gestures:"Gestes de souris",suggestion_common:"Touches courantes",suggestion_movement:"Mouvement",suggestion_abilities:"Compétences",suggestion_quickslots:"Raccourcis",suggestion_mouse:"Actions de souris",key_selection_failed:"Échec de la sélection de la touche"},ie={sto_tools_keybind_manager:"STO Tools Keybind Manager",open:"Abrir",save:"Guardar",explorer:"Explorador",keybinds:"Atajos de teclado",import_keybinds:"Importar atajos de teclado",export_keybinds:"Exportar atajos de teclado",aliases:"Alias",import_aliases:"Importar alias",export_aliases:"Exportar alias",import:"Importar",import_menu:"Importar",backup:"Respaldo",backup_menu:"Respaldo",backup_application_state:"Respaldar estado de la aplicación",restore_application_state:"Restaurar estado de la aplicación",preferences:"Preferencias",language:"Idioma",sync_folder_label:"Carpeta de sincronización:",no_folder_selected:"Ninguna carpeta seleccionada",download:"Descargar",vfx:"VFX",dark_mode:"Modo oscuro",light_mode:"Modo claro",load_default_data:"Cargar datos predeterminados",reset_application:"Restablecer aplicación",set_sync_folder:"Establecer carpeta de sincronización",sync_now:"Sincronizar ahora",about:"Acerca de",new:"Nuevo",clone:"Clonar",rename:"Renombrar",delete:"Eliminar",space:"Espacio",ground:"Suelo",modified:"Modificado",valid:"Válido",keys:"teclas",keys_firstupper:"Teclas",key_singular:"tecla",all:"Todo",add_key:"Agregar tecla",copy:"Copiar",select_a_key_to_edit:"Selecciona una tecla para editar",commands:"comandos",command_singular:"comando",stabilize_execution_order:"Estabilizar orden de ejecución",validate:"Validar",clear:"Limpiar",no_key_selected:"Ninguna tecla seleccionada",select_a_key_from_the_left_panel_to_view_and_edit_its_command_chain:"Selecciona una tecla del panel izquierdo para ver y editar su cadena de comandos.",generated_command:"Comando generado:",select_a_key_to_see_the_generated_command:"Selecciona una tecla para ver el comando generado",add_command:"Agregar comando",from_template:"Desde plantilla",add_alias:"Agregar alias",copy_from_key:"Copiar desde tecla",command_library:"Biblioteca de comandos",add_new_key:"Agregar nueva tecla",key_name:"Nombre de la tecla:",use_standard_key_names_like_f1_ctrl_a_shift_space_etc:"Use nombres de teclas estándar como F1, Ctrl+A, Shift+Space, etc.",or_capture_keys:"O capturar teclas:",click_here_then_press_keys:"Haga clic aquí, luego presione la combinación de teclas",press_key_combination_now:"Presione la combinación de teclas ahora...",supports_single_modifier_plus_key_combinations:"Admite combinaciones de modificador único + tecla (ej. Ctrl+A, Alt+1, Shift+Space)",common_keys:"Teclas comunes:",ctrl:"Ctrl",alt:"Alt",shift:"Mayús",cancel:"Cancelar",command_type:"Tipo de comando:",select_command_type:"Seleccionar tipo de comando...",targeting:"Apuntado",combat:"Combate",tray_execution:"Ejecución de bandeja",shield_management:"Gestión de escudos",movement:"Movimiento",camera:"Cámara",communication:"Comunicación",system:"Sistema",alias:"Alias",custom_command:"Comando personalizado",select_a_command_type_to_see_preview:"Selecciona un tipo de comando para ver vista previa",profile:"Perfil",profile_name:"Nombre del perfil:",description_optional:"Descripción (opcional):",command_alias_manager:"Gestor de alias de comandos",new_alias:"Nuevo alias",edit_alias:"Editar alias",alias_name:"Nombre del alias:",use_alphanumeric_characters_only_no_spaces:"Use solo caracteres alfanuméricos, sin espacios",description:"Descripción:",target:"$Target",example_target_self_power_exec_science_team_team_healing_target:"Ejemplo: target_self $$ +power_exec Science_Team $$ team Healing [$Target]",use_in_communication_commands_to_include_target_name:"- Use en comandos de comunicación para incluir nombre del objetivo",preview:"Vista previa:",alias_myalias_command_sequence:'alias MiAlias "secuencia de comandos"',save_alias:"Guardar alias",select_key:"Seleccionar Tecla",select_key_dialog_title:"Seleccionar Tecla",select_key_dialog_description:"Elija de las teclas disponibles a continuación:",key_combination:"Combinación de Teclas:",capture_key:"Capturar Tecla",select_this_key:"Seleccionar Esta Tecla",select_modifier_key:"Seleccionar Modificador + Tecla",step_1_select_modifiers_optional:"Paso 1: Seleccionar Modificadores (Opcional)",step_2_select_key:"Paso 2: Seleccionar Tecla",common:"Común",letters:"Letras",numbers:"Números",function:"Función",arrows:"Flechas",symbols:"Símbolos",mouse:"Ratón",gamepad:"Gamepad",common_keys1:"Teclas comunes",find_other_keys:"Encontrar otras teclas...",vfx_manager:"Gestor VFX",select_visual_effects_to_disable_using_dynfxsetfxexlusionlist_aliases_effects_are_organized_by_environment:"Selecciona efectos visuales para desactivar usando alias dynFxSetFXExlusionList. Los efectos están organizados por entorno.",space_effects:"Efectos de espacio",select_all:"Seleccionar Todo",clear_all:"Limpiar Todo",selected:"seleccionado",ground_effects:"Efectos de suelo",generated_aliases:"Alias generados:",space_alias:"Alias de espacio:",no_space_effects_selected:"No hay efectos espaciales seleccionados",ground_alias:"Alias de suelo:",no_ground_effects_selected:"No hay efectos terrestres seleccionados",show_player_say:"Mostrar Decir del Jugador",generate_aliases:"Generar Alias",about_sto_tools_keybind_manager:"Acerca de STO Tools Keybind Manager",a_comprehensive_web_based_tool_for_creating_editing_and_managing_star_trek_online_keybind_configurations_with_visual_editing_and_advanced_features:"Una herramienta web integral para crear, editar y gestionar configuraciones de atajos de teclado de Star Trek Online con edición visual y características avanzadas.",features:"Características:",visual_keybind_editor:"Editor visual de atajos de teclado",sto_command_library_with_search_and_categorization:"Biblioteca de comandos STO con búsqueda y categorización",multiple_profile_management_create_clone_rename_delete:"Gestión de múltiples perfiles (crear, clonar, renombrar, eliminar)",custom_alias_system_for_complex_command_sequences:"Sistema de alias personalizado para secuencias de comandos complejas",vertigo_inspired_vfx_manager_for_visual_effects_control:"Gestor VFX inspirado en VERTIGO para control de efectos visuales",import_export_keybind_and_alias_files_and_project_backups:"Importar/exportar archivos de atajos y alias, y respaldos de proyecto",real_time_validation_and_command_preview:"Validación en tiempo real y vista previa de comandos",quick_start:"Inicio rápido:",create_a_new_profile_or_use_the_default_profile:"Crea un nuevo perfil o usa el perfil predeterminado",select_keys_from_the_grid_and_add_commands_from_the_library:"Selecciona teclas de la cuadrícula y agrega comandos desde la biblioteca",use_the_command_chain_editor_to_build_complex_sequences:"Usa el editor de cadenas de comandos para construir secuencias complejas",export_your_keybinds_as_txt_files_for_use_in_sto:"Exporta tus atajos como archivos .txt para usar en STO",resources:"Recursos:",copyright:"© 2025 STO Tools. Todos los derechos reservados.",got_it:"¡Entendido!",file_explorer:"Explorador de archivos",select_an_item_on_the_left_to_preview_export:"Selecciona un elemento a la izquierda para previsualizar exportación",close:"Cerrar",select_export_format:"Seleccionar formato de exportación",export_as:"Exportar como:",sto_keybind_file_txt:"Archivo de atajos STO (.txt)",json_profile_json:"Perfil JSON (.json)",complete_project_json:"Proyecto completo (.json)",csv_data_csv:"Datos CSV (.csv)",html_report_html:"Reporte HTML (.html)",alias_file_txt:"Archivo de alias (.txt)",environment:"Entorno:",export:"Exportar",filter_keys:"Filtrar teclas...",search_commands:"Buscar comandos...",e_g_f5_ctrl_a_shift_1:"ej. F5, Ctrl+A, Mayús+1",enter_profile_name:"Ingresa nombre del perfil",describe_this_keybind_profile:"Describe este perfil de atajos de teclado",myalias:"MiAlias",brief_description_of_what_this_alias_does:"Breve descripción de lo que hace este alias",enter_command_sequence_use_to_separate_commands:"Ingresa secuencia de comandos (usa $$ para separar comandos)",search_keys:"Buscar teclas...",open_project_json:"Abrir JSON del proyecto",save_project_json:"Guardar JSON del proyecto",keybind_operations:"Operaciones de atajos",alias_operations:"Operaciones de alias",settings:"Configuración",select_profile:"Seleccionar perfil",new_profile:"Nuevo perfil",clone_profile:"Clonar perfil",rename_profile:"Renombrar perfil",delete_profile:"Eliminar perfil",space_mode:"Modo espacio",ground_mode:"Modo suelo",unsaved_changes:"Cambios no guardados",validation_status:"Estado de validación",bound_keys:"Teclas vinculadas",toggle_between_grid_and_categorized_view:"Alternar entre vista de cuadrícula y categorizada",ensures_consistent_execution_order_by_mirroring_commands_phase_1_left_to_right_phase_2_right_to_left:"Asegura orden de ejecución consistente reflejando comandos (Fase 1: izquierda a derecha, Fase 2: derecha a izquierda)",validate_command_chain:"Validar cadena de comandos",clear_all_commands:"Limpiar todos los comandos",copy_to_clipboard:"Copiar al portapapeles",collapse_expand:"Contraer/Expandir",insert_target_variable:"Insertar variable $Target",sto_keybind_report:"Reporte de atajos STO",mode:"Modo:",generated:"Generado:",created_by:"Creado por:",statistics:"Estadísticas",keys_bound:"Teclas vinculadas:",total_commands:"Total de comandos:",aliases_defined:"Alias definidos:",no_keybinds_defined:"No hay atajos de teclado definidos.",command_aliases:"Alias de comandos",vfx_aliases:"Alias VFX",create_command_aliases:"Crear Alias de Comandos",select_bridge_officer_command:{name:"Seleccionar comando de oficial de puente",description:"Selecciona un comando de oficial de puente"},report_footer:"Este reporte fue generado por STO Tools Keybind Manager. Para más información sobre atajos de teclado de Star Trek Online, visita el Wiki de STO.",command_categories:{targeting:"Apuntado",combat:"Combate",cosmetic:"Cosmético",bridge_officer:"Oficial de Puente",tray:"Ejecución de Bandeja",power:"Gestión de Escudos",movement:"Movimiento",camera:"Cámara",communication:"Comunicación",system:"Sistema"},command_definitions:{target:{name:"Apuntar por nombre",description:"Apuntar entidad por nombre (requiere comillas)"},target_enemy_near:{name:"Apuntar enemigo más cercano",description:"Apuntar al enemigo más cercano visible"},target_friend_near:{name:"Apuntar aliado más cercano",description:"Apuntar a la entidad aliada más cercana"},target_self:{name:"Apuntarse a sí mismo",description:"Apuntar a tu propia nave/personaje"},target_clear:{name:"Limpiar objetivo",description:"Eliminar el bloqueo de objetivo actual"},target_teammate_1:{name:"Apuntar compañero 1",description:"Apuntar al primer miembro del equipo"},target_teammate_2:{name:"Apuntar compañero 2",description:"Apuntar al segundo miembro del equipo"},target_teammate_3:{name:"Apuntar compañero 3",description:"Apuntar al tercer miembro del equipo"},target_teammate_4:{name:"Apuntar compañero 4",description:"Apuntar al cuarto miembro del equipo"},fire_all:{name:"Disparar todas las armas",description:"Disparar todas las armas"},fire_phasers:{name:"Disparar armas de energía",description:"Disparar todas las armas de energía"},fire_torps:{name:"Disparar torpedos",description:"Disparar todos los torpedos"},fire_mines:{name:"Disparar minas",description:"Disparar todas las minas"},fire_phasers_torps:{name:"Disparar phasers y torpedos",description:"Disparar phasers y torpedos"},fire_projectiles:{name:"Disparar Proyectiles",description:"Disparar torpedos y minas"},setactivecostume:{name:"Establecer Disfraz Activo",description:"Establece el disfraz activo actual. Requiere dos modificadores."},custom_tray:{name:"Ejecución de bandeja",description:"Ejecutar ranura específica de bandeja"},tray_with_backup:{name:"Ejecución de bandeja con respaldo",description:"Ejecutar ranura específica de bandeja con habilidad de respaldo"},tray_range:{name:"Ejecución de rango de bandeja",description:"Ejecutar un rango de ranuras de bandeja"},tray_range_with_backup:{name:"Rango de bandeja con respaldo",description:"Ejecutar un rango de ranuras de bandeja con habilidades de respaldo"},whole_tray:{name:"Ejecución de bandeja completa",description:"Ejecutar todas las ranuras de una bandeja"},whole_tray_with_backup:{name:"Bandeja completa con respaldo",description:"Ejecutar todas las ranuras de una bandeja con bandeja de respaldo"},distribute_shields:{name:"Distribuir escudos",description:"Distribuye uniformemente los escudos como si hicieras clic en el medio del ícono de nave y escudos"},reroute_shields_rear:{name:"Redirigir escudos traseros",description:"Redirigir energía de escudos hacia atrás"},reroute_shields_left:{name:"Redirigir escudos izquierdos",description:"Redirigir energía de escudos hacia la izquierda"},reroute_shields_right:{name:"Redirigir escudos derechos",description:"Redirigir energía de escudos hacia la derecha"},reroute_shields_forward:{name:"Redirigir escudos delanteros",description:"Redirigir energía de escudos hacia adelante"},full_impulse:{name:"Impulso completo",description:"Activar motor de impulso completo"},reverse:{name:"Reversa",description:"Motores en reversa"},throttle_adjust:{name:"Ajustar acelerador",description:"Aumentar o disminuir el acelerador por cantidad"},throttle_set:{name:"Establecer acelerador",description:"Establecer el acelerador a una posición específica (negativo = reversa, 0 = parar)"},throttle_toggle:{name:"Alternar acelerador",description:"Alternar entre acelerador completo y parada completa"},turn_left:{name:"Girar izquierda",description:"Girar nave a la izquierda (continuo mientras se mantiene)"},turn_right:{name:"Girar derecha",description:"Girar nave a la derecha (continuo mientras se mantiene)"},pitch_up:{name:"Cabecear arriba",description:"Cabecear nariz de nave hacia arriba (cambio de altitud espacial)"},pitch_down:{name:"Cabecear abajo",description:"Cabecear nariz de nave hacia abajo (cambio de altitud espacial)"},strafe_left:{name:"Desplazamiento lateral izquierdo",description:"Desplazar nave lateralmente a la izquierda"},strafe_right:{name:"Desplazamiento lateral derecho",description:"Desplazar nave lateralmente a la derecha"},forward:{name:"Adelante",description:"Moverse adelante"},backward:{name:"Atrás",description:"Moverse atrás"},auto_forward:{name:"Avance automático",description:"El personaje se mueve adelante hasta que se den nuevos comandos de movimiento"},follow:{name:"Seguir objetivo",description:"Seguir a la entidad objetivo"},follow_cancel:{name:"Cancelar seguimiento",description:"Dejar de seguir y olvidar el objetivo"},zoom_in:{name:"Acercar zoom",description:"Acercar la cámara"},zoom_out:{name:"Alejar zoom",description:"Alejar la cámara"},zoom_in_small:{name:"Acercar zoom ligeramente",description:"Acercar la cámara ligeramente"},zoom_out_small:{name:"Alejar zoom ligeramente",description:"Alejar la cámara ligeramente"},cam_distance:{name:"Establecer distancia de cámara",description:"Establecer la distancia de la cámara del jugador"},cam_reset:{name:"Reiniciar cámara",description:"Reiniciar la posición de la cámara por defecto"},cam_target_lock:{name:"Bloquear cámara al objetivo",description:"Bloquear o desbloquear la cámara al objetivo"},cam_cycle_distance:{name:"Alternar distancia de cámara",description:"Alternar la distancia de la cámara entre varios valores preestablecidos"},cam_mouse_look:{name:"Vista de ratón",description:"Activar control de cámara con vista de ratón"},cam_turn_to_face:{name:"Girar hacia la cámara",description:"Girar nave para mirar hacia la dirección de la cámara"},look_up:{name:"Mirar arriba",description:"Cambiar punto de vista para mirar directamente arriba"},look_down:{name:"Mirar abajo",description:"Cambiar punto de vista para mirar directamente abajo"},team_message:{name:"Mensaje de equipo",description:"Enviar mensaje al equipo"},local_message:{name:"Mensaje local",description:"Enviar mensaje al área local"},zone_message:{name:"Mensaje de zona",description:"Enviar mensaje a la zona"},toggle_hud:{name:"Alternar HUD",description:"Alternar visibilidad del HUD"},screenshot:{name:"Captura de pantalla",description:"Tomar una captura de pantalla"},screenshot_jpg:{name:"Captura de pantalla JPG",description:"Guardar una captura de pantalla como JPG"},autofire_toggle:{name:"Alternar disparo automático",description:"Alternar disparo automático de armas"},bind_save_file:{name:"Guardar atajos a archivo",description:"Guardar todos tus atajos en un archivo de texto"},bind_load_file:{name:"Cargar atajos desde archivo",description:"Cargar un archivo de atajos en el cliente"},combat_log:{name:"Alternar registro de combate",description:"Activar/desactivar grabación del registro de combate (1=activado, 0=desactivado)"},missions:{name:"Mostrar/Ocultar misiones",description:"Mostrar/ocultar el diario de misiones"},inventory:{name:"Mostrar/Ocultar inventario",description:"Mostrar/ocultar tu inventario"},map:{name:"Mostrar/Ocultar mapa",description:"Mostrar/ocultar la ventana del mapa"},logout:{name:"Cerrar sesión",description:"Cerrar sesión del personaje actual."},quit:{name:"Salir del juego",description:"Cerrar la ventana."},ui_load:{name:"Cargar configuración de UI",description:"Carga el archivo de guardado predeterminado de ventanas de UI, generalmente Live\\ui_settings.txt"},ui_save:{name:"Guardar configuración de UI",description:"Guarda el diseño de UI en el archivo de guardado predeterminado de ventanas de UI, generalmente Live\\ui_settings.txt"},ui_load_file:{name:"Cargar archivo de configuración de UI",description:"Carga archivo de guardado de ventanas de UI con nombre"},ui_save_file:{name:"Guardar archivo de configuración de UI",description:"Guarda el diseño de UI en archivo de guardado de ventanas de UI con nombre"},ui_cancel:{name:"UI Cancelar",description:'Responde "Cancelar" a un cuadro de diálogo abierto; puede no funcionar en todos los diálogos.'},ui_ok:{name:"UI OK",description:'Responde "OK" a un cuadro de diálogo abierto; puede no funcionar en todos los diálogos.'},chat_log:{name:"Alternar registro de chat",description:"Activar/desactivar registro de chat. 1=activado, 0=desactivado, sin parámetro=imprimir estado. Anteponer ++ lo convierte en alternador"},remember_ui_lists:{name:"Recordar listas de UI",description:"Si se deben recordar la colocación y ancho de columnas de listas de UI."},ui_remember_positions:{name:"Recordar posiciones de UI",description:"Si se deben recordar tamaños y posiciones de UI. Activado por defecto."},safe_login:{name:"Inicio de sesión seguro",description:"Si es verdadero, entonces inicia sesión al jugador en su mapa estático más reciente en lugar de cualquier otra cosa."},goto_character_select:{name:"Ir a selección de personaje",description:"Ir a la pantalla de selección de personaje sin cerrar sesión."},ui_gen_layers_reset:{name:"Restablecer diseño de UI",description:"Restablece el diseño, usado cuando el servidor actualiza posiciones de ventanas movibles"},ui_resolution:{name:"Imprimir resolución de UI",description:"Imprime la resolución de pantalla de UI actual."},ui_tooltip_delay:{name:"Establecer retraso de tooltip",description:"Establece el retraso adicional, en segundos, antes de que aparezcan los tooltips"},show_game_ui:{name:"Mostrar UI del juego",description:"Mostrar la UI del juego"},show_game_ui_no_extra_keybinds:{name:"Mostrar UI del juego (sin keybinds extra)",description:"Este comando no agrega ningún keybind para mostrar la UI cuando el usuario presiona escape"},change_instance:{name:"Cambiar instancia",description:"Cambiar a una instancia ya creada del mismo mapa. Solo funciona cuando no está en alerta roja."},aim:{name:"Apuntar/Mira",description:"Activar/desactivar mira. En modo mira el jugador hace más daño. Puede usarse como alternador o presionar y mantener"},holster:{name:"Enfundar arma",description:"Intentar enfundar tu arma activa"},holster_toggle:{name:"Alternar enfundar arma",description:"Intentar enfundar o desenfundar tus armas"},unholster:{name:"Desenfundar arma",description:"Intentar desenfundar tu arma activa"},toggle_shooter_mode:{name:"Alternar modo tirador",description:"Activar/desactivar modo tirador"},shooter_primary:{name:"Tirador primario",description:"Acción primaria del modo tirador"},shooter_secondary:{name:"Tirador secundario",description:"Acción secundaria del modo tirador"},shooter_tertiary:{name:"Tirador terciario",description:"Acción terciaria del modo tirador"},shooter_clear_offset_tray_binds:{name:"Limpiar enlaces de bandeja de compensación del tirador",description:"Limpiar la ubicación inicial y movimiento de la caja de acción amarilla que aparece en la bandeja en modo tirador"},shooter_clear_overlay_tray_binds:{name:"Limpiar enlaces de bandeja superpuesta del tirador",description:"Limpiar enlaces de bandeja superpuesta para modo tirador"},shooter_set_offset_tray_binds:{name:"Establecer enlaces de bandeja de compensación del tirador",description:"Establecer la ubicación inicial y movimiento de la caja de acción amarilla que aparece en la bandeja en modo tirador"},shooter_set_overlay_tray_binds:{name:"Establecer enlaces de bandeja superpuesta del tirador",description:"Establecer enlaces de bandeja superpuesta para modo tirador"},setrallypoint:{name:"Establecer Punto de Encuentro",description:"Establece un punto de encuentro para tu objetivo actual"},setrallypointconsole:{name:"Establecer Punto de Encuentro (Consola)",description:"Establece un punto de encuentro para tu objetivo actual (variante consola)"},clearrallypoint:{name:"Borrar Punto de Encuentro",description:"Borra el punto de encuentro para tu objetivo actual"},clearallrallypoints:{name:"Borrar Todos los Puntos de Encuentro",description:"Borra todos los puntos de encuentro"},assist:{name:"Asistir",description:"Asistir '<name>': Asiste a la entidad con el nombre coincidente. Si no se da un nombre, asiste a tu objetivo actual."},net_timing_graph:{name:"Gráfico de Tiempo de Red",description:"Activar o desactivar el gráfico de tiempo de red (0=desactivar, 1=activar)"},net_timing_graph_alpha:{name:"Gráfico de Tiempo de Red Alpha",description:"Establecer nivel de transparencia para el gráfico de tiempo de red (50=mayor transparencia, 255=sin transparencia)"},net_timing_graph_paused:{name:"Gráfico de Tiempo de Red Pausado",description:"Pausar o reanudar el gráfico de tiempo de red (0=pausa desactivada, 1=pausa activada)"},netgraph:{name:"Gráfico de Red",description:"Mostrar datos de red SND y RCV como texto (1=activado, 0=desactivado)"},entity_name_optional:"Nombre de entidad (opcional)",entity_name_optional_placeholder:"Introduce el nombre de la entidad (opcional)",bridge_officer_command:{name:"Comando de Oficial de Puente",description:"Ejecuta una orden de oficial de puente"},select_bridge_officer_command:{name:"Seleccionar comando de oficial de puente",description:"Selecciona un comando de oficial de puente"}},category_descriptions:{targeting:"Selección y gestión de objetivos",combat:"Disparo de armas y acciones de combate",tray:"Ejecutar habilidades desde bandejas de acción",power:"Gestión de energía y distribución de escudos",movement:"Movimiento y navegación de nave",camera:"Control de cámara y gestión de vista",communication:"Chat y comunicación de equipo",system:"Comandos de UI y sistema"},no_aliases:"Sin alias",no_aliases_defined:"Sin alias definidos",create_alias_to_get_started:"Crea un alias para comenzar",create_aliases_hint:"Crea alias de comandos para simplificar secuencias de comandos complejas.",alias_deleted:'Alias "{{alias}}" eliminado',please_select_a_key_first:"Por favor selecciona una tecla primero",alias_added_to_key:'Alias "{{alias}}" agregado a {{key}}',no_active_profile:"Sin perfil activo",alias_exists:"Ya existe un alias con este nombre",alias_template_exists:'El alias "{{alias}}" ya existe',alias_created_from_template:'Alias "{{alias}}" creado desde plantilla',template_not_found:"Plantilla no encontrada",alias_not_found:"Alias no encontrado",alias_created:'Alias "{{alias}}" creado',alias_updated:'Alias "{{alias}}" actualizado',no_profile_selected_for_import:"Ningún perfil seleccionado para importar",no_keybinds_found_in_file:"No se encontraron atajos en el archivo",import_failed:"Importación falló: {{error}}",no_aliases_found_in_file:"No se encontraron alias en el archivo",failed_to_get_profile_for_import:"Falló al obtener perfil para importar",import_completed_keybinds:"Importación completada: {{count}} atajos",import_completed_keybinds_with_aliases:"Importación completada: {{keyCount}} atajos ({{aliasCount}} alias ignorados - usa Importar Alias)",import_completed_aliases:"Importación completada: {{count}} alias",no_profile_selected_to_export:"Ningún perfil seleccionado para exportar",keybind_file_exported:"Archivo de atajos exportado exitosamente",failed_to_export_keybind_file:"Falló al exportar archivo de atajos: {{error}}",profile_exported_json:"Perfil exportado como JSON",failed_to_export_profile:"Falló al exportar perfil: {{error}}",complete_project_exported:"Proyecto completo exportado",failed_to_export_project:"Falló al exportar proyecto: {{error}}",data_exported_csv:"Datos exportados como CSV",failed_to_export_csv:"Falló al exportar CSV: {{error}}",html_report_exported:"Reporte HTML exportado",failed_to_export_html_report:"Falló al exportar reporte HTML: {{error}}",no_command_to_copy:"Ningún comando para copiar",no_profiles_to_export:"Ningún perfil para exportar",exporting_profiles:"Exportando {{count}} perfiles...",aliases_exported_successfully:"Alias exportados exitosamente",failed_to_export_aliases:"Falló al exportar alias: {{error}}",sync_folder_set:"Carpeta de sincronización seleccionada",failed_to_set_sync_folder:"Falló al seleccionar carpeta de sincronización: {{error}}",no_sync_folder_selected:"Ninguna carpeta de sincronización seleccionada",project_synced_successfully:"Proyecto sincronizado exitosamente",permission_denied_to_folder:"Permiso denegado para escribir en la carpeta",failed_to_sync_project:"Falló al sincronizar proyecto: {{error}}",general:"General",synchronization:"Sincronización",appearance:"Apariencia",advanced:"Avanzado",general_settings:"Configuración general",synchronization_settings:"Configuración de sincronización",appearance_settings:"Configuración de apariencia",language_settings:"Configuración de idioma",advanced_settings:"Configuración avanzada",auto_save:"Guardado automático",auto_save_description:"Guardar automáticamente los cambios mientras trabajas",validation_mode:"Modo de validación",validation_mode_description:"Qué tan estrictamente validar comandos y atajos",strict:"Estricto",lenient:"Permisivo",disabled:"Deshabilitado",sync_folder_description:"Elige una carpeta para sincronizar automáticamente tus proyectos",auto_sync:"Sincronización automática",auto_sync_description:"Sincronizar automáticamente los cambios con la carpeta seleccionada",auto_sync_interval:"Intervalo de sincronización automática",auto_sync_interval_description:"Con qué frecuencia sincronizar automáticamente sus cambios",after_every_change:"Después de cada cambio",every_1_minute:"Cada minuto",every_2_minutes:"Cada 2 minutos",every_5_minutes:"Cada 5 minutos",auto_sync_completed:"Sincronización automática completada",selected_folder:"Carpeta seleccionada",theme:"Tema",theme_description:"Elige entre temas claro y oscuro",light_theme:"Claro",dark_theme:"Oscuro",compact_mode:"Modo compacto",compact_mode_description:"Usar un diseño de interfaz más compacto",interface_language:"Idioma de la interfaz",language_description:"Elige el idioma para la interfaz",debug_mode:"Modo de depuración",debug_mode_description:"Habilitar registro de depuración y herramientas de desarrollador",backup_interval:"Intervalo de respaldo",backup_interval_description:"Con qué frecuencia respaldar automáticamente tu trabajo",every_15_minutes:"Cada 15 minutos",every_30_minutes:"Cada 30 minutos",every_hour:"Cada hora",preferences_saved:"Preferencias guardadas exitosamente",failed_to_save_preferences:"Falló al guardar las preferencias",vfx_manager_description:"Selecciona efectos visuales para desactivar usando alias de dynFxSetFXExlusionList. Los efectos están organizados por entorno.",app_description:"Una herramienta integral basada en web para crear, editar y gestionar configuraciones de atajos de Star Trek Online con edición visual y características avanzadas.",csv_header:"Tecla,Comando,Tipo,Descripción,Posición",default_export_filename:"export.txt",select_a_space_ground_build_or_aliases_to_preview_export:"Selecciona una construcción de Espacio/Tierra o Alias para previsualizar la exportación.",alias_mode:"Modo de alias",alias_options:"Opciones de alias",create:"Crear",create_new_alias:"Crear nuevo alias",cycle_type:"Tipo de ciclo",filter_aliases:"Filtrar alias",select_an_alias_to_edit:"Selecciona un alias para editar",select_an_alias_to_see_the_generated_command:"Selecciona un alias para ver el comando generado",select_options:"Seleccionar opciones",toggle_type:"Tipo de alternancia",no_alias_selected:"Ningún alias seleccionado",select_alias_from_left_panel:"Selecciona un alias del panel izquierdo para ver y editar su cadena de comandos.",select_key_from_left_panel:"Selecciona una tecla del panel izquierdo para ver y editar su cadena de comandos.",validation_error:"Error de validación",failed_to_load_application:"No se pudo cargar la aplicación",profile_created:'Perfil "{{name}}" creado',failed_to_create_profile:"No se pudo crear el perfil",failed_to_clone_profile:"No se pudo clonar el perfil",cannot_delete_the_last_profile:"No se puede eliminar el último perfil",profile_deleted:'Perfil "{{profileName}}" eliminado',failed_to_delete_profile:"No se pudo eliminar el perfil",invalid_key_name:"Nombre de tecla inválido",key_added:'Tecla "{{keyName}}" agregada',key_already_exists:'La tecla "{{keyName}}" ya existe',key_deleted:'Tecla "{{keyName}}" eliminada',command_added_to_alias:"Comando agregado al alias",commands_added:"{{count}} comandos agregados",command_added:"Comando agregado",command_deleted_from_alias:"Comando eliminado del alias",command_deleted:"Comando eliminado",switched_to_mode:"Cambiado a modo {{mode}}",alias_already_exists:'El alias "{{name}}" ya existe',commands_cleared_for_key:"Comandos limpiados para {{keyName}}",project_loaded_successfully:"Proyecto cargado exitosamente",failed_to_load_project_file:"No se pudo cargar el archivo del proyecto",invalid_project_file:"Archivo de proyecto inválido",project_exported_successfully:"Proyecto exportado exitosamente",no_commands_to_duplicate:"No hay comandos para duplicar",key_duplicated:'Tecla "{{keyName}}" duplicada como "{{newKeyName}}"',template_system_coming_soon:"Sistema de plantillas próximamente",no_commands_to_validate:"No hay comandos para validar",command_chain_is_valid:"Cadena de comandos es válida",please_configure_a_command:"Por favor configura un comando",command_updated_successfully:"Comando actualizado exitosamente",error_message:"Error: {{error}}",failed_to_select_all_space_effects:"No se pudieron seleccionar todos los efectos de espacio",failed_to_select_all_ground_effects:"No se pudieron seleccionar todos los efectos de suelo",space_preview_error:"Error de vista previa de espacio: {{error}}",ground_preview_error:"Error de vista previa de suelo: {{error}}",space_alias_error:"Error de alias de espacio: {{error}}",failed_to_generate_space_alias:"No se pudo generar el alias de espacio",ground_alias_error:"Error de alias de suelo: {{error}}",failed_to_generate_ground_alias:"No se pudo generar el alias de suelo",no_profile_selected:"Ningún perfil seleccionado",no_profile_found:"No se encontró el perfil",switched_to_theme:"Cambiado a {{themeName}}",language_updated:"Idioma actualizado",auto_sync_failed:"Auto-sincronización falló: {{error}}",nothing_to_copy:"Nada que copiar",content_copied_to_clipboard:"Contenido copiado al portapapeles",failed_to_generate_export:"No se pudo generar la exportación",no_profile_selected_to_clone:"Ningún perfil seleccionado para clonar",no_profile_selected_to_rename:"Ningún perfil seleccionado para renombrar",profile_name_is_required:"El nombre del perfil es requerido",profile_name_too_long:"El nombre del perfil es muy largo (máx. 50 caracteres)",profile_name_already_exists:"Ya existe un perfil con este nombre",failed_to_save_profile:"No se pudo guardar el perfil: {{error}}",no_profile_selected_to_delete:"Ningún perfil seleccionado para eliminar",no_keybinds_to_export:"No hay atajos para exportar",no_aliases_to_export:"No hay alias para exportar",failed_to_reset_application:"No se pudo restablecer la aplicación: {{error}}",default_demo_data_loaded:"Datos de demostración predeterminados cargados exitosamente",failed_to_load_default_data:"No se pudieron cargar los datos predeterminados",failed_to_load_default_data_with_error:"No se pudieron cargar los datos predeterminados: {{error}}",failed_to_create_profile_from_template:"No se pudo crear el perfil desde la plantilla",profile_exported:'Perfil "{{profileName}}" exportado',failed_to_import_profile:"No se pudo importar el perfil: {{error}}",application_reset_successfully:"Aplicación restablecida exitosamente",clear_commands:"Limpiar comandos",command_info:"Comando: {{command}}\nTipo: {{type}}",commands_updated_successfully:"{{count}} comandos actualizados exitosamente",confirm_clear_commands:'¿Estás seguro de que quieres limpiar todos los comandos para "{{keyName}}"?',confirm_delete_alias:'¿Estás seguro de que quieres eliminar el alias "{{aliasName}}"?',confirm_delete_key:'¿Estás seguro de que quieres eliminar la tecla "{{keyName}}" y todos sus comandos?',confirm_delete_profile:'¿Estás seguro de que quieres eliminar el perfil "{{profileName}}"?\n\nEsta acción no se puede deshacer.',confirm_reset_application:"¿Estás seguro de que quieres restablecer la aplicación?\n\nEsto eliminará todos los perfiles, atajos y configuraciones. Esta acción no se puede deshacer.",delete_alias:"Eliminar alias",delete_key:"Eliminar tecla",failed_to_copy_to_clipboard:"Falló al copiar al portapapeles",failed_to_import_aliases_generic:"No se pudieron importar los alias: {{error}}",failed_to_import_keybind_file:"No se pudo importar el archivo de atajos: {{error}}",failed_to_import_keybind_file_generic:"No se pudo importar el archivo de atajos: {{error}}",generated_vertigo_aliases:"¡{{count}} alias de Vertigo generado{{plural}}! Revisa la lista de alias.",keybinds_exported_successfully:"Atajos de {{environment}} exportados exitosamente",no_effects_selected:"No hay efectos seleccionados. Por favor selecciona al menos un efecto para generar alias.",profile_created_from:'Perfil "{{newName}}" creado desde "{{sourceProfile}}"',profile_created_from_current:'Perfil "{{name}}" creado desde el perfil actual "{{currentProfile}}"',profile_created_from_template_generic:'Perfil "{{profileName}}" creado desde plantilla',profile_imported_successfully:'Perfil "{{profileName}}" importado exitosamente',profile_renamed:'Perfil renombrado de "{{oldName}}" a "{{name}}"',sto_tools_keybind_manager_loaded_successfully:"STO Tools Keybind Manager cargado exitosamente",switched_to_profile:"Cambiado al perfil: {{name}} ({{environment}})",yes:"Sí",no:"No",active:"Activo",inactive:"Inactivo",active_state:"Estado Activo",no_aliases_available:"No hay alias disponibles",no_commands:"No hay comandos",profile_not_found:"Perfil no encontrado",click_add_command_to_start_building_your_command_chain:"Haga clic en 'Agregar Comando' para comenzar a construir su cadena de comandos para",click_add_command_to_start_building_your_alias_chain:"Haga clic en 'Agregar Comando' para comenzar a construir su cadena de alias para",create_aliases_in_the_alias_manager_first:"Cree alias en el Administrador de Alias primero",enter_sto_command:"Ingrese comando STO",enter_the_exact_sto_command_syntax:"Ingrese la sintaxis exacta del comando STO",enter_your_message:"Ingrese su mensaje",maximum_100_characters:"Máximo 100 caracteres",replaced_with_your_current_targets_name:"Reemplazado con el nombre de su objetivo actual",this_alias_will_automatically_toggle_between_its_onoff_states_when_executed:"Este alias cambiará automáticamente entre sus estados encendido/apagado cuando se ejecute",select_an_alias:"Seleccionar un alias",select_targeting_command:"Seleccionar comando de objetivo",select_combat_command:"Seleccionar comando de combate",select_shield_command:"Seleccionar comando de escudo",select_movement_command:"Seleccionar comando de movimiento",select_camera_command:"Seleccionar comando de cámara",select_system_command:"Seleccionar comando de sistema",select_communication_type:"Seleccionar tipo de comunicación",create_alias:"Crear Alias",alias_commands:"Comandos de Alias",available_aliases:"Alias Disponibles",common_commands:"Comandos Comunes",sto_variables:"Variables STO",example:"Ejemplo",message:"Mensaje",display_text:"Texto de Visualización",descriptive_name_for_this_command:"Nombre descriptivo para este comando",filename:"Nombre de archivo",position:"Posición",distance:"Distancia",amount:"Cantidad",state:"Estado",command:"Comando",command_variant:"Variante de Comando",communication_type:"Tipo de Comunicación",combat_command:"Comando de Combate",movement_command:"Comando de Movimiento",camera_command:"Comando de Cámara",shield_command:"Comando de Escudo",system_command:"Comando de Sistema",targeting_command:"Comando de Objetivo",tray_number:"Número de Bandeja",slot_number:"Número de Ranura",start_tray:"Bandeja de Inicio",end_tray:"Bandeja Final",start_slot:"Ranura de Inicio",end_slot:"Ranura Final",backup_tray:"Bandeja de Respaldo",backup_slot:"Ranura de Respaldo",backup_start_tray:"Bandeja de Inicio de Respaldo",backup_end_tray:"Bandeja Final de Respaldo",backup_start_slot:"Ranura de Inicio de Respaldo",backup_end_slot:"Ranura Final de Respaldo",backup_configuration:"Configuración de Respaldo",range_configuration:"Configuración de Rango",backup_range_configuration:"Configuración de Rango de Respaldo",single_tray_slot:"Ranura de Bandeja Única",single_tray_with_backup:"Bandeja Única con Respaldo",tray_range:"Rango de Bandeja",tray_range_with_backup:"Rango de Bandeja con Respaldo",whole_tray:"Bandeja Completa",whole_tray_with_backup:"Bandeja Completa con Respaldo",configure_command_options_to_see_preview:"Configure las opciones del comando para ver la vista previa",key:"tecla",no_profile:"Sin perfil",stotrayexecbytray_description:"STOTrayExecByTray (muestra el enlace de tecla en la UI)",trayexecbytray_description:"TrayExecByTray (sin indicación de UI)",parameter_configuration:"Configuración de parámetros",modifier_1:"Modificador 1",modifier_2:"Modificador 2",first_modifier:"Primer modificador",second_modifier:"Segundo modificador",cosmetic_command:"Comando Cosmético",select_cosmetic_command:"Selecciona un comando cosmético",tray_command:"Comando de Bandeja",on:"Activado",off:"Desactivado",delay_seconds:"Retraso (segundos)",bridge_officer:"Oficial de Puente",net_graph:"Gráfico de Red",net_graph_command:"Comando de Gráfico de Red",select_net_graph_command:"Selecciona un comando de gráfico de red",net_timing_graph:"Gráfico de Tiempo de Red",net_timing_graph_alpha:"Gráfico de Tiempo de Red Alpha",net_timing_graph_paused:"Gráfico de Tiempo de Red Pausado",netgraph:"Gráfico de Red",enable_disable:"Activar/Desactivar",transparency_level:"Nivel de Transparencia",pause_state:"Estado de Pausa",delete_selected_key:"Eliminar tecla seleccionada",duplicate_selected_key:"Duplicar tecla seleccionada",show_all_keys:"Mostrar todas las teclas",duplicate:"Duplicar",invalid_alias_name:"Nombre de alias inválido",reserved_command_name:"El nombre entra en conflicto con un comando STO",backup_created_successfully:"Copia de seguridad de la aplicación creada exitosamente",failed_to_create_backup:"Falló al crear copia de seguridad: {{error}}",backup_restored_successfully:"Estado de la aplicación restaurado exitosamente",failed_to_restore_backup:"Falló al restaurar copia de seguridad: {{error}}",import_from_key_or_alias:"Importar desde Tecla o Alias",select_source_to_import_from:"Seleccionar fuente para importar:",clear_destination_chain_prior_to_import:"Limpiar cadena de destino antes de importar",no_sources_available:"No hay fuentes disponibles",error_loading_sources:"Error cargando fuentes",please_select_a_source:"Por favor selecciona una fuente",source_has_no_commands:"La fuente no tiene comandos para importar",commands_imported_successfully:"{{count}} comandos importados desde {{source}}",cross_environment_import_warning:"Advertencia: {{dropped}} comandos específicos de {{sourceEnv}} fueron descartados al importar a {{targetEnv}}",no_compatible_commands_to_import:"No hay comandos compatibles para importar después del filtrado",alias_command:"Comando de Alias",enter_alias_name:"Ingresar nombre de alias",numpad:"Teclado numérico",failed_to_load_profile_data:"Error al cargar datos del perfil",no_profile_to_save:"No hay perfil para guardar",profile_saved:"Perfil guardado",data_saved:"Datos guardados",failed_to_save_data:"Error al guardar datos",failed_to_save_current_profile:"Error al guardar el perfil actual",already_on_profile:"Ya está en este perfil",source_profile_not_found:"Perfil fuente no encontrado",no_profile_or_build_data:"No hay datos de perfil o construcción",profile_name_required:"Se requiere nombre de perfil",confirm_reset_app:"¿Está seguro de que desea restablecer la aplicación? Esto eliminará todos los perfiles y datos. Esta acción no se puede deshacer.",switch_to_key_type_view:"Cambiar a vista de tipo de tecla",switch_to_grid_view:"Cambiar a vista de cuadrícula",switch_to_command_categories:"Cambiar a categorías de comandos",no_profiles_available:"No hay perfiles disponibles",verb:{say:"Decir (Local)",team:"Equipo",zone:"Zona",tell:"Susurrar"},duplicate_alias:"Duplicar Alias",enter_new_alias_name:"Ingresar nuevo nombre de alias",alias_name_in_use:"El nombre del alias ya existe",failed_to_export_profiles:"Error al exportar perfiles: {{error}}",failed_to_rename_profile:"Error al renombrar perfil: {{error}}",failed_to_save_file:"Error al guardar archivo: {{error}}",file_saved_successfully:"Archivo guardado exitosamente",ground_build:"Construcción Terrestre",html_report_title:"Reporte de Atajos STO",import_failed_invalid_format:"Importación falló: Formato de archivo inválido",import_failed_invalid_json:"Importación falló: Formato JSON inválido",no_content_available:"No hay contenido disponible",no_valid_profile:"No hay perfil válido disponible",profile_already_exists:"El perfil ya existe",profile_id_required:"Se requiere ID de perfil",space_build:"Construcción Espacial",sync_completed:"Sincronización completada exitosamente",sync_failed:"Sincronización falló: {{error}}",syncing:"Sincronizando...",add_new_alias:"Agregar Nuevo Alias",delete_selected_alias:"Eliminar Alias Seleccionado",duplicate_selected_alias:"Duplicar Alias Seleccionado",search_aliases:"Buscar alias...",show_all_aliases:"Mostrar Todos los Alias",show_all_commands:"Mostrar Todos los Comandos",enter_key_name:"Ingresar nombre de tecla...",clear_filter:"Limpiar filtro",warning:"Advertencia",error:"Error",validation_details:"Detalles de validación",ok:"Aceptar",command_chain_near_limit:"La cadena de comandos es demasiado larga ({{length}} caracteres). Superar 999 puede fallar.",command_chain_too_long:"La cadena de comandos es demasiado larga ({{length}} caracteres) y puede fallar en el juego.",stabilized_non_tray_warning:"La ejecución estabilizada solo debe usarse con habilidades de ejecución de barra.",too_many_commands_on_key:"Asignar {{count}} comandos a una tecla puede fallar en el juego (máximo recomendado 20).",alias_mixed_environment_warning:"El alias contiene comandos exclusivos de espacio y de tierra; esto no se recomienda.",commands_with_internal_warnings:"{{list}}",spam_bar_warning:"No se recomienda en barras de spam ya que interfiere con los ciclos de disparo",press_any_key_combination:"Presione cualquier combinación de teclas...",capture_instructions:"Utiliza tu teclado o ratón, o cambia a modo manual para hacer clic en las teclas de abajo",switch_to_manual:"Cambiar a Manual",start_capture:"Iniciar captura",selected_key:"Tecla seleccionada",confirm_selection:"Confirmar selección",quick_suggestions:"Sugerencias rápidas",modifiers:"Modificadores",keyboard_layout:"Distribución de teclado",mouse_gestures:"Gestos de ratón",suggestion_common:"Teclas comunes",suggestion_movement:"Movimiento",suggestion_abilities:"Habilidades",suggestion_quickslots:"Accesos rápidos",suggestion_mouse:"Acciones de ratón",key_selection_failed:"Error al seleccionar la tecla"};function ae(){return`${Date.now()}_${Math.random().toString(36).slice(2,10)}`}function se(e=o,t,i,a=5e3){const s=ae(),n=`${t}::reply::${s}`;return new Promise((r,o)=>{const c=setTimeout(()=>{d(),o(new Error("Request timed out"))},a);function l(e){d(),e&&Object.prototype.hasOwnProperty.call(e,"error")?o(new Error(e.error)):r(e?e.data:void 0)}function d(){clearTimeout(c),e.off(n,l)}e.on(n,l),e.emit(`rpc:${t}`,{requestId:s,replyTopic:n,payload:i})})}function ne(e=o,t,i){async function a(t){if(!t)return;const{requestId:a,replyTopic:s,payload:n}=t;if(s)try{const t=await i(n);e.emit(s,{requestId:a,data:t})}catch(t){const i=t&&t.message?t.message:String(t);e.emit(s,{requestId:a,error:i})}}return e.on(`rpc:${t}`,a),()=>e.off(`rpc:${t}`,a)}var re=Object.freeze({__proto__:null,makeRequestId:ae,request:se,respond:ne});class oe{constructor(e=null){this.eventBus=e,this.initialized=!1,this.destroyed=!1,this.eventListeners=new Map,this.componentName=this.constructor.name}init(){this.initialized||(this.initialized=!0,this.destroyed=!1,this.addEventListener("component:register",this.i.bind(this)),this.o=`component:registered:reply:${this.getComponentName()}:${Date.now()}`,this.addEventListener(this.o,this.l.bind(this)),this.emit("component:register",{name:this.getComponentName(),replyTopic:this.o}),this.onInit())}destroy(){this.destroyed||(this.destroyed=!0,this.initialized=!1,this.cleanupEventListeners(),this.onDestroy())}onInit(){}onDestroy(){}addEventListener(e,t,i=null){this.eventBus&&(this.eventBus.on(e,t,i),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push({handler:t,context:i}))}removeEventListener(e,t){if(!this.eventBus)return;this.eventBus.off(e,t);const i=this.eventListeners.get(e);if(i){const e=i.findIndex(e=>e.handler===t);-1!==e&&i.splice(e,1)}}emit(e,t=null){if(this.eventBus&&"function"==typeof this.eventBus.emit)this.eventBus.emit(e,t);else if(!this.eventBus)return;const i=this.eventListeners.get(e);i&&i.length>0&&i.forEach(({handler:e,context:i})=>{try{e.call(i||this,t)}catch(e){}})}cleanupEventListeners(){if(this.eventBus){for(const[e,t]of this.eventListeners)t.forEach(({handler:t})=>{this.eventBus.off(e,t)});this.eventListeners.clear()}}isInitialized(){return this.initialized&&!this.destroyed}isDestroyed(){return this.destroyed}getComponentName(){return this.componentName||this.constructor.name}i({name:e,replyTopic:t}={}){e!==this.getComponentName()&&this.initialized&&!this.destroyed&&this.emit(t,{sender:this.getComponentName(),state:this.getCurrentState()})}l({sender:e,state:t}={}){"function"==typeof this.handleInitialState&&this.handleInitialState(e,t)}getCurrentState(){return null}handleInitialState(e,t){}async request(e,t={}){return await se(this.eventBus,e,t)}respond(e,t){return ne(this.eventBus,e,async e=>await t(e))}}class ce extends oe{constructor({storage:e,eventBus:t,i18n:i=Q}={}){super(t),this.componentName="PreferencesService",this.storage=e,this.i18n=i,this.defaultSettings={theme:"default",autoSave:!0,showTooltips:!0,confirmDeletes:!0,maxUndoSteps:50,defaultMode:"space",compactView:!1,language:"en",syncFolderName:null,syncFolderPath:null,autoSync:!1,autoSyncInterval:"change"},this.settings={...this.defaultSettings},this.eventBus&&(this.respond("preferences:init",()=>this.init()),this.respond("preferences:load-settings",()=>this.loadSettings()),this.respond("preferences:save-settings",()=>this.saveSettings()),this.respond("preferences:get-settings",()=>this.getSettings()),this.respond("preferences:set-setting",({key:e,value:t})=>this.setSetting(e,t)),this.respond("preferences:get-setting",({key:e})=>this.getSetting(e)),this.respond("preferences:reset-settings",()=>this.resetSettings()),this.respond("i18n:translate",({key:e,params:t={}})=>this.i18n&&this.i18n.t?this.i18n.t(e,t):e)),this.setupEventListeners()}setupEventListeners(){this.eventBus&&(this.eventBus.on("theme:toggle",()=>{this.toggleTheme()}),this.eventBus.on("language:change",({language:e})=>{e&&this.changeLanguage(e)}))}init(){this.loadSettings(),this.applySettings()}loadSettings(){try{if(!this.storage)return;const e=this.storage.getSettings();this.settings={...this.defaultSettings,...e},this.emit("preferences:loaded",{settings:this.getSettings()})}catch(e){this.settings={...this.defaultSettings}}}saveSettings(){if(!this.storage)return!1;const e=this.storage.saveSettings(this.settings);return e&&this.emit("preferences:saved",{settings:this.getSettings()}),e}getSettings(){return{...this.settings}}getSetting(e){return this.settings[e]}setSetting(e,t){this.settings[e]=t,this.saveSettings(),this.applySettings(),this.emit("preferences:changed",{key:e,value:t})}setSettings(e={}){this.settings={...this.defaultSettings,...e},this.saveSettings(),this.applySettings()}resetSettings(){this.settings={...this.defaultSettings},this.saveSettings(),this.applySettings()}applySettings(){this.applyTheme(),this.applyLanguage(),this.applyOtherSettings()}applyTheme(){if("undefined"==typeof document)return;const e=this.settings.theme||"default";"dark"===e?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme"),this.updateThemeToggleButton(e)}async applyLanguage(){const e=this.settings.language||"en";this.i18n&&this.i18n.language!==e&&await this.i18n.changeLanguage(e),"undefined"!=typeof window&&"function"==typeof window.applyTranslations&&window.applyTranslations(),this.updateLanguageFlag(e)}applyOtherSettings(){if("undefined"!=typeof document&&(this.settings.compactView?document.body.classList.add("compact-view"):document.body.classList.remove("compact-view")),"undefined"!=typeof window&&window.app){const e=window.app;"autoSave"in e&&(e.autoSave=this.settings.autoSave),"maxUndoSteps"in e&&(e.maxUndoSteps=this.settings.maxUndoSteps)}}toggleTheme(){const e="dark"===(this.settings.theme||"default")?"default":"dark";this.setSetting("theme",e);const t="dark"===e?"Dark Mode":"Light Mode";if(this.i18n){const e=this.i18n.t("switched_to_theme",{themeName:t})||`Switched to ${t}`;this.emit("toast:show",{message:e,type:"success"})}}updateThemeToggleButton(e){if("undefined"==typeof document)return;const t=document.getElementById("themeToggleBtn"),i=document.getElementById("themeToggleText"),a=t?.querySelector("i");t&&i&&a&&("dark"===e?(a.className="fas fa-sun",i.setAttribute("data-i18n","light_mode"),i.textContent=this.i18n?.t("light_mode")||"Light Mode"):(a.className="fas fa-moon",i.setAttribute("data-i18n","dark_mode"),i.textContent=this.i18n?.t("dark_mode")||"Dark Mode"))}async changeLanguage(e){if(this.setSetting("language",e),"undefined"!=typeof window&&window.localizeCommandData&&window.localizeCommandData(),this.emit("language:changed",{language:e}),this.i18n){const e=this.i18n.t("language_updated")||"Language updated";this.emit("toast:show",{message:e,type:"success"})}}updateLanguageFlag(e){if("undefined"==typeof document)return;const t=document.getElementById("languageFlag");t&&(t.className={en:"fi fi-gb",de:"fi fi-de",es:"fi fi-es",fr:"fi fi-fr"}[e]||"fi fi-gb")}detectBrowserLanguage(){try{if("undefined"==typeof navigator)return"en";const e=navigator.languages&&navigator.languages[0]||navigator.language;if(!e)return"en";const t=e.toLowerCase().split(/[-_]/)[0];return["en","de","es","fr"].includes(t)?t:"en"}catch(e){return"en"}}}const le=globalThis.STO_DATA||{};class de extends oe{constructor({storage:e=null,ui:t=null,exportManager:i=null,i18n:a=null,app:s=null,eventBus:n=null}={}){super(n),this.componentName="ProjectManagementService",this.storage=e,this.ui=t,this.exportManager=i,this.i18n=void 0!==Q?Q:null,this.app=s,this.eventBus&&this.setupEventHandlers()}onInit(){}setupEventHandlers(){this.eventBus.on("project:save",()=>{this.backupApplicationState()}),this.eventBus.on("project:open",()=>{this.restoreApplicationState()})}async backupApplicationState(){try{const e=this.storage.getAllData(),t={version:le?.settings?.version||"1.0.0",exported:(new Date).toISOString(),type:"project",data:{profiles:e.profiles||{},settings:e.settings||{},currentProfile:e.currentProfile}},i=JSON.stringify(t,null,2),a=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(a),n=`STO_Tools_Backup_${(new Date).toISOString().split("T")[0]}.json`,r=document.createElement("a");return r.href=s,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),this.ui?.showToast(this.i18n?.t?.("backup_created_successfully")||"Application backup created successfully","success"),this.emit("project-backup-created",{filename:n,data:t}),{success:!0,filename:n}}catch(e){return this.ui?.showToast(this.i18n?.t?.("failed_to_create_backup",{error:e.message})||`Failed to create backup: ${e.message}`,"error"),this.emit("project-backup-failed",{error:e}),{success:!1,error:e.message}}}async restoreApplicationState(){try{const e=document.createElement("input");return e.type="file",e.accept=".json,application/json",new Promise((t,i)=>{e.onchange=async e=>{try{const i=e.target.files[0];if(!i)return void t({success:!1,cancelled:!0});const a=await i.text(),s=JSON.parse(a);if(!s||"project"!==s.type||!s.data)throw new Error("Invalid project file format. Expected project.json from backup or sync folder.");const n=await this.request("import:project-file",{content:a});if(!n.success)throw new Error(n.error||"Import failed");if(await this.request("data:reload-state"),s.data.currentProfile)try{await this.request("data:switch-profile",{profileId:s.data.currentProfile})}catch(e){}this.ui?.showToast(this.i18n?.t?.("backup_restored_successfully")||"Application state restored successfully","success"),this.emit("project-backup-restored",{filename:i.name,data:s,imported:n.imported}),t({success:!0,data:s,imported:n.imported})}catch(e){this.ui?.showToast(this.i18n?.t?.("backup_restore_failed",{error:e.message})||`Failed to restore backup: ${e.message}`,"error"),t({success:!1,error:e.message})}},e.oncancel=()=>{t({success:!1,cancelled:!0})},e.click()})}catch(e){return{success:!1,error:e.message}}}async exportProject(){try{const e=this.storage.exportData(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),i=URL.createObjectURL(t),a=document.createElement("a");return a.href=i,a.download=`sto-keybinds-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i),this.emit("project-exported",{data:e}),{success:!0,data:e}}catch(e){return this.emit("project-export-failed",{error:e}),{success:!1,error:e.message}}}async importProject(e){try{const t=await e.text(),i=JSON.parse(t);if(!i||"object"!=typeof i)throw new Error("Invalid project file format");if(!this.storage.importData(t))throw new Error("Failed to import project data");return this.emit("project-imported",{data:i}),{success:!0,data:i}}catch(e){return this.emit("project-import-failed",{error:e}),{success:!1,error:e.message}}}async loadProjectFromFile(){try{const e=document.createElement("input");return e.type="file",e.accept=".json",await new Promise(t=>{e.onchange=async e=>{const i=e.target.files[0];if(!i)return void t({success:!1,error:"No file selected"});const a=await this.importProject(i);t(a)},e.oncancel=()=>{t({success:!1,error:"File selection cancelled"})},e.click()})}catch(e){return{success:!1,error:e.message}}}async saveProjectToFile(){try{return await this.exportProject()}catch(e){return{success:!1,error:e.message}}}validateProjectData(e){try{if(!e||"object"!=typeof e)return{valid:!1,error:"Invalid data format"};if(!e.profiles||"object"!=typeof e.profiles)return{valid:!1,error:"Missing profiles data"};if(!e.currentProfile)return{valid:!1,error:"Missing current profile"};for(const[t,i]of Object.entries(e.profiles)){if(!i||"object"!=typeof i)return{valid:!1,error:`Invalid profile structure for ${t}`};if(!i.name||"string"!=typeof i.name)return{valid:!1,error:`Missing profile name for ${t}`}}return{valid:!0}}catch(e){return{valid:!1,error:e.message}}}openProject(){const e=document.getElementById("fileInput")||document.createElement("input");e.id||(e.id="fileInput"),e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const i=new FileReader;i.onload=e=>{try{this.exportManager.importJSONFile(e.target.result)?(this.app?.loadData?.(),this.app?.renderProfiles?.(),this.app?.renderKeyGrid?.(),this.ui?.showToast(this.i18n?.t("project_loaded_successfully")??"Project loaded","success")):this.ui?.showToast(this.i18n?.t("failed_to_load_project_file")??"Failed to load project","error")}catch(e){this.ui?.showToast(this.i18n?.t("invalid_project_file")??"Invalid project file","error")}},i.readAsText(t)},e.click()}saveProject(){const e=this.storage.exportData(),t="string"==typeof e?e:JSON.stringify(e,null,2),i=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download="sto_keybinds.json",s.click(),URL.revokeObjectURL(a),this.ui?.showToast(this.i18n?.t("project_exported_successfully")??"Project exported","success"),this.emit("project-saved")}exportKeybinds(){const e=this.app?.getCurrentProfile?.();if(!e)return;const t=this.app?.currentEnvironment||"space",i=this.exportManager.generateSTOKeybindFile(e,{environment:t}),a=new Blob([i],{type:"text/plain"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s;const r=e.name.replace(/[^a-zA-Z0-9]/g,"_");n.download=`${r}_${t}_keybinds.txt`,n.click(),URL.revokeObjectURL(s),this.ui?.showToast(this.i18n?.t("keybinds_exported_successfully",{environment:t})??"Keybinds exported","success")}static#e=null;static getInstance(){return this.#e||(this.#e=new de),this.#e}}class me extends oe{constructor({eventBus:e,storage:t,syncManager:i,ui:a}={}){super(e),this.storage=t,this.syncManager=i,this.ui=a,this.isEnabled=!1,this.interval="change",this.m=null,this.lastSync=null,this.h=null,this.u=500,this.p=()=>this.debouncedSync(),this.setupPreferencesListeners()}onInit(){this.setupFromSettings()}setupPreferencesListeners(){this.eventBus.on("preferences:autosync-settings-changed",()=>{this.setupFromSettings()}),this.eventBus.on("preferences:changed",e=>{"autoSync"!==e.key&&"autoSyncInterval"!==e.key||this.setupFromSettings()})}setupFromSettings(){if(!this.storage)return;const e=this.storage.getSettings();e.autoSync?this.enable(e.autoSyncInterval||"change"):this.disable()}enable(e="change"){if(this.disable(),this.isEnabled=!0,this.interval=e,"change"===e)this.eventBus.on("storage:data-changed",this.p);else{const t=parseInt(e,10);if(isNaN(t)||t<=0)this.interval="change",this.eventBus.on("storage:data-changed",this.p);else{const e=1e3*t;this.m=setInterval(()=>this.sync(),e)}}}disable(){this.isEnabled=!1,this.eventBus.off("storage:data-changed",this.p),this.m&&(clearInterval(this.m),this.m=null),this.h&&(clearTimeout(this.h),this.h=null)}_(e){if(!this.storage)return;const t=this.storage.getSettings();t.autoSync=e,e&&(t.autoSyncInterval=this.interval),this.storage.saveSettings(t)}debouncedSync(){this.h&&clearTimeout(this.h),this.h=setTimeout(()=>{this.h=null,this.sync()},this.u)}async sync(){if(this.isEnabled&&this.syncManager)try{await this.syncManager.syncProject("auto"),this.lastSync=new Date,this.v("synced")}catch(e){this.v("error")}}getStatus(){return{enabled:this.isEnabled,interval:this.interval,lastSync:this.lastSync}}v(e){if(!this.ui||"undefined"==typeof document)return;const t=document.getElementById("modifiedIndicator");if(t)switch(t.classList.remove("syncing","synced","error"),e){case"synced":t.style.display="inline",t.classList.add("synced"),t.innerHTML='<i class="fas fa-check"></i> Synced',setTimeout(()=>{t.style.display="none",t.classList.remove("synced")},2e3);break;case"error":t.style.display="inline",t.classList.add("error"),t.innerHTML='<i class="fas fa-exclamation-triangle"></i> Sync Error',setTimeout(()=>{t.style.display="none",t.classList.remove("error")},5e3)}}}class he extends oe{constructor({storage:e,eventBus:t,i18n:i,dataCoordinator:a}){super(t),this.componentName="ProfileService",this.i18n=i,this.dataCoordinator=a,this.currentProfile=null,this.currentEnvironment="space",this.isModified=!1,this.profilesCache={},this.eventBus&&(this.respond("profile:switch",({id:e}={})=>this.switchProfile(e)),this.respond("profile:create",({name:e,description:t,mode:i}={})=>this.createProfile(e,t,i)),this.respond("profile:delete",({id:e}={})=>this.deleteProfile(e)),this.respond("profile:list",()=>this.getAllProfiles()),this.respond("profile:clone",({sourceId:e,newName:t}={})=>this.cloneProfile(e,t)),this.respond("profile:rename",({id:e,newName:t,description:i}={})=>this.renameProfile(e,t,i)),this.respond("profile:save",({profile:e}={})=>this.saveSpecificProfile(e)))}async init(){super.init(),this.setupEventListeners()}setupEventListeners(){this.addEventListener("profile:switched",({profileId:e,environment:t})=>{this.currentProfile=e,this.currentEnvironment=t,this.isModified=!1}),this.addEventListener("environment:changed",({environment:e})=>{this.currentEnvironment=e}),this.addEventListener("profile:created",({profile:e})=>{e&&e.id&&(this.profilesCache[e.id]=e)}),this.addEventListener("profile:deleted",({profileId:e})=>{this.profilesCache[e]&&delete this.profilesCache[e]}),this.addEventListener("profile:updated",({profile:e})=>{e&&e.id&&(this.profilesCache[e.id]=e)})}async loadData(){try{return this.currentProfile&&this.emit("profile-switched",{profileId:this.currentProfile,profile:this.currentProfile,environment:this.currentEnvironment}),{currentProfile:this.currentProfile,currentEnvironment:this.currentEnvironment,profiles:this.profilesCache}}catch(e){throw new Error(this.i18n.t("failed_to_load_profile_data")||"Failed to load profile data")}}async saveProfile(){try{if(!this.currentProfile)throw new Error(this.i18n.t("no_profile_to_save")||"No profile to save");return await this.request("data:update-profile",{profileId:this.currentProfile,properties:{currentEnvironment:this.currentEnvironment}}),this.isModified=!1,{success:!0,message:this.i18n.t("profile_saved")||"Profile saved"}}catch(e){throw new Error(this.i18n.t("failed_to_save_profile")||"Failed to save profile")}}async saveSpecificProfile(e){try{if(!e)throw new Error(this.i18n.t("no_profile_to_save")||"No profile to save");const t=e.id||this.currentProfile;return await this.request("data:update-profile",{profileId:t,properties:e}),this.setModified(!0),{success:!0,message:this.i18n.t("profile_saved")||"Profile saved"}}catch(e){throw new Error(this.i18n.t("failed_to_save_profile")||"Failed to save profile")}}async saveData(){try{return this.setModified(!1),{success:!0,message:this.i18n.t("data_saved")||"Data saved"}}catch(e){throw e}}async saveCurrentProfile(){try{return{success:!0}}catch(e){throw e}}setModified(e=!0){return this.isModified=e,e&&this.emit("profile-modified"),{modified:e,success:!0}}getCurrentBuild(e){return e}async switchProfile(e){try{const t=await this.request("data:switch-profile",{profileId:e});return t.success&&t.switched&&(this.currentProfile=e,this.currentEnvironment=t.profile?.environment||"space",this.isModified=!1),t.message&&this.i18n&&(t.switched?t.message=this.i18n.t("switched_to_profile",{name:t.profile?.name,environment:this.currentEnvironment})||t.message:t.message=this.i18n.t("already_on_profile")||t.message),t}catch(e){if(e.message.includes("not found")&&this.i18n)throw new Error(this.i18n.t("profile_not_found")||e.message);throw e}}async createProfile(e,t="",i="space"){try{const a=await this.request("data:create-profile",{name:e,description:t,mode:i});return a.message&&this.i18n&&(a.message=this.i18n.t("profile_created",{name:e})||a.message),a}catch(t){if(this.i18n)throw t.message.includes("already exists")?new Error(this.i18n.t("profile_already_exists",{name:e})||t.message):new Error(this.i18n.t("failed_to_create_profile")||t.message);throw t}}async cloneProfile(e,t){try{const i=await this.request("data:clone-profile",{sourceId:e,newName:t});return i.message&&this.i18n&&(i.message=this.i18n.t("profile_created_from",{newName:t,sourceProfile:e})||i.message),i}catch(e){if(this.i18n)throw e.message.includes("not found")?new Error(this.i18n.t("source_profile_not_found")||e.message):new Error(this.i18n.t("failed_to_clone_profile")||e.message);throw e}}async deleteProfile(e){try{const t=await this.request("data:delete-profile",{profileId:e});return t.success&&t.switchedProfile&&(this.currentProfile=t.switchedProfile.id||Object.keys(await this.request("data:get-all-profiles"))[0],this.currentEnvironment=t.switchedProfile.environment||"space",this.isModified=!1),t.message&&this.i18n&&(t.message=this.i18n.t("profile_deleted",{profileName:t.deletedProfile?.name||"Unknown"})||t.message),t}catch(e){if(this.i18n)throw e.message.includes("not found")?new Error(this.i18n.t("profile_not_found")||e.message):e.message.includes("last profile")?new Error(this.i18n.t("cannot_delete_the_last_profile")||e.message):new Error(this.i18n.t("failed_to_delete_profile")||e.message);throw e}}async saveCurrentBuild(){try{if(!this.currentProfile)throw new Error(this.i18n.t("no_profile_or_build_data")||"No profile or build data");return await this.request("data:update-profile",{profileId:this.currentProfile,properties:{currentEnvironment:this.currentEnvironment}}),{success:!0}}catch(e){throw e}}async generateProfileId(e){const t=e.toLowerCase().replace(/[^a-z0-9]/g,"_");let i=t,a=1;const s=await this.request("data:get-all-profiles");for(;s[i];)i=`${t}_${a}`,a++;return i}getCurrentProfileId(){return this.currentProfile}getCurrentEnvironment(){return this.currentEnvironment}setCurrentEnvironment(e){this.currentEnvironment=e}getModified(){return this.isModified}async getCurrentState(){return{currentProfile:this.currentProfile,currentEnvironment:this.currentEnvironment,profiles:{...this.profilesCache},modified:this.isModified}}async handleInitialState(e,t){if("DataCoordinator"===t&&e.currentProfileData){this.currentProfile=e.currentProfile||e.currentProfileData?.id,this.currentEnvironment=e.currentEnvironment||"space",this.isModified=!1,e.profiles&&(this.profilesCache={...e.profiles});try{await this.loadData()}catch(e){}}else e.currentProfile&&(this.currentProfile=e.currentProfile,this.currentEnvironment=e.currentEnvironment||"space",this.isModified=e.modified||!1,e.profiles&&(this.profilesCache={...e.profiles}))}async getAllProfiles(){return{...this.profilesCache}}async renameProfile(e,t,i=""){try{const a=await this.request("data:rename-profile",{profileId:e,newName:t,description:i});return a.message&&this.i18n&&(a.message=this.i18n.t("profile_renamed",{name:t})||a.message),a}catch(e){if(this.i18n)throw e.message.includes("required")?new Error(this.i18n.t("profile_id_required")||e.message):e.message.includes("not found")?new Error(this.i18n.t("profile_not_found")||e.message):new Error(this.i18n.t("failed_to_rename_profile")||e.message);throw e}}}function ue(e,t={},i=!0){let a="";return i&&t.description&&(a+=`; ${t.description}\n`),a+=`alias ${e} <& ${t.commands} &>\n`,a}function pe(e,t=[]){if(!t||0===t.length)return"";const i=t.map(e=>"string"==typeof e?e.trim():e&&"string"==typeof e.command?e.command.trim():"").filter(e=>e.length>0);return 0===i.length?"":`${e} "${i.join(" $$ ")}"\n`}class _e extends oe{constructor({storage:e,eventBus:t,i18n:i,ui:a,modalManager:s}){if(super(t),this.componentName="CommandLibraryService",this.$=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.storage=e,this.i18n=i,this.ui=a,this.modalManager=s,this.currentProfile=null,this.currentEnvironment="space",this.selectedKey=null,this.selectedAlias=null,this.cache={currentProfile:null,currentEnvironment:"space",profile:null,keys:{},aliases:{}},this.j=[],this.eventBus&&this.j.push(this.respond("command:get-for-selected-key",async()=>await this.getCommandsForSelectedKey()),this.respond("command:get-empty-state-info",async()=>await this.getEmptyStateInfo()),this.respond("command:find-definition",({command:e})=>this.findCommandDefinition(e)),this.respond("command:get-warning",({command:e})=>this.getCommandWarning(e)),this.respond("command:get-categories",()=>this.getCommandCategories()),this.respond("command:generate-id",()=>this.generateCommandId()),this.respond("command:filter-library",()=>(this.filterCommandLibrary(),!0))),"undefined"!=typeof vi&&"function"==typeof vi.fn&&!vi.isMockFunction?.(this.emit)){const e=this.emit.bind(this);this.emit=vi.fn((...t)=>e(...t))}}async init(){super.init(),this.setupEventListeners(),this.setupRequestResponseEndpoints()}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&this.updateCacheFromProfile(t)}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfile=e,this.cache.currentProfile=e,this.currentEnvironment=i,this.cache.currentEnvironment=i,this.updateCacheFromProfile(t),this.selectedKey=null,this.selectedAlias=null}),this.addEventListener("key-selected",e=>{this.selectedKey=e.key,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,"alias"!==t&&(this.selectedAlias=null),"alias"===t&&(this.selectedKey=null),this.filterCommandLibrary())}),this.addEventListener("language:changed",()=>{"undefined"!=typeof window&&window.i18next&&(this.i18n=window.i18next)})}updateCacheFromProfile(e){if(!e)return;this.normalizeKeyArrays(e),this.cache.profile=e,this.cache.aliases=e.aliases||{},this.cache.profile.keybindMetadata=e.keybindMetadata||{},this.cache.profile.aliasMetadata=e.aliasMetadata||{};const t=e.builds?.[this.cache.currentEnvironment];this.cache.keys=t?.keys||{}}async getCommandsForSelectedKey(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return[];const t=this.getCurrentProfile();if(!t)return[];if("alias"===this.currentEnvironment){const i=t.aliases&&t.aliases[e];return i&&Array.isArray(i.commands)?[...i.commands]:[]}const i=t.keys&&t.keys[e]?t.keys[e]:[];return Array.isArray(i)?[...i]:[]}getCurrentProfile(){return this.cache.profile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[this.currentEnvironment]||(e.builds[this.currentEnvironment]={keys:{}}),e.builds[this.currentEnvironment].keys||(e.builds[this.currentEnvironment].keys={}),{...e,keys:e.builds[this.currentEnvironment].keys,aliases:e.aliases||{},keybindMetadata:e.keybindMetadata||{},aliasMetadata:e.aliasMetadata||{}}):null}async findCommandDefinition(e){try{if(!await this.request("data:has-commands"))return null;const t=await this.request("data:get-commands"),i="string"==typeof e?e.trim():(e?.command||"").trim(),a="string"==typeof e?e.trim():(e?.text||"").trim();for(const[e,s]of Object.entries(t))for(const[t,n]of Object.entries(s.commands))if(n.command===i||n.name===a)return{...this.translateCommandDefinition(n,t),commandId:t,categoryId:e};for(const[e,a]of Object.entries(t))for(const[t,s]of Object.entries(a.commands))if(i){const a=s.command.split(/\s+/)[0],n=a.replace(/^\+/,""),r=a.replace(/^\+?STO/,""),o=a.replace(/^\+?STO/,"+"),c=new Set([a,n,r,o]),l=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=Array.from(c).filter(Boolean).map(e=>new RegExp(`^${l(e)}(\\s|$)`,"i")),m=i.replace(/^\+/,""),h=d.some(e=>e.test(i)||e.test(m));if(/TrayExec/i.test(i)&&h||h)return{...this.translateCommandDefinition(s,t),commandId:t,categoryId:e}}return null}catch(e){return null}}translateCommandDefinition(e,t){if(!this.i18n)return e;const i={...e},a=`command_definitions.${t}.name`;i.name=this.i18n.t(a,{defaultValue:e.name});const s=`command_definitions.${t}.description`;return i.description=this.i18n.t(s,{defaultValue:e.description}),i}formatDisplayText(e){if("string"==typeof e)return e;if("object"==typeof e&&e.key){if(!this.i18n)return e.fallback;const t=this.i18n.t(e.key,{defaultValue:e.fallback});if(e.params){const{tray:i,slot:a,backup_tray:s,backup_slot:n}=e.params;if(void 0!==s&&void 0!==n)return`${t} (${i} ${a} -> ${s} ${n})`;if(void 0!==i&&void 0!==a)return`${t} (${i} ${a})`}return t}return e}async getCommandWarning(e){try{if(!await this.request("data:has-commands"))return null;const t=await this.request("data:get-commands"),i="string"==typeof e?e.trim():(e?.command||"").trim();for(const[a,s]of Object.entries(t))for(const[t,a]of Object.entries(s.commands))if(i&&a.command===i||"object"==typeof e&&(a.command===e.command||a.name===e.text))return a.warning||null;for(const[a,s]of Object.entries(t))for(const[t,a]of Object.entries(s.commands)){const t=i||e.command;if(t&&t.includes(a.command)){const e=t.includes("TrayExec"),i=t.startsWith(a.command);if(e||i)return a.warning||null}}return null}catch(e){return null}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async getCommandCategories(){try{return await this.request("data:has-commands")?await this.request("data:get-commands"):{}}catch(e){return{}}}async filterCommandLibrary(){try{if(!await this.request("data:has-commands"))return;const e=document.querySelectorAll(".command-item"),t=await this.request("data:get-commands");e.forEach(e=>{const i=e.dataset.command;if(!i)return;let a=null;for(const[e,s]of Object.entries(t))if(s.commands[i]){a=s.commands[i];break}if(a){let t;t="alias"===this.currentEnvironment||!a.environment||a.environment===this.currentEnvironment,e.dataset.envHidden=(!t).toString(),t?""!==e.style.display&&"none"!==e.style.display||(e.style.display="flex"):e.style.display="none"}}),document.querySelectorAll(".category").forEach(e=>{const t=e.querySelectorAll('.command-item:not([style*="display: none"])').length>0;e.style.display=t?"block":"none"})}catch(e){}}async getCommandChainPreview(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_see_the_generated_command"):this.i18n.t("select_a_key_to_see_the_generated_command");const t=await this.getCommandsForSelectedKey();if(0===t.length)return"alias"===this.currentEnvironment?ue(e,{commands:""}).trim():`${e} ""`;if("alias"===this.currentEnvironment){const i=this.getCurrentProfile();let a,s=!1;return i&&i.aliasMetadata&&i.aliasMetadata[e]&&i.aliasMetadata[e].stabilizeExecutionOrder&&(s=!0),a=s&&t.length>1?await this.generateMirroredCommandString(t):(await this.normalizeCommandsForDisplay(t)).join(" $$ "),ue(e,{commands:a}).trim()}{const i=this.getCurrentProfile();let a,s=!1;return i&&i.keybindMetadata&&i.keybindMetadata[this.currentEnvironment]&&i.keybindMetadata[this.currentEnvironment][e]&&i.keybindMetadata[this.currentEnvironment][e].stabilizeExecutionOrder&&(s=!0),a=s&&t.length>1?await this.generateMirroredCommandString(t):(await this.normalizeCommandsForDisplay(t)).join(" $$ "),`${e} "${a}"`}}async generateMirroredCommandString(e){return await this.request("fileops:generate-mirrored-commands",{commands:e})}async normalizeCommandsForDisplay(e){const t=[];for(const i of e){const e="string"==typeof i?i:i&&i.command||"";if(e)try{const i=await this.request("parser:parse-command-string",{commandString:e,options:{generateDisplayText:!1}});if(i.commands&&i.commands[0]){const a=i.commands[0];if(a.signature&&(a.signature.includes("TrayExecByTray")||a.signature.includes("TrayExecByTrayWithBackup"))&&a.parameters){const e=a.parameters,i=void 0!==e.active?e.active:1;if(a.signature.includes("TrayExecByTrayWithBackup")){const a=(e.baseCommand||"TrayExecByTrayWithBackup").replace(/^\+/,"");1===i?t.push(`+${a} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`):t.push(`${a} ${i} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`)}else{const a=(e.baseCommand||"TrayExecByTray").replace(/^\+/,"");1===i?t.push(`+${a} ${e.tray} ${e.slot}`):t.push(`${a} ${i} ${e.tray} ${e.slot}`)}}else t.push(e)}else t.push(e)}catch(i){t.push(e)}}return t}async getEmptyStateInfo(){const e="alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;if(!e)return{title:"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_edit")||"Select an alias to edit":this.i18n.t("select_a_key_to_edit")||"Select a key to edit",preview:"alias"===this.currentEnvironment?this.i18n.t("select_an_alias_to_see_the_generated_command")||"Select an alias to see the generated command":this.i18n.t("select_a_key_to_see_the_generated_command")||"Select a key to see the generated command",icon:"alias"===this.currentEnvironment?"fas fa-mask":"fas fa-keyboard",emptyTitle:"alias"===this.currentEnvironment?this.i18n.t("no_alias_selected")||"No Alias Selected":this.i18n.t("no_key_selected")||"No Key Selected",emptyDesc:"alias"===this.currentEnvironment?this.i18n.t("select_alias_from_left_panel")||"Select an alias from the left panel to view and edit its command chain.":this.i18n.t("select_key_from_left_panel")||"Select a key from the left panel to view and edit its command chain.",commandCount:"0"};const t=await this.getCommandsForSelectedKey(),i="alias"===this.currentEnvironment?"Alias Chain":"Command Chain";if(0===t.length){const t="alias"===this.currentEnvironment?`${this.i18n.t("click_add_command_to_start_building_your_alias_chain")||'Click "Add Command" to start building your alias chain for'} ${e}.`:`${this.i18n.t("click_add_command_to_start_building_your_command_chain")||'Click "Add Command" to start building your command chain for'} ${e}.`;return{title:`${i} for ${e}`,preview:await this.getCommandChainPreview(),icon:"fas fa-plus-circle",emptyTitle:this.i18n.t("no_commands")||"No Commands",emptyDesc:t,commandCount:"0"}}return{title:`${i} for ${e}`,preview:await this.getCommandChainPreview(),commandCount:t.length.toString()}}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfile=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.updateCacheFromProfile(e)}"KeyService"===e&&t.selectedKey&&(this.selectedKey=t.selectedKey),"AliasBrowserService"===e&&t.selectedAliasName&&(this.selectedAlias=t.selectedAliasName)}}destroy(){this.j&&(this.j.forEach(e=>{"function"==typeof e&&e()}),this.j=[]),super.destroy&&"function"==typeof super.destroy&&super.destroy()}setupRequestResponseEndpoints(){this.j||(this.j=[]),this.j.push(this.respond("command-library:get-data",()=>({commandCategories:this.commandCategories,userCommands:this.userCommands})))}normalizeKeyArrays(e){e&&e.builds&&["space","ground"].forEach(t=>{const i=e.builds[t];i&&i.keys&&Object.entries(i.keys).forEach(([e,t])=>{Array.isArray(t)&&(i.keys[e]=t.map(e=>"string"==typeof e?e:e&&e.command||"").filter(Boolean))})})}}async function fe(e,t,i={}){if("string"!=typeof e)return we(e,t);const a=i.eventBus||globalThis.eventBus||o;try{const i=await se(a,"parser:parse-command-string",{commandString:e,options:{generateDisplayText:!0}});if(!i||!i.commands||0===i.commands.length)return we(e,t);const s=i.commands[0];let n=null;try{n=await se(a,"command:find-definition",{command:e})}catch(e){}const r={command:e,text:s.displayText||e,displayText:s.displayText||e,icon:s.icon||"⚙️",type:s.category||"custom",category:s.category||"custom",parameters:s.parameters||{},signature:s.signature,baseCommand:s.baseCommand,id:s.id||`display_${Date.now()}_${Math.random()}`};if(n&&(r.icon=n.icon||r.icon,r.type=n.categoryId||r.type,r.category=n.categoryId||r.category,n.customizable&&r.parameters?(r.text=function(e,t){if(!e||!t)return e?.name||"Parameterized Command";const{commandId:i,categoryId:a}=e;if("communication"===a||"communication"===i){if(t.verb&&t.message)return`${t.verb}: "${t.message}"`}else if("tray_with_backup"===i){if(void 0!==t.tray&&void 0!==t.slot)return`${e.name} (${t.tray} ${t.slot} ${t.backup_tray??""} ${t.backup_slot??""})`}else if("custom_tray"===i){if(void 0!==t.tray&&void 0!==t.slot)return`${e.name} (${t.tray} ${t.slot})`}else if("target"===i&&t.entityName)return`${e.name}: ${t.entityName}`;return e.name||"Parameterized Command"}(n,r.parameters),r.displayText=r.text):n.name&&(new Set(["custom_tray","tray_with_backup"]).has(n.commandId)||(r.text=n.name,r.displayText=n.name))),t&&"function"==typeof t.t){const e=function(e,t){return t?.translationKey?t.translationKey:e?.baseCommand?`command.${e.baseCommand.toLowerCase()}`:e?.signature?`command.${e.signature.split("(")[0].toLowerCase()}`:null}(s,n);if(e){const i=t.t(e,r.parameters);if(i&&i!==e)if("object"==typeof s.displayText&&s.displayText?.params){const{tray:e,slot:t,backup_tray:a,backup_slot:n}=s.displayText.params;let o="";void 0!==a&&void 0!==n?o=` (${e} ${t} -> ${a} ${n})`:void 0!==e&&void 0!==t&&(o=` (${e} ${t})`),r.text=`${i}${o}`,r.displayText=r.text}else r.text=i,r.displayText=i}}if("object"==typeof r.displayText&&r.displayText&&!("key"in r.displayText)){const t=r.displayText.fallback||r.displayText.text||e;r.displayText=t,r.text=t}return r}catch(i){return we(e,t)}}function ye(e){return"string"==typeof e?e.trim():e&&"object"==typeof e?(e.command||e.text||"").trim():""}async function ge(e,t={}){const i=ye(e);if(!i)return"";const a=t.eventBus||globalThis.eventBus||o;try{const e=await se(a,"parser:parse-command-string",{commandString:i,options:{generateDisplayText:!1}});if(e?.commands?.[0]){const t=e.commands[0];if(t.signature&&(t.signature.includes("TrayExecByTray")||t.signature.includes("TrayExecByTrayWithBackup"))&&t.parameters){const e=t.parameters,i=void 0!==e.active?e.active:1;if(t.signature.includes("TrayExecByTrayWithBackup")){if(1===i){return`+${(e.baseCommand||"TrayExecByTrayWithBackup").replace(/^\+/,"")} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`}return`${(e.baseCommand||"TrayExecByTrayWithBackup").replace(/^\+/,"")} ${i} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`}if(1===i){return`+${(e.baseCommand||"TrayExecByTray").replace(/^\+/,"")} ${e.tray} ${e.slot}`}return`${(e.baseCommand||"TrayExecByTray").replace(/^\+/,"")} ${i} ${e.tray} ${e.slot}`}}}catch(e){}return i}function be(e){if(!Array.isArray(e)){const t=ye(e);return t?[t]:[]}return e.map(ye).filter(e=>e.length>0)}function we(e,t){const i=String(e||"").trim();return{command:i,text:i||t?.t?.("unknown_command")||"Unknown Command",displayText:i||t?.t?.("unknown_command")||"Unknown Command",icon:"⚙️",type:"custom",category:"custom",parameters:{},signature:"UnknownCommand()",baseCommand:"Unknown",id:`fallback_${Date.now()}_${Math.random()}`}}class ve extends oe{constructor({storage:e,eventBus:t,i18n:i,profileService:a=null,modalManager:s=null}){super(t),this.componentName="CommandService",this.storage=e,this.i18n=i,this.profileService=a,this.modalManager=s,this.currentProfile=null,this.currentEnvironment="space",this.selectedKey=null,this.selectedAlias=null,this.cache={currentProfile:null,currentEnvironment:"space",profile:null,builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},keys:{}},this.j=[],this.eventBus&&this.j.push(this.respond("command:add",async({command:e,key:t,position:i})=>this.addCommand(t,e,i)),this.respond("command:edit",async({key:e,index:t,updatedCommand:i})=>this.editCommand(e,t,i)),this.respond("command:validate",({command:e})=>this.validateCommand(e)),this.respond("command:delete",async({key:e,index:t})=>this.deleteCommand(e,t)),this.respond("command:move",async({key:e,fromIndex:t,toIndex:i})=>this.moveCommand(e,t,i)))}async init(){super.init(),this.setupEventListeners()}onInit(){}getCurrentProfileId(){return this.currentProfile}getCurrentProfile(){return this.cache.currentProfile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){if(!e)return null;const t=this.cache.builds||{space:{keys:{}},ground:{keys:{}}};return t[this.currentEnvironment]||(t[this.currentEnvironment]={keys:{}}),t[this.currentEnvironment].keys||(t[this.currentEnvironment].keys={}),{...e,keys:t[this.currentEnvironment].keys,aliases:this.cache.aliases||{}}}async addCommand(e,t){if(!e)return this.ui?.showToast?.(this.i18n?.t?.("please_select_a_key_first")||"Please select a key first","warning"),!1;const i=this.getCurrentProfile();if(!i)return this.ui?.showToast?.(this.i18n.t("no_valid_profile"),"error"),!1;const a=this.cache.aliases&&this.cache.aliases[e];let s=[];a&&Array.isArray(a.commands)&&(s=[...a.commands]);const n=(Array.isArray(t)?be(t):[ye(t)]).filter(e=>e.length>0);if(0===n.length)return!1;s.push(...n);const r=[...this.cache.keys[e]||[],...n];try{const a={};return"alias"===this.currentEnvironment?i.aliases?.[e]?a.modify={aliases:{[e]:{...i.aliases[e]||{},commands:s}}}:a.add={aliases:{[e]:{commands:s,description:"",type:"alias"}}}:i.builds?.[this.currentEnvironment]?.keys?.[e]?a.modify={builds:{[this.currentEnvironment]:{keys:{[e]:r}}}}:a.add={builds:{[this.currentEnvironment]:{keys:{[e]:r}}}},await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),this.emit("command-added",{key:e,command:t}),!0}catch(e){return this.ui?.showToast?.("Failed to add command","error"),!1}}async deleteCommand(e,t){if(!this.getCurrentProfile())return!1;if(!e||void 0===t)return!1;let i=null;if("alias"===this.currentEnvironment||this.cache.aliases&&Object.prototype.hasOwnProperty.call(this.cache.aliases,e)){const a=this.cache.aliases[e];if(!a||!Array.isArray(a.commands))return!1;const s=[...a.commands];if(t<0||t>=s.length)return!1;s.splice(t,1),i=0===s.length?{delete:{aliases:[e]}}:{modify:{aliases:{[e]:{...a,commands:s}}}}}else{const a=this.cache.keys[e]||[];if(!a[t])return!1;const s=[...a];s.splice(t,1),i=0===s.length?{delete:{builds:{[this.currentEnvironment]:{keys:[e]}}}}:{modify:{builds:{[this.currentEnvironment]:{keys:{[e]:s}}}}}}try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...i}),this.emit("command-deleted",{key:e,index:t}),!0}catch(e){return!1}}async moveCommand(e,t,i){if(!this.getCurrentProfile())return!1;let a=null;if("alias"===this.currentEnvironment){const s=this.cache.aliases&&this.cache.aliases[e];if(!s||!Array.isArray(s.commands))return!1;const n=[...s.commands];if(t<0||t>=n.length||i<0||i>=n.length)return!1;const[r]=n.splice(t,1);n.splice(i,0,r),a={modify:{aliases:{[e]:{...s,commands:n}}}}}else{const s=this.cache.keys[e]||[];if(t<0||t>=s.length||i<0||i>=s.length)return!1;const n=[...s],[r]=n.splice(t,1);n.splice(i,0,r),a={modify:{builds:{[this.currentEnvironment]:{keys:{[e]:n}}}}}}try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),this.emit("command-moved",{key:e,fromIndex:t,toIndex:i}),!0}catch(e){return!1}}async editCommand(e,t,i){if(!e||void 0===t||!i)return!1;if(!this.getCurrentProfile())return this.ui?.showToast?.("No valid profile","error"),!1;let a=null;if("alias"===this.currentEnvironment){const s=this.cache.aliases[e];if(!s||!Array.isArray(s.commands))return!1;const n=[...s.commands];if(t<0||t>=n.length)return!1;const r=ye(i);n[t]=r,a={modify:{aliases:{[e]:{...s,commands:n}}}}}else{const s=this.cache.keys[e]||[];if(t<0||t>=s.length)return!1;const n=[...s];n[t]=ye(i),a={modify:{builds:{[this.currentEnvironment]:{keys:{[e]:n}}}}}}try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,...a}),this.emit("command-edited",{key:e,index:t,updatedCommand:i}),!0}catch(e){return this.ui?.showToast?.("Failed to update command","error"),!1}}async findCommandDefinition(e){try{if(!await this.request("data:has-commands"))return null;if(e.command&&e.command.includes("TrayExec")){const t=await this.request("data:get-tray-category");if(t){if(e.command.includes("TrayExecByTrayWithBackup")&&e.command.includes("$$"))return{commandId:"tray_range_with_backup",...t.commands.tray_range_with_backup};if((e.command.includes("STOTrayExecByTray")||e.command.includes("TrayExecByTray"))&&e.command.includes("$$")&&!e.command.includes("WithBackup"))return{commandId:"tray_range",...t.commands.tray_range};if(e.command.includes("TrayExecByTrayWithBackup"))return{commandId:"tray_with_backup",...t.commands.tray_with_backup};if(e.command.includes("STOTrayExecByTray")||e.command.includes("TrayExecByTray")&&!e.command.includes("WithBackup"))return{commandId:"custom_tray",...t.commands.custom_tray}}}const t=await this.request("data:get-command-category",{categoryId:e.type});if(!t)return null;for(const[i,a]of Object.entries(t.commands))if(a.command===e.command)return{commandId:i,...a};for(const[i,a]of Object.entries(t.commands))if(a.customizable&&e.command.startsWith(a.command.split(" ")[0]))return{commandId:i,...a};return null}catch(e){return null}}async getCommandWarning(e){try{if(!await this.request("data:has-commands"))return null;const t=await this.request("data:get-commands");for(const[i,a]of Object.entries(t))for(const[t,i]of Object.entries(a.commands))if(i.command===e.command||i.name===e.text||e.command&&e.command.includes(i.command))return i.warning||null;return null}catch(e){return null}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&this.updateCacheFromProfile(t)}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfile=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.updateCacheFromProfile(t)}),this.addEventListener("key-selected",e=>{this.selectedKey=e.key,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,this.cache.keys=this.cache.builds[t]?.keys||{},this.selectedKey=null,this.selectedAlias=null)}),this.addEventListener("command:add",async e=>{const{command:t,key:i,position:a}=e;await this.addCommand(i,t,a)}),this.addEventListener("command:edit",async e=>{const{key:t,index:i,updatedCommand:a}=e;await this.editCommand(t,i,a)})}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.aliases=e.aliases||{},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{})}getCommandsForKey(e){if("alias"===this.currentEnvironment){const t=this.cache.aliases&&this.cache.aliases[e];return t&&Array.isArray(t.commands)&&Array.isArray(t.commands)?t.commands:[]}return this.cache.keys[e]||[]}validateCommand(e){return e?{valid:!0}:{valid:!1,reason:"empty"}}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfile=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.updateCacheFromProfile(e)}"CommandService"===e&&(this.selectedKey=t.selectedKey??this.selectedKey,this.selectedAlias=t.selectedAlias??this.selectedAlias),"KeyService"===e&&t.selectedKey&&(this.selectedKey=t.selectedKey)}}destroy(){this.j&&(this.j.forEach(e=>{"function"==typeof e&&e()}),this.j=[]),super.destroy&&"function"==typeof super.destroy&&super.destroy()}}class ke extends oe{constructor({eventBus:e,storage:t,profileService:i,app:a}){super(e),this.componentName="InterfaceModeService",this.storage=t,this.profileService=i,this.app=a,this.q="space",this.ee=null,this.te=!1,this.ie=null,this.ae=null,this.eventBus&&(this.ae=this.respond("environment:switch",async({mode:e}={})=>e?(await this.switchMode(e),{success:!0,mode:this.q}):{success:!1,error:"No mode provided"}))}init(){super.init(),this.setupEventListeners()}get currentMode(){return this.q}set currentMode(e){this.switchMode(e).catch(e=>{})}get currentEnvironment(){return this.q}set currentEnvironment(e){this.switchMode(e).catch(e=>{})}setupEventListeners(){this.te||(this.ie=e=>{e.profileId&&(this.ee=e.profileId),e.environment&&this.switchMode(e.environment).catch(e=>{})},this.eventBus.on("profile:switched",this.ie),this.te=!0)}async switchMode(e){if(e!==this.q){this.q,this.q=e;try{await this.updateProfileMode(e)}catch(e){}this.emit("environment:changed",{environment:e})}}async updateProfileMode(e){if(this.ee)try{await this.request("data:update-profile",{profileId:this.ee,properties:{currentEnvironment:e}})}catch(e){}}getCurrentMode(){return this.q}async setCurrentMode(e){await this.switchMode(e)}initializeFromProfile(e){e?.currentEnvironment&&(this.q,this.q=e.currentEnvironment,this.emit("environment:changed",{environment:this.q,isInitialization:!0}))}destroy(){this.te&&(this.eventBus.off("profile:switched",this.ie),this.te=!1),this.ae&&(this.ae(),this.ae=null),super.destroy()}getCurrentState(){return{currentMode:this.q,environment:this.q,currentEnvironment:this.q}}handleInitialState(e,t){t&&("DataCoordinator"!==e&&"ProfileService"!==e||!t.currentEnvironment||(t.currentProfile&&(this.ee=t.currentProfile),this.q,this.q=t.currentEnvironment,this.emit("environment:changed",{environment:this.q,isInitialization:!0})))}}const Se="sync-folder";class xe extends oe{constructor({dbName:e="sto-sync-handles",storeName:t="directories",eventBus:i}={}){super(i),this.componentName="FileSystemService",this.dbName=e,this.storeName=t}openDB(){return new Promise((e,t)=>{const i=indexedDB.open(this.dbName,1);i.onupgradeneeded=()=>{i.result.createObjectStore(this.storeName)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async saveDirectoryHandle(e,t){const i=await this.openDB(),a=i.transaction(this.storeName,"readwrite");a.objectStore(this.storeName).put(t,e),await new Promise((e,t)=>{a.oncomplete=()=>e(),a.onerror=()=>t(a.error),a.onabort=()=>t(a.error)}),i.close()}async getDirectoryHandle(e){const t=await this.openDB(),i=t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e),a=await new Promise((e,t)=>{i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)});return t.close(),a||null}async writeFile(e,t,i){const a=t.split("/"),s=a.pop();let n=e;for(const e of a)n=await n.getDirectoryHandle(e,{create:!0});const r=await n.getFileHandle(s,{create:!0}),o=await r.createWritable();await o.write(i),await o.close()}static#e=null;static se(){return this.#e||(this.#e=new xe),this.#e}static saveDirectoryHandle(e,t){return this.se().saveDirectoryHandle(e,t)}static getDirectoryHandle(e){return this.se().getDirectoryHandle(e)}static writeFile(e,t,i){return this.se().writeFile(e,t,i)}}const Te=(...e)=>xe.writeFile(...e);class Ce extends oe{constructor(e={}){if(super(o),this.componentName="SyncService",e&&"function"==typeof e.getSettings)this.storage=e,this.ui=global.stoUI;else{const{storage:t,ui:i,fs:a}=e;this.storage=t,this.ui=i,this.fs=a||new xe({eventBus:o})}this.fs||(this.fs=new xe({eventBus:o})),this.eventBus&&(this.respond("sync:sync-project",({source:e}={})=>this.syncProject(e)),this.respond("sync:set-sync-folder",({autoSync:e}={})=>this.setSyncFolder(e)),this.respond("sync:get-sync-folder-handle",()=>this.getSyncFolderHandle()))}async setSyncFolder(e=!1){try{const t=await window.showDirectoryPicker();await this.fs.saveDirectoryHandle(Se,t);const i=t.name;if(this.storage){const t=this.storage.getSettings();t.syncFolderName=i,t.syncFolderPath=`Selected folder: ${i}`,t.autoSync=e,this.storage.saveSettings(t)}return this.ui?.showToast(Q.t("sync_folder_set"),"success"),this.emit("sync:folder-set",{handle:t}),t}catch(e){return"AbortError"!==e?.name&&this.ui?.showToast(Q.t("failed_to_set_sync_folder",{error:e.message}),"error"),null}}async getSyncFolderHandle(){try{return await this.fs.getDirectoryHandle(Se)}catch(e){return null}}async ensurePermission(e){if(!e)return!1;try{const t={mode:"readwrite"};return"granted"===await e.queryPermission(t)||"granted"===await e.requestPermission(t)}catch(e){return!1}}async syncProject(e="auto"){const t=await this.getSyncFolderHandle();if(t)if(await this.ensurePermission(t))try{await(window.stoExport?.syncToFolder(t));const i=this.storage?.getSettings()||{},a=i.autoSync,s=i.autoSyncInterval||"change";("manual"===e||!(a&&"change"===s))&&this.ui?.showToast(Q.t("project_synced_successfully"),"success"),o.emit("project-synced")}catch(e){this.ui?.showToast(Q.t("failed_to_sync_project",{error:e.message}),"error")}else this.ui?.showToast(Q.t("permission_denied_to_folder"),"error");else this.ui?.showToast(Q.t("no_sync_folder_selected"),"warning")}}class Ae extends oe{constructor({storage:e,eventBus:t,i18n:i,ui:a}={}){super(t),this.componentName="KeyService",this.storage=e,this.i18n=i,this.ui=a,this.selectedKey=null,this.currentEnvironment="space",this.currentProfile=null,this.cache={currentProfile:null,currentEnvironment:"space",keys:{},builds:{space:{keys:{}},ground:{keys:{}}},aliases:{}},this.validKeys=this.generateValidKeys(),this.eventBus&&(this.respond("key:get-selected",()=>this.selectedKey),this.respond("key:add",({key:e}={})=>this.addKey(e)),this.addEventListener("key:delete",({key:e}={})=>this.deleteKey(e)),this.respond("key:duplicate-with-name",({sourceKey:e,newKey:t}={})=>this.duplicateKeyWithName(e,t)))}async init(){super.init(),this.setupEventListeners()}setSelectedKey(e){this.selectedKey=e}setCurrentEnvironment(e){this.currentEnvironment=e,this.cache.currentEnvironment=e,this.cache.keys=this.cache.builds[e]?.keys||{}}setCurrentProfile(e){this.currentProfile=e,this.cache.currentProfile=e}getCurrentProfileId(){return this.currentProfile}setupEventListeners(){this.eventBus&&(this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("keys:changed",{keys:this.cache.keys}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.cache.currentProfile=e,this.currentProfile=e,this.cache.currentEnvironment=i||"space",this.currentEnvironment=this.cache.currentEnvironment,this.selectedKey=null,this.updateCacheFromProfile(t),this.emit("keys:changed",{keys:this.cache.keys})}),this.addEventListener("environment:changed",({environment:e})=>{e&&(this.cache.currentEnvironment=e,this.currentEnvironment=e,this.cache.keys=this.cache.builds[e]?.keys||{},this.emit("keys:changed",{keys:this.cache.keys}))}),this.addEventListener("key-selected",({key:e,name:t}={})=>{this.selectedKey=e||t||null}))}updateCacheFromProfile(e){e&&(this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{},this.cache.aliases=e.aliases||{})}getCurrentProfile(){return this.cache.currentProfile?{id:this.cache.currentProfile,builds:this.cache.builds,keys:this.cache.keys,aliases:this.cache.aliases,environment:this.cache.currentEnvironment}:null}async addKey(e){if(!await this.isValidKeyName(e))return this.ui?.showToast?.(this.i18n?.t?.("invalid_key_name")||"Invalid key name","error"),!1;if(!this.cache.currentProfile)return this.ui?.showToast?.(this.i18n?.t?.("no_profile_selected")||"No active profile","error"),!1;if(this.cache.keys[e])return this.ui?.showToast?.(this.i18n?.t?.("key_already_exists",{keyName:e})||"Key already exists","warning"),!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{builds:{[this.cache.currentEnvironment]:{keys:{[e]:[]}}}}}),this.selectedKey=e,this.emit("key-added",{key:e}),this.ui?.showToast?.(this.i18n?.t?.("key_added")||"Key added","success"),!0}catch(e){return this.ui?.showToast?.(this.i18n?.t?.("failed_to_add_key")||"Failed to add key","error"),!1}}async deleteKey(e){if(!this.cache.currentProfile||!this.cache.keys[e])return!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,delete:{builds:{[this.cache.currentEnvironment]:{keys:[e]}}}}),this.selectedKey===e&&(this.selectedKey=null),this.emit("key-deleted",{key:e}),!0}catch(e){return!1}}async duplicateKey(e){if(!this.cache.currentProfile||!this.cache.keys[e])return!1;const t=this.cache.keys[e];if(!t||0===t.length)return!1;try{let i=`${e}_copy`,a=1;for(;this.cache.keys[i];)i=`${e}_copy_${a}`,a++;const s=t.map(e=>({...e,id:this.generateKeyId()}));return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{builds:{[this.cache.currentEnvironment]:{keys:{[i]:s}}}}}),this.emit("key-duplicated",{from:e,to:i}),!0}catch(e){return!1}}async duplicateKeyWithName(e,t){if(!e||!t)return!1;if(!this.cache.keys[e])return!1;if(!await this.isValidKeyName(t))return!1;if(this.cache.keys[t])return!1;const i=this.cache.keys[e];try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{builds:{[this.cache.currentEnvironment]:{keys:{[t]:JSON.parse(JSON.stringify(i))}}}}}),this.cache.keys[t]=JSON.parse(JSON.stringify(i)),this.emit("keys:changed",{keys:this.cache.keys}),this.emit("key-duplicated",{from:e,to:t}),!0}catch(e){return!1}}async isValidKeyName(e){if(!e||"string"!=typeof e)return!1;try{return(await this.request("data:get-key-name-pattern")||/^[A-Za-z0-9_+]+$/).test(e)&&e.length<=20}catch(t){return/^[A-Za-z0-9_+]+$/.test(e)&&e.length<=20}}async isValidAliasName(e){try{return(await this.request("data:get-alias-name-pattern")||/^[A-Za-z0-9_]+$/).test(e)}catch(t){return/^[A-Za-z0-9_]+$/.test(e)}}isValidKey(e){return!(!e||"string"!=typeof e||!Array.isArray(this.validKeys))&&this.validKeys.some(t=>t.toLowerCase()===e.toLowerCase())}generateValidKeys(){const e=[];for(let t=1;t<=12;t++)e.push(`F${t}`),e.push(`Alt+F${t}`);e.push("Space","Tab","Enter","Shift+Space");for(let t=65;t<=90;t++){const i=String.fromCharCode(t);e.push(i),e.push(`Ctrl+${i}`),e.push(`Control+${i}`),e.push(`Alt+${i}`),e.push(`Shift+${i}`)}for(let t=0;t<=9;t++)e.push(String(t)),e.push(`Ctrl+${t}`),e.push(`Alt+${t}`),e.push(`Shift+${t}`);return e.push("Lbutton","Rbutton","Button4","Wheelplus"),e}generateKeyId(){return`key_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}onInit(){}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateMirroredCommandString(e){return se(this.eventBus,"fileops:generate-mirrored-commands",{commands:e})}detectAndUnmirrorCommands(e){return se(this.eventBus,"fileops:detect-unmirror-commands",{commandString:e})}parseCommandString(e){return se(this.eventBus,"parser:parse-command-string",{commandString:e}).then(e=>e.commands)}parseKeybindFile(e){return se(this.eventBus,"fileops:parse-keybind-file",{content:e})}importKeybindFile(e){const t=this.currentProfile,i=this.currentEnvironment||"space";return se(this.eventBus,"import:keybind-file",{content:e,profileId:t,environment:i})}importAliasFile(e){const t=this.currentProfile;return se(this.eventBus,"import:alias-file",{content:e,profileId:t})}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const s=/^\d+$/.test(e),n=/^\d+$/.test(t);if(s&&n)return parseInt(e)-parseInt(t);if(s&&!n)return-1;if(!s&&n)return 1;const r=/^[A-Z]$/.test(e),o=/^[A-Z]$/.test(t);if(r&&o)return e.localeCompare(t);if(r&&!o)return-1;if(!r&&o)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}exportProfile(e){return se(this.eventBus,"fileops:generate-keybind-file",{profile:e})}validateKeybind(e,t=[]){const i=[];return this.isValidKey(e)||i.push(`Invalid key name: ${e}`),Array.isArray(t)&&0!==t.length?(t.length>20&&i.push("Too many commands (max 20)"),t.forEach((e,t)=>{e&&"string"==typeof e.command&&e.command.trim()||i.push(`Command ${t+1} is empty`)})):i.push("At least one command is required"),{valid:0===i.length,errors:i}}suggestKeys(e=""){if(!Array.isArray(this.validKeys)||0===this.validKeys.length)return[];const t=e.toLowerCase();return this.validKeys.filter(e=>e.toLowerCase().includes(t)).sort(this.compareKeys.bind(this)).slice(0,20)}getCommonKeys(){return["Space","Tab","Enter","Escape","F1","F2","F3","Ctrl+1","Ctrl+2","Ctrl+3"].filter(e=>this.validKeys.includes(e)).sort(this.compareKeys.bind(this))}generateKeybindId(){return`keybind_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}cloneKeybind(e){return JSON.parse(JSON.stringify(e))}getProfileStats(e={}){const t=e.keys||{},i=e.aliases||{},a={totalKeys:Object.keys(t).length,totalCommands:0,totalAliases:Object.keys(i).length,commandTypes:{},mostUsedCommands:{}};return Object.values(t).forEach(e=>{Array.isArray(e)&&(a.totalCommands+=e.length,e.forEach(e=>{if(!e)return;const t=e.command||"",i=e.category||e.type||"unknown";a.commandTypes[i]=(a.commandTypes[i]||0)+1,t&&(a.mostUsedCommands[t]=(a.mostUsedCommands[t]||0)+1)}))}),a}handleKeybindFileImport(e){if(!e||!e.target||!e.target.files||0===e.target.files.length)return;const t=e.target.files[0],i=new FileReader;i.onload=e=>{const t=e.target.result;this.importKeybindFile(t)},i.readAsText(t),e.target.value=""}async detectCommandType(e){if(!e||"string"!=typeof e)return"custom";try{const t=await this.request("parser:parse-command-string",{commandString:e.trim(),options:{generateDisplayText:!1}});if(t.commands&&t.commands.length>0)return t.commands[0].category||"custom"}catch(e){}return"custom"}getCurrentState(){return{selectedKey:this.selectedKey,currentProfile:this.cache.currentProfile,currentEnvironment:this.cache.currentEnvironment,keys:this.getKeys()}}getKeys(){return Object.keys(this.cache.keys)}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.cache.currentProfile=e.id,this.currentProfile=e.id,this.cache.currentEnvironment=e.environment||"space",this.currentEnvironment=this.cache.currentEnvironment,this.updateCacheFromProfile(e),this.emit("keys:changed",{keys:this.cache.keys})}"KeyService"===e&&(this.selectedKey=t.selectedKey??this.selectedKey)}}}class Ee extends oe{constructor({eventBus:e,storage:t,i18n:i,ui:a}={}){super(e),this.componentName="FileOperationsService",this.storage=t,this.i18n=i,this.ui=a}setupRequestHandlers(){this.eventBus&&(this.respond("fileops:parse-keybind-file",({content:e})=>this.parseKeybindFile(e)),this.respond("fileops:import-keybind-file",({content:e,profileId:t,environment:i,options:a={}})=>this.importKeybindFile(e,t,i,a)),this.respond("fileops:import-alias-file",({content:e,profileId:t,options:i={}})=>this.importAliasFile(e,t,i)),this.respond("fileops:validate-keybind-file",({content:e})=>this.validateKeybindFile(e)),this.respond("fileops:generate-command-preview",({key:e,commands:t,stabilize:i=!1})=>this.generateCommandPreview(e,t,i)),this.respond("fileops:generate-mirrored-commands",async({commands:e=[]})=>{if(!Array.isArray(e)||0===e.length)return"";const t=e.map(e=>"string"==typeof e?{command:e}:e&&"string"==typeof e.command?e:null).filter(Boolean);if(t.length<=1)return(await this.normalizeCommandsForDisplay(t)).join(" $$ ");const i=await this.normalizeCommandsForDisplay(t);return[...i,...i.slice(0,-1).reverse()].join(" $$ ")}))}async parseKeybindFile(e){const t={},i={},a=[];if(!e||"string"!=typeof e)return{keybinds:t,aliases:i,errors:["Invalid file content"]};const s=e.split("\n");for(let e=0;e<s.length;e++){const i=s[e].trim();if(i&&!i.startsWith("//"))try{const s=i.match(/^(\S+)\s+"([^"]+)"/);if(s){const[,e,i]=s,a=await this.request("parser:parse-command-string",{commandString:i});t[e]={raw:i,commands:a.commands};continue}if(i.startsWith("alias ")){a.push(`Line ${e+1}: Alias definitions are not permitted in keybind files`);continue}}catch(t){a.push(`Line ${e+1}: Parse error: ${t.message}`)}}return{keybinds:t,aliases:i,errors:a}}async parseAliasFile(e){const t={},i=[];if(!e||"string"!=typeof e)return{aliases:t,errors:["Invalid file content"]};const a=e.split("\n");for(let e=0;e<a.length;e++){const s=a[e].trim();if(s&&!s.startsWith("//"))try{const a=s.match(/^alias\s+(\w+)\s+"([^"]+)"/);if(a){const[,e,i]=a;t[e]={commands:i};continue}const n=s.match(/^alias\s+(\w+)\s+<&\s*(.+?)\s*&>/);if(n){const[,e,i]=n;t[e]={commands:i};continue}i.push(`Line ${e+1}: Non-alias content found: ${s}`)}catch(t){i.push(`Line ${e+1}: Parse error: ${t.message}`)}}return{aliases:t,errors:i}}async importKeybindFile(e,t,i,a={}){try{const a=await this.parseKeybindFile(e),s=Object.keys(a.keybinds).length;if(0===s)return this.showToast(this.i18n?.t?.("no_keybinds_found_in_file")||"No keybinds found","warning"),{success:!1,error:"No keybinds found"};if(!this.storage)return{success:!1,error:"Storage not available"};if(!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};let n=this.storage.getProfile(t)||{builds:{space:{keys:{}},ground:{keys:{}}}};n.builds||(n.builds={space:{keys:{}},ground:{keys:{}}});const r=i||"space";n.builds[r]||(n.builds[r]={keys:{}});const o=n.builds[r].keys;for(const[e,t]of Object.entries(a.keybinds)){const i=t.raw;if((await this.request("parser:parse-command-string",{commandString:i})).isMirrored){const t=this.extractOriginalFromMirrored(i),a=await this.request("parser:parse-command-string",{commandString:t.join(" $$ ")});o[e]=be(a.commands),n.keybindMetadata||(n.keybindMetadata={}),n.keybindMetadata[r]||(n.keybindMetadata[r]={}),n.keybindMetadata[r][e]||(n.keybindMetadata[r][e]={}),n.keybindMetadata[r][e].stabilizeExecutionOrder=!0}else o[e]=be(t.commands)}this.storage.saveProfile(t,n),this.emit("profile-updated",{profileId:t,environment:r}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0);const c=Object.keys(a.aliases).length,l=c>0?this.i18n?.t?.("import_completed_with_ignored_aliases",{keyCount:s,ignoredAliases:c})||`Import completed: ${s} keybinds (${c} aliases ignored - use Import Aliases)`:this.i18n?.t?.("import_completed",{keyCount:s})||`Import completed: ${s} keybinds`;return this.showToast(l,"success"),{success:!0,imported:{keys:s},errors:a.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_keybind_file",{error:e.message})||`Failed to import keybind file: ${e.message}`,"error"),{success:!1,error:e.message}}}extractOriginalFromMirrored(e){const t=e.split(/\s*\$\$\s*/);if(t.length<3||t.length%2==0)return t;const i=Math.floor(t.length/2);return t.slice(0,i+1)}async normalizeCommandsForDisplay(e){const t=[];for(const i of e)try{const e=await this.request("parser:parse-command-string",{commandString:i.command,options:{generateDisplayText:!1}});if(e.commands&&e.commands[0]){const a=e.commands[0];if(a.signature&&(a.signature.includes("TrayExecByTray")||a.signature.includes("TrayExecByTrayWithBackup"))&&a.parameters){const e=a.parameters,i=void 0!==e.active?e.active:1;if(a.signature.includes("TrayExecByTrayWithBackup"))if(1===i){const i=(e.baseCommand||"TrayExecByTrayWithBackup").replace(/^\+/,"");t.push(`+${i} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`)}else{const a=(e.baseCommand||"TrayExecByTrayWithBackup").replace(/^\+/,"");t.push(`${a} ${i} ${e.tray} ${e.slot} ${e.backup_tray} ${e.backup_slot}`)}else if(1===i){const i=(e.baseCommand||"TrayExecByTray").replace(/^\+/,"");t.push(`+${i} ${e.tray} ${e.slot}`)}else{const a=(e.baseCommand||"TrayExecByTray").replace(/^\+/,"");t.push(`${a} ${i} ${e.tray} ${e.slot}`)}}else t.push(i.command)}else t.push(i.command)}catch(e){t.push(i.command)}return t}async importAliasFile(e,t,i={}){try{const i=await this.parseAliasFile(e),a=Object.keys(i.aliases).length;if(0===a)return this.showToast(this.i18n?.t?.("no_aliases_found_in_file")||"No aliases found","warning"),{success:!1,error:"No aliases found"};if(!this.storage||!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};const s=this.storage.getProfile(t)||{aliases:{}};return s.aliases||(s.aliases={}),Object.entries(i.aliases).forEach(([e,t])=>{const i=t.commands||"",a=i.trim()?i.trim().split(/\s*\$\$\s*/).filter(e=>e.trim()):[];s.aliases[e]={commands:a,description:t.description||""}}),this.storage.saveProfile(t,s),this.emit("profile-updated",{profileId:t}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("aliases_imported_successfully",{aliasCount:a})||`Successfully imported ${a} aliases`,"success"),{success:!0,imported:{aliases:a},errors:i.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_aliases",{error:e.message})||`Failed to import aliases: ${e.message}`,"error"),{success:!1,error:e.message}}}async validateKeybindFile(e){try{const t=await this.parseKeybindFile(e);return{valid:!0,stats:{keybinds:Object.keys(t.keybinds).length,aliases:Object.keys(t.aliases).length,errors:t.errors.length},errors:t.errors}}catch(e){return{valid:!1,error:e.message}}}generateCommandPreview(e,t,i=!1){if(!Array.isArray(t)||0===t.length)return`${e} ""`;let a;if(i&&t.length>1)if(this.legacyHandler&&"function"==typeof this.legacyHandler.generateMirroredCommandString)a=this.legacyHandler.generateMirroredCommandString(t);else{const e=t.map(e=>"string"==typeof e?e:e.command);a=[...e,...e.slice(0,-1).reverse()].join(" $$ ")}else a=t.map(e=>e.command||e).join(" $$ ");return`${e} "${a}"`}showToast(e,t="info"){this.ui?.showToast?this.ui.showToast(e,t):"undefined"!=typeof window&&window.stoUI?.showToast&&window.stoUI.showToast(e,t)}onInit(){this.setupRequestHandlers(),this.emit("fileops-ready")}}const $e=globalThis.STO_DATA||{};class Fe{constructor(){this.keybindPatterns={standard:/^([a-zA-Z0-9_+\-\s\[\]]+)\s+"([^"]*)"(?:\s+"([^"]*)")?$/,bind:/^\/bind\s+([a-zA-Z0-9_+\-\s\[\]]+)\s+(.+)$/,alias:/^alias\s+([a-zA-Z_][a-zA-Z0-9_]*)\s+(?:"([^"]+)"|<&\s+(.+?)\s+&>)$/,comment:/^[#;].*$/},this.validKeys=this.generateValidKeys()}generateValidKeys(){const e=new Set;for(let t=1;t<=12;t++)e.add(`F${t}`);for(let t=0;t<=9;t++)e.add(t.toString());for(let t=65;t<=90;t++)e.add(String.fromCharCode(t));["Space","Tab","Enter","Escape","Backspace","Delete","Insert","Home","End","PageUp","PageDown","Up","Down","Left","Right","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","NumPadEnter","NumPadPlus","NumPadMinus","NumPadMultiply","NumPadDivide","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","divide","multiply","Button4","Button5","Button6","Button7","Button8","Lbutton","Rbutton","Mbutton","Leftdrag","Rightdrag","Middleclick","Mousechord","Wheelplus","Wheelminus","Semicolon","Equals","Comma","Minus","Period","Slash","Grave","LeftBracket","Backslash","RightBracket","Quote","[","]"].forEach(t=>e.add(t));const t=Array.from(e);return["Ctrl","Alt","Shift","Control"].forEach(i=>{t.forEach(t=>e.add(`${i}+${t}`))}),e.add("Ctrl+Alt"),e.add("Ctrl+Shift"),e.add("Alt+Shift"),e.add("Control+Alt"),e.add("Control+Shift"),t.forEach(t=>{e.add(`Ctrl+Alt+${t}`),e.add(`Ctrl+Shift+${t}`),e.add(`Alt+Shift+${t}`),e.add(`Control+Alt+${t}`),e.add(`Control+Shift+${t}`)}),Array.from(e).sort()}parseKeybindFile(e){const t=e.split("\n"),i={keybinds:{},aliases:{},comments:[],errors:[]};return t.forEach((e,t)=>{const a=e.trim();if(a)try{if(this.keybindPatterns.comment.test(a))i.comments.push({line:t+1,content:a});else if(this.keybindPatterns.alias.test(a)){const e=a.match(this.keybindPatterns.alias);if(e){const[,a,s,n]=e,r=s||n;i.aliases[a]={name:a,commands:r,line:t+1}}}else if(this.keybindPatterns.standard.test(a)){const e=a.match(this.keybindPatterns.standard);if(e){const[,a,s,n]=e,r=this.parseCommandString(s);i.keybinds[a]={key:a,commands:r,line:t+1,raw:s,optionalParam:n||null}}}else if(this.keybindPatterns.bind.test(a)){const e=a.match(this.keybindPatterns.bind);if(e){const[,a,s]=e,n=s.replace(/^"(.*)"$/,"$1"),r=this.parseCommandString(n);i.keybinds[a]={key:a,commands:r,line:t+1,raw:n}}}else i.errors.push({line:t+1,content:a,error:"Invalid keybind format"})}catch(e){i.errors.push({line:t+1,content:a,error:e.message})}}),i}generateMirroredCommandString(e){if(!e||e.length<=1)return(e||[]).map(e=>e.command||e).join(" $$ ");const t=e.map(e=>e.command||e),i=[...t].slice(0,-1).reverse();return[...t,...i].join(" $$ ")}detectAndUnmirrorCommands(e){if(!e||"string"!=typeof e)return{isMirrored:!1,originalCommands:[]};const t=e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e);if(t.length<=1)return{isMirrored:!1,originalCommands:t};if(t.length<3||t.length%2==0)return{isMirrored:!1,originalCommands:t};const i=Math.floor(t.length/2),a=t.slice(0,i+1),s=t.slice(i+1),n=a.slice(0,-1).reverse();return s.length===n.length&&s.every((e,t)=>e===n[t])?{isMirrored:!0,originalCommands:a}:{isMirrored:!1,originalCommands:t}}parseCommandString(e){return e.split(/\s*\$\$\s*/).map(e=>e.trim()).map((e,t)=>{const i={command:e,type:this.detectCommandType(e),icon:this.getCommandIcon(e),text:this.getCommandText(e),id:`imported_${Date.now()}_${t}`};if(/TrayExecByTray/.test(e)){const t=e.match(/(?:\+)?(?:STO)?TrayExecByTray\s+(\d+)\s+(\d+)/i);if(t){const e=parseInt(t[1]),a=parseInt(t[2]);i.parameters={tray:e,slot:a},i.text=`Execute Tray ${e+1} Slot ${a+1}`}}else if(e.includes('"')){const t=e.match(/^(\w+)\s+"([^"]+)"$/);t&&(i.parameters={message:t[2]},i.text=`${i.text}: ${t[2]}`)}return i})}detectCommandType(e){if(!e||"string"!=typeof e)return"custom";const t=e.toLowerCase().trim();return t.includes("+stotrayexecbytray")?"tray":t.startsWith("say ")||t.startsWith("team ")||t.startsWith("zone ")||t.startsWith("tell ")||t.includes('"')?"communication":t.includes("+power_exec")||t.includes("distribute_shields")||t.includes("reroute_shields")?"power":t.includes("+fullimpulse")||t.includes("+reverse")||t.includes("throttle")||t.includes("+turn")||t.includes("+up")||t.includes("+down")||t.includes("+left")||t.includes("+right")||t.includes("+forward")||t.includes("+backward")||t.includes("follow")?"movement":t.includes("cam")||t.includes("look")||t.includes("zoom")?"camera":t.includes("fire")||t.includes("attack")||"fireall"===t||"firephasers"===t||"firetorps"===t||"firephaserstorps"===t?"combat":t.includes("target")||"target_enemy_near"===t||"target_self"===t||"target_friend_near"===t||"target_clear"===t?"targeting":t.includes("+gentoggle")||"screenshot"===t||t.includes("hud")||"interactwindow"===t?"system":"custom"}getCommandIcon(e){return{targeting:"🎯",combat:"🔥",tray:"⚡",power:"🔋",communication:"💬",movement:"🚀",camera:"📹",system:"⚙️"}[this.detectCommandType(e)]||"⚙️"}getCommandText(e){if(e.includes("+STOTrayExecByTray")){const t=e.match(/\+STOTrayExecByTray\s+(\d+)\s+(\d+)/);if(t)return`Execute Tray ${parseInt(t[1])+1} Slot ${parseInt(t[2])+1}`}if($e.commands)for(const[,t]of Object.entries($e.commands))for(const[,i]of Object.entries(t.commands))if(i.command===e)return i.name;return e.replace(/[_+]/g," ").replace(/([A-Z])/g," $1").trim()}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const s=/^\d+$/.test(e),n=/^\d+$/.test(t);if(s&&n)return parseInt(e)-parseInt(t);if(s&&!n)return-1;if(!s&&n)return 1;const r=/^[A-Z]$/.test(e),o=/^[A-Z]$/.test(t);if(r&&o)return e.localeCompare(t);if(r&&!o)return-1;if(!r&&o)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}getProfileStats(e){const t={totalKeys:Object.keys(e.keys||{}).length,totalCommands:0,totalAliases:Object.keys(e.aliases||{}).length,commandTypes:{},mostUsedCommands:{}};return Object.values(e.keys||{}).forEach(e=>{t.totalCommands+=e.length,e.forEach(e=>{t.commandTypes[e.type]=(t.commandTypes[e.type]||0)+1,t.mostUsedCommands[e.command]=(t.mostUsedCommands[e.command]||0)+1})}),t}generateFileHeader(e,t=null){const i=(new Date).toLocaleString(),a=this.getProfileStats(e),s=t||this.generateFileName(e,"txt");return`; ================================================================\n; ${e.name} - STO Keybind Configuration\n; ================================================================\n; Mode: ${(e.currentEnvironment||"space").toUpperCase()}\n; Generated: ${i}\n; Created by: STO Tools Keybind Manager v${$e.settings.version}\n;\n; Keybind Statistics:\n; - Keys bound: ${a.totalKeys}\n; - Total commands: ${a.totalCommands}\n;\n; Note: Aliases are exported separately\n; To use this file in Star Trek Online:\n; 1. Save this file to your STO Live folder\n; 2. In game, type: /bind_load_file ${s}\n; ================================================================\n\n`}generateAliasFile(e){if(!e||0===Object.keys(e).length)return"";let t="; Command Aliases\n; ================================================================\n; Aliases allow you to create custom commands that execute\n; multiple commands in sequence. Use them in keybinds like any\n; other command.\n; ================================================================\n\n";return Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,i])=>{t+=ue(e,i),t+="\n"}),t}generateKeybindSection(e,t={}){if(!e||0===Object.keys(e).length)return"; No keybinds defined\n\n";let i="; Keybind Commands\n; ================================================================\n; Each line binds a key to one or more commands.\n; Multiple commands are separated by $$";i+="\n; ================================================================\n\n";const a=Object.keys(e).sort(this.compareKeys.bind(this));if(t.groupByType){const s=this.groupKeysByType(a,e);Object.entries(s).forEach(([a,s])=>{0!==s.length&&(i+=`; ${a}\n; ${"-".repeat(a.length)}\n`,s.forEach(a=>{i+=this.ne(a,e[a],t)}),i+="\n")})}else a.forEach(a=>{i+=this.ne(a,e[a],t)});return i+="\n",i}ne(e,t,i={}){if(!t||0===t.length)return"";const a=Array.isArray(t)?t.filter(e=>e&&("string"==typeof e.command||"string"==typeof e)):[];if(0===a.length)return"";let s,n=!1;if(i.profile&&i.profile.keybindMetadata&&i.environment&&i.profile.keybindMetadata[i.environment]){const t=i.profile.keybindMetadata[i.environment];n=!!(t&&t[e]&&t[e].stabilizeExecutionOrder)}return s=n?this.generateMirroredCommandString(a):a.map(e=>e.command||e).join(" $$ "),`${e} "${s}"\n`}groupKeysByType(e,t){const i={"Function Keys":[],"Number Keys":[],"Letter Keys":[],"Special Keys":[],"Modifier Combinations":[]};return e.forEach(e=>{/^F\d+$/.test(e)?i["Function Keys"].push(e):/^\d+$/.test(e)?i["Number Keys"].push(e):/^[A-Z]$/.test(e)?i["Letter Keys"].push(e):e.includes("+")?i["Modifier Combinations"].push(e):i["Special Keys"].push(e)}),i}generateFileFooter(){return"; ================================================================\n; End of keybind file\n; ================================================================\n;\n; Additional STO Commands Reference:\n;\n; Targeting:\n;   target_nearest_enemy    - Target closest hostile\n;   target_nearest_friend   - Target closest friendly\n;   target_self            - Target your own ship\n;\n; Combat:\n;   FireAll               - Fire all weapons\n;   FirePhasers          - Fire beam weapons only\n;   FireTorps            - Fire torpedo weapons only\n;\n; Shield Management:\n;   +power_exec <ability> - Execute bridge officer ability\n;   Examples: +power_exec Distribute_Shields\n;\n; Tray Execution:\n;   +STOTrayExecByTray <tray> <slot> - Execute ability from tray\n;   Example: +STOTrayExecByTray 0 0  (Tray 1, Slot 1)\n;\n; For more commands and help, visit the STO Wiki or community forums.\n; ================================================================\n"}generateFileName(e,t,i){const a=(new Date).toISOString().replace(/[:.]/g,"-"),s=i||e.currentEnvironment||"space";return`${e.name.replace(/\s+/g,"_")}_${s}_${a}.${t}`}generateKeybindFile(e,t={}){let i="";return i+=this.generateFileHeader(e,t.syncFilename),i+=this.generateKeybindSection(e.keys,{...t,profile:e,environment:t.environment||e.currentEnvironment||"space"}),i+=this.generateFileFooter(),i}}class Be extends oe{constructor({eventBus:e,storage:t,i18n:i,ui:a}={}){super(e),this.componentName="ImportService",this.storage=t,this.i18n=i,this.ui=a,this.fileHandler=new Fe}setupRequestHandlers(){this.eventBus&&(this.respond("import:keybind-file",({content:e,profileId:t,environment:i,options:a={}})=>this.importKeybindFile(e,t,i,a)),this.respond("import:alias-file",({content:e,profileId:t,options:i={}})=>this.importAliasFile(e,t,i)),this.respond("import:profile-file",({content:e,options:t={}})=>this.importProfileFile(e,t)),this.respond("import:project-file",({content:e,options:t={}})=>this.importProjectFile(e,t)),this.respond("import:from-file",({file:e})=>this.importFromFile(e)),this.respond("import:validate-keybind-file",({content:e})=>this.validateKeybindFile(e)),this.respond("import:validate-profile-file",({content:e})=>this.validateProfileFile(e)))}async parseKeybindFile(e){const t={},i={},a=[];if(!e||"string"!=typeof e)return{keybinds:t,aliases:i,errors:["Invalid file content"]};const s=e.split("\n");for(let e=0;e<s.length;e++){const n=s[e].trim();if(n&&!n.startsWith(";")&&!n.startsWith("#"))try{const s=n.match(/^(\S+)\s+"([^"]+)"/);if(s){const[,e,i]=s,a=await this.request("parser:parse-command-string",{commandString:i});t[e]={raw:i,commands:a.commands};continue}const r=n.match(/^alias\s+(\w+)\s+"([^"]+)"/);if(r){const[,e,t]=r;i[e]={commands:t};continue}const o=n.match(/^alias\s+(\w+)\s+<&\s*(.+?)\s*&>/);if(o){const[,e,t]=o;i[e]={commands:t};continue}n.length>0&&a.push(`Line ${e+1}: Unrecognized format: ${n}`)}catch(t){a.push(`Line ${e+1}: Parse error: ${t.message}`)}}return{keybinds:t,aliases:i,errors:a}}async importKeybindFile(e,t,i,a={}){try{const a=await this.parseKeybindFile(e),s=Object.keys(a.keybinds).length;if(0===s)return this.showToast(this.i18n?.t?.("no_keybinds_found_in_file")||"No keybinds found","warning"),{success:!1,error:"No keybinds found"};if(!this.storage)return{success:!1,error:"Storage not available"};if(!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};let n=this.storage.getProfile(t)||{builds:{space:{keys:{}},ground:{keys:{}}}};n.builds||(n.builds={space:{keys:{}},ground:{keys:{}}});const r=i||"space";n.builds[r]||(n.builds[r]={keys:{}});const o=n.builds[r].keys;for(const[e,t]of Object.entries(a.keybinds)){const i=t.raw;if((await this.request("parser:parse-command-string",{commandString:i})).isMirrored){const t=this.extractOriginalFromMirrored(i),a=be((await this.request("parser:parse-command-string",{commandString:t.join(" $$ ")})).commands),s=[];for(const e of a){const t=await ge(e,{eventBus:this.eventBus});s.push(t)}o[e]=s,n.keybindMetadata||(n.keybindMetadata={}),n.keybindMetadata[r]||(n.keybindMetadata[r]={}),n.keybindMetadata[r][e]||(n.keybindMetadata[r][e]={}),n.keybindMetadata[r][e].stabilizeExecutionOrder=!0}else{const i=be(t.commands),a=[];for(const e of i){const t=await ge(e,{eventBus:this.eventBus});a.push(t)}o[e]=a}}this.storage.saveProfile(t,n),this.emit("profile:updated",{profileId:t,profile:n,environment:r}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0);const c=Object.keys(a.aliases).length,l=c>0?this.i18n?.t?.("import_completed_with_ignored_aliases",{keyCount:s,ignoredAliases:c})||`Import completed: ${s} keybinds (${c} aliases ignored - use Import Aliases)`:this.i18n?.t?.("import_completed",{keyCount:s})||`Import completed: ${s} keybinds`;return this.showToast(l,"success"),{success:!0,imported:{keys:s},errors:a.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_keybind_file",{error:e.message})||`Failed to import keybind file: ${e.message}`,"error"),{success:!1,error:e.message}}}async importAliasFile(e,t,i={}){try{const i=await this.parseKeybindFile(e),a=Object.keys(i.aliases).length;if(0===a)return this.showToast(this.i18n?.t?.("no_aliases_found_in_file")||"No aliases found","warning"),{success:!1,error:"No aliases found"};if(!this.storage||!t)return this.showToast(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected","warning"),{success:!1,error:"No active profile"};const s=this.storage.getProfile(t)||{aliases:{}};s.aliases||(s.aliases={});for(const[e,t]of Object.entries(i.aliases)){const i=t.commands||"",a=i.trim()?i.trim().split(/\s*\$\$\s*/).filter(e=>e.trim()):[],n=[];for(const e of a){const t=await ge(e,{eventBus:this.eventBus});n.push(t)}s.aliases[e]={commands:n,description:t.description||""}}return this.storage.saveProfile(t,s),this.emit("profile:updated",{profileId:t,profile:s}),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("aliases_imported_successfully",{aliasCount:a})||`Successfully imported ${a} aliases`,"success"),{success:!0,imported:{aliases:a},errors:i.errors}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_aliases",{error:e.message})||`Failed to import aliases: ${e.message}`,"error"),{success:!1,error:e.message}}}async importProfileFile(e,t={}){try{const i=JSON.parse(e);if(!i.name)throw new Error("Invalid profile file: missing profile name");const a=t.profileId||this.generateProfileId(i.name),s=this.sanitizeProfileData(i);return this.storage.saveProfile(a,s),"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("profile_imported_successfully",{profileName:s.name})||`Profile "${s.name}" imported successfully`,"success"),{success:!0,profileId:a,profile:s}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_profile",{error:e.message})||`Failed to import profile: ${e.message}`,"error"),{success:!1,error:e.message}}}async importProjectFile(e,t={}){try{const i=JSON.parse(e);if(!i.data||"project"===!i.type)throw new Error("Invalid project file format");const a=i.data;let s=0,n=!1;if(a.profiles)for(const[e,t]of Object.entries(a.profiles)){const i=this.sanitizeProfileData(t);this.storage.saveProfile(e,i),s++}if(a.settings&&!1!==t.importSettings){const e=this.storage.getSettings()||{},t={...e,...a.settings,version:e.version||a.settings.version,firstRun:e.firstRun};this.storage.saveSettings(t),n=!0}return"undefined"!=typeof globalThis&&globalThis.app?.setModified&&globalThis.app.setModified(!0),this.showToast(this.i18n?.t?.("project_imported_successfully",{profileCount:s})||`Project imported: ${s} profiles${n?" and settings":""}`,"success"),{success:!0,imported:{profiles:s,settings:n}}}catch(e){return this.showToast(this.i18n?.t?.("failed_to_import_project",{error:e.message})||`Failed to import project: ${e.message}`,"error"),{success:!1,error:e.message}}}async importFromFile(e){const t=await e.text(),i=e.name.toLowerCase();if(!i.endsWith(".json")){if(i.endsWith(".txt")){const e=this.getCurrentProfileId();if(!e)throw new Error(this.i18n?.t?.("no_profile_selected_for_import")||"No profile selected for import");return this.importKeybindFile(t,e)}throw new Error(this.i18n?.t?.("import_failed_unsupported_format")||"Unsupported file format")}try{const e=JSON.parse(t);if("project"===e.type)return this.importProjectFile(t);if(e.name)return this.importProfileFile(t);throw new Error("Unknown JSON file format")}catch(e){throw new Error(this.i18n?.t?.("import_failed_invalid_json")||"Invalid JSON file format")}}async validateKeybindFile(e){try{const t=await this.parseKeybindFile(e);return{valid:!0,stats:{keybinds:Object.keys(t.keybinds).length,aliases:Object.keys(t.aliases).length,errors:t.errors.length},errors:t.errors}}catch(e){return{valid:!1,error:e.message}}}async validateProfileFile(e){try{const t=JSON.parse(e);return t.name?{valid:!0,profile:{name:t.name,mode:t.mode||t.currentEnvironment||"space",hasKeybinds:!!(t.builds||t.keys||t.keybinds),hasAliases:!!(t.aliases&&Object.keys(t.aliases).length>0)}}:{valid:!1,error:"Missing profile name"}}catch(e){return{valid:!1,error:"Invalid JSON format"}}}sanitizeProfileData(e){const t={name:e.name,currentEnvironment:e.currentEnvironment||e.mode||"space",builds:{space:{keys:{},aliases:{}},ground:{keys:{},aliases:{}}},aliases:{},keybindMetadata:{}};if(e.builds)e.builds.space&&(t.builds.space={keys:e.builds.space.keys||{},aliases:e.builds.space.aliases||{}}),e.builds.ground&&(t.builds.ground={keys:e.builds.ground.keys||{},aliases:e.builds.ground.aliases||{}});else if(e.keys||e.keybinds){const i=e.keys||e.keybinds||{};t.builds.space.keys=i}return e.aliases&&(t.aliases=e.aliases),e.keybindMetadata&&(t.keybindMetadata=e.keybindMetadata),t}generateProfileId(e){return`${e.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${Date.now()}`}getCurrentProfileId(){if("undefined"!=typeof globalThis&&globalThis.app?.getCurrentProfileId)return globalThis.app.getCurrentProfileId();const e=this.storage?.getSettings?.();return e?.currentProfile}extractOriginalFromMirrored(e){const t=e.split(/\s*\$\$\s*/);if(t.length<3||t.length%2==0)return t;const i=Math.floor(t.length/2);return t.slice(0,i+1)}showToast(e,t="info"){this.ui?.showToast?this.ui.showToast(e,t):"undefined"!=typeof window&&window.stoUI?.showToast&&window.stoUI.showToast(e,t)}onInit(){this.setupRequestHandlers(),this.emit("import-service-ready")}}const Ie=globalThis.STO_DATA||{};class Pe extends oe{constructor({eventBus:e,storage:t}={}){super(e),this.componentName="ExportService",this.storage=t,this.fileHandler=new Fe,this.cache={profiles:{},currentProfile:null,currentEnvironment:"space"}}onInit(){this.setupRequestHandlers(),this.setupEventListeners()}setupRequestHandlers(){this.respond("export:generate-filename",async({profile:e,extension:t,environment:i})=>await this.generateFileName(e,t,i)),this.respond("export:generate-alias-filename",({profile:e,extension:t})=>this.generateAliasFileName(e,t)),this.respond("export:generate-csv-data",({profile:e})=>this.generateCSVData(e)),this.respond("export:generate-html-report",({profile:e})=>this.generateHTMLReport(e)),this.respond("export:import-from-file",async({file:e})=>await this.importFromFile(e)),this.respond("export:sanitize-profile",({profile:e})=>this.sanitizeProfileForExport(e)),this.respond("export:extract-keys",({profile:e,environment:t})=>this.extractKeys(e,t)),this.respond("export:generate-keybind-file",async({profileId:e,environment:t="space",syncMode:i=!1})=>{const a=this.getProfileFromCache(e);if(!a)throw new Error(`Profile ${e} not found in ExportService cache`);return await this.generateSTOKeybindFile(a,{environment:t,syncMode:i})}),this.respond("export:generate-alias-file",async({profileId:e})=>{const t=this.getProfileFromCache(e);if(!t)throw new Error(`Profile ${e} not found`);return await this.generateAliasFile(t)})}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e&&t&&(this.cache.profiles[e]=t)}),this.addEventListener("profile:switched",({profileId:e,environment:t,profile:i})=>{e&&(this.cache.currentProfile=e),t&&(this.cache.currentEnvironment=t),i&&(this.cache.profiles[e]=i)})}async generateSTOKeybindFile(e,t={}){const{environment:i="space",syncMode:a=!1}=t,s=this.extractKeys(e,i);if(!(s&&Object.keys(s).length>0))return`; No keybinds defined for this environment\n; Profile: ${JSON.stringify(e,null,2)}\n; Options: ${JSON.stringify(t,null,2)}\n`;const n=`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_${i}.txt`;let r=await this.generateFileHeader(e,n);return r+=await this.generateKeybindSection(s,{environment:i,profile:e,syncMode:a}),r}async generateFileHeader(e,t=null){const i=(new Date).toLocaleString(),a=e.currentEnvironment||"space",s=Object.keys(this.extractKeys(e,a)).length;return Object.keys(e.aliases||{}).length,`; ================================================================\n; ${e.name} - STO Keybind Configuration\n; ================================================================\n; Environment: ${a.toUpperCase()}\n; Generated: ${i}\n; Created by: STO Tools Keybind Manager v${Ie?.settings?.version??"unknown"}\n;\n; Keybind Statistics:\n; - Total keybinds: ${s}\n;\n; To use this keybind file in Star Trek Online:\n; 1. Save this file in your STO Live folder as a .txt file\n; 2. In-game, type: /bind_load_file ${t}\n; 3. Your keybinds will be applied immediately\n;\n; File Structure:\n; - Aliases (if any) are defined first\n; - Keybinds follow, organized by key\n; ================================================================\n\n`}async generateAliasSection(e,t={}){if(!e||0===Object.keys(e).length)return"";let i="; Command Aliases\n; ================================================================\n; Aliases allow you to create custom commands that execute\n; multiple commands in sequence. Use them in keybinds like any\n; other command.\n; ================================================================\n\n";const a=Object.entries(e).sort(([e],[t])=>e.localeCompare(t));for(const[e,s]of a){let a=Array.isArray(s.commands)?s.commands:[];if(t.aliasMetadata&&t.aliasMetadata[e]&&t.aliasMetadata[e].stabilizeExecutionOrder&&a.length>1){const e=a.map(e=>({command:e}));a=(await this.request("fileops:generate-mirrored-commands",{commands:e})).split(/\s*\$\$\s*/).filter(Boolean)}const n=[];for(const e of a){const t=await ge(e,{eventBus:this.eventBus});n.push(t)}const r=n.join(" $$ ");i+=ue(e,{...s,commands:r}),i+="\n"}return i}async generateKeybindSection(e,t={}){const{environment:i="space",syncMode:a=!1,profile:s}=t;if(!e||0===Object.keys(e).length)return"; No keybinds defined\n";let n="; ==============================================================================\n";n+=`; ${i.toUpperCase()} KEYBINDS\n`,n+="; ==============================================================================\n\n";for(const[t,a]of Object.entries(e)){let e=a;s.keybindMetadata&&s.keybindMetadata[i]&&s.keybindMetadata[i][t]&&s.keybindMetadata[i][t].stabilizeExecutionOrder&&Array.isArray(a)&&a.length>1&&(e=this.mirrorCommands(a));const r=[];for(const t of e){const e=await ge(t,{eventBus:this.eventBus});r.push(e)}n+=pe(t,r)}return n+="\n",n}generateCSVData(e){const t=[],i=e.currentEnvironment||"space",a=this.extractKeys(e,i);Object.entries(a).forEach(([e,i])=>{i.forEach((i,a)=>{const s="string"==typeof(n=i)?n:n.command;var n;t.push({key:e,order:a+1,command:s,type:i&&i.type||"",description:i&&i.text||""})})}),e.aliases&&Object.values(e.aliases).forEach(e=>{t.push({key:"ALIAS",order:"",command:e.name,type:"alias",description:e.description||""})});const s=[["Key","Command","Type","Description","Position"].join(",")];return t.forEach(e=>{s.push([this.escapeCSV(e.key),this.escapeCSV(e.command),this.escapeCSV(e.type),this.escapeCSV(e.description),this.escapeCSV(e.order)].join(","))}),s.join("\n")}escapeCSV(e){if(null==e)return"";const t=e.toString();return/[",\n]/.test(t)?'"'+t.replace(/"/g,'""')+'"':t}generateHTMLReport(e){const t=e.currentEnvironment||"space",i=this.extractKeys(e,t),a=`${e.name} – ${Q.t("html_report_title")}`;return`<!DOCTYPE html>\n<html lang="${Q.language}">\n<head>\n  <meta charset="utf-8" />\n  <title>${a}</title>\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <style>\n    body { font-family: Arial, sans-serif; margin: 20px; }\n    h1 { font-size: 24px; margin-bottom: 10px; }\n    h2 { font-size: 20px; margin-top: 20px; }\n    table { border-collapse: collapse; width: 100%; margin-top: 10px; }\n    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }\n    th { background-color: #f2f2f2; }\n    code { background-color: #eee; padding: 2px 4px; }\n    .keybind { margin-bottom: 10px; }\n    .command { background-color:#e0e0e0; padding:2px 4px; margin:1px; display:inline-block; }\n  </style>\n</head>\n<body>\n  <h1>${a}</h1>\n\n  <h2>${Q.t("keybinds")}</h2>\n  ${this.generateHTMLKeybindSection(i)}\n\n  <h2>${Q.t("aliases")}</h2>\n  ${this.generateHTMLAliasSection(e.aliases)}\n</body>\n</html>`}generateHTMLKeybindSection(e){if(!e||0===Object.keys(e).length)return"<p>No keybinds defined</p>";const t=e=>"string"==typeof e?e:e.command;let i="<table><thead><tr><th>Key</th><th>Commands</th></tr></thead><tbody>";return Object.entries(e).forEach(([e,a])=>{const s=a.map(t).filter(Boolean).map(e=>`<span class="command">${e}</span>`).join(" ");i+=`<tr><td><code>${e}</code></td><td>${s}</td></tr>`}),i+="</tbody></table>",i}generateHTMLAliasSection(e){if(!e||0===Object.keys(e).length)return"<p>No aliases defined</p>";let t="<table><thead><tr><th>Alias</th><th>Commands</th><th>Description</th></tr></thead><tbody>";return Object.values(e).forEach(e=>{const i=(Array.isArray(e.commands)?e.commands:[]).join(" $$ ");t+=`<tr>\n        <td><code>${e.name}</code></td>\n        <td><code>${i}</code></td>\n        <td>${e.description||""}</td>\n      </tr>`}),t+="</tbody></table>",t}async importFromFile(e){return await this.request("import:from-file",{file:e})}importJSONFile(e){try{const t=JSON.parse(e);if("project"===t.type)return this.request("import:project-file",{content:e});if(t.name)return this.request("import:profile-file",{content:e});throw new Error(Q.t("import_failed_invalid_format"))}catch(e){throw new Error(Q.t("import_failed_invalid_json"))}}async generateAliasFile(e){const t=e.aliases||{};if(0===Object.keys(t).length)return"; No aliases defined\n";let i=await this.generateAliasFileHeader(e);const a=Object.entries(t).sort(([e],[t])=>e.localeCompare(t));for(const[t,s]of a){let a=Array.isArray(s.commands)?s.commands:[];if(e.aliasMetadata&&e.aliasMetadata[t]&&e.aliasMetadata[t].stabilizeExecutionOrder&&a.length>1){const e=a.map(e=>({command:e}));a=(await this.request("fileops:generate-mirrored-commands",{commands:e})).split(/\s*\$\$\s*/).filter(Boolean)}const n=[];for(const e of a){const t=await ge(e,{eventBus:this.eventBus});n.push(t)}const r=n.join(" $$ ");i+=ue(t,{...s,commands:r}),i+="\n"}return i}async generateAliasFileHeader(e){const t=(new Date).toLocaleString(),i=Object.keys(e.aliases||{}).length,a=e.currentEnvironment||"space";return`; ================================================================\n; ${e.name} - STO Alias Configuration\n; ================================================================\n; Mode: ${a.toUpperCase()}\n; Generated: ${t}\n; Created by: STO Tools Keybind Manager v${Ie?.settings?.version??"unknown"}\n;\n; Alias Statistics:\n; - Total aliases: ${i}\n;\n; To use these aliases in Star Trek Online:\n; 1. Save this file as "CommandAliases.txt" (exactly, without quotes)\n; 2. Place it in your STO directory:\n;    [STO Install]\\Star Trek Online\\Live\\localdata\\CommandAliases.txt\n; 3. The aliases will be available when you start the game\n;\n; Alternative: You can append these aliases to an existing CommandAliases.txt\n; file if you already have one with other aliases.\n;\n; Common STO installation paths:\n; - Steam: C:\\Program Files (x86)\\Steam\\steamapps\\common\\Star Trek Online\n; - Epic: C:\\Program Files\\Epic Games\\Star Trek Online  \n; - Arc: C:\\Program Files (x86)\\Perfect World Entertainment\\Arc Games\\Star Trek Online\n; ================================================================\n\n`}async syncToFolder(e){const t=this.storage.getAllData(),i=t.profiles||{};try{for(const[t,a]of Object.entries(i)){if(!a||!a.name)continue;const t=a.name.replace(/[^a-zA-Z0-9_-]/g,"_"),i=`${t}`;for(const s of["space","ground"])if(a.builds?.[s]?.keys&&Object.keys(a.builds[s].keys).length>0){const n=await this.generateSTOKeybindFile(a,{environment:s,profile:a,syncMode:!0}),r=`${i}/${t}_${s}.txt`;await Te(e,r,n)}if(a.aliases&&Object.keys(a.aliases).length>0){const s=await this.generateAliasFile(a),n=`${i}/${t}_aliases.txt`;await Te(e,n,s)}}const a={version:Ie?.settings?.version||"1.0.0",exported:(new Date).toISOString(),type:"project",data:{profiles:i,settings:t.settings||{},currentProfile:t.currentProfile}};await Te(e,"project.json",JSON.stringify(a,null,2)),this.emit("toast:show",{message:Q.t("sync_completed"),type:"success"})}catch(e){throw this.emit("toast:show",{message:Q.t("sync_failed",{error:e.message}),type:"error"}),e}}generateFileName(e,t,i=e.currentEnvironment||"space"){return`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_${i}_${(new Date).toISOString().split("T")[0]}.${t}`}generateAliasFileName(e,t){return`${e.name.replace(/[^a-zA-Z0-9_-]/g,"_")}_aliases.${t}`}sanitizeProfileForExport(e){const t=JSON.parse(JSON.stringify(e)),i=(e=[])=>be(e);return t.keybinds&&Object.keys(t.keybinds).forEach(e=>{t.keybinds[e]&&Object.keys(t.keybinds[e]).forEach(a=>{t.keybinds[e][a]=i(t.keybinds[e][a])})}),t.builds&&Object.keys(t.builds).forEach(e=>{t.builds[e]&&t.builds[e].keys&&Object.keys(t.builds[e].keys).forEach(a=>{t.builds[e].keys[a]=i(t.builds[e].keys[a])})}),t}extractKeys(e={},t="space"){return e.keys&&!e.builds?e.keys:e.builds&&e.builds[t]&&e.builds[t].keys?e.builds[t].keys:e.keybinds&&e.keybinds[t]?e.keybinds[t]:{}}mirrorCommands(e){if(!Array.isArray(e)||e.length<=1)return e;const t=be(e);return[...t,...t.slice(0,-1).reverse()]}getCurrentState(){return{currentProfile:this.cache.currentProfile,currentEnvironment:this.cache.currentEnvironment,profiles:this.cache.profiles}}handleInitialState(e,t){"DataCoordinator"===e&&t?.profiles&&(this.cache.profiles=t.profiles,this.cache.currentProfile=t.currentProfile,this.cache.currentEnvironment=t.currentEnvironment||"space")}getProfileFromCache(e){return e&&this.cache.profiles[e]?this.cache.profiles[e]:this.storage&&"function"==typeof this.storage.getProfile?this.storage.getProfile(e):null}}class De extends oe{constructor({eventBus:e=null,i18n:t=null,containerId:i="toastContainer"}={}){super(e),this.componentName="ToastService",this.i18n=t||("undefined"!=typeof i18next?i18next:null),this.toastQueue=[],this.containerId=i,this.eventBus&&(this.respond("ui:show-toast",({message:e,type:t="info",duration:i=3e3})=>(this.showToast(e,t,i),!0)),this.addEventListener("toast:show",({message:e,type:t="info",duration:i=3e3})=>{this.showToast(e,t,i)}))}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showToast(e,t="info",i=3e3){const a=this.createToast(e,t,i),s=document.getElementById(this.containerId);s&&(s.appendChild(a),requestAnimationFrame(()=>{a.classList.add("show")}),setTimeout(()=>{this.removeToast(a)},i))}createToast(e,t,i){const a=document.createElement("div");a.className=`toast toast-${t}`;const s={success:"fa-check-circle",error:"fa-exclamation-circle",warning:"fa-exclamation-triangle",info:"fa-info-circle"},n=document.createElement("div");n.className="toast-content";const r=document.createElement("i");r.className=`fas ${s[t]||s.info}`,n.appendChild(r);const o=document.createElement("span");o.className="toast-message",o.textContent=e,n.appendChild(o);const c=document.createElement("button");c.className="toast-close",c.setAttribute("aria-label","close toast");const l=document.createElement("i");return l.className="fas fa-times",c.appendChild(l),n.appendChild(c),a.appendChild(n),c.addEventListener("click",()=>{this.removeToast(a)}),a}hideToast(e){e&&e.parentNode&&this.removeToast(e)}removeToast(e){e&&(e.classList.add("removing"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}}class je extends oe{constructor(e){super(e),this.componentName="UIUtilityService",this.dragState={isDragging:!1,dragElement:null,dragData:null},this.setupEventListeners(),this.setupTooltips()}onDestroy(){this.requestDetachers&&(this.requestDetachers.forEach(e=>e()),this.requestDetachers=[]),super.onDestroy()}setupEventListeners(){this.eventBus.on("ui:copy-to-clipboard",this.handleCopyToClipboard.bind(this)),this.eventBus.on("ui:validate-form",this.handleValidateForm.bind(this)),this.eventBus.on("ui:validate-email",this.handleValidateEmail.bind(this)),this.eventBus.on("ui:init-drag-drop",this.handleInitDragDrop.bind(this)),this.eventBus.on("ui:fade-in",this.handleFadeIn.bind(this)),this.eventBus.on("ui:fade-out",this.handleFadeOut.bind(this)),this.eventBus.on("ui:show-tooltip",this.handleShowTooltip.bind(this)),this.eventBus.on("ui:hide-tooltip",this.handleHideTooltip.bind(this)),this.setupRequestHandlers()}setupRequestHandlers(){this.requestDetachers=[],this.requestDetachers.push(this.respond("ui:copy-to-clipboard",this.copyToClipboard.bind(this))),this.requestDetachers.push(this.respond("ui:validate-form",this.validateForm.bind(this))),this.requestDetachers.push(this.respond("ui:validate-email",this.isValidEmail.bind(this))),this.requestDetachers.push(this.respond("ui:debounce",this.debounce.bind(this))),this.requestDetachers.push(this.respond("ui:throttle",this.throttle.bind(this)))}async handleCopyToClipboard({text:e}){const t=await this.copyToClipboard(e);this.emit("ui:clipboard-result",{success:t,text:e})}async handleValidateForm({formElement:e,formId:t}){const i=e||document.getElementById(t),a=this.validateForm(i);this.emit("ui:form-validated",{result:a,formId:t})}async handleValidateEmail({email:e}){const t=this.isValidEmail(e);this.emit("ui:email-validated",{email:e,isValid:t})}async handleInitDragDrop({container:e,containerId:t,options:i={}}){const a=e||document.getElementById(t);this.initDragAndDrop(a,i),this.emit("ui:drag-drop-initialized",{containerId:t,options:i})}async handleFadeIn({element:e,elementId:t,duration:i=300}){const a=e||document.getElementById(t);this.fadeIn(a,i),this.emit("ui:fade-in-complete",{elementId:t,duration:i})}async handleFadeOut({element:e,elementId:t,duration:i=300}){const a=e||document.getElementById(t);this.fadeOut(a,i),this.emit("ui:fade-out-complete",{elementId:t,duration:i})}async handleShowTooltip({element:e,elementId:t,text:i}){const a=e||document.getElementById(t);this.showTooltip(a,i),this.emit("ui:tooltip-shown",{elementId:t,text:i})}async handleHideTooltip(){this.hideTooltip(),this.emit("ui:tooltip-hidden")}async copyToClipboard(e){try{return await navigator.clipboard.writeText(e),this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("content_copied_to_clipboard"):"Content copied to clipboard",type:"success"}),!0}catch(t){const i=document.createElement("textarea");i.value=e,document.body.appendChild(i),i.select();try{return document.execCommand("copy"),this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("content_copied_to_clipboard"):"Content copied to clipboard",type:"success"}),!0}catch(e){return this.emit("toast:show",{message:"undefined"!=typeof i18next?i18next.t("failed_to_copy_to_clipboard"):"Failed to copy to clipboard",type:"error"}),!1}finally{document.body.removeChild(i)}}}validateForm(e){if(!e)return{isValid:!1,errors:["Form element not found"]};const t=[];return e.querySelectorAll("input[required], textarea[required], select[required]").forEach(e=>{e.value.trim()||t.push(`${e.name||e.id||"Field"} is required`),"email"===e.type&&e.value&&!this.isValidEmail(e.value)&&t.push(`${e.name||e.id||"Email"} is not valid`)}),{isValid:0===t.length,errors:t}}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}initDragAndDrop(e,t={}){if(!e)return;const{draggableSelector:i=".draggable",dropZoneSelector:a=i,onDragStart:s=null,onDragEnd:n=null,onDrop:r=null}=t;e.addEventListener("dragstart",e=>{const t=e.target.closest(i);t&&(this.dragState.isDragging=!0,this.dragState.dragElement=t,this.dragState.dragData=t.dataset,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",t.outerHTML),s&&s(e,this.dragState))}),e.addEventListener("dragend",e=>{e.target.closest(i)&&(this.dragState.isDragging=!1,this.dragState.dragElement=null,this.dragState.dragData=null,n&&n(e,this.dragState))});let o=null;e.addEventListener("dragover",e=>{if(e.preventDefault(),!a)return;const t=e.target.closest?e.target.closest(a):null;t&&t!==o&&(o=t)}),e.addEventListener("drop",e=>{e.preventDefault();let t=null;if(a){if("function"==typeof e.target.closest&&(t=e.target.closest(a)),!t&&"undefined"!=typeof document&&document.elementFromPoint){const i=document.elementFromPoint(e.clientX,e.clientY);t=i?.closest?i.closest(a):null}t||(t=o)}t&&t&&r&&r(e,this.dragState,t)})}fadeIn(e,t=300){if(!e)return;e.style.opacity="0",e.style.display="block";let i=null;const a=s=>{i||(i=s);const n=s-i,r=Math.min(n/t,1);e.style.opacity=r,n<t&&requestAnimationFrame(a)};requestAnimationFrame(a)}fadeOut(e,t=300){if(!e)return;let i=null;const a=s=>{i||(i=s);const n=s-i,r=Math.max(1-n/t,0);e.style.opacity=r,n<t?requestAnimationFrame(a):e.style.display="none"};requestAnimationFrame(a)}debounce(e,t){let i;return function(...a){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),e(...a)},t)}}throttle(e,t){let i;return function(){const a=arguments;i||(e.apply(this,a),i=!0,setTimeout(()=>i=!1,t))}}setupTooltips(){document.addEventListener("mouseenter",e=>{e.target&&"function"==typeof e.target.hasAttribute&&e.target.hasAttribute("title")&&e.target.getAttribute("title").trim()&&this.showTooltip(e.target,e.target.getAttribute("title"))},!0),document.addEventListener("mouseleave",e=>{e.target&&"function"==typeof e.target.hasAttribute&&e.target.hasAttribute("title")&&this.hideTooltip()},!0)}showTooltip(e,t){if(!e||!t)return;this.hideTooltip();const i=document.createElement("div");i.className="tooltip",i.textContent=t,i.id="active-tooltip",document.body.appendChild(i);const a=e.getBoundingClientRect(),s=i.getBoundingClientRect();let n=a.left+a.width/2-s.width/2,r=a.top-s.height-8;n<8&&(n=8),n+s.width>window.innerWidth-8&&(n=window.innerWidth-s.width-8),r<8&&(r=a.bottom+8,i.classList.add("tooltip-bottom")),i.style.left=n+"px",i.style.top=r+"px",requestAnimationFrame(()=>{i.classList.add("show")})}hideTooltip(){const e=document.getElementById("active-tooltip");e&&e.remove()}}class Ne extends oe{constructor({eventBus:e=null,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="KeyCaptureService",this.document=t,this.isCapturing=!1,this.pressedCodes=new Set,this.currentContext="keySelectionModal",this.hasCapturedValidKey=!1,this.locationSpecific=!1,this.boundHandleKeyDown=this.handleKeyDown.bind(this),this.boundHandleKeyUp=this.handleKeyUp.bind(this),this.boundHandleMouseDown=this.handleMouseDown.bind(this),this.boundHandleMouseUp=this.handleMouseUp.bind(this),this.boundHandleMouseMove=this.handleMouseMove.bind(this),this.boundHandleWheel=this.handleWheel.bind(this),this.mouseState={isDown:!1,button:null,startX:0,startY:0,pressTimer:null,dragThreshold:5,pressTimeout:200},this.addEventListener("keycapture:start",({context:e}={})=>this.startCapture(e)),this.addEventListener("keycapture:stop",()=>this.stopCapture()),this.addEventListener("keycapture:set-location-specific",({value:e}={})=>{this.setLocationSpecific(e)})}startCapture(e="keySelectionModal"){this.isCapturing||(this.resetState(),this.currentContext=e,this.isCapturing=!0,this.document.addEventListener("keydown",this.boundHandleKeyDown),this.document.addEventListener("keyup",this.boundHandleKeyUp),this.document.addEventListener("mousedown",this.boundHandleMouseDown),this.document.addEventListener("mouseup",this.boundHandleMouseUp),this.document.addEventListener("mousemove",this.boundHandleMouseMove),this.document.addEventListener("wheel",this.boundHandleWheel),this.emit("capture-start",{context:e}))}stopCapture(){this.isCapturing&&(this.isCapturing=!1,this.document.removeEventListener("keydown",this.boundHandleKeyDown),this.document.removeEventListener("keyup",this.boundHandleKeyUp),this.document.removeEventListener("mousedown",this.boundHandleMouseDown),this.document.removeEventListener("mouseup",this.boundHandleMouseUp),this.document.removeEventListener("mousemove",this.boundHandleMouseMove),this.document.removeEventListener("wheel",this.boundHandleWheel),this.pressedCodes.clear(),this.hasCapturedValidKey=!1,this.resetMouseState(),this.emit("capture-stop",{context:this.currentContext}),this.currentContext="keySelectionModal")}setLocationSpecific(e){this.locationSpecific=!!e}resetState(){this.pressedCodes.clear(),this.hasCapturedValidKey=!1,this.resetMouseState()}resetMouseState(){this.mouseState.pressTimer&&(clearTimeout(this.mouseState.pressTimer),this.mouseState.pressTimer=null),this.mouseState.isDown=!1,this.mouseState.button=null,this.mouseState.startX=0,this.mouseState.startY=0}handleKeyDown(e){if(!this.isCapturing)return;if(this.isPureModifier(e.code))return this.pressedCodes.add(e.code),void this.emit("update",{chord:this.chordToString(this.pressedCodes),codes:[...this.pressedCodes],context:this.currentContext});this.pressedCodes.add(e.code);const t=this.chordToString(this.pressedCodes);this.emit("chord-captured",{chord:t,context:this.currentContext}),this.hasCapturedValidKey=!0,e.preventDefault()}handleKeyUp(e){this.isCapturing&&(this.hasCapturedValidKey||(this.pressedCodes.delete(e.code),this.emit("update",{chord:this.chordToString(this.pressedCodes),codes:[...this.pressedCodes],context:this.currentContext})))}handleMouseDown(e){this.isCapturing&&(e.preventDefault(),this.mouseState.isDown=!0,this.mouseState.button=e.button,this.mouseState.startX=e.clientX,this.mouseState.startY=e.clientY,this.mouseState.pressTimer=setTimeout(()=>{if(this.mouseState.isDown){const t=this.getButtonGesture(e.button,"press");this.captureMouseGesture(t)}},this.mouseState.pressTimeout))}handleMouseUp(e){if(this.isCapturing){if(e.preventDefault(),this.mouseState.pressTimer&&(clearTimeout(this.mouseState.pressTimer),this.mouseState.pressTimer=null),this.mouseState.isDown&&this.mouseState.button===e.button){const t=Math.abs(e.clientX-this.mouseState.startX),i=Math.abs(e.clientY-this.mouseState.startY);if(t>this.mouseState.dragThreshold||i>this.mouseState.dragThreshold){const t=this.getButtonGesture(e.button,"drag");this.captureMouseGesture(t)}else{const t=this.getButtonGesture(e.button,"click");this.captureMouseGesture(t)}}this.resetMouseState()}}handleMouseMove(e){if(!this.isCapturing||!this.mouseState.isDown)return;const t=Math.abs(e.clientX-this.mouseState.startX),i=Math.abs(e.clientY-this.mouseState.startY);(t>this.mouseState.dragThreshold||i>this.mouseState.dragThreshold)&&this.mouseState.pressTimer&&(clearTimeout(this.mouseState.pressTimer),this.mouseState.pressTimer=null)}handleWheel(e){if(!this.isCapturing)return;e.preventDefault();const t=e.deltaY>0?"wheeldown":"wheelup";this.captureMouseGesture(t)}getButtonGesture(e,t){return`${{0:"l",1:"m",2:"r"}[e]||"l"}${t}`}captureMouseGesture(e){const t=[...[...this.pressedCodes].filter(e=>this.isPureModifier(e)),e],i=this.chordToString(new Set(t));this.emit("chord-captured",{chord:i,context:this.currentContext}),this.hasCapturedValidKey=!0}isPureModifier(e){return["ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","MetaLeft","MetaRight"].includes(e)}chordToString(e){const t=this.locationSpecific;return[...e].sort().map(e=>{if("string"==typeof e&&(e.startsWith("l")||e.startsWith("r")||e.startsWith("m")||"wheelup"===e||"wheeldown"===e))return e;if(e.startsWith("Control"))return t?e.endsWith("Left")?"LCTRL":"RCTRL":"Ctrl";if(e.startsWith("Alt"))return t?e.endsWith("Left")?"LALT":"RALT":"Alt";if(e.startsWith("Shift"))return"Shift";if(e.startsWith("Meta"))return"Meta";const i=e.match(/^Digit(\d)$/);if(i)return i[1];const a=e.match(/^Key([A-Z])$/);if(a)return a[1];if(e.startsWith("F")&&/^F\d+$/.test(e))return e;const s=e.match(/^Numpad(\d)$/);if(s)return`numpad${s[1]}`;const n={NumpadAdd:"Add",NumpadSubtract:"Subtract",NumpadMultiply:"Multiply",NumpadDivide:"Divide",NumpadDecimal:"Decimal",NumpadEnter:"numpadenter"};if(n[e])return n[e];const r={Space:"Space",Enter:"Enter",Tab:"Tab",Escape:"Escape",Backspace:"Backspace",Delete:"Delete",Home:"Home",End:"End",PageUp:"PageUp",PageDown:"PageDown",ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:"'",Comma:",",Period:".",Slash:"/",Backslash:"\\",Minus:"-",Equal:"=",Backquote:"`",IntlBackslash:"\\"};return r[e]?r[e]:e.replace(/^Key/,"")}).join("+")}}class Me extends oe{constructor(e){super(e),this.componentName="ModalManagerService",this.overlayId="modalOverlay",this.regenerateCallbacks={},this.isInitialized=!1,this.registerAllModalCallbacks(),this.setupEventListeners(),"undefined"!=typeof window&&(window.modalManager=this),"undefined"!=typeof window&&window.i18next&&window.i18next.on("languageChanged",()=>{const e=document.querySelector(".modal.active");if(!e)return;const t=e.id;this.regenerateCallbacks[t]?(this.regenerateCallbacks[t](),this.emit("modal:regenerated",{modalId:t})):"function"==typeof window.applyTranslations&&window.applyTranslations(e)})}async init(){this.isInitialized||(this.isInitialized=!0)}setupEventListeners(){this.eventBus.on("modal:show",this.handleShowModal.bind(this)),this.eventBus.on("modal:hide",this.handleHideModal.bind(this)),this.eventBus.on("modal:toggle",this.handleToggleModal.bind(this)),this.eventBus.on("modal:register-callback",this.handleRegisterCallback.bind(this)),this.eventBus.on("modal:unregister-callback",this.handleUnregisterCallback.bind(this)),this.setupGlobalModalEventListeners()}setupGlobalModalEventListeners(){document.addEventListener("click",e=>{const t=e.target.closest("[data-modal]");if(t){const i=t.getAttribute("data-modal");i&&(this.hide(i),e.preventDefault(),e.stopPropagation())}}),document.addEventListener("keydown",e=>{if("Escape"===e.key){const e=document.querySelector(".modal.active");e&&this.hide(e.id)}}),document.addEventListener("click",e=>{if(e.target.id===this.overlayId||e.target.classList.contains("modal-overlay")){const e=document.querySelector(".modal.active");e&&this.hide(e.id)}})}async handleShowModal({modalId:e}){const t=this.show(e);return this.emit("modal:shown",{modalId:e,success:t}),t}async handleHideModal({modalId:e}){const t=this.hide(e);return this.emit("modal:hidden",{modalId:e,success:t}),t}async handleToggleModal({modalId:e}){const t="string"==typeof e?document.getElementById(e):e;if(!t)return!1;const i=t.classList.contains("active"),a=i?this.hide(e):this.show(e);return this.emit("modal:toggled",{modalId:e,isActive:!i,success:a}),a}async handleRegisterCallback({modalId:e,callback:t}){this.registerRegenerateCallback(e,t)}async handleUnregisterCallback({modalId:e}){this.unregisterRegenerateCallback(e)}getOverlay(){return document.getElementById(this.overlayId)}show(e){const t="string"==typeof e?document.getElementById(e):e,i=this.getOverlay();if(!i||!t)return!1;i.classList.add("active"),t.classList.add("active"),document.body.classList.add("modal-open"),"function"==typeof window.applyTranslations&&window.applyTranslations(t);const a=t.querySelector("input, textarea, select");a&&setTimeout(()=>a.focus(),100);const s="string"==typeof e?e:t.id;return this.emit("modal:shown",{modalId:s,success:!0}),!0}hide(e){const t="string"==typeof e?document.getElementById(e):e,i=this.getOverlay();return!(!i||!t||(t.classList.remove("active"),document.querySelector(".modal.active")||(i.classList.remove("active"),document.body.classList.remove("modal-open")),0))}registerRegenerateCallback(e,t){this.regenerateCallbacks[e]=t}unregisterRegenerateCallback(e){delete this.regenerateCallbacks[e]}registerAllModalCallbacks(){this.registerRegenerateCallback("addCommandModal",()=>{window.stoCommands?.regenerateModalContent&&window.stoCommands.regenerateModalContent()}),this.registerRegenerateCallback("parameterModal",()=>{if(window.app?.populateParameterModal){const e=document.getElementById("parameterModal"),t=e?.getAttribute("data-command-def");if(t)try{window.app.populateParameterModal(JSON.parse(t))}catch(e){}}}),this.registerRegenerateCallback("keySelectionModal",()=>{const e=document.getElementById("keySelectionModal"),t=e?.querySelector(".tab-content .tab-pane.active");if(t){const e=t.id.replace("Tab","");window.app?.populateKeyTab?.(e)}}),this.registerRegenerateCallback("vertigoModal",()=>{this.eventBus?this.emit("vfx:modal-regenerate-requested"):window.app?.populateVertigoModal?.()}),this.registerRegenerateCallback("profileModal",()=>{const e=document.getElementById("profileModal");window.applyTranslations?.(e)}),this.registerRegenerateCallback("preferencesModal",()=>{window.app?.preferencesManager?.populatePreferencesModal?.()}),this.registerRegenerateCallback("fileExplorerModal",()=>{window.stoFileExplorer?.refreshFileList?.()}),this.registerRegenerateCallback("exportModal",()=>{window.stoExport?.populateExportModal?.()}),this.registerRegenerateCallback("aboutModal",()=>{const e=document.getElementById("aboutModal");window.applyTranslations?.(e)}),this.registerRegenerateCallback("addKeyModal",()=>{window.app?.setupKeyCaptureModal?.()})}}class Oe extends oe{constructor(e){super(e),this.componentName="VFXManagerService",this.selectedEffects={space:new Set,ground:new Set},this.showPlayerSay=!1,this.currentProfile=null,this.initialState=null,this.isInitialized=!1}async init(){this.isInitialized||(super.init(),this.setupEventListeners(),this.isInitialized=!0)}handleInitialState(e,t){t&&"DataCoordinator"===e&&(t.currentProfile&&(this.currentProfile=t.currentProfile),t.currentProfileData&&this.loadState(t.currentProfileData))}setupEventListeners(){this.eventBus.on("vfx:show-modal",this.showModal.bind(this)),this.eventBus.on("vfx:save-effects",this.saveEffects.bind(this)),this.eventBus.on("vfx:cancel-effects",this.cancelEffects.bind(this)),this.addEventListener("profile:switched",({profileId:e,profile:t,updateSource:i})=>{"VFXManagerService"!==i&&(this.currentProfile=e,t&&this.loadState(t))}),this.addEventListener("profile:updated",({profileId:e,profile:t,updateSource:i})=>{"VFXManagerService"!==i&&e===this.currentProfile&&t&&this.loadState(t)})}generateAlias(e){const t=Array.from(this.selectedEffects[e]);if(0===t.length)return"No effects selected";const i=`dynFxSetFXExclusionList_${e.charAt(0).toUpperCase()+e.slice(1)}`;let a=`dynFxSetFXExclusionList  ${t.join(",")}`;return this.showPlayerSay&&(a+=" $$ PlayerSay VFX Suppression Loaded"),ue(i,{commands:a}).trim()}generateAliasCommand(e){if(!this.selectedEffects||!this.selectedEffects[e])return"";const t=Array.from(this.selectedEffects[e]);if(0===t.length)return"";let i=`dynFxSetFXExclusionList ${t.join(",")}`;return this.showPlayerSay&&(i+=" $$ PlayerSay VFX Suppression Loaded"),i}generateCombinedAliasCommand(e){const t=Array.isArray(e)?e:[e];if(!this.selectedEffects)return"";const i=[];for(const e of t){if(!this.selectedEffects[e])continue;const t=Array.from(this.selectedEffects[e]);0!==t.length&&i.push(...t)}if(0===i.length)return"";let a=`dynFxSetFXExclusionList ${i.join(",")}`;return this.showPlayerSay&&(a+=" $$ PlayerSay VFX Suppression Loaded"),a}getSelectedEffects(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return Array.from(this.selectedEffects[e])}toggleEffect(e,t){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);if(!t)throw new Error(`Invalid effect: ${t} for environment: ${e}`);this.selectedEffects[e].has(t)?this.selectedEffects[e].delete(t):this.selectedEffects[e].add(t)}clearAllEffects(){this.selectedEffects.space.clear(),this.selectedEffects.ground.clear()}selectAllEffects(e){if(!VFX_EFFECTS[e])throw new Error(`Invalid environment: ${e}`);if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);VFX_EFFECTS[e].forEach(t=>{this.selectedEffects[e].add(t.effect)})}getEffectCount(e){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return this.selectedEffects[e].size}isEffectSelected(e,t){if(!this.selectedEffects[e])throw new Error(`Invalid environment: ${e}`);return this.selectedEffects[e].has(t)}saveState(e){e.vertigoSettings||(e.vertigoSettings={}),e.vertigoSettings={selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay}}loadState(e){if(this.selectedEffects||(this.selectedEffects={space:new Set,ground:new Set}),e&&e.vertigoSettings){const t=e.vertigoSettings;this.selectedEffects.space=new Set(t.selectedEffects?.space||[]),this.selectedEffects.ground=new Set(t.selectedEffects?.ground||[]),this.showPlayerSay=t.showPlayerSay||!1}else this.selectedEffects.space.clear(),this.selectedEffects.ground.clear(),this.showPlayerSay=!1;this.autoGenerateAliases()}async autoGenerateAliases(){if(!this.currentProfile)return;if(!this.selectedEffects)return;const e=[];if(this.selectedEffects.space&&this.selectedEffects.space.size>0&&e.push("space"),this.selectedEffects.ground&&this.selectedEffects.ground.size>0&&e.push("ground"),0!==e.length)try{const t=(await this.request("data:get-all-profiles"))[this.currentProfile];if(t){const i=[],a=t.aliases||{};Object.keys(a).forEach(e=>{(e.startsWith("dynFxSetFXExclusionList_")||"dynFxSetFXExclusionList"===e)&&i.push(e)});const s={},n=[];if(e.forEach(e=>{const t=this.generateAliasCommand(e);if(t){const i=`dynFxSetFXExclusionList_${e.charAt(0).toUpperCase()+e.slice(1)}`;s[i]={commands:t,description:`VFX suppression for ${e} environment`,type:"vfx-alias"},n.push(i)}}),n.length>0){const t=this.generateCombinedAliasCommand(e);t&&(s.dynFxSetFXExclusionList_Combined={commands:t,description:"VFX suppression for all environments",type:"vfx-alias"})}try{const e={profileId:this.currentProfile,updateSource:"VFXManagerService"};i.length>0&&(e.delete={aliases:i}),Object.keys(s).length>0&&(e.add={aliases:s}),await this.request("data:update-profile",e),this.emit("aliases-changed",{aliases:{...a,...s}})}catch(e){}}}catch(e){}}async showModal(){if(this.currentProfile)try{const e=(await this.request("data:get-all-profiles"))[this.currentProfile];e&&this.loadState(e)}catch(e){}this.initialState={selectedEffects:{space:new Set(this.selectedEffects.space),ground:new Set(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay},this.emit("vfx:modal-populate",{vfxManager:this})}async saveEffects(){if(this.selectedEffects&&this.selectedEffects.space&&this.selectedEffects.ground){if(this.currentProfile)try{const e=(await this.request("data:get-all-profiles"))[this.currentProfile];if(e){const t={selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay},i=[],a=e.aliases||{};Object.keys(a).forEach(e=>{(e.startsWith("dynFxSetFXExclusionList_")||"dynFxSetFXExclusionList"===e)&&i.push(e)});const s={},n=[],r=["space","ground"];for(let e=0;e<r.length;e++){const t=r[e],i=this.generateAliasCommand(t);if(i){const e=`dynFxSetFXExclusionList_${t.charAt(0).toUpperCase()+t.slice(1)}`;s[e]={commands:i,description:`VFX suppression for ${t} environment`,type:"vfx-alias"},n.push(e)}}if(n.length>0){const e=this.generateCombinedAliasCommand(r);e&&(s.dynFxSetFXExclusionList_Combined={commands:e,description:"VFX suppression for all environments",type:"vfx-alias"})}try{const e={profileId:this.currentProfile,properties:{vertigoSettings:t},updateSource:"VFXManagerService"};i.length>0&&(e.delete={aliases:i}),Object.keys(s).length>0&&(e.add={aliases:s}),await this.request("data:update-profile",e),this.emit("aliases-changed",{aliases:{...a,...s}})}catch(e){}}}catch(e){}this.emit("modal:hide",{modalId:"vertigoModal"})}}cancelEffects(){this.initialState&&(this.selectedEffects.space=new Set(this.initialState.selectedEffects.space),this.selectedEffects.ground=new Set(this.initialState.selectedEffects.ground),this.showPlayerSay=this.initialState.showPlayerSay),this.emit("modal:hide",{modalId:"vertigoModal"})}getCurrentState(){return{currentProfile:this.currentProfile,selectedEffects:{space:Array.from(this.selectedEffects.space),ground:Array.from(this.selectedEffects.ground)},showPlayerSay:this.showPlayerSay}}}function Ke(e){if("string"!=typeof e)return e;let t=e.match(/^(?:STO)?TrayExecByTray\s+1\s+(\d+)\s+(\d+)$/i);return t?`+TrayExecByTray ${t[1]} ${t[2]}`:(t=e.match(/^TrayExecByTrayWithBackup\s+1\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)$/i),t?`+TrayExecByTrayWithBackup ${t[1]} ${t[2]} ${t[3]} ${t[4]}`:e)}function ze(e){return be(e).map(Ke)}function Le(e){if(!e||"object"!=typeof e)return e;let t=!1;if(e.builds&&"object"==typeof e.builds)for(const[i,a]of Object.entries(e.builds))if(a&&a.keys&&"object"==typeof a.keys)for(const[s,n]of Object.entries(a.keys)){const a=Re(n);JSON.stringify(a)!==JSON.stringify(n)&&(e.builds[i].keys[s]=a,t=!0)}if(e.aliases&&"object"==typeof e.aliases)for(const[i,a]of Object.entries(e.aliases))if(a&&"object"==typeof a){const s=Ue(a.commands);JSON.stringify(s)!==JSON.stringify(a.commands)&&(e.aliases[i].commands=s,t=!0)}return t&&(e.lastModified=(new Date).toISOString(),e.migrationVersion="2.0.0"),e}function Re(e){if(!e)return[];if("string"==typeof e)return e.includes("$$")?e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e.length>0):e.trim()?[e.trim()]:[];if(Array.isArray(e))return ze(e);if("object"==typeof e){const t=ye(e);return t?[t]:[]}return[]}function Ue(e){if(!e)return[];if("string"==typeof e)return e.includes("$$")?e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e.length>0):e.trim()?[e.trim()]:[];if(Array.isArray(e))return ze(e);if("object"==typeof e){const t=ye(e);return t?[t]:[]}return[]}function qe(e){if(!e||"object"!=typeof e)return!1;if("2.0.0"===e.migrationVersion)return!1;if(e.builds&&"object"==typeof e.builds)for(const t of Object.values(e.builds))if(t&&t.keys&&"object"==typeof t.keys)for(const e of Object.values(t.keys))if(Ve(e)||"string"==typeof e)return!0;if(e.aliases&&"object"==typeof e.aliases)for(const t of Object.values(e.aliases))if(t&&"object"==typeof t&&("string"==typeof t.commands||Ve(t.commands)))return!0;return!1}function Ve(e){return!!e&&("object"==typeof e&&!Array.isArray(e)&&"string"==typeof e.command||!!Array.isArray(e)&&e.some(e=>e&&"object"==typeof e&&"string"==typeof e.command))}class Ge{constructor({id:e,defaultSeverity:t,messageKey:i,tags:a=[]}={}){if(!e)throw new Error('Validator requires "id"');if(!t)throw new Error('Validator requires "defaultSeverity"');if(!i)throw new Error('Validator requires "messageKey"');this.id=e,this.level=t,this.messageKey=i,this.tags=a}validate(){throw new Error("validate(ctx) not implemented")}run(e){const t=this.validate(e);return t?{id:this.id,severity:t.severity||this.level,key:"function"==typeof t.key?t.key(e):t.key||this.messageKey,params:t.params||{},defaultMessage:t.defaultMessage}:null}}const We=/trayexec|slot|stotrayexec/i,He="undefined"!=typeof window&&window.COMMANDS?window.COMMANDS:{};function Xe(e){if(!e)return null;const t=e.trim().split(/\s+/)[0].toLowerCase();for(const e in He){const i=He[e];if(i&&i.command&&i.command.toLowerCase()===t)return i.environment||null}return null}const Ze="undefined"!=typeof window&&window.COMMANDS?window.COMMANDS:{};function Je(e){if(!e)return null;const t=e.trim().toLowerCase();for(const e in Ze){const i=Ze[e];if(!i||!i.command)continue;const a=i.command.trim().toLowerCase();if(t===a)return{...i,re:e};if(t.startsWith(a))return{...i,re:e};if(t.split(/\s+/)[0]===a)return{...i,re:e}}return null}const Qe=[new class extends Ge{constructor(){super({id:"maxLength",defaultSeverity:"warning",messageKey:"command_chain_near_limit",tags:["length","performance"]})}validate(e){const{length:t}=e;return t>=990?{severity:"error",key:"command_chain_too_long",params:{length:t},defaultMessage:`Command chain exceeds safe length (${t}/999). It may fail in game.`}:t>=900?{params:{length:t},defaultMessage:`Command chain is ${t} characters; consider shortening (limit 999).`}:null}},new class extends Ge{constructor(){super({id:"stabilizedTrayOnly",defaultSeverity:"warning",messageKey:"stabilized_non_tray_warning"})}validate(e){const{stabilized:t,commands:i}=e;return t&&Array.isArray(i)&&0!==i.length&&i.some(e=>{const t="string"==typeof e?e:e.command||"";return!We.test(t)})?{severity:"warning",key:"stabilized_non_tray_warning",defaultMessage:"Stabilized execution should only be used with tray execution abilities."}:null}},new class extends Ge{constructor(){super({id:"keyCommandCount",defaultSeverity:"warning",messageKey:"too_many_commands_on_key"})}validate(e){const{isAlias:t,commands:i}=e;return t||!Array.isArray(i)?null:i.length>20?{severity:"warning",key:"too_many_commands_on_key",params:{count:i.length},defaultMessage:`Binding ${i.length} commands to one key may fail in game (max recommended 20).`}:null}},new class extends Ge{constructor(){super({id:"aliasMixedEnvironment",defaultSeverity:"warning",messageKey:"alias_mixed_environment_warning"})}validate(e){const{isAlias:t,commands:i}=e;if(!t||!Array.isArray(i))return null;let a=!1,s=!1;for(const e of i){const t=Xe("string"==typeof e?e:e.command||"");if("space"===t?a=!0:"ground"===t&&(s=!0),a&&s)break}return a&&s?{severity:"warning",key:"alias_mixed_environment_warning",defaultMessage:"Alias contains both space-only and ground-only commands; consider splitting for reliability."}:null}},new class extends Ge{constructor(){super({id:"commandWarnings",defaultSeverity:"warning",messageKey:"_internal_command_warning"})}validate(e){const{commands:t}=e;if(!Array.isArray(t)||0===t.length)return null;const i=[];for(const e of t){const t="string"==typeof e?e:e.command||"",a=Je(t);if(a&&a.warning){let e=a.name||t;if(a.re&&"undefined"!=typeof window&&window.i18next&&window.i18next.t){const t=`command_definitions.${a.re}.name`,i=window.i18next.t(t);i&&i!==t&&(e=i)}let s=a.warning;if("undefined"!=typeof window&&window.i18next&&window.i18next.t){const e=window.i18next.t(a.warning);s=e&&e!==a.warning?e:a.warning}i.push({name:e,warnText:s})}}return i}run(e){const t=this.validate(e);return t&&0!==t.length?t.map(({name:e,warnText:t})=>({id:this.id,severity:"warning",defaultMessage:`${e} - ${t}`})):null}}];class Ye extends oe{constructor({eventBus:e,i18n:t=null,ui:i=null}={}){super(e),this.componentName="CommandChainValidatorService",this.i18n=t,this.ui=i}onInit(){this.addEventListener("command-chain:validate",async({key:e,stabilized:t,isAlias:i})=>{await this.validateChain(e,t,i)})}async validateChain(e,t=void 0,i=void 0){if(!this.oe){this.oe=!0;try{const a=await this.request("command:get-for-selected-key");if(!Array.isArray(a))return;const s=await this.request("fileops:generate-command-preview",{key:e,commands:a,stabilize:!1}),n=void 0!==t&&t,r=void 0!==i&&i;let o;o=n&&a.length>1?(await this.request("fileops:generate-command-preview",{key:e,commands:a,stabilize:!0})).length:s.length;const c={key:e,commands:a,length:o,stabilized:n,isAlias:r},l=Qe.flatMap(e=>{const t=e.run(c);return t?Array.isArray(t)?t:[t]:[]}),d=l.filter(e=>"error"===e.severity),m=l.filter(e=>"warning"===e.severity),h=d.length?"error":m.length?"warning":"success";this.emit("command-chain:validation-result",{key:e,length:o,severity:h,warnings:m,errors:d}),this.ce||(this.ce={});const u=this.ce[e];if(this.ce[e]=h,"success"===h){if("success"!==u){const e=await this.getI18nMessage("command_chain_is_valid",{length:o})||`Command chain is valid (${o}/999)`;await this.showToast(e,"success")}}else for(const e of l){let t;t=e.key?await this.getI18nMessage(e.key,e.params)||e.defaultMessage||e.key:e.defaultMessage,await this.showToast(t,e.severity)}}catch(e){}finally{this.oe=!1}}}async getI18nMessage(e,t={}){try{return this.i18n&&"function"==typeof this.i18n.t?this.i18n.t(e,t):await this.request("i18n:translate",{key:e,params:t})}catch(e){return null}}async showToast(e,t="info"){try{this.ui?.showToast?this.ui.showToast(e,t):await this.request("toast:show",{message:e,type:t})}catch(e){}}}class et extends oe{constructor({eventBus:e,storage:t,ui:i,fileSystem:a,document:s=window.document}={}){super(e),this.componentName="FileExplorerUI",this.storage=t||window.storageService||null,this.ui=i||window.stoUI||null,this.fileSystem=a||xe.se(),this.document=s,this.modalId="fileExplorerModal",this.treeId="fileTree",this.contentId="fileContent",this.selectedNode=null,this.currentDirectory=null}onInit(){this.setupEventListeners()}setupEventListeners(){this.eventBus.on("file-explorer:open",()=>{this.openExplorer()}),this.eventBus.onDom("fileExplorerBtn","click","fileExplorer-open",()=>{this.openExplorer()}),this.eventBus.onDom(this.treeId,"click","fileExplorer-tree-click",e=>{const t=e.target.closest(".tree-node");t&&this.selectNode(t)}),this.eventBus.onDom("copyFileContentBtn","click","fileExplorer-copy-content",()=>{const e=this.document.getElementById(this.contentId);if(!e)return;const t=e.textContent||"";t.trim()?(this.ui?.copyToClipboard(t),this.ui?.showToast(i18next.t("content_copied_to_clipboard"),"success")):this.ui?.showToast(i18next.t("nothing_to_copy"),"warning")}),this.eventBus.onDom("downloadFileBtn","click","fileExplorer-download",async()=>{if(!this.selectedNode)return;const{type:e,profileId:t,environment:i}=this.selectedNode,a=this.document.getElementById(this.contentId);if(!a)return;const s=a.textContent||"";if(!s.trim())return;let n=i18next.t("default_export_filename");if(this.storage){const a=this.storage.getProfile(t);try{"build"===e?n=await this.request("export:generate-filename",{profile:a,extension:"txt",environment:i}):"aliases"===e&&(n=await this.request("export:generate-alias-filename",{profile:a,extension:"txt"}))}catch(e){}}this.downloadFile(s,n,"text/plain")}),this.addEventListener("file-explorer:save",e=>this.saveFile(e.path,e.content))}openExplorer(){this.buildTree();const e=this.document.getElementById(this.contentId);e&&(e.textContent=i18next.t("select_an_item_on_the_left_to_preview_export")),this.emit("modal:show",{modalId:this.modalId})}buildTree(){const e=this.document.getElementById(this.treeId);if(!e||!this.storage)return;e.innerHTML="";const t=this.storage.getAllData().profiles||{};Object.entries(t).forEach(([t,i])=>{const a=this.createNode("profile",i.name,{profileId:t}),s=this.document.createElement("div");if(s.className="tree-children",i.builds&&i.builds.space){const e=this.createNode("build",i18next.t("space_build")||"Space Build",{profileId:t,environment:"space"});s.appendChild(e)}if(i.builds&&i.builds.ground){const e=this.createNode("build",i18next.t("ground_build")||"Ground Build",{profileId:t,environment:"ground"});s.appendChild(e)}const n=this.createNode("aliases",i18next.t("aliases")||"Aliases",{profileId:t});s.appendChild(n),a.appendChild(s),e.appendChild(a)})}createNode(e,t,i={}){const a=this.document.createElement("div");return a.className=`tree-node ${e}`,a.textContent=t,a.dataset.type=e,Object.entries(i).forEach(([e,t])=>a.setAttribute(`data-${e}`,t)),a}async selectNode(e){const t=this.document.querySelector(".tree-node.selected");t&&t.classList.remove("selected"),e.classList.add("selected");const i=e.dataset.type||e.getAttribute("data-type"),a=e.getAttribute("data-profileid"),s=e.getAttribute("data-environment");if(this.selectedNode={type:i,profileId:a,environment:s},a&&this.storage)try{let e="";e="build"===i?await this.generateBuildExport(a,s):"aliases"===i?await this.generateAliasExport(a):i18next.t("select_a_space_ground_build_or_aliases_to_preview_export");const t=this.document.getElementById(this.contentId);t&&(t.textContent=e||i18next.t("no_content_available"))}catch(e){this.ui?.showToast(i18next.t("failed_to_generate_export"),"error")}}async generateBuildExport(e,t){const i=this.storage.getProfile(e);return i&&i.builds&&i.builds[t]?await this.request("export:generate-keybind-file",{profileId:e,environment:t}).catch(e=>`; Failed to generate export: ${e.message}`):""}async generateAliasExport(e){const t=this.storage.getProfile(e);return t?await this.request("export:generate-alias-file",{profileId:e}).catch(e=>`; Failed to generate export: ${e.message}`):""({...t.aliases||{},...t.builds?.space?.aliases||{},...t.builds?.ground?.aliases||{}})}async ensureDirectoryHandle(){return this.currentDirectory||(this.currentDirectory=await this.fileSystem.getDirectoryHandle(Se)),this.currentDirectory}async openFile(e){}async saveFile(e,t){try{let i=await this.ensureDirectoryHandle();if(!i)return;await this.fileSystem.writeFile(i,e,t),this.ui?.showToast(i18next.t("file_saved_successfully"),"success")}catch(e){this.ui?.showToast(i18next.t("failed_to_save_file"),"error")}}downloadFile(e,t,i){const a=new Blob([e],{type:i}),s=URL.createObjectURL(a),n=this.document.createElement("a");n.href=s,n.download=t,this.document.body.appendChild(n),n.click(),this.document.body.removeChild(n),URL.revokeObjectURL(s)}}const tt=new Proxy({currentProfile:null,currentMode:"space",currentEnvironment:"space",selectedKey:null,isModified:!1,undoStack:[],redoStack:[],maxUndoSteps:50,commandIdCounter:0},{set:(e,t,i)=>(e[t]=i,o&&o.emit&&o.emit(`store:${t}`,i),!0)});class it extends oe{constructor({eventBus:e,ui:t=null,modalManager:i=null,document:a=null,i18n:s=null}={}){super(e),this.componentName="ProfileUI",this.ui=t,this.modalManager=i,this.document=a||("undefined"!=typeof window?window.document:null),this.i18n=s,this.ee=null,this.le="space",this.me=!1,this.he=null,this.currentModal=null,this.eventListenersSetup=!1,this.ue=this.ue.bind(this)}ue(e,t){return this.i18n?.t?.(e,t)||e}onInit(){this.setupEventListeners(),this.renderProfiles(),this.updateProfileInfo()}setupEventListeners(){if(this.eventListenersSetup)return;this.eventListenersSetup=!0;const e=this.document.getElementById("profileSelect");e&&e.addEventListener("change",e=>{this.handleProfileSwitch(e.target.value)}),this.eventBus.onDom("newProfileBtn","click","profile-new",()=>{this.showNewProfileModal()}),this.eventBus.onDom("cloneProfileBtn","click","profile-clone",()=>{this.showCloneProfileModal()}),this.eventBus.onDom("renameProfileBtn","click","profile-rename",()=>{this.showRenameProfileModal()}),this.eventBus.onDom("deleteProfileBtn","click","profile-delete",()=>{this.confirmDeleteProfile()}),this.eventBus.onDom("saveProfileBtn","click","profile-save",()=>{this.handleProfileSave()}),this.addEventListener("profile:switched",({profileId:e,environment:t,profile:i}={})=>{e&&(this.ee=e),t&&(this.le=t),i&&(this.he=i),this.me=!1,this.renderProfiles(),this.updateProfileInfo()}),this.addEventListener("environment:changed",({environment:e}={})=>{e&&(this.le=e,this.updateProfileInfo())}),this.addEventListener("profile-modified",()=>{this.me=!0,this.updateProfileInfo()}),this.addEventListener("current-profile:updated",({profile:e})=>{e&&(this.he=e,this.updateProfileInfo())})}async handleProfileSwitch(e){try{const t=await this.request("data:switch-profile",{profileId:e});t?.switched&&(this.pe=null,this.renderKeyGrid(),this.updateProfileInfo(),this.ui?.showToast?.(t.message,"success"))}catch(e){this.ui?.showToast?.(e.message,"error")}}async renderProfiles(){const e=this.document.getElementById("profileSelect");if(!e)return;const t=await this.request("data:get-all-profiles");e.innerHTML="";const i=Object.entries(t||{});if(0===i.length){const t=this.document.createElement("option");t.value="",t.textContent=this.ue("no_profiles_available")||"No profiles available",t.disabled=!0,e.appendChild(t)}else i.forEach(([t,i])=>{const a=this.document.createElement("option");a.value=t,a.textContent=i.name,t===this.ee&&(a.selected=!0),e.appendChild(a)});this.updateProfileInfo()}updateProfileInfo(){this.document.querySelectorAll(".mode-btn").forEach(e=>{e.classList.toggle("active",this.he&&e.dataset.mode===this.le),e.disabled=!this.ee});const e=this.document.getElementById("keyCount");if(e)if(this.he){const t=this.he.builds?.[this.le],i=Object.keys(t?.keys||{}).length,a=1===i?this.ue("key"):this.ue("keys");e.textContent=`${i} ${a}`}else e.textContent=this.ue("no_profile");const t=this.document.getElementById("modifiedIndicator");t&&(t.style.display=this.me?"inline":"none")}renderKeyGrid(){"undefined"!=typeof app&&app.renderKeyGrid&&app.renderKeyGrid()}renderCommandChain(){}showNewProfileModal(){this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.ue("new_profile")),t&&(t.value="",t.placeholder="Enter profile name"),i&&(i.value=""),this.currentModal="new",this.modalManager.show("profileModal")}showCloneProfileModal(){if(!this.he)return void this.ui?.showToast?.(this.ue("no_profile_selected_to_clone"),"warning");this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.ue("clone_profile")),t&&(t.value=`${this.he.name} Copy`,t.placeholder="Enter new profile name"),i&&(i.value=`Copy of ${this.he.name}`),this.currentModal="clone",this.modalManager.show("profileModal")}showRenameProfileModal(){if(!this.he)return void this.ui?.showToast?.(this.ue("no_profile_selected_to_rename"),"warning");this.document.getElementById("profileModal");const e=this.document.getElementById("profileModalTitle"),t=this.document.getElementById("profileName"),i=this.document.getElementById("profileDescription");e&&(e.textContent=this.ue("rename_profile")),t&&(t.value=this.he.name,t.placeholder="Enter profile name"),i&&(i.value=this.he.description||""),this.currentModal="rename",this.modalManager.show("profileModal")}async handleProfileSave(){const e=this.document.getElementById("profileName"),t=this.document.getElementById("profileDescription");if(!e)return;const i=e.value.trim(),a=t?t.value.trim():"";if(i)try{let e;switch(this.currentModal){case"new":e=await this.request("data:create-profile",{name:i,description:a}),e?.success&&(await this.request("data:switch-profile",{profileId:e.profileId}),await this.renderProfiles(),this.renderKeyGrid(),this.updateProfileInfo(),this.ui?.showToast?.(e.message,"success"));break;case"clone":e=await this.request("data:clone-profile",{sourceId:this.ee,newName:i}),e?.success&&(await this.renderProfiles(),this.ui?.showToast?.(e.message,"success"));break;case"rename":e=await this.request("data:rename-profile",{profileId:this.ee,newName:i,description:a}),e?.success&&(await this.renderProfiles(),this.updateProfileInfo(),this.ui?.showToast?.(e.message||this.ue("profile_renamed"),"success"))}this.modalManager.hide("profileModal"),this.currentModal=null}catch(e){this.ui?.showToast?.(e.message,"error")}else this.ui?.showToast?.(this.ue("profile_name_required"),"error")}confirmDeleteProfile(){this.he?confirm(this.ue("confirm_delete_profile",{name:this.he.name})||`Are you sure you want to delete the profile "${this.he.name}"? This action cannot be undone.`)&&this.deleteCurrentProfile():this.ui?.showToast?.(this.ue("no_profile_selected_to_delete"),"warning")}async deleteCurrentProfile(){try{const e=await this.request("data:delete-profile",{profileId:this.ee});e.success&&(e.switchedProfile&&(this.pe=null,this.renderKeyGrid(),this.updateProfileInfo()),this.renderProfiles(),this.ui?.showToast?.(e.message,"success"))}catch(e){this.ui?.showToast?.(e.message,"error")}}setSelectedKey(e){this.pe=e}getSelectedKey(){return this.pe}handleInitialState(e,t){t&&("DataCoordinator"===e||"ProfileService"===e||t.currentProfile)&&(t.currentProfile&&(this.ee=t.currentProfile),t.currentEnvironment&&(this.le=t.currentEnvironment),"boolean"==typeof t.modified&&(this.me=t.modified),t.profiles&&t.currentProfile&&t.profiles[t.currentProfile]&&(this.he=t.profiles[t.currentProfile]),this.renderProfiles(),this.updateProfileInfo())}getCurrentState(){return{currentProfile:this.ee,currentEnvironment:this.le,modified:this.me}}}class at{static newToOld(e){return e?{command:e.command,type:e.category,parameters:e.parameters||{},signature:e.signature,baseCommand:e.baseCommand,displayText:e.displayText,icon:e.icon,id:e.id}:null}static oldToNew(e){return e?{command:e.command,category:e.type,parameters:e.parameters||{},signature:e.signature||"Unknown()",baseCommand:e.baseCommand||"Unknown",displayText:e.displayText||e.command,icon:e.icon||"⚙️",id:e.id||`legacy_${Date.now()}`}:null}static getCommandString(e){return e?.command||""}static getCategory(e){return e?.category||e?.type||"custom"}static getParameters(e){return e?.parameters||{}}static isParameterized(e){const t=e?.signature;return!!t&&/\(.+\)/.test(t)&&"UnknownCommand(command: string)"!==t}static normalize(e){return e?e.signature&&e.category?this.newToOld(e):e.command&&e.type?{command:e.command,type:e.type,parameters:e.parameters||{},signature:e.signature,baseCommand:e.baseCommand,displayText:e.displayText||e.command,icon:e.icon||"⚙️",id:e.id}:e:null}}const st={"TrayExecByTray(active: number, tray: number, slot: number)":{commandId:"custom_tray",name:"Execute Tray Slot",category:"tray",icon:"⚡",description:"Execute a specific tray slot",parameters:{active:{type:"number",min:0,max:1,default:1,label:"Active",help:"Set to 1 to enable, 0 to disable (temporarily disable without removing)"},tray:{type:"number",min:0,max:9,default:0,label:"Tray Number",help:"Tray number (0-9, displays as 1-10 in UI)"},slot:{type:"number",min:0,max:9,default:0,label:"Slot Number",help:"Slot number (0-9, displays as 1-10 in UI)"},command_type:{type:"select",options:["STOTrayExecByTray","TrayExecByTray"],default:"STOTrayExecByTray",label:"Command Type",help:"STOTrayExecByTray shows binding in UI, TrayExecByTray does not"}}},"TrayExecByTrayWithBackup(active: number, tray: number, slot: number, backup_tray: number, backup_slot: number)":{commandId:"tray_with_backup",name:"Execute Tray with Backup",category:"tray",icon:"⚡",description:"Execute tray slot with backup fallback",parameters:{active:{type:"number",min:0,max:1,default:1,label:"Active State",help:"Primary tray state (0 or 1)"},tray:{type:"number",min:0,max:9,default:0,label:"Primary Tray",help:"Primary tray number"},slot:{type:"number",min:0,max:9,default:0,label:"Primary Slot",help:"Primary slot number"},backup_tray:{type:"number",min:0,max:9,default:0,label:"Backup Tray",help:"Backup tray number"},backup_slot:{type:"number",min:0,max:9,default:0,label:"Backup Slot",help:"Backup slot number"}}},"Communication(verb: string, message: string)":{commandId:"communication",name:"Communication Command",category:"communication",icon:"💬",description:"Send message to chat channel",parameters:{verb:{type:"select",options:["say","team","zone","tell"],default:"say",label:"Channel",help:"Chat channel to send message to"},message:{type:"text",default:"",placeholder:"Enter your message...",label:"Message",help:"Message text to send"}}},"Target(entityName: string)":{commandId:"target_entity",name:"Target Entity",category:"targeting",icon:"🎯",description:"Target specific entity by name",parameters:{entityName:{type:"text",default:"",placeholder:"Entity name...",label:"Entity Name",help:"Name of entity to target"}}},"VFXExclusion(effects: string)":{commandId:"vfx_exclusion",name:"VFX Exclusion List",category:"vfx",icon:"✨",description:"Set visual effects exclusion list",parameters:{effects:{type:"text",default:"",placeholder:"Fx_Explosion,Fx_Beam,Fx_Particle...",label:"Effects List",help:"Comma-separated list of effects to exclude"}}},"VFXExclusionAlias(aliasName: string)":{commandId:"vfx_exclusion_alias",name:"VFX Exclusion Alias",category:"vfx",icon:"✨",description:"Use predefined VFX exclusion alias",parameters:{aliasName:{type:"text",default:"",placeholder:"LowVFX, NoParticles, etc...",label:"Alias Name",help:"Name of predefined VFX exclusion alias"}}},"VFXExclusionMaster()":{commandId:"vfx_exclusion_master",name:"VFX Exclusion Master Alias",category:"vfx",icon:"✨",description:"Combined space and ground VFX suppression alias",parameters:{}},"PowerExec(powerName: string)":{commandId:"power_exec",name:"Execute Power",category:"power",icon:"🔋",description:"Execute specific power by name",parameters:{powerName:{type:"text",default:"",placeholder:"Power name...",label:"Power Name",help:"Name of power to execute"}}},"StaticCombat()":{commandId:"static_combat",name:"Combat Command",category:"combat",icon:"🔥",description:"Static combat command",parameters:{commandName:{type:"hidden",default:"",label:"Command Name"}}},"StaticTargeting()":{commandId:"static_targeting",name:"Targeting Command",category:"targeting",icon:"🎯",description:"Static targeting command",parameters:{commandName:{type:"hidden",default:"",label:"Command Name"}}}};function nt(e){return st[e]||null}const rt=new class extends oe{constructor({eventBus:e=o,dataService:t=null}={}){super(e),this.componentName="ParameterCommandService",this.selectedKey=null,this.selectedAlias=null,this.currentEnvironment="space",this.editingContext=null}onInit(){this.addEventListener("key-selected",e=>{this.selectedKey=e.key||e.name,this.selectedAlias=null}),this.addEventListener("alias-selected",e=>{this.selectedAlias=e.name,this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e.environment;t&&(this.currentEnvironment=t)}),this.addEventListener("parameter-edit:start",e=>{this.editingContext={isEditing:!0,editIndex:e.index,selectedKey:e.key,existingCommand:e.command}}),this.addEventListener("parameter-edit:end",()=>{this.editingContext=null})}getCurrentState(){return{selectedKey:this.selectedKey,selectedAlias:this.selectedAlias,currentEnvironment:this.currentEnvironment,editingContext:this.editingContext}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.selectedKey=t.selectedKey),void 0!==t.selectedAlias&&(this.selectedAlias=t.selectedAlias),void 0!==t.currentEnvironment&&(this.currentEnvironment=t.currentEnvironment),void 0!==t.editingContext&&(this.editingContext=t.editingContext))}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).slice(2,11)}`}generateTrayRangeCommands(e,t,i,a,s,n=1){const r=[];if(t===a)for(let a=i;a<=s;a++)if(1!==n||e.startsWith("+"))if(1===n&&e.startsWith("+"))r.push(`${e} ${t} ${a}`);else{const i=e.replace(/^\+/,"");r.push(`${i} ${n} ${t} ${a}`)}else r.push(`+${e} ${t} ${a}`);else for(let s=t;s<=a;s++)if(1!==n||e.startsWith("+"))if(1===n&&e.startsWith("+"))r.push(`${e} ${s} ${i}`);else{const t=e.replace(/^\+/,"");r.push(`${t} ${n} ${s} ${i}`)}else r.push(`+${e} ${s} ${i}`);return r}generateWholeTrayCommands(e,t,i=1){const a=[];for(let s=0;s<=9;s++)if(1!==i||e.startsWith("+"))if(1===i&&e.startsWith("+"))a.push(`${e} ${t} ${s}`);else{const n=e.replace(/^\+/,"");a.push(`${n} ${i} ${t} ${s}`)}else a.push(`+${e} ${t} ${s}`);return a}generateTrayRangeWithBackupCommands(e,t,i,a,s,n,r,o,c){const l=[];if(t===a)for(let a=i;a<=s;a++){const s=r+(a-i);1===e?l.push(`+TrayExecByTrayWithBackup ${t} ${a} ${n} ${s}`):l.push(`TrayExecByTrayWithBackup ${e} ${t} ${a} ${n} ${s}`)}else for(let s=t;s<=a;s++){const a=n+(s-t);1===e?l.push(`+TrayExecByTrayWithBackup ${s} ${i} ${a} ${r}`):l.push(`TrayExecByTrayWithBackup ${e} ${s} ${i} ${a} ${r}`)}return l}generateWholeTrayWithBackupCommands(e,t,i){const a=[];for(let s=0;s<=9;s++)1===e?a.push(`+TrayExecByTrayWithBackup ${t} ${s} ${i} ${s}`):a.push(`TrayExecByTrayWithBackup ${e} ${t} ${s} ${i} ${s}`);return a}async parseCommandsToObjects(e){const t=e.map(async e=>{try{const t=await this.request("parser:parse-command-string",{commandString:e});if(t.commands&&t.commands.length>0)return t.commands[0]}catch(e){}return{command:e,category:"tray",displayText:e,id:this.generateCommandId(),parameters:{}}});return Promise.all(t)}async buildParameterizedCommand(e,t,i,a={}){"alias"===this.currentEnvironment?this.selectedAlias:this.selectedKey;const s={targeting:e=>"target"!==t&&"target_entity"!==t||!e.entityName?{command:"string"==typeof i.command?i.command:"Target",text:i.name}:{command:`Target "${e.entityName}"`,text:`Target: ${e.entityName}`},tray:async e=>{const a=e.tray||0,s=e.slot||0,n=void 0!==e.active?e.active:1;if("tray_with_backup"===t){const t=e.backup_tray||0,i=e.backup_slot||0;return 1===n?{command:`+TrayExecByTrayWithBackup ${a} ${s} ${t} ${i}`,text:`Execute Tray ${a+1} Slot ${s+1} (backup: Tray ${t+1} Slot ${i+1})`}:{command:`TrayExecByTrayWithBackup ${n} ${a} ${s} ${t} ${i}`,text:`Execute Tray ${a+1} Slot ${s+1} (backup: Tray ${t+1} Slot ${i+1})`}}if("tray_range"===t){const t=e.start_tray||0,a=e.start_slot||0,s=e.end_tray||0,r=e.end_slot||0;let o;if(i.baseCommand)o=i.baseCommand;else if(e.baseCommand)o=e.baseCommand;else{const t=e.command_type||"STOTrayExecByTray";o=1===n?`+${t}`:t}const c=this.generateTrayRangeCommands(o,t,a,s,r,n);return await this.parseCommandsToObjects(c)}if("tray_range_with_backup"===t){const t=e.start_tray||0,i=e.start_slot||0,a=e.end_tray||0,s=e.end_slot||0,r=e.backup_start_tray||0,o=e.backup_start_slot||0,c=e.backup_end_tray||0,l=e.backup_end_slot||0,d=this.generateTrayRangeWithBackupCommands(n,t,i,a,s,r,o,c,l);return await this.parseCommandsToObjects(d)}if("whole_tray"===t){let t;if(i.baseCommand)t=i.baseCommand;else if(e.baseCommand)t=e.baseCommand;else{const i=e.command_type||"STOTrayExecByTray";t=1===n?`+${i}`:i}const s=this.generateWholeTrayCommands(t,a,n);return await this.parseCommandsToObjects(s)}if("whole_tray_with_backup"===t){const t=e.backup_tray||0,i=this.generateWholeTrayWithBackupCommands(n,a,t);return await this.parseCommandsToObjects(i)}let r,o;return this.editingContext&&this.editingContext.isEditing,r=i.baseCommand?i.baseCommand.replace(/^\+/,""):e.baseCommand?e.baseCommand.replace(/^\+/,""):e.command_type?e.command_type:"STOTrayExecByTray",o=1===n?`+${r} ${a} ${s}`:`${r} ${n} ${a} ${s}`,{command:o,text:`Execute Tray ${a+1} Slot ${s+1}`,parameters:{active:n,tray:a,slot:s}}},movement:e=>{let a=i.command;return"throttle_adjust"===t&&void 0!==e.amount?a=`${a||"ThrottleAdjust"} ${e.amount}`:"throttle_set"===t&&void 0!==e.position&&(a=`${a||"ThrottleSet"} ${e.position}`),{command:a||i.name||"Movement Command",text:i.name}},camera:e=>{let a=i.command;return"cam_distance"===t&&void 0!==e.distance&&(a=`${a||"camdist"} ${e.distance}`),{command:a||i.name||"Camera Command",text:i.name}},communication:e=>{const t=i&&i.command?i.command:"say",a=e.verb||t,s=e.message||"Message text here";return{command:`${a} "${s}"`,text:`${a}: "${s}"`}},vfx:e=>{if("vfx_exclusion"===t){const t=e.effects||"";return{command:`dynFxSetFXExclusionList ${t}`,text:`VFX Exclude: ${t}`}}if("vfx_exclusion_alias"===t){const t=e.aliasName||"";return{command:`dynFxSetFXExclusionList_${t}`,text:`VFX Alias: ${t}`}}return{command:i.command,text:i.name}},power:e=>{if("power_exec"===t){const t=e.powerName||"";return{command:`+power_exec ${t}`,text:`Power: ${t}`}}return{command:i.command,text:i.name}},combat:e=>({command:e.commandName||i.command,text:i.name}),system:e=>{let a=i.command;return"bind_save_file"!==t&&"bind_load_file"!==t||!e.filename?"combat_log"===t&&void 0!==e.state?a=`${a||"CombatLog"} ${e.state}`:"ui_remember_positions"===t&&void 0!==e.state?a=`${a||"UIRememberPositions"} ${e.state}`:"chat_log"===t&&void 0!==e.state?a=`${a||"ChatLog"} ${e.state}`:"ui_tooltip_delay"===t&&void 0!==e.seconds?a=`${a||"ui_TooltipDelay"} ${e.seconds}`:"remember_ui_lists"===t&&void 0!==e.state?a=`${a||"RememberUILists"} ${e.state}`:"safe_login"===t&&void 0!==e.state?a=`${a||"SafeLogin"} ${e.state}`:"net_timing_graph"===t&&void 0!==e.state?a=`${a||"netTimingGraph"} ${e.state}`:"net_timing_graph_alpha"===t&&void 0!==e.alpha?a=`${a||"netTimingGraphAlpha"} ${e.alpha}`:"net_timing_graph_paused"===t&&void 0!==e.state?a=`${a||"netTimingGraphPaused"} ${e.state}`:"netgraph"===t&&void 0!==e.state?a=`${a||"netgraph"} ${e.state}`:"ui_load_file"===t&&e.filename?a=`${a||"ui_load_file"} ${e.filename}`:"ui_save_file"===t&&e.filename&&(a=`${a||"ui_save_file"} ${e.filename}`):a=`${a||("bind_save_file"===t?"bind_save_file":"bind_load_file")} ${e.filename}`,{command:a||i.name||"System Command",text:i.name}},alias:e=>{const t=e.alias_name?.trim()||"";return t?{command:t,text:`Alias: ${t}`}:null},bridge_officer:e=>"assist"===t&&e.name?{command:`Assist "${e.name}"`,text:`Assist: ${e.name}`}:"assist"===t?{command:"Assist",text:"Assist Current Target"}:{command:i.command,text:i.name},cosmetic:e=>"setactivecostume"===t&&e.modifier1&&e.modifier2?{command:`${i.command} ${e.modifier1} ${e.modifier2}`,text:`Set Costume: ${e.modifier1} ${e.modifier2}`}:{command:i.command,text:i.name}}[e];if(!s)return null;const n=await s(a);return n?Array.isArray(n)?n:{command:n.command,type:e,icon:i.icon,displayText:n.text,id:this.generateCommandId(),parameters:n.parameters||a}:null}async findCommandDefinition(e){try{const t=at.normalize(e);if(!t)return null;const i=await this.request("parser:parse-command-string",{commandString:t.command});if(!i?.commands?.[0])return null;const a=i.commands[0],s=nt(a.signature);return s&&function(e){const t=nt(e);return!!t&&Object.values(t.parameters||{}).some(e=>"hidden"!==e.type)}(a.signature)?{commandId:s.commandId,categoryId:s.category,name:s.name,description:s.description,icon:s.icon,category:s.category,parameters:s.parameters,signature:a.signature,baseCommand:a.baseCommand,extractedParameters:a.parameters,...a.parameters}:null}catch(e){return null}}}({eventBus:o});rt.init();class ot extends oe{constructor({modalManager:e=null,i18n:t=null,ui:i=null,document:a=null}={}){super(o),this.componentName="ParameterCommandUI",this.modalManager=e,this.i18n=t,this.ui=i,this.document=a||("undefined"!=typeof window?window.document:null),this.pe=null,this._e=null,this.le="space",this.currentParameterCommand=null}onInit(){this.setupEventListeners()}get selectedKey(){return this.pe}set selectedKey(e){this.pe=e}get selectedAlias(){return this._e}set selectedAlias(e){this._e=e}get currentEnvironment(){return this.le}set currentEnvironment(e){this.le=e}setupEventListeners(){this.addEventListener("key-selected",e=>{this.pe=e.key||e.name,this._e=null,this.selectedKey=this.pe}),this.addEventListener("alias-selected",e=>{this._e=e.name,this.pe=null,this.selectedKey=this._e}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.le=t)}),this.addEventListener("parameter-command:edit",({index:e,command:t,commandDef:i,categoryId:a,commandId:s})=>{i&&a&&s&&this.editParameterizedCommand(e,t,i)})}getCurrentState(){return{selectedKey:this.pe,selectedAlias:this._e,currentEnvironment:this.le}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.pe=t.selectedKey,this.selectedKey=t.selectedKey),void 0!==t.selectedAlias&&(this._e=t.selectedAlias,this.selectedKey=t.selectedAlias),void 0!==t.currentEnvironment&&(this.le=t.currentEnvironment))}showParameterModal(e,t,i){this.currentParameterCommand={categoryId:e,commandId:t,commandDef:i},this.document.getElementById("parameterModal")||this.createParameterModal();const a=this.document.getElementById("parameterModal");a&&a.setAttribute("data-command-def",JSON.stringify(i)),this.populateParameterModal(i),this.modalManager?.show("parameterModal")}createParameterModal(){const e=this.document.createElement("div");e.className="modal",e.id="parameterModal",e.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3 id="parameterModalTitle">Configure Command Parameters</h3>\n          <button class="modal-close" data-modal="parameterModal">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n        <div class="modal-body">\n          <div id="parameterInputs"></div>\n          <div class="command-preview-modal">\n            <label>Generated Command:</label>\n            <div class="command-preview" id="parameterCommandPreview"></div>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <button class="btn btn-primary" id="saveParameterCommandBtn">Add Command</button>\n          <button class="btn btn-secondary" data-modal="parameterModal">Cancel</button>\n        </div>\n      </div>',this.document.body.appendChild(e),this.eventBus.onDom("saveParameterCommandBtn","click","parameter-command-save",()=>{this.saveParameterCommand()}),e.querySelectorAll('.modal-close, [data-modal="parameterModal"]').forEach(e=>{e.addEventListener("click",()=>this.cancelParameterCommand())})}cancelParameterCommand(){this.emit("parameter-edit:end"),this.currentParameterCommand=null;const e=this.document.getElementById("saveParameterCommandBtn");e&&(e.textContent=this.i18n?.t?.("add_command")||"Add Command"),this.modalManager?.hide("parameterModal")}populateParameterModal(e){const t=this.document.getElementById("parameterInputs"),i=this.document.getElementById("parameterModalTitle");t&&i&&(i.textContent=`Configure: ${e.name}`,t.innerHTML="",this.buildParameterInputs(t,e),this.updateParameterPreview())}editParameterizedCommand(e,t,i){const a=ye(t);this.currentParameterCommand={categoryId:i.categoryId,commandId:i.commandId,commandDef:i,editIndex:e,originalCommand:t},this.document.getElementById("parameterModal")||this.createParameterModal();const s=this.document.getElementById("parameterModal");s&&s.setAttribute("data-command-def",JSON.stringify(i)),(async()=>{try{const e="undefined"!=typeof i18next?i18next:null,t=(await fe(a,e,{eventBus:this.eventBus})).parameters||{};this.populateParameterModalForEdit(i,t);const s=this.document.getElementById("saveParameterCommandBtn");s&&(s.textContent=this.i18n?.t?.("save_changes")||"Save Changes"),this.modalManager?.show("parameterModal")}catch(e){this.populateParameterModalForEdit(i,{}),this.modalManager?.show("parameterModal")}})()}populateParameterModalForEdit(e,t={}){const i=this.document.getElementById("parameterInputs"),a=this.document.getElementById("parameterModalTitle");i&&a&&(a.textContent=`Edit: ${e.name}`,i.innerHTML="",this.buildParameterInputs(i,e,t),this.updateParameterPreview())}async updateParameterPreview(){if(!this.currentParameterCommand)return;const{categoryId:e,commandId:t}=this.currentParameterCommand,i=this.currentParameterCommand,a=this.getParameterValues();try{const s=await rt.buildParameterizedCommand(e,t,i,a),n=this.document.getElementById("parameterCommandPreview");if(!n||!s)return;if(Array.isArray(s))n.textContent=s.map(e=>e.command||e).filter(e=>e).join(" $$ ");else{let e="";e="string"==typeof s?s:s.command?s.command:"Error: Invalid command format",n.textContent=e}}catch(e){const t=this.document.getElementById("parameterCommandPreview");t&&(t.textContent="Error generating command")}}getParameterValues(){const e=this.document.getElementById("parameterInputs");if(!e)return{};const t={};return e.querySelectorAll("input, select").forEach(e=>{const i=e.name;i&&("number"===e.type?t[i]=""===e.value?void 0:Number(e.value):t[i]=e.value)}),t}async saveParameterCommand(...e){const t=this.le||"space",i="alias"===t?this._e:this.pe;if(!i||!this.currentParameterCommand){const e="alias"===t?this.i18n?.t?.("please_select_an_alias_first")||"Please select an alias first":this.i18n?.t?.("please_select_a_key_first")||"Please select a key first";return void this.ui?.showToast?.(e,"warning")}const{categoryId:a,commandId:s}=this.currentParameterCommand,n=this.currentParameterCommand,r=this.getParameterValues();try{const e=await rt.buildParameterizedCommand(a,s,n,r);if(!e)return;this.currentParameterCommand.isEditing&&void 0!==this.currentParameterCommand.editIndex?this.emit("command:edit",{key:i,index:this.currentParameterCommand.editIndex,updatedCommand:e}):(Array.isArray(e),this.emit("command:add",{command:e,key:i}))}catch(e){return void this.ui?.showToast?.("Error generating command","error")}this.modalManager?.hide("parameterModal"),this.emit("parameter-edit:end"),this.currentParameterCommand=null;const o=this.document.getElementById("saveParameterCommandBtn");o&&(o.textContent=this.i18n?.t?.("add_command")||"Add Command")}async editCommand(e){if("alias"===(this.le||"space")?this._e:this.pe)try{const t=await this.request("command:get-for-selected-key");if(!t||!t[e])return;const i=t[e],a=await rt.findCommandDefinition(i);if(!a)return;this.editParameterizedCommand(e,i,a)}catch(e){}}generateCommandId(...e){return rt.generateCommandId(...e)}async buildParameterizedCommand(...e){return await rt.buildParameterizedCommand(...e)}async findCommandDefinition(...e){return await rt.findCommandDefinition(...e)}formatParameterName(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}getParameterHelp(e,t){return t.help?t.help:{tray:"Tray number (0-9)",slot:"Slot number (0-9)",start_tray:"Starting tray number",end_tray:"Ending tray number",start_slot:"Starting slot number",end_slot:"Ending slot number",backup_tray:"Backup tray number",backup_slot:"Backup slot number",active:"0: Disabled, 1: Enabled",entityName:"Name of the entity to target",message:"Message text to send",distance:"Camera distance value",amount:"Throttle adjustment amount",position:"Throttle position (0-100)",filename:"File name (without extension)",state:"1 to enable, 0 to disable",verb:"Communication channel (say, team, zone)",alias_name:"Name of the alias to execute"}[e]||"Parameter value"}getOptionLabel(e,t){return"verb"===e?this.i18n?.t?.(`verb.${t}`)||t:"STOTrayExecByTray"===t?"STOTrayExecByTray (shows key binding on UI)":"TrayExecByTray"===t?"TrayExecByTray (no UI indication)":t}buildParameterInputs(e,t,i={}){Object.entries(t.parameters).forEach(([t,a])=>{const s=this.document.createElement("div");s.className="form-group";const n=this.document.createElement("label");let r;n.textContent=this.formatParameterName(t),n.setAttribute("for",`param_${t}`);const o=i[t]??a.default;"select"===a.type?(r=this.document.createElement("select"),r.id=`param_${t}`,r.name=t,a.options.forEach(e=>{const i=this.document.createElement("option");i.value=e,i.textContent=this.getOptionLabel(t,e),e===o&&(i.selected=!0),r.appendChild(i)})):(r=this.document.createElement("input"),r.type="number"===a.type?"number":"text",r.id=`param_${t}`,r.name=t,r.value=o??"",a.placeholder&&(r.placeholder=a.placeholder),"number"===a.type&&(void 0!==a.min&&(r.min=a.min),void 0!==a.max&&(r.max=a.max),void 0!==a.step&&(r.step=a.step)));const c=this.document.createElement("small");c.textContent=this.getParameterHelp(t,a),s.appendChild(n),s.appendChild(r),s.appendChild(c),e.appendChild(s),r.addEventListener("input",()=>this.updateParameterPreview()),"SELECT"===r.tagName&&r.addEventListener("change",()=>this.updateParameterPreview())})}}class ct extends oe{constructor({service:e,eventBus:t,ui:i,modalManager:a,document:s}){super(t),this.componentName="CommandLibraryUI",this.service=e,this.ui=i,this.modalManager=a,this.document=s||("undefined"!=typeof window?window.document:null),this.eventListenersSetup=!1,this.cache={profile:null,aliases:{},currentProfile:null},this.le="space",this.pe=null,this._e=null}onInit(){this.setupEventListeners(),this.setupCommandLibrary()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.addEventListener("profile:updated",({profile:e})=>{this.updateCacheFromProfile(e),this.updateCommandLibrary()}),this.addEventListener("profile:switched",({profile:e})=>{this.updateCacheFromProfile(e),this.updateCommandLibrary()}),this.addEventListener("environment:changed",({environment:e})=>{this.le=e;const t=this.document.getElementById("commandSearch"),i=t?t.value:"";this.applySearchFilter(i)}),this.addEventListener("key:selected",({key:e})=>{this.pe=e,this._e=null,this.updateChainActions()}),this.addEventListener("alias:selected",({alias:e})=>{this._e=e,this.pe=null,this.updateChainActions()}),this.addEventListener("language:changed",()=>{this.setupCommandLibrary()}),this.addEventListener("aliases-changed",({aliases:e})=>{e&&(this.cache.aliases=e,this.updateCommandLibrary())}),this.addEventListener("command:filter",({filter:e=""})=>{this.applySearchFilter(e)}))}async setupCommandLibrary(){const e=this.document.getElementById("commandCategoriesList")||this.document.getElementById("commandCategories");if(!e)return;e.innerHTML="";const t=await this.request("command:get-categories");Object.entries(t).forEach(([t,i])=>{const a=this.createCategoryElement(t,i);e.appendChild(a)}),this.filterCommandLibrary(),await this.updateCommandLibrary()}createCategoryElement(e,t){const i=this.document.createElement("div")||{};i.dataset||(i.dataset={}),i.className="category",i.dataset.category=e;const a=`commandCategory_${e}_collapsed`,s="true"===localStorage.getItem(a);i.innerHTML=`\n      <h4 class="${s?"collapsed":""}" data-category="${e}">\n        <i class="fas fa-chevron-right category-chevron"></i>\n        <i class="${t.icon}"></i> \n        ${t.name}\n        <span class="command-count">(${Object.keys(t.commands).length})</span>\n      </h4>\n      <div class="category-commands ${s?"collapsed":""}">\n        ${Object.entries(t.commands).map(([e,t])=>{const i=`command_definitions.${e}.name`,a=void 0!==Q&&Q.exists(i)?Q.t(i):t.name,s=`command_definitions.${e}.description`,n=void 0!==Q&&Q.exists(s)?Q.t(s):t.description;return`\n            <div class="command-item ${t.customizable?"customizable":""}" data-command="${e}" title="${n}${t.customizable?" (Customizable)":""}">\n              ${t.icon} ${a}${t.customizable?' <span class="param-indicator">⚙️</span>':""}\n            </div>\n          `}).join("")}\n      </div>\n    `;const n=i.querySelector?i.querySelector("h4"):null;return n&&n.addEventListener&&n.addEventListener("click",()=>{this.toggleCommandCategory(e,i)}),i.addEventListener&&i.addEventListener("click",e=>{if(e.target.classList.contains("command-item")){const t=e.target.dataset.command,i=e.target.closest(".category").dataset.category,a=STO_DATA?.commands?.[i]?.commands?.[t];if(!a)return;if(a.customizable)this.emit("command-add",{categoryId:i,commandId:t,commandDef:a});else{const e={command:a.command,type:i,icon:a.icon,text:a.name,id:`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};this.emit("command-add",{commandDef:e})}}}),i}toggleCommandCategory(e,t){const i=t.querySelector("h4"),a=t.querySelector(".category-commands"),s=i.querySelector(".category-chevron"),n=`commandCategory_${e}_collapsed`;a.classList.contains("collapsed")?(a.classList.remove("collapsed"),i.classList.remove("collapsed"),s.style.transform="rotate(90deg)",localStorage.setItem(n,"false")):(a.classList.add("collapsed"),i.classList.add("collapsed"),s.style.transform="rotate(0deg)",localStorage.setItem(n,"true"))}createAliasCategoryElement(e,t="aliases",i="command_aliases",a="fas fa-mask"){const s=document.createElement("div");s.className="category",s.dataset.category=t;const n=`commandCategory_${t}_collapsed`,r="true"===localStorage.getItem(n),o="vertigo-aliases"===t,c=o?"👁️":"🎭",l=o?"command-item vertigo-alias-item":"command-item alias-item";return s.innerHTML=`\n            <h4 class="${r?"collapsed":""}" data-category="${t}">\n                <i class="fas fa-chevron-right category-chevron"></i>\n                <i class="${a}"></i>\n                ${void 0!==Q?Q.t(i):i}\n                <span class="command-count">(${e.length})</span>\n            </h4>\n            <div class="category-commands ${r?"collapsed":""}">\n                ${e.map(([e,t])=>`\n                    <div class="${l}" data-alias="${e}" title="${t.description||t.commands}">\n                        ${c} ${t.fe||e}\n                    </div>\n                `).join("")}\n            </div>\n        `,s.querySelector("h4").addEventListener("click",()=>{this.toggleAliasCategory(t,s)}),s.addEventListener("click",t=>{if(t.target.classList.contains("alias-item")||t.target.classList.contains("vertigo-alias-item")){const i=t.target.dataset.alias,a=e.find(([e])=>e===i),s=a?a[1]:{},n="vfx-alias"===s.type,r={command:i,type:s.type,icon:n?"👁️":"🎭",text:`${i}`,description:s.description,isUserAlias:!0,isVfxAlias:n,id:`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};this.emit("command-add",{commandDef:r})}}),s}toggleAliasCategory(e,t){const i=t.querySelector("h4"),a=t.querySelector(".category-commands"),s=i.querySelector(".category-chevron"),n=`commandCategory_${e}_collapsed`;a.classList.contains("collapsed")?(a.classList.remove("collapsed"),i.classList.remove("collapsed"),s.style.transform="rotate(90deg)",localStorage.setItem(n,"false")):(a.classList.add("collapsed"),i.classList.add("collapsed"),s.style.transform="rotate(0deg)",localStorage.setItem(n,"true"))}async updateCommandLibrary(){if(!this.cache.profile)return;const e=this.document.getElementById("aliasCategoriesList")||this.document.getElementById("commandCategories");if(!e)return;const t=Object.entries(this.cache.aliases),i=await Promise.all(t.map(async([e,t])=>("vfx-alias"!==t.type||t.fe||(t.fe=await this.ye(e,t)),[e,t]))),a=i.filter(([,e])=>"vfx-alias"!==e.type),s=i.filter(([,e])=>"vfx-alias"===e.type),n=this.document.createDocumentFragment();a.length>0&&n.appendChild(this.createAliasCategoryElement(a,"aliases","command_aliases","fas fa-mask")),s.length>0&&n.appendChild(this.createAliasCategoryElement(s,"vertigo-aliases","vfx_aliases","fas fa-eye-slash")),e.replaceChildren(n)}filterCommandLibrary(){se(this.eventBus,"command:filter-library").catch(()=>{})}updateChainActions(){if(window.commandChainUI&&"function"==typeof window.commandChainUI.updateChainActions)return void window.commandChainUI.updateChainActions();const e=!!("alias"===this.le?this._e:this.pe),t=this.document;if("alias"===this.le){["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(i=>{const a=t.getElementById(i);a&&(a.disabled=!e)});const i=t.getElementById("addCommandBtn");i&&(i.disabled=!e);const a=t.getElementById("importFromKeyOrAliasBtn");a&&(a.disabled=!e.duplicateKeyBtn.forEach(e=>{const i=t.getElementById(e);i&&(i.disabled=!0)}))}else["addCommandBtn","importFromKeyOrAliasBtn","deleteKeyBtn","duplicateKeyBtn"].forEach(i=>{const a=t.getElementById(i);a&&(a.disabled=!e)}).duplicateAliasChainBtn.forEach(e=>{const i=t.getElementById(e);i&&(i.disabled=!0)})}toggleLibrary(){const e=this.document.getElementById("libraryContent"),t=this.document.getElementById("toggleLibraryBtn");if(e&&t){const i="none"===e.style.display;e.style.display=i?"block":"none";const a=t.querySelector("i");a&&(a.className=i?"fas fa-chevron-up":"fas fa-chevron-down")}}showTemplateModal(){this.ui?.showToast?.(Q.t("template_system_coming_soon"))}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.currentProfile=e.id,this.cache.aliases=e.aliases||{})}getCurrentState(){return{aliases:this.cache.aliases,currentProfile:this.cache.currentProfile,currentEnvironment:this.le,selectedKey:this.pe,selectedAlias:this._e}}handleInitialState(e,t){"DataCoordinator"===t&&e.currentProfileData&&(this.updateCacheFromProfile(e.currentProfileData),this.updateCommandLibrary())}async applySearchFilter(e){const t=(e||"").trim().toLowerCase(),i=this.document||("undefined"!=typeof window?window.document:void 0);if(!i)return;const a=i.getElementById("commandCategories")||i.querySelector(".command-categories");if(!a)return;a.querySelectorAll(".command-item, .alias-item, .vertigo-alias-item").forEach(e=>{const i="true"===e.dataset.envHidden;if(!t)return void(i||(e.style.display="flex"));const a=(e.textContent||"").toLowerCase().includes(t);e.style.display=a&&!i?"flex":"none"}),a.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item:not([style*="display: none"]), .alias-item:not([style*="display: none"]), .vertigo-alias-item:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"});const s=i.getElementById("commandSearchBtn");s&&(s.classList.toggle("active",!!t),s.setAttribute("aria-pressed",!!t))}async ye(e,t){if("vfx-alias"===t.type)try{const t=await se(this.eventBus,"parser:parse-command-string",{commandString:e,options:{generateDisplayText:!0}}),i=t?.commands?.[0];if(i?.displayText)return i.displayText}catch{}return e}}class lt extends oe{constructor({eventBus:e=o,ui:t=null,modalManager:i=null,parameterCommandUI:a=null,document:s=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="CommandUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.modalManager=i,this.parameterCommandUI=a,this.pe=null,this._e=null,this.le="space",this.ge={warnings:[],errors:[]},this.document=s}onInit(){this.setupEventListeners(),this.setupUIStateEventListeners(),this.addEventListener("command-add",async(e={})=>{const{categoryId:t,commandId:i,commandDef:a}=e;if(!a||t||i)t&&i&&a&&this.parameterCommandUI&&this.parameterCommandUI.showParameterModal(t,i,a);else try{const e=this.getSelectedKey();if(!e){const e=this.getCurrentEnvironment(),t="alias"===e?"please_select_an_alias_first":"please_select_a_key_first",i=await this.getI18nMessage(t)||("alias"===e?"Please select an alias first":"Please select a key first");return void await this.showToast(i,"warning")}this.emit("command:add",{command:a,key:e})}catch(e){}}),this.addEventListener("command-chain:validation-result",async({severity:e,warnings:t=[],errors:i=[]})=>{const a=this.document.getElementById("statusIndicator");if(!a)return;const s=a.querySelector("i"),n=a.querySelector("span");if(!s||!n)return;const r={success:{icon:"fa-check-circle",textKey:"valid",textDefault:"Valid",color:"status-success"},warning:{icon:"fa-exclamation-triangle",textKey:"warning",textDefault:"Warning",color:"status-warning"},error:{icon:"fa-exclamation-circle",textKey:"error",textDefault:"Error",color:"status-error"}},o=r[e]||r.success;s.className=`fas ${o.icon}`;try{const e=await this.request("i18n:translate",{key:o.textKey}),t=e&&e!==o.textKey?e:o.textDefault;n.textContent=t,n.setAttribute("data-i18n",o.textKey)}catch{n.textContent=o.textDefault,n.setAttribute("data-i18n",o.textKey)}a.classList.remove("status-success","status-warning","status-error"),a.classList.add(o.color),this.ge={warnings:t,errors:i},"success"!==e&&(t.length||i.length)?(a.classList.add("clickable"),a.onclick=()=>this.showValidationDetails()):(a.classList.remove("clickable"),a.onclick=null)})}setupUIStateEventListeners(){this.addEventListener("key-selected",e=>{this.pe=e.key||e.name,this._e=null}),this.addEventListener("alias-selected",e=>{this._e=e.name,this.pe=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.le=t)})}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addCommandBtn","click","command-add-modal",()=>{this.modalManager.show("addCommandModal")}),this.eventBus.onDom("clearChainBtn","click","command-chain-clear",()=>{const e=this.getSelectedKey();e&&this.confirmClearChain(e)}),this.eventBus.onDom("validateChainBtn","click","command-chain-validate",()=>{const e=this.getSelectedKey();e&&this.validateCurrentChain(e)}),this.eventBus.onDomDebounced("commandSearch","input","command-search",e=>{this.filterCommands(e.target.value)},250),this.eventBus.onDom("commandSearch","keydown","command-search-key",e=>{if("Escape"===e.key){const t=e.target;t.value="",t.classList.remove("expanded"),this.emit("command:filter",{filter:""})}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllCommandsBtn","click","command-clear-filter",()=>{const e=this.document.getElementById("commandSearch");if(e){e.value="";const t=new Event("input",{bubbles:!0});e.dispatchEvent(t)}this.filterCommands("")}),this.eventBus.onDom("commandSearchBtn","click","command-search-toggle",()=>{this.toggleCommandSearch()}),this.eventBus.onDom("importFromKeyOrAliasBtn","click","import-from-key-or-alias",()=>{this.showImportFromKeyOrAliasModal()}),this.eventBus.onDom("saveCommandBtn","click","save-command",()=>{this.saveCommand()}),this.eventBus.onDom("confirmImportBtn","click","confirm-import",()=>{this.performImport()}))}getSelectedKey(){return"alias"===this.le?this._e:this.pe}getCurrentEnvironment(){return this.le}getCurrentState(){return{selectedKey:this.pe,selectedAlias:this._e,currentEnvironment:this.le}}handleInitialState(e,t){t&&(void 0!==t.selectedKey&&(this.pe=t.selectedKey),void 0!==t.selectedAlias&&(this._e=t.selectedAlias),void 0!==t.currentEnvironment&&(this.le=t.currentEnvironment))}async getI18nMessage(e,t={}){try{return await this.request("i18n:translate",{key:e,params:t})}catch(e){return null}}async showToast(e,t="info"){try{this.ui?.showToast?this.ui.showToast(e,t):await this.request("toast:show",{message:e,type:t})}catch(t){alert(e)}}async confirmClearChain(e){if(e)try{const t=await this.getI18nMessage("confirm_clear_commands",{keyName:e})||`Clear command chain for ${e}?`;confirm(t)&&this.emit("command-chain:clear",{key:e})}catch(e){}}async validateCurrentChain(e){if(e){let t=!1;try{t=await this.request("command-chain:is-stabilized",{name:e})}catch(e){}const i="alias"===this.getCurrentEnvironment();this.emit("command-chain:validate",{key:e,stabilized:t,isAlias:i})}}filterCommands(e){this.emit("command:filter",{filter:e});const t=this.document.getElementById("commandSearchBtn");if(t){const i=!(!e||!e.trim());t.classList.toggle("active",i),t.setAttribute("aria-pressed",i)}}toggleCommandSearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("commandSearch");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}async showImportFromKeyOrAliasModal(){if(!this.getSelectedKey()){const e=this.getCurrentEnvironment(),t="alias"===e?"please_select_an_alias_first":"please_select_a_key_first",i=await this.getI18nMessage(t)||("alias"===e?"Please select an alias first":"Please select a key first");return void await this.showToast(i,"warning")}await this.populateImportSources(),this.modalManager&&this.modalManager.show("importFromKeyOrAliasModal")}async populateImportSources(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("importSourceSelect");if(!t)return;t.innerHTML="";const i=this.getCurrentEnvironment(),a=this.getSelectedKey();try{if("alias"===i){const i=await this.request("data:get-keys",{environment:"space"})||{};Object.keys(i).forEach(a=>{if(Object.keys(i[a]||{}).length>0){const i=e.createElement("option");i.value=`space:${a}`,i.textContent=`Space: ${a}`,t.appendChild(i)}});const s=await this.request("data:get-keys",{environment:"ground"})||{};Object.keys(s).forEach(i=>{if(Object.keys(s[i]||{}).length>0){const a=e.createElement("option");a.value=`ground:${i}`,a.textContent=`Ground: ${i}`,t.appendChild(a)}});const n=await this.request("alias:get-all")||{};Object.keys(n).forEach(i=>{if(i!==a&&n[i]?.commands){const a=e.createElement("option");a.value=`alias:${i}`,a.textContent=`Alias: ${i}`,t.appendChild(a)}})}else{const s=await this.request("data:get-keys",{environment:"space"})||{};Object.keys(s).forEach(n=>{if(("space"!==i||n!==a)&&Object.keys(s[n]||{}).length>0){const i=e.createElement("option");i.value=`space:${n}`,i.textContent=`Space: ${n}`,t.appendChild(i)}});const n=await this.request("data:get-keys",{environment:"ground"})||{};Object.keys(n).forEach(s=>{if(("ground"!==i||s!==a)&&Object.keys(n[s]||{}).length>0){const i=e.createElement("option");i.value=`ground:${s}`,i.textContent=`Ground: ${s}`,t.appendChild(i)}});const r=await this.request("alias:get-all")||{};Object.keys(r).forEach(i=>{if(r[i]?.commands){const a=e.createElement("option");a.value=`alias:${i}`,a.textContent=`Alias: ${i}`,t.appendChild(a)}})}if(0===t.children.length){const i=e.createElement("option");i.value="",i.textContent=await this.getI18nMessage("no_sources_available")||"No sources available",i.disabled=!0,t.appendChild(i)}}catch(i){const a=e.createElement("option");a.value="",a.textContent=await this.getI18nMessage("error_loading_sources")||"Error loading sources",a.disabled=!0,t.appendChild(a)}}async isCommandCompatible(e,t){if(!e)return!0;try{const i=await this.request("data:find-command-by-name",{command:e});if(e.toLowerCase().includes("holster"),!i||!i.environment)return e.toLowerCase().includes("holster"),!0;const a=i.environment===t;return e.toLowerCase().includes("holster"),a}catch(e){return!0}}async performImport(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("importSourceSelect"),i=e.getElementById("clearDestinationBeforeImport");if(!t||!i)return;const a=t.value,s=i.checked,n=this.getSelectedKey();if(!a||!n){const e=await this.getI18nMessage("please_select_a_source")||"Please select a source";return void await this.showToast(e,"warning")}try{const[e,t]=a.split(":");let i=[];if("alias"===e){const e=(await this.request("alias:get-all")||{})[t];if(e&&e.commands){let t;t=Array.isArray(e.commands)?e.commands.join(" $$ "):e.commands,t&&t.trim()&&(i=(await this.request("parser:parse-command-string",{commandString:t})).commands||[])}}else i=await this.request("data:get-key-commands",{environment:e,key:t})||[];if(0===i.length){const e=await this.getI18nMessage("source_has_no_commands")||"Source has no commands to import";return void await this.showToast(e,"warning")}const r=this.getCurrentEnvironment();let o=i,c=0;if("alias"!==r&&"alias"!==e&&e!==r){const t=i.length,a=i.map(async e=>({command:e,isCompatible:await this.isCommandCompatible(e,r)}));if(o=(await Promise.all(a)).filter(e=>e.isCompatible).map(e=>e.command),c=t-o.length,c>0){const t=e.charAt(0).toUpperCase()+e.slice(1),i=r.charAt(0).toUpperCase()+r.slice(1),a=await this.getI18nMessage("cross_environment_import_warning",{dropped:c,sourceEnv:t,targetEnv:i})||`Warning: ${c} ${t}-specific commands were dropped when importing to ${i}`;await this.showToast(a,"warning")}}if(0===o.length){const e=await this.getI18nMessage("no_compatible_commands_to_import")||"No compatible commands to import after filtering";return void await this.showToast(e,"warning")}s&&await this.request("command-chain:clear",{key:n});for(const e of o)await this.request("command:add",{key:n,command:e});const l=await this.getI18nMessage("commands_imported_successfully",{count:o.length,source:t})||`Imported ${o.length} commands from ${t}`;await this.showToast(l,"success"),this.modalManager&&this.modalManager.hide("importFromKeyOrAliasModal")}catch(e){const t=await this.getI18nMessage("import_failed",{error:e?.message||e})||`Import failed: ${e?.message||e}`;await this.showToast(t,"error")}}async saveCommand(){const e=this.document.getElementById("commandType")?.value,t=this.document.getElementById("modalCommandPreview")?.textContent;if(!e||!t){const e=await this.getI18nMessage("please_complete_command_configuration")||"Please complete the command configuration";return void await this.showToast(e,"warning")}const i=this.getSelectedKey();if(!i){const e=this.getCurrentEnvironment(),t="alias"===e?"please_select_an_alias_first":"please_select_a_key_first",i=await this.getI18nMessage(t)||("alias"===e?"Please select an alias first":"Please select a key first");return void await this.showToast(i,"warning")}this.emit("command:save",{key:i,type:e,command:t}),this.modalManager&&this.modalManager.hide("addCommandModal")}async showValidationDetails(){const{warnings:e=[],errors:t=[]}=this.ge||{};if(!e.length&&!t.length)return;const i=async e=>"string"==typeof e?this.request("i18n:translate",{key:e}).catch(()=>e):e&&e.key?this.request("i18n:translate",{key:e.key,params:e.params||{}}).catch(()=>e.defaultMessage||e.key):e&&e.defaultMessage?e.defaultMessage:"",a=await Promise.all(t.map(i)),s=await Promise.all(e.map(i)),n=await i("error"),r=await i("warning");let o="";a.length&&(o+=`<h4>${n}</h4><ul>${a.map(e=>`<li class="error-item">${e}</li>`).join("")}</ul>`),s.length&&(o+=`<h4>${r}</h4><ul>${s.map(e=>`<li class="warning-item">${e}</li>`).join("")}</ul>`);const c=e=>this.request("i18n:translate",{key:e}),l=await c("validation_details")||"Validation Details",d=await c("ok")||"OK",m="validationDetailsModal",h=this.document.getElementById(m);h&&h.remove();const u=this.document.createElement("div");u.id=m,u.className="modal",u.innerHTML=`\n      <div class="modal-content">\n        <div class="modal-header"><h3>${l}</h3></div>\n        <div class="modal-body">${o}</div>\n        <div class="modal-footer"><button class="btn btn-primary" id="validationOkBtn">${d}</button></div>\n      </div>`,this.document.body.appendChild(u),u.querySelector("#validationOkBtn").addEventListener("click",()=>{this.modalManager&&this.modalManager.hide(m),u.remove()}),this.modalManager?this.modalManager.show(m):requestAnimationFrame(()=>u.classList.add("active"))}}class dt extends oe{constructor({eventBus:e,ui:t=null,profileUI:i=null,document:a=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="InterfaceModeUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.profileUI=i,this.document=a,this.q="space",this.be=!1,this.we={},this.ve={},this.ke=null,this.Se=null}init(){super.init(),this.setupEventListeners(),this.setupModeButtons()}setupEventListeners(){this.be||(this.ke=e=>{const t="string"==typeof e?e:e?.newMode;t&&(this.q=t,this.updateModeUI(t))},this.Se=(e={})=>{const t="string"==typeof e?e:e.environment||e.newMode||e.mode;t&&(this.q=t,this.updateModeUI(t))},this.eventBus.on("mode-changed",this.ke),this.eventBus.on("environment:changed",this.Se),this.be=!0)}setupModeButtons(){this.we.space=this.document.querySelector('[data-mode="space"]'),this.we.ground=this.document.querySelector('[data-mode="ground"]'),this.we.alias=this.document.querySelector('[data-mode="alias"]'),Object.entries(this.we).forEach(([e,t])=>{if(t){const i=()=>{this.handleModeButtonClick(e)};this.ve[e]=i,t.addEventListener("click",i)}})}async handleModeButtonClick(e){try{(await this.request("environment:switch",{mode:e})).success}catch(e){}}updateModeUI(e){Object.entries(this.we).forEach(([t,i])=>{i&&i.classList.toggle("active",t===e)}),this.updateKeyGridDisplay(e)}updateKeyGridDisplay(e){const t=this.document.querySelector(".key-selector-container"),i=this.document.getElementById("aliasSelectorContainer");"alias"===e?(t&&(t.style.display="none"),i&&(i.style.display="")):(t&&(t.style.display=""),i&&(i.style.display="none"),this.profileUI&&this.profileUI.renderKeyGrid()),this.profileUI}get currentMode(){return this.q}set currentMode(e){this.q=e,se(this.eventBus,"environment:switch",{mode:e}).catch(e=>{})}get currentEnvironment(){return this.q}set currentEnvironment(e){this.currentMode=e}getCurrentMode(){return this.currentMode}async setCurrentMode(e){try{const t=await this.request("environment:switch",{mode:e});t.success&&(this.q=t.mode,this.updateModeUI(t.mode))}catch(e){}}destroy(){this.be&&(this.eventBus.off("mode-changed",this.ke),this.eventBus.off("environment:changed",this.Se),this.be=!1),Object.entries(this.we).forEach(([e,t])=>{t&&this.ve[e]&&t.removeEventListener("click",this.ve[e])}),this.ve={},super.destroy()}handleInitialState(e,t){t&&("InterfaceModeService"===e||t.environment)&&t.environment&&this.updateModeUI(t.environment)}}const mt={F1:{row:0,col:0,width:1},F2:{row:0,col:1,width:1},F3:{row:0,col:2,width:1},F4:{row:0,col:3,width:1},F5:{row:0,col:5,width:1},F6:{row:0,col:6,width:1},F7:{row:0,col:7,width:1},F8:{row:0,col:8,width:1},F9:{row:0,col:10,width:1},F10:{row:0,col:11,width:1},F11:{row:0,col:12,width:1},F12:{row:0,col:13,width:1},Escape:{row:1,col:0,width:1},Digit1:{row:1,col:1,width:1},Digit2:{row:1,col:2,width:1},Digit3:{row:1,col:3,width:1},Digit4:{row:1,col:4,width:1},Digit5:{row:1,col:5,width:1},Digit6:{row:1,col:6,width:1},Digit7:{row:1,col:7,width:1},Digit8:{row:1,col:8,width:1},Digit9:{row:1,col:9,width:1},Digit0:{row:1,col:10,width:1},Minus:{row:1,col:11,width:1},Equal:{row:1,col:12,width:1},Tab:{row:2,col:0,width:1.5},KeyQ:{row:2,col:1.5,width:1},KeyW:{row:2,col:2.5,width:1},KeyE:{row:2,col:3.5,width:1},KeyR:{row:2,col:4.5,width:1},KeyT:{row:2,col:5.5,width:1},KeyY:{row:2,col:6.5,width:1},KeyU:{row:2,col:7.5,width:1},KeyI:{row:2,col:8.5,width:1},KeyO:{row:2,col:9.5,width:1},KeyP:{row:2,col:10.5,width:1},BracketLeft:{row:2,col:11.5,width:1},BracketRight:{row:2,col:12.5,width:1},CapsLock:{row:3,col:0,width:1.75},KeyA:{row:3,col:1.75,width:1},KeyS:{row:3,col:2.75,width:1},KeyD:{row:3,col:3.75,width:1},KeyF:{row:3,col:4.75,width:1},KeyG:{row:3,col:5.75,width:1},KeyH:{row:3,col:6.75,width:1},KeyJ:{row:3,col:7.75,width:1},KeyK:{row:3,col:8.75,width:1},KeyL:{row:3,col:9.75,width:1},Quote:{row:3,col:10.75,width:1},ShiftLeft:{row:4,col:0,width:2.25},KeyZ:{row:4,col:2.25,width:1},KeyX:{row:4,col:3.25,width:1},KeyC:{row:4,col:4.25,width:1},KeyV:{row:4,col:5.25,width:1},KeyB:{row:4,col:6.25,width:1},KeyN:{row:4,col:7.25,width:1},KeyM:{row:4,col:8.25,width:1},Comma:{row:4,col:9.25,width:1},Period:{row:4,col:10.25,width:1},ShiftRight:{row:4,col:11.25,width:2.75},ControlLeft:{row:5,col:0,width:1.5},AltLeft:{row:5,col:1.5,width:1.5},Space:{row:5,col:3,width:6},AltRight:{row:5,col:9,width:1.5},ControlRight:{row:5,col:10.5,width:1.5},Insert:{row:0,col:14.5,width:1},Delete:{row:0,col:15.5,width:1},Home:{row:1,col:14.5,width:1},End:{row:1,col:15.5,width:1},PageUp:{row:2,col:14.5,width:1},PageDown:{row:2,col:15.5,width:1},ArrowUp:{row:3,col:15,width:1},ArrowLeft:{row:4,col:14,width:1},ArrowDown:{row:4,col:15,width:1},ArrowRight:{row:4,col:16,width:1},NumpadDivide:{row:0,col:17,width:1},NumpadMultiply:{row:0,col:18,width:1},NumpadSubtract:{row:0,col:19,width:1},Numpad7:{row:1,col:17,width:1},Numpad8:{row:1,col:18,width:1},Numpad9:{row:1,col:19,width:1},NumpadAdd:{row:1,col:20,width:1},Numpad4:{row:2,col:17,width:1},Numpad5:{row:2,col:18,width:1},Numpad6:{row:2,col:19,width:1},Numpad1:{row:3,col:17,width:1},Numpad2:{row:3,col:18,width:1},Numpad3:{row:3,col:19,width:1},NumpadEnter:{row:3,col:20,width:1},Numpad0:{row:4,col:17,width:2},NumpadDecimal:{row:4,col:19,width:1}},ht={name:"QWERTY",languages:["en","es"],keys:{Digit1:{primary:"1",secondary:""},Digit2:{primary:"2",secondary:""},Digit3:{primary:"3",secondary:""},Digit4:{primary:"4",secondary:""},Digit5:{primary:"5",secondary:""},Digit6:{primary:"6",secondary:""},Digit7:{primary:"7",secondary:""},Digit8:{primary:"8",secondary:""},Digit9:{primary:"9",secondary:""},Digit0:{primary:"0",secondary:""},KeyQ:{primary:"Q",secondary:""},KeyW:{primary:"W",secondary:""},KeyE:{primary:"E",secondary:""},KeyR:{primary:"R",secondary:""},KeyT:{primary:"T",secondary:""},KeyY:{primary:"Y",secondary:""},KeyU:{primary:"U",secondary:""},KeyI:{primary:"I",secondary:""},KeyO:{primary:"O",secondary:""},KeyP:{primary:"P",secondary:""},KeyA:{primary:"A",secondary:""},KeyS:{primary:"S",secondary:""},KeyD:{primary:"D",secondary:""},KeyF:{primary:"F",secondary:""},KeyG:{primary:"G",secondary:""},KeyH:{primary:"H",secondary:""},KeyJ:{primary:"J",secondary:""},KeyK:{primary:"K",secondary:""},KeyL:{primary:"L",secondary:""},KeyZ:{primary:"Z",secondary:""},KeyX:{primary:"X",secondary:""},KeyC:{primary:"C",secondary:""},KeyV:{primary:"V",secondary:""},KeyB:{primary:"B",secondary:""},KeyN:{primary:"N",secondary:""},KeyM:{primary:"M",secondary:""},Minus:{primary:"-",secondary:""},Equal:{primary:"=",secondary:""},BracketLeft:{primary:"[",secondary:""},BracketRight:{primary:"]",secondary:""},Quote:{primary:"'",secondary:""},Comma:{primary:",",secondary:""},Period:{primary:".",secondary:""},Space:{primary:"Space",secondary:""},Tab:{primary:"Tab",secondary:""},Escape:{primary:"Esc",secondary:""},Delete:{primary:"Del",secondary:""},CapsLock:{primary:"Caps",secondary:""},ShiftLeft:{primary:"Shift",secondary:""},ShiftRight:{primary:"Shift",secondary:""},ControlLeft:{primary:"Ctrl",secondary:""},ControlRight:{primary:"Ctrl",secondary:""},AltLeft:{primary:"Alt",secondary:""},AltRight:{primary:"Alt",secondary:""},ArrowUp:{primary:"↑",secondary:""},ArrowDown:{primary:"↓",secondary:""},ArrowLeft:{primary:"←",secondary:""},ArrowRight:{primary:"→",secondary:""},Home:{primary:"Home",secondary:""},End:{primary:"End",secondary:""},PageUp:{primary:"PgUp",secondary:""},PageDown:{primary:"PgDn",secondary:""},Insert:{primary:"Ins",secondary:""},F1:{primary:"F1",secondary:""},F2:{primary:"F2",secondary:""},F3:{primary:"F3",secondary:""},F4:{primary:"F4",secondary:""},F5:{primary:"F5",secondary:""},F6:{primary:"F6",secondary:""},F7:{primary:"F7",secondary:""},F8:{primary:"F8",secondary:""},F9:{primary:"F9",secondary:""},F10:{primary:"F10",secondary:""},F11:{primary:"F11",secondary:""},F12:{primary:"F12",secondary:""},NumpadDivide:{primary:"/",secondary:""},NumpadMultiply:{primary:"*",secondary:""},NumpadSubtract:{primary:"-",secondary:""},NumpadAdd:{primary:"+",secondary:""},NumpadEnter:{primary:"Enter",secondary:""},NumpadDecimal:{primary:".",secondary:""},Numpad0:{primary:"0",secondary:""},Numpad1:{primary:"1",secondary:""},Numpad2:{primary:"2",secondary:""},Numpad3:{primary:"3",secondary:""},Numpad4:{primary:"4",secondary:""},Numpad5:{primary:"5",secondary:""},Numpad6:{primary:"6",secondary:""},Numpad7:{primary:"7",secondary:""},Numpad8:{primary:"8",secondary:""},Numpad9:{primary:"9",secondary:""}}},ut={name:"QWERTZ",languages:["de"],keys:{Digit1:{primary:"1",secondary:""},Digit2:{primary:"2",secondary:""},Digit3:{primary:"3",secondary:""},Digit4:{primary:"4",secondary:""},Digit5:{primary:"5",secondary:""},Digit6:{primary:"6",secondary:""},Digit7:{primary:"7",secondary:""},Digit8:{primary:"8",secondary:""},Digit9:{primary:"9",secondary:""},Digit0:{primary:"0",secondary:""},KeyQ:{primary:"Q",secondary:""},KeyW:{primary:"W",secondary:""},KeyE:{primary:"E",secondary:""},KeyR:{primary:"R",secondary:""},KeyT:{primary:"T",secondary:""},KeyZ:{primary:"Y",secondary:""},KeyU:{primary:"U",secondary:""},KeyI:{primary:"I",secondary:""},KeyO:{primary:"O",secondary:""},KeyP:{primary:"P",secondary:""},KeyA:{primary:"A",secondary:""},KeyS:{primary:"S",secondary:""},KeyD:{primary:"D",secondary:""},KeyF:{primary:"F",secondary:""},KeyG:{primary:"G",secondary:""},KeyH:{primary:"H",secondary:""},KeyJ:{primary:"J",secondary:""},KeyK:{primary:"K",secondary:""},KeyL:{primary:"L",secondary:""},KeyY:{primary:"Z",secondary:""},KeyX:{primary:"X",secondary:""},KeyC:{primary:"C",secondary:""},KeyV:{primary:"V",secondary:""},KeyB:{primary:"B",secondary:""},KeyN:{primary:"N",secondary:""},KeyM:{primary:"M",secondary:""},Minus:{primary:"-",secondary:""},Equal:{primary:"=",secondary:""},BracketLeft:{primary:"[",secondary:""},BracketRight:{primary:"]",secondary:""},Quote:{primary:"'",secondary:""},Comma:{primary:",",secondary:""},Period:{primary:".",secondary:""},Space:{primary:"Space",secondary:""},Tab:{primary:"Tab",secondary:""},Escape:{primary:"Esc",secondary:""},Delete:{primary:"Del",secondary:""},CapsLock:{primary:"Caps",secondary:""},ShiftLeft:{primary:"Shift",secondary:""},ShiftRight:{primary:"Shift",secondary:""},ControlLeft:{primary:"Ctrl",secondary:""},ControlRight:{primary:"Ctrl",secondary:""},AltLeft:{primary:"Alt",secondary:""},AltRight:{primary:"Alt",secondary:""},ArrowUp:{primary:"↑",secondary:""},ArrowDown:{primary:"↓",secondary:""},ArrowLeft:{primary:"←",secondary:""},ArrowRight:{primary:"→",secondary:""},Home:{primary:"Home",secondary:""},End:{primary:"End",secondary:""},PageUp:{primary:"PgUp",secondary:""},PageDown:{primary:"PgDn",secondary:""},Insert:{primary:"Ins",secondary:""},F1:{primary:"F1",secondary:""},F2:{primary:"F2",secondary:""},F3:{primary:"F3",secondary:""},F4:{primary:"F4",secondary:""},F5:{primary:"F5",secondary:""},F6:{primary:"F6",secondary:""},F7:{primary:"F7",secondary:""},F8:{primary:"F8",secondary:""},F9:{primary:"F9",secondary:""},F10:{primary:"F10",secondary:""},F11:{primary:"F11",secondary:""},F12:{primary:"F12",secondary:""}}},pt={name:"AZERTY",languages:["fr"],keys:{Digit1:{primary:"1",secondary:""},Digit2:{primary:"2",secondary:""},Digit3:{primary:"3",secondary:""},Digit4:{primary:"4",secondary:""},Digit5:{primary:"5",secondary:""},Digit6:{primary:"6",secondary:""},Digit7:{primary:"7",secondary:""},Digit8:{primary:"8",secondary:""},Digit9:{primary:"9",secondary:""},Digit0:{primary:"0",secondary:""},KeyA:{primary:"Q",secondary:""},KeyQ:{primary:"A",secondary:""},KeyZ:{primary:"W",secondary:""},KeyW:{primary:"Z",secondary:""},KeyE:{primary:"E",secondary:""},KeyR:{primary:"R",secondary:""},KeyT:{primary:"T",secondary:""},KeyY:{primary:"Y",secondary:""},KeyU:{primary:"U",secondary:""},KeyI:{primary:"I",secondary:""},KeyO:{primary:"O",secondary:""},KeyP:{primary:"P",secondary:""},KeyS:{primary:"S",secondary:""},KeyD:{primary:"D",secondary:""},KeyF:{primary:"F",secondary:""},KeyG:{primary:"G",secondary:""},KeyH:{primary:"H",secondary:""},KeyJ:{primary:"J",secondary:""},KeyK:{primary:"K",secondary:""},KeyL:{primary:"L",secondary:""},KeyX:{primary:"X",secondary:""},KeyC:{primary:"C",secondary:""},KeyV:{primary:"V",secondary:""},KeyB:{primary:"B",secondary:""},KeyN:{primary:"N",secondary:""},KeyM:{primary:"M",secondary:""},Minus:{primary:"-",secondary:""},Equal:{primary:"=",secondary:""},BracketLeft:{primary:"[",secondary:""},BracketRight:{primary:"]",secondary:""},Quote:{primary:"'",secondary:""},Comma:{primary:",",secondary:""},Period:{primary:".",secondary:""},Space:{primary:"Space",secondary:""},Tab:{primary:"Tab",secondary:""},Escape:{primary:"Esc",secondary:""},Delete:{primary:"Del",secondary:""},CapsLock:{primary:"Caps",secondary:""},ShiftLeft:{primary:"Shift",secondary:""},ShiftRight:{primary:"Shift",secondary:""},ControlLeft:{primary:"Ctrl",secondary:""},ControlRight:{primary:"Ctrl",secondary:""},AltLeft:{primary:"Alt",secondary:""},AltRight:{primary:"Alt",secondary:""},ArrowUp:{primary:"↑",secondary:""},ArrowDown:{primary:"↓",secondary:""},ArrowLeft:{primary:"←",secondary:""},ArrowRight:{primary:"→",secondary:""},Home:{primary:"Home",secondary:""},End:{primary:"End",secondary:""},PageUp:{primary:"PgUp",secondary:""},PageDown:{primary:"PgDn",secondary:""},Insert:{primary:"Ins",secondary:""},F1:{primary:"F1",secondary:""},F2:{primary:"F2",secondary:""},F3:{primary:"F3",secondary:""},F4:{primary:"F4",secondary:""},F5:{primary:"F5",secondary:""},F6:{primary:"F6",secondary:""},F7:{primary:"F7",secondary:""},F8:{primary:"F8",secondary:""},F9:{primary:"F9",secondary:""},F10:{primary:"F10",secondary:""},F11:{primary:"F11",secondary:""},F12:{primary:"F12",secondary:""}}};function _t(e){switch(e){case"de":return ut;case"fr":return pt;default:return ht}}function ft(e){return _t(e).name}class yt extends oe{constructor({eventBus:e=o,modalManager:t=null,app:i=null,document:a=("undefined"!=typeof window?window.document:void 0),ui:s=null,service:n=null}={}){super(e),this.componentName="KeyCaptureUI",this.eventBus=e,this.modalManager=t||("undefined"!=typeof window?window.modalManager:null),this.app=i||("undefined"!=typeof window?window.app:null),this.document=a,this.ui=s||("undefined"!=typeof window?window.stoUI:null),this.currentKeyboard=null,this.selectedKey=null,this.highlightedKeys=new Set,this.isDuplicationMode=!1,this.sourceKeyForDuplication=null,this.isCapturing=!1,this.ignoreNextChord=!1,this.lastModifierSide={ctrl:"L",alt:"L",shift:"L"},this.selectedLayout="en",this.service=n}onInit(){this.addEventListener("capture-start",e=>this.handleCaptureStart(e)),this.addEventListener("update",e=>this.updateCapturedKeysDisplay(e)),this.addEventListener("chord-captured",e=>this.handleChordCaptured(e)),this.addEventListener("capture-stop",e=>this.handleCaptureStop(e)),this.addEventListener("key:duplicate",({key:e}={})=>{this.handleKeyDuplication(e)}),this.eventBus&&this.eventBus.on("modal:shown",({modalId:e})=>{"keySelectionModal"===e&&this.initializeModal()}),this.setupEventListeners()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("toggleCaptureMode","click","toggle-capture-mode",()=>{this.toggleCaptureMode()}),this.eventBus.onDom("confirm-key-selection","click","confirm-key-selection",()=>{this.confirmSelection()}),this.eventBus.onDom("cancel-key-selection","click","cancel-key-selection",()=>{this.cancelSelection()}),this.eventBus.onDom(".vkey","click","virtual-key-click",e=>{if(this.isCapturing)return;const t=e.target.closest(".vkey");if(!t)return;const i=t.dataset.keyCode;i&&this.selectKeyFromVirtualKeyboard(i)}),this.eventBus.onDom("keyboardLayoutSelector","change","layout-change",e=>{this.changeKeyboardLayout(e.target.value)}),this.eventBus.onDom("distinguishModifierSide","change","location-specific-toggle",e=>{this.emit("keycapture:set-location-specific",{value:e.target.checked}),this.selectedKey&&this.updateChordWithLocationSpecific(e.target.checked),this.updateModifierHighlighting()}))}initializeModal(){this.buildModalContent();const e=this.document.getElementById("keyboardLayoutSelector");e&&(e.value=this.selectedLayout),this.updateKeyboardLayout();const t=this.document.getElementById("distinguishModifierSide"),i=!!t?.checked;this.emit("keycapture:set-location-specific",{value:i}),this.startCaptureMode()}handleKeyDuplication(e){this.isDuplicationMode=!0,this.sourceKeyForDuplication=e,this.showKeySelectionModal()}showKeySelectionModal(){this.modalManager&&this.modalManager.show("keySelectionModal")}startCaptureMode(){this.updateCaptureState(!0),this.emit("keycapture:start",{context:"keySelectionModal"})}stopCaptureMode(){this.updateCaptureState(!1),this.emit("keycapture:stop")}toggleCaptureMode(){const e=this.document.getElementById("captureIndicator"),t=e?.classList.contains("active");t?(this.ignoreNextChord=!0,this.stopCaptureMode(),this.selectedKey=null,this.clearVirtualModifiers(),this.updatePreviewDisplay(""),this.disableConfirmButton()):this.startCaptureMode()}updateCaptureState(e){const t=this.document.getElementById("captureIndicator"),i=this.document.getElementById("toggleCaptureMode"),a=this.document.getElementById("manualSelectionMode");this.isCapturing=e,t&&t.classList.toggle("active",e),i&&(i.textContent=e?i18next?.t("switch_to_manual")||"Switch to Manual":i18next?.t("start_capture")||"Start Capture"),a&&(a.style.opacity=e?"0.7":"1");const s=this.document.getElementById("virtualKeyboard");s&&s.classList.toggle("disabled",e)}handleCaptureStart({context:e}){this.updateCaptureState(!0)}handleCaptureStop({context:e}){this.updateCaptureState(!1)}updateCapturedKeysDisplay({chord:e,codes:t,context:i}){this.highlightKeysOnVirtualKeyboard(t),this.updatePreviewDisplay(e)}handleChordCaptured({chord:e,context:t}){this.ignoreNextChord?this.ignoreNextChord=!1:(this.selectKey(e),setTimeout(()=>{this.stopCaptureMode()},100))}selectKey(e){this.selectedKey=e,this.updateLastModifierSideFromChord(e),this.updatePreviewDisplay(e),this.enableConfirmButton(),this.highlightSelectedKeyOnKeyboard(e)}selectKeyFromVirtualKeyboard(e){if(["ControlLeft","ControlRight","AltLeft","AltRight","ShiftLeft","ShiftRight"].includes(e))return void this.toggleVirtualModifier(e);const t=this.getActiveVirtualModifiers();let i=e;if(t.length>0){const a=this.keyCodeToDisplayName(e);i=`${t.join("+")}+${a}`}else i=this.keyCodeToDisplayName(e);this.selectKey(i),t.length>0&&this.clearVirtualModifiers(!0)}toggleVirtualModifier(e){const t=this.document.getElementById("distinguishModifierSide")?.checked||!1,i=this.getModifierType(e),a="ctrl"===i?"ControlLeft":"alt"===i?"AltLeft":"ShiftLeft",s="ctrl"===i?"ControlRight":"alt"===i?"AltRight":"ShiftRight",n=(e,t)=>{e&&e.classList.toggle("modifier-active",t)},r=this.document.querySelector(`[data-key-code="${a}"]`),o=this.document.querySelector(`[data-key-code="${s}"]`),c=this.document.querySelector(`[data-key-code="${e}"]`),l=c?.classList.contains("modifier-active");if(this.clearVirtualModifiers(!0),l)return void this.updatePreviewWithCurrentModifiers();t?n(c,!0):(n(r,!0),n(o,!0));const d=["Ctrl","Alt","Shift","LCTRL","RCTRL","LALT","RALT","LSHIFT","RSHIFT"];this.selectedKey&&this.selectedKey.split("+").some(e=>e&&!d.includes(e))||this.updatePreviewWithCurrentModifiers(),i&&(this.lastModifierSide[i]=e.endsWith("Right")?"R":"L")}getModifierType(e){return e.includes("Control")?"ctrl":e.includes("Alt")?"alt":e.includes("Shift")?"shift":null}getActiveVirtualModifiersOfType(e,t){const i="ctrl"===e?"ControlLeft":"alt"===e?"AltLeft":"ShiftLeft",a="ctrl"===e?"ControlRight":"alt"===e?"AltRight":"ShiftRight",s=this.document.querySelector(`[data-key-code="${i}"]`),n=this.document.querySelector(`[data-key-code="${a}"]`),r=[];return s?.classList.contains("modifier-active")&&r.push(t?i:e),n?.classList.contains("modifier-active")&&r.push(t?a:e),[...new Set(r)]}getActiveVirtualModifiers(){const e=this.document.getElementById("distinguishModifierSide")?.checked||!1,t=[];return["ctrl","alt","shift"].forEach(i=>{const a=this.getActiveVirtualModifiersOfType(i,e);e?a.forEach(e=>{"ControlLeft"===e?t.push("LCTRL"):"ControlRight"===e?t.push("RCTRL"):"AltLeft"===e?t.push("LALT"):"AltRight"===e?t.push("RALT"):"ShiftLeft"===e?t.push("LSHIFT"):"ShiftRight"===e&&t.push("RSHIFT")}):a.length>0&&("ctrl"===i?t.push("Ctrl"):"alt"===i?t.push("Alt"):"shift"===i&&t.push("Shift"))}),t}clearVirtualModifiers(e=!1){["ControlLeft","ControlRight","AltLeft","AltRight","ShiftLeft","ShiftRight"].forEach(e=>{const t=this.document.querySelector(`[data-key-code="${e}"]`);t&&t.classList.remove("modifier-active")}),e||this.updatePreviewWithCurrentModifiers()}updatePreviewWithCurrentModifiers(){const e=this.getActiveVirtualModifiers();if(e.length>0){const t=e.join("+")+"+";this.updatePreviewDisplay(t)}else this.updatePreviewDisplay("")}getActiveModifiers(){return this.getActiveVirtualModifiers()}toggleModifier(e){const t="ctrl"===e?"ControlLeft":"alt"===e?"AltLeft":"ShiftLeft";this.toggleVirtualModifier(t)}async confirmSelection(){if(this.selectedKey)try{this.isDuplicationMode?(await this.request("key:duplicate-with-name",{sourceKey:this.sourceKeyForDuplication,newKey:this.selectedKey}),this.isDuplicationMode=!1,this.sourceKeyForDuplication=null):await this.request("key:add",{key:this.selectedKey}),this.modalManager?.hide("keySelectionModal"),this.resetState()}catch(e){this.ui?.showToast&&this.ui.showToast(i18next?.t("key_selection_failed")||"Failed to select key","error")}}cancelSelection(){this.modalManager?.hide("keySelectionModal"),this.resetState()}resetState(){this.selectedKey=null,this.highlightedKeys.clear(),this.isDuplicationMode=!1,this.sourceKeyForDuplication=null,this.isCapturing=!1,this.ignoreNextChord=!1,this.lastModifierSide={ctrl:"L",alt:"L",shift:"L"},this.clearKeyboardHighlights(),this.clearVirtualModifiers(),this.updatePreviewDisplay(""),this.disableConfirmButton(),this.emit("keycapture:set-location-specific",{value:!1})}buildModalContent(){const e=this.document.getElementById("keySelectionModal");if(!e)return;const t=e.querySelector(".modal-body");t&&(t.innerHTML=this.generateModalHTML())}generateModalHTML(){return ft(i18next?.language||"en"),`\n      <div class="hybrid-key-capture">\n        \x3c!-- Header Section --\x3e\n        <div class="capture-header">\n          <div class="capture-zone" id="captureZone">\n            <div class="capture-indicator" id="captureIndicator">\n              <div class="pulse-ring"></div>\n              <i class="fas fa-keyboard"></i>\n            </div>\n            <div class="capture-instructions">\n              <h3 data-i18n="press_any_key_combination">${i18next?.t("press_any_key_combination")||"Press any key combination..."}</h3>\n              <p data-i18n="capture_instructions">${i18next?.t("capture_instructions")||"Use your keyboard, mouse, or click keys below"}</p>\n            </div>\n          </div>\n          <button class="btn btn-secondary toggle-mode" id="toggleCaptureMode" data-i18n="switch_to_manual">\n            ${i18next?.t("switch_to_manual")||"Switch to Manual"}\n          </button>\n        </div>\n\n        \x3c!-- Preview Section --\x3e\n        <div class="selection-preview">\n          <div class="preview-display">\n            <label data-i18n="selected_key">${i18next?.t("selected_key")||"Selected Key"}:</label>\n            <div class="key-preview-display" id="keyPreviewDisplay">\n              <span class="no-selection" data-i18n="no_key_selected">${i18next?.t("no_key_selected")||"No key selected"}</span>\n            </div>\n          </div>\n          <div class="preview-controls">\n            <label class="location-specific-toggle">\n              <input type="checkbox" id="distinguishModifierSide" />\n              <span data-i18n="distinguish_left_right_modifiers">${i18next?.t("distinguish_left_right_modifiers")||"Distinguish left/right modifiers"}</span>\n            </label>\n          </div>\n        </div>\n\n        \x3c!-- Main Content --\x3e\n        <div class="capture-content">\n          \x3c!-- Virtual Keyboard Section --\x3e\n          <div class="virtual-keyboard-section">\n            <div class="section-header">\n              <h4><i class="fas fa-keyboard"></i> <span data-i18n="keyboard_layout">${i18next?.t("keyboard_layout")||"Keyboard Layout"}</span></h4>\n              <select id="keyboardLayoutSelector" class="form-select">\n                <option value="en">QWERTY (English)</option>\n                <option value="de">QWERTZ (German)</option>\n                <option value="fr">AZERTY (French)</option>\n                <option value="es">QWERTY (Spanish)</option>\n              </select>\n            </div>\n            <div class="virtual-keyboard" id="virtualKeyboard">\n              \x3c!-- Virtual keyboard will be rendered here --\x3e\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Footer Section --\x3e\n        <div class="capture-footer">\n          <div class="action-buttons">\n            <button class="btn btn-primary" id="confirm-key-selection" disabled data-i18n="confirm_selection">\n              ${i18next?.t("confirm_selection")||"Confirm Selection"}\n            </button>\n            <button class="btn btn-secondary" id="cancel-key-selection" data-i18n="cancel">\n              ${i18next?.t("cancel")||"Cancel"}\n            </button>\n          </div>\n        </div>\n      </div>\n    `}updateKeyboardLayout(){this.currentKeyboard=JSON.parse(JSON.stringify(_t(this.selectedLayout))),this.renderVirtualKeyboard()}changeKeyboardLayout(e){this.selectedLayout=e||"en",this.currentKeyboard=JSON.parse(JSON.stringify(_t(this.selectedLayout))),this.renderVirtualKeyboard();const t=this.document.querySelector(".current-layout");t&&(t.textContent=ft(e))}renderVirtualKeyboard(){const e=this.document.getElementById("virtualKeyboard");if(!e||!this.currentKeyboard)return;const t={},i={},a={};Object.entries(mt).forEach(([e,s])=>{var n,r,o;n=s.col>=17?a:s.col>=14?i:t,r=s.row,o={keyCode:e,...s},n[r]||(n[r]=[]),n[r].push(o)});const s=e=>{const t=this.currentKeyboard.keys[e.keyCode]||{primary:e.keyCode,secondary:""};return`<button class="vkey" data-key-code="${e.keyCode}"><span class="key-primary">${t.primary}</span>${t.secondary?`<span class="key-secondary">${t.secondary}</span>`:""}</button>`},n=Math.max(...Object.values(mt).map(e=>e.row)),r=(e,t=!1)=>{const i=[17,18,19,20];let a="";for(let r=0;r<=n;r++){const n=(e[r]||[]).sort((e,t)=>e.col-t.col);let o="";o=t?i.map(e=>{const t=n.find(t=>t.col===e);return t?s(t):'<div class="vkey placeholder"></div>'}).join(""):n.map(s).join(""),a+=`<div class="keyboard-row" style="grid-row:${r+1}">${o}</div>`}return a},o=`\n      <div class="keyboard-columns">\n        <div class="keyboard-column main">${r(t)}</div>\n        <div class="keyboard-column nav">${r(i)}</div>\n        <div class="keyboard-column numpad">${r(a,!0)}</div>\n      </div>`;e.innerHTML=o}updatePreviewDisplay(e){const t=this.document.getElementById("keyPreviewDisplay");if(t)if(e){const i=this.formatKeyForDisplay(e);t.innerHTML=`<span class="key-combination">${i}</span>`}else t.innerHTML=`<span class="no-selection" data-i18n="no_key_selected">${i18next?.t("no_key_selected")||"No key selected"}</span>`}formatKeyForDisplay(e){return e?e.split("+").filter(e=>e.length>0).map(e=>`<kbd>${e}</kbd>`).join('<span class="plus">+</span>'):""}keyCodeToDisplayName(e){if(e.startsWith("Numpad")){const t=e.match(/^Numpad(\d)$/);return t?`numpad${t[1]}`:{Add:"Add",Subtract:"Subtract",Multiply:"Multiply",Divide:"Divide",Decimal:"Decimal",Enter:"numpadenter"}[e.replace("Numpad","")]||e}const t=this.currentKeyboard?.keys[e];return t?t.primary:e.replace(/^Key|^Digit/,"")}highlightKeysOnVirtualKeyboard(e){this.clearKeyboardHighlights(),e&&0!==e.length&&e.forEach(e=>{const t=this.document.querySelector(`[data-key-code="${e}"]`);t&&(t.classList.add("pressed"),this.highlightedKeys.add(e))})}updateModifierHighlighting(){const e=this.document.getElementById("distinguishModifierSide")?.checked||!1,t=[];if(["ControlLeft","ControlRight","AltLeft","AltRight","ShiftLeft","ShiftRight"].forEach(e=>{const i=this.document.querySelector(`[data-key-code="${e}"]`);i?.classList.contains("modifier-active")&&t.push(e)}),this.clearVirtualModifiers(!0),t.length>0)if(e){const e=new Set,i={L:"Left",R:"Right"};t.forEach(a=>{const s=this.getModifierType(a);if(!s||e.has(s))return;const n=this.lastModifierSide[s]||"L",r="ctrl"===s?`Control${i[n]}`:"alt"===s?`Alt${i[n]}`:`Shift${i[n]}`;let o=r;if(!t.includes(o)){const e="L"===n?r.replace("Left","Right"):r.replace("Right","Left");t.includes(e)&&(o=e)}const c="ctrl"===s?"ControlLeft":"alt"===s?"AltLeft":"ShiftLeft",l="ctrl"===s?"ControlRight":"alt"===s?"AltRight":"ShiftRight";if(o===c){const e=this.document.querySelector(`[data-key-code="${l}"]`);e?.classList.remove("selected")}else{const e=this.document.querySelector(`[data-key-code="${c}"]`);e?.classList.remove("selected")}this.highlightKey(o),e.add(s)})}else{const e=new Set;t.forEach(t=>{const i=this.getModifierType(t);i&&e.add(i)}),e.forEach(e=>{const t="ctrl"===e?"ControlLeft":"alt"===e?"AltLeft":"ShiftLeft",i="ctrl"===e?"ControlRight":"alt"===e?"AltRight":"ShiftRight",a=this.document.querySelector(`[data-key-code="${t}"]`),s=this.document.querySelector(`[data-key-code="${i}"]`);a?.classList.add("modifier-active"),s?.classList.add("modifier-active")})}const i=["Ctrl","Alt","Shift","LCTRL","RCTRL","LALT","RALT","LSHIFT","RSHIFT"];this.selectedKey&&this.selectedKey.split("+").some(e=>e&&!i.includes(e))||this.updatePreviewWithCurrentModifiers()}highlightSelectedKeyOnKeyboard(e){if(this.clearKeyboardHighlights(),!e)return;const t=e.split("+");this.updateLastModifierSideFromChord(e),t.forEach(e=>{let t=null;const i=this.document.getElementById("distinguishModifierSide")?.checked||!1;if("Ctrl"===e&&!i)return this.highlightKey("ControlLeft"),void this.highlightKey("ControlRight");if("Alt"===e&&!i)return this.highlightKey("AltLeft"),void this.highlightKey("AltRight");if("Shift"===e&&!i)return this.highlightKey("ShiftLeft"),void this.highlightKey("ShiftRight");if("LCTRL"===e)t="ControlLeft";else if("RCTRL"===e)t="ControlRight";else if("LALT"===e)t="AltLeft";else if("RALT"===e)t="AltRight";else if("LSHIFT"===e)t="ShiftLeft";else if("RSHIFT"===e)t="ShiftRight";else if("Ctrl"===e)t="ControlLeft";else if("Alt"===e)t="AltLeft";else if("Shift"===e)t="ShiftLeft";else if(this.currentKeyboard){const i={1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",0:"Digit0",numpad0:"Numpad0",numpad1:"Numpad1",numpad2:"Numpad2",numpad3:"Numpad3",numpad4:"Numpad4",numpad5:"Numpad5",numpad6:"Numpad6",numpad7:"Numpad7",numpad8:"Numpad8",numpad9:"Numpad9",Add:"NumpadAdd",Subtract:"NumpadSubtract",Multiply:"NumpadMultiply",Divide:"NumpadDivide",Decimal:"NumpadDecimal",numpadenter:"NumpadEnter",A:"KeyA",B:"KeyB",C:"KeyC",D:"KeyD",E:"KeyE",F:"KeyF",G:"KeyG",H:"KeyH",I:"KeyI",J:"KeyJ",K:"KeyK",L:"KeyL",M:"KeyM",N:"KeyN",O:"KeyO",P:"KeyP",Q:"KeyQ",R:"KeyR",S:"KeyS",T:"KeyT",U:"KeyU",V:"KeyV",W:"KeyW",X:"KeyX",Y:"KeyY",Z:"KeyZ",Space:"Space",Tab:"Tab",Escape:"Escape",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12"};for(const[i,a]of Object.entries(this.currentKeyboard.keys))if(a.primary===e||a.secondary===e){t=i;break}t||(t=i[e])}t&&this.highlightKey(t)})}highlightKey(e){const t=this.document.querySelector(`[data-key-code="${e}"]`);t&&(t.classList.add("selected"),this.highlightedKeys.add(e))}clearKeyboardHighlights(){this.highlightedKeys.forEach(e=>{const t=this.document.querySelector(`[data-key-code="${e}"]`);t&&t.classList.remove("pressed","selected")}),this.highlightedKeys.clear()}enableConfirmButton(){const e=this.document.getElementById("confirm-key-selection");e&&(e.disabled=!1)}disableConfirmButton(){const e=this.document.getElementById("confirm-key-selection");e&&(e.disabled=!0)}updateChordWithLocationSpecific(e){if(!this.selectedKey)return;let t=this.selectedKey;t=e?t.replace(/\bCtrl\b/g,"R"===this.lastModifierSide.ctrl?"RCTRL":"LCTRL").replace(/\bAlt\b/g,"R"===this.lastModifierSide.alt?"RALT":"LALT").replace(/\bShift\b/g,"R"===this.lastModifierSide.shift?"RSHIFT":"LSHIFT"):t.replace(/\bLCTRL\b/g,"Ctrl").replace(/\bRCTRL\b/g,"Ctrl").replace(/\bLALT\b/g,"Alt").replace(/\bRALT\b/g,"Alt").replace(/\bLSHIFT\b/g,"Shift").replace(/\bRSHIFT\b/g,"Shift"),t!==this.selectedKey&&this.selectKey(t)}updateLastModifierSideFromChord(e){e&&e.split("+").forEach(e=>{"LCTRL"===e?this.lastModifierSide.ctrl="L":"RCTRL"===e?this.lastModifierSide.ctrl="R":"LALT"===e?this.lastModifierSide.alt="L":"RALT"===e?this.lastModifierSide.alt="R":"LSHIFT"===e?this.lastModifierSide.shift="L":"RSHIFT"===e&&(this.lastModifierSide.shift="R")})}startCapture(e="keySelectionModal"){this.startCaptureMode()}stopCapture(){this.stopCaptureMode()}addSelectedKey(){this.confirmSelection()}populateKeySelectionModal(){this.initializeModal()}}class gt extends oe{constructor(e,t){super(e),this.componentName="VFXManagerUI",this.modalManager=t,this.isInitialized=!1,this.vfxManager=null}async init(){this.isInitialized||(this.setupEventListeners(),this.isInitialized=!0)}setupEventListeners(){this.eventBus.on("vfx:modal-populate",this.handleModalPopulate.bind(this)),this.setupDOMEventListeners()}handleModalPopulate({vfxManager:e}){this.vfxManager=e,this.populateModal(),this.modalManager.show("vertigoModal"),this.updatePreview()}populateModal(){if(!this.vfxManager)return;const e=document.getElementById("spaceEffectsList");e&&(e.innerHTML="",VFX_EFFECTS.space.forEach(t=>{const i=this.createEffectItem("space",t);e.appendChild(i)}));const t=document.getElementById("groundEffectsList");t&&(t.innerHTML="",VFX_EFFECTS.ground.forEach(e=>{const i=this.createEffectItem("ground",e);t.appendChild(i)})),this.updateCheckboxes("space"),this.updateCheckboxes("ground");const i=document.getElementById("vertigoShowPlayerSay");i&&(i.checked=this.vfxManager.showPlayerSay),this.updateEffectCounts(),this.updatePreview()}createEffectItem(e,t){const i=document.createElement("div");i.className="effect-item";const a=this.vfxManager.isEffectSelected(e,t.effect);return i.innerHTML=`\n      <label class="effect-label">\n        <input type="checkbox" \n               class="effect-checkbox" \n               data-environment="${e}" \n               data-effect="${t.effect}"\n               ${a?"checked":""}>\n        <span class="effect-name">${t.label}</span>\n      </label>\n    `,i}updateCheckboxes(e){document.querySelectorAll(`input[data-environment="${e}"]`).forEach(t=>{const i=t.dataset.effect;t.checked=this.vfxManager.isEffectSelected(e,i)})}updateEffectCounts(){const e=this.vfxManager.getEffectCount("space"),t=document.getElementById("spaceEffectCount");t&&(t.textContent=e);const i=this.vfxManager.getEffectCount("ground"),a=document.getElementById("groundEffectCount");a&&(a.textContent=i)}updatePreview(){const e=document.getElementById("spaceAliasCommand");if(e&&this.vfxManager){const t=this.vfxManager.generateAlias("space");e.textContent=t||"No space effects selected"}const t=document.getElementById("groundAliasCommand");if(t&&this.vfxManager){const e=this.vfxManager.generateAlias("ground");t.textContent=e||"No ground effects selected"}}setupDOMEventListeners(){document.addEventListener("change",e=>{if(e.target.classList.contains("effect-checkbox")){const t=e.target.dataset.environment,i=e.target.dataset.effect;this.vfxManager&&(this.vfxManager.toggleEffect(t,i),this.updateEffectCounts(),this.updatePreview())}}),document.addEventListener("change",e=>{"vertigoShowPlayerSay"===e.target.id&&this.vfxManager&&(this.vfxManager.showPlayerSay=e.target.checked,this.updatePreview())}),this.eventBus.onDom("spaceSelectAll","click","vfx-space-select-all",()=>{this.vfxManager&&(this.vfxManager.selectAllEffects("space"),this.updateCheckboxes("space"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("spaceClearAll","click","vfx-space-clear-all",()=>{this.vfxManager&&(this.vfxManager.selectedEffects.space.clear(),this.updateCheckboxes("space"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("groundSelectAll","click","vfx-ground-select-all",()=>{this.vfxManager&&(this.vfxManager.selectAllEffects("ground"),this.updateCheckboxes("ground"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("groundClearAll","click","vfx-ground-clear-all",()=>{this.vfxManager&&(this.vfxManager.selectedEffects.ground.clear(),this.updateCheckboxes("ground"),this.updateEffectCounts(),this.updatePreview())}),this.eventBus.onDom("saveVertigoBtn","click","vfx-save",()=>{this.emit("vfx:save-effects")})}}class bt extends oe{constructor({eventBus:e=o,app:t=null,modalManager:i=null,document:a=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="KeyBrowserUI",this.app=t||(void 0!==window.app?window.app:null),this.modalManager=i||("undefined"!=typeof window?window.modalManager:null),this.document=a,this.le="space"}onInit(){this.xe=null,this.le=null,this.eventBus.on("key:list-changed",()=>this.render()),this.eventBus.on("key-selected",e=>{this.xe=e.key||e.name,this.render()}),this.eventBus.on("environment:changed",(e={})=>{const t="string"==typeof e?e:e.environment||e.newMode||e.mode;t&&(this.le=t,this.toggleVisibility(t),"alias"!==t&&this.render())}),this.addEventListener("key-view:toggle",()=>this.toggleKeyView()),this.addEventListener("key-view:update-toggle",e=>this.updateViewToggleButton(e?.viewMode)),this.addEventListener("keys:filter",e=>{const t="string"==typeof e?e:e?.value||"";this.filterKeys(t)}),this.addEventListener("commands:filter",e=>{const t="string"==typeof e?e:e?.value||"";this.filterCommands(t)}),this.addEventListener("keys:show-all",()=>this.showAllKeys()),this.addEventListener("key-view:mode-changed",()=>this.render());const e=localStorage.getItem("keyViewMode")||"grid";this.updateViewToggleButton(e),this.setupEventListeners()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addKeyBtn","click","key-add",()=>{this.showKeySelectionModal()}),this.eventBus.onDom("deleteKeyBtn","click","key-delete",()=>{this.xe&&this.confirmDeleteKey(this.xe)}),this.eventBus.onDom("duplicateKeyBtn","click","key-duplicate",()=>{this.xe&&this.duplicateKey(this.xe)}),this.eventBus.onDomDebounced("keyFilter","input","key-filter",e=>{this.filterKeys(e.target.value)},250),this.eventBus.onDom("keyFilter","keydown","key-filter-key",e=>{if("Escape"===e.key){e.preventDefault();const t=e.target;t.value="",t.classList.remove("expanded"),this.emit("key:filter",{filter:""})}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllKeysBtn","click","show-all-keys",()=>{this.showAllKeys()}),this.eventBus.onDom("toggleKeyViewBtn","click","toggle-key-view",()=>{this.toggleKeyView()}),this.eventBus.onDom("keySearchBtn","click","key-search-toggle",()=>{this.toggleKeySearch()}),this.addEventListener("key-selected",({key:e}={})=>{this.xe=e,this.render()}),this.addEventListener("profile:switched",({profileId:e,environment:t}={})=>{this.ee=e,this.le=t,this.render()}),this.addEventListener("environment:changed",({environment:e}={})=>{this.le=e,this.render()}))}async render(){const e=this.document.getElementById("keyGrid");if(!e)return;const t=await this.request("key:get-profile");if(!t)return void(e.innerHTML=`<div class="empty-state"><i class="fas fa-folder-open"></i><h4>${i18next.t("no_profile_selected")||"No Profile Selected"}</h4></div>`);const i=await this.request("key:get-all");this.Te=i;const a=Object.keys(i),s={};a.forEach(e=>{const t=i[e];t&&t.length>0&&(s[e]=t)});const n=[...new Set([...a,...Object.keys(s)])];e.innerHTML="";const r=localStorage.getItem("keyViewMode")||"grid";"key-types"===r?this.renderKeyTypeView(e,t,n):"grid"===r?this.renderSimpleGridView(e,n):await this.renderCommandCategoryView(e,s,n)}renderSimpleGridView(e,t){e.classList.remove("categorized"),t.sort(this.compareKeys.bind(this)).forEach(t=>{const i=this.createKeyElement(t);e.appendChild(i)})}async renderCommandCategoryView(e,t,i){e.classList.add("categorized");const a=await this.categorizeKeys(t,i);Object.entries(a).sort(([e,t],[i,a])=>t.priority!==a.priority?t.priority-a.priority:t.name.localeCompare(a.name)).forEach(([t,i])=>{const a=this.createKeyCategoryElement(t,i);e.appendChild(a)})}renderKeyTypeView(e,t,i){e.classList.add("categorized");const a=this.categorizeKeysByType(this.Te,i);Object.entries(a).sort(([,e],[,t])=>e.priority-t.priority).forEach(([t,i])=>{const a=this.createKeyCategoryElement(t,i,"key-type");e.appendChild(a)})}async categorizeKeys(e,t){const i={unknown:{name:"Unknown",icon:"fas fa-question-circle",keys:new Set,priority:0}};return Object.entries(STO_DATA.commands).forEach(([e,t])=>{i[e]={name:t.name,icon:t.icon,keys:new Set,priority:1}}),await Promise.all(t.map(async t=>{const a=e[t]||[];if(!a||0===a.length)return void i.unknown.keys.add(t);const s=new Set;await Promise.all(a.map(async e=>{const t=e.category||e.type;if(t&&i[t])s.add(t);else try{const t=await this.request("parser:parse-command-string",{commandString:e.command,options:{generateDisplayText:!1}});if(t.commands&&t.commands.length>0){const e=t.commands[0].category;i[e]&&s.add(e)}}catch(e){i.custom||(i.custom={name:"Custom Commands",icon:"fas fa-cog",keys:new Set,priority:2})}})),s.size>0?s.forEach(e=>i[e].keys.add(t)):(i.custom||(i.custom={name:"Custom Commands",icon:"fas fa-cog",keys:new Set,priority:2}),i.custom.keys.add(t))})),Object.values(i).forEach(e=>{e.keys=Array.from(e.keys).sort(this.compareKeys.bind(this))}),i}detectKeyTypes(e){const t=[];return/^F[0-9]+$/.test(e)&&t.push("function"),/^[A-Z0-9]$/.test(e)&&t.push("alphanumeric"),/^NUMPAD/.test(e)&&t.push("numberpad"),/(Ctrl|Alt|Shift)/.test(e)&&t.push("modifiers"),/(UP|DOWN|LEFT|RIGHT|HOME|END|PGUP|PGDN)/.test(e)&&t.push("navigation"),/(ESC|TAB|CAPS|PRINT|SCROLL|PAUSE|Space|Enter|Escape)/.test(e)&&t.push("system"),/MOUSE|WHEEL/.test(e)&&t.push("mouse"),0===t.length&&/[^A-Za-z0-9]/.test(e)&&t.push("symbols"),0===t.length&&t.push("other"),t}categorizeKeysByType(e,t){const i={function:{name:"Function Keys",icon:"fas fa-keyboard",keys:new Set,priority:1},alphanumeric:{name:"Letters & Numbers",icon:"fas fa-font",keys:new Set,priority:2},numberpad:{name:"Numberpad",icon:"fas fa-calculator",keys:new Set,priority:3},modifiers:{name:"Modifier Keys",icon:"fas fa-hand-paper",keys:new Set,priority:4},navigation:{name:"Navigation",icon:"fas fa-arrows-alt",keys:new Set,priority:5},system:{name:"System Keys",icon:"fas fa-cogs",keys:new Set,priority:6},mouse:{name:"Mouse & Wheel",icon:"fas fa-mouse",keys:new Set,priority:7},symbols:{name:"Symbols & Punctuation",icon:"fas fa-at",keys:new Set,priority:8},other:{name:"Other Keys",icon:"fas fa-question-circle",keys:new Set,priority:9}};return t.forEach(e=>{this.detectKeyTypes(e).forEach(t=>(i[t]||i.other).keys.add(e))}),Object.values(i).forEach(e=>{e.keys=Array.from(e.keys).sort(this.compareKeys.bind(this))}),i}compareKeys(e,t){const i=e.match(/^F(\d+)$/),a=t.match(/^F(\d+)$/);if(i&&a)return parseInt(i[1])-parseInt(a[1]);if(i&&!a)return-1;if(!i&&a)return 1;const s=/^\d+$/.test(e),n=/^\d+$/.test(t);if(s&&n)return parseInt(e)-parseInt(t);if(s&&!n)return-1;if(!s&&n)return 1;const r=/^[A-Z]$/.test(e),o=/^[A-Z]$/.test(t);if(r&&o)return e.localeCompare(t);if(r&&!o)return-1;if(!r&&o)return 1;const c=["Space","Tab","Enter","Escape"],l=c.indexOf(e),d=c.indexOf(t);return-1!==l&&-1!==d?l-d:-1!==l&&-1===d?-1:-1===l&&-1!==d?1:e.localeCompare(t)}formatKeyName(e){return e.replace(/\+/g,"<br>+")}createKeyElement(e){const t=this.Te||{},i=t&&t[e]?t[e]:[],a=e===this.xe,s=i.filter(e=>"string"==typeof e?""!==e.trim():!(!e||"string"!=typeof e.command)&&""!==e.command.trim()),n=this.document.createElement("div");n.className="key-item "+(a?"active":""),n.dataset.key=e,n.title=`${e}: ${s.length} command${1!==s.length?"s":""}`;const r=this.formatKeyName(e),c=e.length,l=c<=3?"short":c<=5?"medium":c<=8?"long":"extra-long";return n.dataset.length=l,n.innerHTML=`<div class="key-label">${r}</div>${s.length>0?`<div class="activity-bar" style="width:${Math.min(15*s.length,100)}%"></div><div class="command-count-badge">${s.length}</div>`:""}`,n.addEventListener("click",()=>{se(o,"key:select",{key:e})}),n}createKeyCategoryElement(e,t,i="command"){const a=this.document.createElement("div");a.className="category",a.dataset.category=e;const s="key-type"===i?`keyTypeCategory_${e}_collapsed`:`keyCategory_${e}_collapsed`,n="true"===localStorage.getItem(s);a.innerHTML=`<h4 class="${n?"collapsed":""}" data-category="${e}" data-mode="${i}"><i class="fas fa-chevron-right category-chevron"></i><i class="${t.icon}"></i>${t.name}<span class="key-count">(${t.keys.length})</span></h4><div class="category-commands ${n?"collapsed":""}">${t.keys.map(e=>this.createKeyElement(e).outerHTML).join("")}</div>`,a.querySelector("h4").addEventListener("click",()=>this.toggleKeyCategory(e,a,i));const r=a.querySelector(".category-commands");return r.innerHTML="",t.keys.forEach(e=>r.appendChild(this.createKeyElement(e))),a}toggleKeyCategory(e,t,i="command"){const a="key-type"===i?`keyTypeCategory_${e}_collapsed`:`keyCategory_${e}_collapsed`,s=t.querySelector("h4").classList.toggle("collapsed");t.querySelector(".category-commands").classList.toggle("collapsed"),localStorage.setItem(a,s)}updateViewToggleButton(e){const t=this.document.getElementById("toggleKeyViewBtn");if(!t)return;const i=t.querySelector("i")||t;"categorized"===e?(i.className="fas fa-sitemap",t.title="undefined"!=typeof i18next?i18next.t("switch_to_key_type_view"):"Switch to key type view"):"key-types"===e?(i.className="fas fa-th",t.title="undefined"!=typeof i18next?i18next.t("switch_to_grid_view"):"Switch to grid view"):(i.className="fas fa-list",t.title="undefined"!=typeof i18next?i18next.t("switch_to_command_categories"):"Switch to command categories")}toggleKeyView(){if(this.app&&"alias"===this.app.currentEnvironment)return;const e=localStorage.getItem("keyViewMode")||"grid";let t;t="key-types"===e?"grid":"grid"===e?"categorized":"key-types",localStorage.setItem("keyViewMode",t),this.render(),this.updateViewToggleButton(t),this.emit("key-view:mode-changed",{mode:t})}filterKeys(e=""){const t=(e||"").toString().toLowerCase(),i=this.document.getElementById("keyGrid");if(!i)return;i.querySelectorAll(".key-item").forEach(e=>{const i=(e.dataset.key||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),i.querySelectorAll(".command-item[data-key]").forEach(e=>{const i=(e.dataset.key||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),i.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item[data-key]:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"});const a=this.document.getElementById("keySearchBtn");if(a){const e=!!t;a.classList.toggle("active",e),a.setAttribute("aria-pressed",e)}}filterCommands(e=""){const t=(e||"").toString().toLowerCase();this.document.querySelectorAll(".command-item").forEach(e=>{const i=(e.textContent||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"}),this.document.querySelectorAll(".category").forEach(e=>{const i=e.querySelectorAll('.command-item:not([style*="display: none"])'),a=!t||i.length>0;e.style.display=a?"block":"none"})}showAllKeys(){const e=this.document.getElementById("keyGrid");if(!e)return;e.querySelectorAll(".key-item").forEach(e=>{e.style.display="flex"}),e.querySelectorAll(".command-item[data-key]").forEach(e=>{e.style.display="flex"}),e.querySelectorAll(".category").forEach(e=>{e.style.display="block"});const t=this.document.getElementById("keyFilter");t&&(t.value="");const i=this.document.getElementById("keySearchBtn");i&&(i.classList.remove("active"),i.setAttribute("aria-pressed","false"))}toggleVisibility(e){const t=()=>{const i=this.document.querySelector(".key-selector-container");i?"alias"!==e?i.style.removeProperty("display"):i.style.setProperty("display","none","important"):setTimeout(t,10)};requestAnimationFrame(t)}handleInitialState(e,t){if(!t)return;const i=t.environment||t.currentEnvironment;i&&(this.le=i,this.toggleVisibility(i),"alias"!==i&&this.render())}showKeySelectionModal(){this.modalManager&&this.modalManager.show("keySelectionModal")}async confirmDeleteKey(e){if(!e)return;const t=this.i18n?.t?.("confirm_delete_key",{key:e})||`Delete key ${e}?`;if(confirm(t))try{return this.emit("key:delete",{key:e}),!0}catch(e){return this.ui?.showToast&&this.ui.showToast("Failed to delete key","error"),!1}return!1}duplicateKey(e){e&&this.emit("key:duplicate",{key:e})}toggleKeySearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("keyFilter");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}}class wt{constructor(e=null,t={}){this.eventBus=e,this.options={enableCache:!0,maxCacheSize:1e3,enablePerformanceMetrics:!1,hotPathThreshold:10,...t},this.parseCache=new Map,this.hotPathCache=new Map,this.frequencyTracker=new Map,this.performanceMetrics=new Map,this.signatures=this.initializeCommandSignatures(),this.eventBus&&this.setupRequestHandlers()}setupRequestHandlers(){ne(this.eventBus,"parser:parse-command-string",({commandString:e,options:t})=>this.parseCommandString(e,t)),ne(this.eventBus,"parser:validate-command",({signature:e,commandString:t})=>this.validateCommand(e,t)),ne(this.eventBus,"parser:get-command-signature",({commandString:e})=>this.getCommandSignature(e)),ne(this.eventBus,"parser:extract-parameters",({signature:e,commandString:t})=>this.extractParameters(e,t)),ne(this.eventBus,"parser:get-performance-metrics",()=>Array.from(this.performanceMetrics.entries())),ne(this.eventBus,"parser:clear-cache",()=>(this.parseCache.clear(),this.hotPathCache.clear(),this.frequencyTracker.clear(),{success:!0}))}initializeCommandSignatures(){return{TrayExecution:{patterns:[{regex:/^(\+(?:STO)?TrayExecByTray)\s+(\d+)\s+(\d+)$/i,weight:100,signature:"TrayExecByTray(active: number, tray: number, slot: number)",extractParams:e=>({active:1,tray:parseInt(e[2]),slot:parseInt(e[3]),baseCommand:e[1],isShorthand:!0}),generateDisplayText:e=>({key:"command_definitions.custom_tray.name",params:{tray:e.tray,slot:e.slot},fallback:`Tray Execution (${e.tray} ${e.slot})`})},{regex:/^((?:STO)?TrayExecByTray)\s+(\d+)\s+(\d+)\s+(\d+)$/i,weight:99,signature:"TrayExecByTray(active: number, tray: number, slot: number)",extractParams:e=>({active:parseInt(e[2]),tray:parseInt(e[3]),slot:parseInt(e[4]),baseCommand:e[1],isShorthand:!1}),generateDisplayText:e=>({key:"command_definitions.custom_tray.name",params:{tray:e.tray,slot:e.slot},fallback:`Tray Execution (${e.tray} ${e.slot})`})}],category:"tray",baseCommand:"TrayExecByTray",icon:"⚡"},TrayWithBackup:{patterns:[{regex:/^(\+TrayExecByTrayWithBackup)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)$/i,weight:90,signature:"TrayExecByTrayWithBackup(active: number, tray: number, slot: number, backup_tray: number, backup_slot: number)",extractParams:e=>({active:1,tray:parseInt(e[2]),slot:parseInt(e[3]),backup_tray:parseInt(e[4]),backup_slot:parseInt(e[5]),baseCommand:e[1],isShorthand:!0}),generateDisplayText:e=>({key:"command_definitions.tray_with_backup.name",params:{tray:e.tray,slot:e.slot,backup_tray:e.backup_tray,backup_slot:e.backup_slot},fallback:`Tray Execution with Backup (${e.tray} ${e.slot} -> ${e.backup_tray} ${e.backup_slot})`})},{regex:/^(TrayExecByTrayWithBackup)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)$/i,weight:89,signature:"TrayExecByTrayWithBackup(active: number, tray: number, slot: number, backup_tray: number, backup_slot: number)",extractParams:e=>({active:parseInt(e[2]),tray:parseInt(e[3]),slot:parseInt(e[4]),backup_tray:parseInt(e[5]),backup_slot:parseInt(e[6]),baseCommand:e[1],isShorthand:!1}),generateDisplayText:e=>({key:"command_definitions.tray_with_backup.name",params:{tray:e.tray,slot:e.slot,backup_tray:e.backup_tray,backup_slot:e.backup_slot},fallback:`Tray Execution with Backup (${e.tray} ${e.slot} -> ${e.backup_tray} ${e.backup_slot})`})}],category:"tray",baseCommand:"TrayExecByTrayWithBackup",icon:"⚡"},Communication:{patterns:[{regex:/^(say|team|zone|tell)\s+"([^"]+)"$/i,weight:70,signature:"Communication(verb: string, message: string)",extractParams:e=>({verb:e[1],message:e[2]}),generateDisplayText:e=>`${e.verb}: "${e.message}"`},{regex:/^(say|team|zone|tell)\s+(.+)$/i,weight:65,signature:"Communication(verb: string, message: string)",extractParams:e=>({verb:e[1],message:e[2]}),generateDisplayText:e=>`${e.verb}: ${e.message}`}],category:"communication",baseCommand:"Communication",icon:"💬"},TargetWithName:{patterns:[{regex:/^Target\s+"([^"]+)"$/i,weight:60,signature:"Target(entityName: string)",extractParams:e=>({entityName:e[1]}),generateDisplayText:e=>`Target "${e.entityName}"`}],category:"targeting",baseCommand:"Target",icon:"🎯"},VFXCommands:{patterns:[{regex:/^dynFxSetFXExclusionList_combined$/i,weight:48,signature:"VFXExclusionMaster()",extractParams:()=>({}),generateDisplayText:()=>"VFX Alias: Combined Space/Ground"},{regex:/^dynFxSetFXExclusionList\s+(.+)$/i,weight:51,signature:"VFXExclusion(effects: string)",extractParams:e=>({effects:e[1]}),generateDisplayText:e=>`VFX Exclude: ${e.effects}`},{regex:/^dynFxSetFXExclusionList_(.+)$/i,weight:49,signature:"VFXExclusionAlias(aliasName: string)",extractParams:e=>({aliasName:e[1]}),generateDisplayText:e=>`VFX Alias: ${e.aliasName}`}],category:"vfx",baseCommand:"VFXControl",icon:"✨"},StaticCombat:{patterns:[{regex:/^(FireAll|FirePhasers|FireTorps|FireMines|FirePhasersTorps|FireProjectiles)$/i,weight:40,signature:"StaticCombat()",extractParams:e=>({commandName:e[1]}),generateDisplayText:e=>this.getStaticCombatDisplayName(e.commandName)}],category:"combat",baseCommand:"StaticCombat",icon:"🔥"},StaticTargeting:{patterns:[{regex:/^(Target_Enemy_Near|Target_Friend_Near|Target_Self|Target_Clear|Target_Teammate\s+\d+)$/i,weight:35,signature:"StaticTargeting()",extractParams:e=>({commandName:e[1]}),generateDisplayText:e=>this.getStaticTargetingDisplayName(e.commandName)}],category:"targeting",baseCommand:"StaticTargeting",icon:"🎯"},PowerCommands:{patterns:[{regex:/^\+power_exec\s+(.+)$/i,weight:30,signature:"PowerExec(powerName: string)",extractParams:e=>({powerName:e[1]}),generateDisplayText:e=>`Power: ${e.powerName}`}],category:"power",baseCommand:"PowerExec",icon:"🔋"},MovementCommands:{patterns:[{regex:/^\+(fullimpulse|reverse|turn_left|turn_right|up|down|left|right|forward|backward)$/i,weight:25,signature:"Movement(direction: string)",extractParams:e=>({direction:e[1]}),generateDisplayText:e=>`Movement: ${e.direction}`}],category:"movement",baseCommand:"Movement",icon:"🚀"},SystemCommands:{patterns:[{regex:/^(screenshot|interactwindow|\+gentoggle.*)$/i,weight:20,signature:"System(command: string)",extractParams:e=>({command:e[1]}),generateDisplayText:e=>`System: ${e.command}`}],category:"system",baseCommand:"System",icon:"⚙️"},CameraCommands:{patterns:[{regex:/^(.*cam.*|.*look.*|.*zoom.*)$/i,weight:15,signature:"Camera(command: string)",extractParams:e=>({command:e[1]}),generateDisplayText:e=>`Camera: ${e.command}`}],category:"camera",baseCommand:"Camera",icon:"📹"}}}parseCommandString(e,t={}){const i=performance.now();if(this.trackCommandFrequency(e),this.hotPathCache.has(e))return this.updateMetrics("hotpath_hit",i),this.hotPathCache.get(e);if(this.options.enableCache&&this.parseCache.has(e))return this.updateMetrics("cache_hit",i),this.parseCache.get(e);const a=e.split(/\s*\$\$\s*/).map(e=>e.trim()).filter(e=>e),s=a.map((e,i)=>this.parseIndividualCommand(e,i,t)),n={originalString:e,commands:s,isMirrored:this.detectMirroring(a),parseTime:performance.now()-i,metadata:{totalCommands:s.length,cacheStatus:"miss",parseMethod:"signature-based"}};return this.options.enableCache&&this.cacheResult(e,n),this.updateMetrics("parse_complete",i),n}parseIndividualCommand(e,t,i={}){const a=Object.entries(this.signatures).sort((e,t)=>{const i=Math.max(...e[1].patterns.map(e=>e.weight));return Math.max(...t[1].patterns.map(e=>e.weight))-i});for(const[s,n]of a)for(const a of n.patterns){const r=e.match(a.regex);if(r){const o=a.extractParams(r),c=!1!==i.generateDisplayText&&a.generateDisplayText?a.generateDisplayText(o):e;return{command:e,signature:a.signature,category:n.category,baseCommand:n.baseCommand,icon:n.icon,parameters:o,displayText:c,matchPattern:a,id:`parsed_${Date.now()}_${t}`,parseMetadata:{signatureName:s,patternWeight:a.weight,matchTime:performance.now()}}}}return{command:e,signature:"UnknownCommand(command: string)",category:"custom",baseCommand:"Custom",icon:"⚙️",parameters:{command:e},displayText:e,id:`unknown_${Date.now()}_${t}`,parseMetadata:{signatureName:"fallback",patternWeight:0,matchTime:performance.now()}}}trackCommandFrequency(e){const t=this.frequencyTracker.get(e)||0;if(this.frequencyTracker.set(e,t+1),t>=this.options.hotPathThreshold&&!this.hotPathCache.has(e)){const t=this.options.hotPathThreshold;this.options.hotPathThreshold=1/0;const i=this.parseCommandString(e);this.hotPathCache.set(e,i),this.options.hotPathThreshold=t}}detectMirroring(e){if(e.length<=1)return!1;if(e.length<3||e.length%2==0)return!1;const t=Math.floor(e.length/2),i=e.slice(0,t+1),a=e.slice(t+1),s=i.slice(0,-1).reverse();return a.length===s.length&&a.every((e,t)=>e.trim()===s[t].trim())}cacheResult(e,t){if(this.parseCache.size>=this.options.maxCacheSize){const e=this.parseCache.keys().next().value;this.parseCache.delete(e)}this.parseCache.set(e,t)}updateMetrics(e,t){if(!this.options.enablePerformanceMetrics)return;const i=performance.now()-t,a=this.performanceMetrics.get(e)||{count:0,totalTime:0,avgTime:0};a.count++,a.totalTime+=i,a.avgTime=a.totalTime/a.count,this.performanceMetrics.set(e,a)}validateCommand(e,t){return this.parseCommandString(t).commands.some(t=>t.signature===e)}getCommandSignature(e){return this.parseCommandString(e).commands.map(e=>e.signature)}extractParameters(e,t){const i=this.parseCommandString(t).commands.find(t=>t.signature===e);return i?i.parameters:{}}getStaticCombatDisplayName(e){return{FireAll:"Fire All Weapons",FirePhasers:"Fire Energy Weapons",FireTorps:"Fire Torpedoes",FireMines:"Fire Mines",FirePhasersTorps:"Fire Phasers & Torpedoes",FireProjectiles:"Fire Projectiles"}[e]||e}getStaticTargetingDisplayName(e){if(e.startsWith("Target_Teammate")){const t=e.match(/Target_Teammate\s+(\d+)/);return t?`Target Teammate ${t[1]}`:e}return{Target_Enemy_Near:"Target Nearest Enemy",Target_Friend_Near:"Target Nearest Friend",Target_Self:"Target Self",Target_Clear:"Clear Target"}[e]||e}static createStandalone(e={}){return new wt(null,e)}}const vt=wt.createStandalone(),kt=(()=>{const e=function(){const e=new Set;return Object.values(vt.signatures).forEach(t=>{"vfx"===(t.category||"").toLowerCase()||(t.baseCommand&&e.add(t.baseCommand.toLowerCase()),Array.isArray(t.patterns)&&t.patterns.forEach(t=>{const i=t.regex?.source?.match(/^\^\(([^)]+)\)/);i&&i[1].split("|").forEach(t=>e.add(t.toLowerCase()))}))}),e}();return Object.values(st).forEach(t=>{(t.parameters?.command_type?.options||t.parameters?.verb?.options||[]).forEach(t=>e.add(t.toLowerCase()))}),e})(),St=/^[A-Za-z][A-Za-z0-9_]*$/;function xt(e=""){return St.test(e)}function Tt(e=""){return!!xt(e)&&!kt.has(e.toLowerCase())}class Ct extends oe{constructor({eventBus:e=o,modalManager:t=null,document:i=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="AliasBrowserUI",this.modalManager=t||("undefined"!=typeof window?window.modalManager:null),this.document=i}async onInit(){this.Ce=null,this.setupEventListeners(),this.eventBus.on("aliases-changed",()=>{this.render()}),this.eventBus.on("alias-selected",e=>{this.Ce=e.name,this.render()}),this.addEventListener("profile:switched",({profileId:e,environment:t}={})=>{this.Ce=null,this.render()}),this.eventBus.on("environment:changed",(e={})=>{const t="string"==typeof e?e:e.environment||e.newMode||e.mode;this.toggleVisibility(t)}),await this.render()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("addAliasChainBtn","click","alias-chain-add",()=>{this.createAliasModal()}),this.eventBus.onDom("deleteAliasChainBtn","click","alias-chain-delete",()=>{this.Ce&&this.confirmDeleteAlias(this.Ce)}),this.eventBus.onDom("duplicateAliasChainBtn","click","alias-chain-duplicate",()=>{this.Ce&&this.duplicateAlias(this.Ce)}),this.eventBus.onDom("aliasOptionsDropdown","click","alias-options-toggle",e=>{e.stopPropagation(),this.toggleAliasOptionsDropdown()}),["aliasStabilizeOption","aliasToggleOption","aliasCycleOption"].forEach(e=>{this.eventBus.onDom(e,"change",`alias-option-${e}`,()=>{this.updateAliasOptionsLabel()})}),this.eventBus.onDomDebounced("aliasFilter","input","alias-filter",e=>{this.filterAliases(e.target.value)},250),this.eventBus.onDom("aliasFilter","keydown","alias-filter-key",e=>{if("Escape"===e.key){const t=e.target;t.value="",t.classList.remove("expanded"),this.filterAliases("")}else if("Enter"===e.key){const t=e.target;t.classList.remove("expanded"),t.blur()}}),this.eventBus.onDom("showAllAliasesBtn","click","alias-show-all",()=>{const e=this.document.getElementById("aliasFilter");e&&(e.value=""),this.filterAliases("")}),this.eventBus.onDom("aliasSearchBtn","click","alias-search-toggle",()=>{this.toggleAliasSearch()}))}confirmDeleteAlias(e){if(!e)return;const t=Q.t("confirm_delete_alias",{alias:e})||`Delete alias ${e}?`;confirm(t)&&this.emit("alias:delete",{name:e})}async duplicateAlias(e){if(!e||!this.modalManager)return;const t=await this.request("alias:get-all"),i=function(e,t={}){let i=`${e}_copy`,a=i,s=1;for(;t[a];)a=`${i}${s}`,s++;return a}(e,t),a=this.document.getElementById("aliasDuplicateModal");if(!a)return;const s=a.querySelector("#duplicateAliasNameInput"),n=a.querySelector("#confirmDuplicateAliasBtn"),r=a.querySelector("#duplicateAliasValidation"),o=()=>{const e=(s.value||"").trim(),i=t[e];let a=null;e&&xt(e)?Tt(e)?i&&(a="alias_name_in_use"):a="reserved_command_name":a="invalid_alias_name",r.textContent=a?Q.t(a):"";const o=!!a;r.style.display=o?"":"none",n.disabled=o};s.value=i,r.style.display="none";const c=()=>o();s.removeEventListener("input",c),s.addEventListener("input",c),n.onclick=()=>{const i=s.value.trim();i&&!t[i]&&(this.modalManager.hide("aliasDuplicateModal"),this.emit("alias:duplicate",{from:e,to:i}))},this.modalManager.show("aliasDuplicateModal"),o()}toggleAliasOptionsDropdown(){const e=this.document.getElementById("aliasOptionsDropdown");e&&e.classList.toggle("active")}updateAliasOptionsLabel(){const e=this.document.getElementById("aliasStabilizeOption")?.checked,t=this.document.getElementById("aliasToggleOption")?.checked,i=this.document.getElementById("aliasCycleOption")?.checked;this.emit("alias:options-changed",{stabilize:e,toggle:t,cycle:i})}async render(){const e=this.document.getElementById("aliasGrid");if(!e)return;const t=await this.request("alias:get-all"),i=Object.entries(t);0!==i.length?(e.classList.remove("categorized"),e.innerHTML=i.map(([e,t])=>this.createAliasElement(e,t)).join(""),e.querySelectorAll(".alias-item").forEach(e=>{e.addEventListener("click",()=>{se(this.eventBus,"alias:select",{name:e.dataset.alias}),this.emit("alias-browser/alias-clicked",{name:e.dataset.alias})})})):e.innerHTML=`\n        <div class="empty-state">\n          <i class="fas fa-mask"></i>\n          <h4 data-i18n="no_aliases_defined">${Q.t("no_aliases_defined")}</h4>\n          <p data-i18n="create_alias_to_get_started">${Q.t("create_alias_to_get_started")}</p>\n        </div>`}createAliasElement(e,t){let i=0;Array.isArray(t.commands)?i=t.commands.filter(e=>e&&e.trim()).length:"string"==typeof t.commands&&t.commands.trim()&&(i=t.commands.trim().split(/\s*\$\$/).length);const a=(this.Ce||null)===e,s=t.description||"";return`\n      <div class="alias-item ${a?"active":""}" data-alias="${e}" data-length="${e.length<=8?"short":e.length<=12?"medium":e.length<=16?"long":"extra-long"}" title="${s}">\n        <div class="alias-name">${e}</div>\n        <div class="alias-command-count">${i} <span data-i18n="commands">${Q.t("commands")}</span></div>\n      </div>`}toggleVisibility(e){const t=this.document.getElementById("aliasSelectorContainer")||this.document.getElementById("aliasGrid")?.parentElement?.parentElement;if(!t)return;const i="alias"===e;t.style.display=i?"":"none"}handleInitialState(e,t){if(t&&(t.environment||t.currentEnvironment)){const e=t.environment||t.currentEnvironment;this.toggleVisibility(e)}}async createAliasModal(){if(!this.modalManager)return;const e=await this.request("alias:get-all"),t=this.document.getElementById("aliasCreationModal");if(!t)return;const i=t.querySelector("#newAliasNameInput"),a=t.querySelector("#confirmCreateAliasBtn"),s=t.querySelector("#createAliasValidation"),n=()=>{const t=(i.value||"").trim();let n=null;t&&xt(t)?Tt(t)?e[t]&&(n="alias_name_in_use"):n="reserved_command_name":n="invalid_alias_name",s.textContent=n?Q.t(n):"";const r=!!n;s.style.display=r?"":"none",a.disabled=r};i.value="",s.style.display="none",i.removeEventListener("input",n),i.addEventListener("input",n),a.onclick=()=>{const e=i.value.trim();e&&(this.modalManager.hide("aliasCreationModal"),this.emit("alias:create",{name:e}))},this.modalManager.show("aliasCreationModal"),n()}filterAliases(e=""){const t=(e||"").toString().toLowerCase(),i=this.document.getElementById("aliasGrid");if(!i)return;i.querySelectorAll(".alias-item").forEach(e=>{const i=(e.dataset.alias||"").toLowerCase(),a=!t||i.includes(t);e.style.display=a?"flex":"none"});const a=this.document.getElementById("aliasSearchBtn");if(a){const e=!!t;a.classList.toggle("active",e),a.setAttribute("aria-pressed",e)}}toggleAliasSearch(){const e=this.document||("undefined"!=typeof window?window.document:void 0);if(!e)return;const t=e.getElementById("aliasFilter");t&&(t.classList.toggle("expanded")?t.focus():t.blur())}}class At extends oe{constructor({eventBus:e,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="HeaderMenuUI",this.document=t}onInit(){this.setupEventListeners()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.onDom("settingsBtn","click","settings-toggle",()=>{this.toggleSettingsMenu()}),this.eventBus.onDom("importMenuBtn","click","import-toggle",()=>{this.toggleImportMenu()}),this.eventBus.onDom("backupMenuBtn","click","backup-toggle",()=>{this.toggleBackupMenu()}),this.eventBus.onDom("languageMenuBtn","click","language-toggle",()=>{this.toggleLanguageMenu()}),this.eventBus.onDom("vertigoBtn","click","vfx-open",()=>{this.emit("vfx:show-modal")}),this.eventBus.onDom("fileExplorerBtn","click","file-explorer-open",()=>{this.emit("file-explorer:open")}),this.eventBus.onDom("syncNowBtn","click","sync-now",()=>{this.emit("sync:sync-now")}),this.eventBus.onDom("preferencesBtn","click","preferences-open",()=>{this.emit("preferences:show")}),this.eventBus.onDom("aboutBtn","click","about-open",()=>{this.emit("about:show")}),this.document.addEventListener("click",e=>{e.target.closest(".dropdown")||this.document.querySelectorAll(".dropdown.active").forEach(e=>{e.classList.remove("active")})}),this.eventBus.onDom("openProjectBtn","click","project-open",()=>{this.emit("project:open")}),this.eventBus.onDom("saveProjectBtn","click","project-save",()=>{this.emit("project:save")}),this.eventBus.onDom("exportKeybindsBtn","click","keybinds-export",()=>{this.emit("keybinds:export")}),this.eventBus.onDom("importKeybindsBtn","click","keybinds-import",()=>{this.emit("keybinds:import")}),this.eventBus.onDom("importAliasesBtn","click","aliases-import",()=>{this.emit("aliases:import")}),this.eventBus.onDom("loadDefaultDataBtn","click","data-load-default",()=>{this.emit("data:load-default")}),this.eventBus.onDom("resetAppBtn","click","app-reset",()=>{this.confirmResetApp()}),this.document.querySelectorAll("[data-lang]").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest("[data-lang]"),i=t?t.getAttribute("data-lang"):null;i&&this.emit("language:change",{language:i})})}),this.eventBus.onDom("themeToggleBtn","click","theme-toggle",()=>{this.emit("theme:toggle")}))}toggleSettingsMenu(){this.toggleDropdown("settingsBtn")}toggleImportMenu(){this.toggleDropdown("importMenuBtn")}toggleBackupMenu(){this.toggleDropdown("backupMenuBtn")}toggleLanguageMenu(){this.toggleDropdown("languageMenuBtn")}toggleDropdown(e){const t=this.document.getElementById(e);if(!t)return;const i=t.closest(".dropdown");i&&(this.document.querySelectorAll(".dropdown.active").forEach(e=>{e!==i&&e.classList.remove("active")}),i.classList.toggle("active"))}closeAllMenus(){this.document.querySelectorAll(".dropdown.active").forEach(e=>{e.classList.remove("active")})}async confirmResetApp(){confirm("Are you sure you want to reset the application? This will clear all profiles and data.")&&this.emit("app:reset-confirmed")}}class Et extends oe{constructor({eventBus:e,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="AboutModalUI",this.document=t}onInit(){this.setupEventListeners(),this.populateAboutContent()}setupEventListeners(){this.eventListenersSetup||(this.eventListenersSetup=!0,this.eventBus.on("about:show",()=>{this.showAboutModal()}),this.eventBus.on("modal:regenerated",({modalId:e})=>{"aboutModal"===e&&this.populateAboutContent()}))}showAboutModal(){this.populateAboutContent(),this.emit("modal:show",{modalId:"aboutModal"})}populateAboutContent(){const t=this.document.getElementById("aboutVersion");t&&(t.textContent=` v${e}`)}}class $t extends oe{constructor({eventBus:e,document:t=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="ImportUI",this.document=t}onInit(){this.addEventListener("keybinds:import",()=>this.openFileDialog("keybinds")),this.addEventListener("aliases:import",()=>this.openFileDialog("aliases"))}async openFileDialog(e){const t=this.document.createElement("input");t.type="file",t.accept=".txt",t.style.display="none",this.document.body.appendChild(t),t.addEventListener("change",async i=>{if(!i.target.files||0===i.target.files.length)return;const a=i.target.files[0],s=new FileReader;s.onload=async i=>{try{const t=i.target.result,a=await this.request("data:get-current-state"),s=a.currentProfile;if("keybinds"===e){const e=await this.promptEnvironment(a.currentEnvironment||"space");if(!e)return;await this.request("import:keybind-file",{content:t,profileId:s,environment:e})}else await this.request("import:alias-file",{content:t,profileId:s})}catch(e){}this.document.body.removeChild(t)},s.readAsText(a)}),t.click()}promptEnvironment(e="space"){return new Promise(t=>{const i=this.document.createElement("div");i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.background="rgba(0,0,0,0.4)",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.zIndex="9999";const a=this.document.createElement("div");a.style.background="#fff",a.style.padding="20px",a.style.borderRadius="8px",a.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)",a.style.textAlign="center",a.innerHTML='<h3 style="margin-top:0">Select Environment</h3><p>Import keybinds into which environment?</p>';const s=this.createEnvButton("Space","space","space"===e),n=this.createEnvButton("Ground","ground","ground"===e),r=this.createEnvButton("Cancel",null);a.appendChild(s),a.appendChild(n),a.appendChild(r),i.appendChild(a),this.document.body.appendChild(i);const o=e=>{this.document.body.removeChild(i),t(e)};s.addEventListener("click",()=>o("space")),n.addEventListener("click",()=>o("ground")),r.addEventListener("click",()=>o(null))})}createEnvButton(e,t,i=!1){const a=this.document.createElement("button");return a.textContent=e,a.style.margin="6px",a.style.padding="8px 14px",a.style.border="none",a.style.borderRadius="4px",a.style.cursor="pointer",a.style.fontSize="14px",a.style.background=i?"#007bff":"#e0e0e0",a.style.color=i?"#fff":"#000",a}}class Ft extends oe{constructor({storage:e,ui:t,eventBus:i}={}){super(i),this.componentName="AliasBrowserService",this.storage=e,this.ui=t,this.currentProfileId=null,this.currentEnvironment="space",this.selectedAliasName=null,this.Ae=null,this.cache={currentProfile:null,currentEnvironment:"space",aliases:{},profile:null},this.eventBus&&(this.respond("alias:get-all",()=>this.getAliases()),this.respond("alias:select",async({name:e})=>await this.selectAlias(e)),this.addEventListener("alias:delete",({name:e}={})=>this.deleteAlias(e)),this.addEventListener("alias:duplicate",({from:e,to:t,name:i}={})=>{if(e&&t)return this.duplicateAlias(e,t);const a=i||e;return this.duplicateAlias(a)}),this.addEventListener("alias:create",({name:e,description:t=""}={})=>this.createAlias(e,t)))}async init(){super.init(),this.setupEventListeners()}onInit(){}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("aliases-changed",{aliases:this.cache.aliases}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{if(this.currentProfileId=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.selectedAliasName=null,this.Ae=null,this.updateCacheFromProfile(t),this.emit("aliases-changed",{aliases:this.cache.aliases}),"alias"===this.currentEnvironment&&!this.selectedAliasName){const e=Object.keys(this.cache.aliases);e.length&&this.selectAlias(e[0])}}),this.addEventListener("environment:changed",async e=>{const t="string"==typeof e?e:e?.environment;t&&("alias"===this.currentEnvironment&&this.selectedAliasName&&(this.Ae=this.selectedAliasName),this.currentEnvironment=t,this.cache.currentEnvironment=t,"alias"===t?await this.Ee():this.selectedAliasName=null)})}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.aliases=e.aliases||{})}async Ee(){const e=this.getProfile(),t=e?.selections?.alias,i=this.getAliases();if(t&&i[t])await this.selectAlias(t);else if(!this.selectedAliasName){const e=Object.keys(i);e.length>0&&(e.sort(),await this.selectAlias(e[0]))}}getProfile(){return this.cache.profile}getAliases(){return Object.fromEntries(Object.entries(this.cache.aliases||{}).filter(([e,t])=>"vfx-alias"!==t.type))}async selectAlias(e){this.selectedAliasName=e,await this.$e(e),this.emit("alias-selected",{name:e})}async $e(e){try{const t=this.getProfile();if(!t)return;await this.request("data:update-profile",{profileId:this.currentProfileId,properties:{selections:{...t.selections||{},alias:e}}})}catch(e){}}async createAlias(e,t=""){if(!this.getProfile())return!1;if(this.cache.aliases[e])return this.ui&&this.ui.showToast(Q.t("alias_already_exists",{name:e}),"error"),!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{aliases:{[e]:{description:t,commands:""}}}}),this.emit("alias-created",{name:e}),await this.selectAlias(e),!0}catch(e){return this.ui&&this.ui.showToast("Failed to create alias","error"),!1}}async deleteAlias(e){if(!this.cache.aliases[e])return!1;try{return await this.request("data:update-profile",{profileId:this.cache.currentProfile,delete:{aliases:[e]}}),this.selectedAliasName===e&&(this.selectedAliasName=null),this.emit("alias-deleted",{name:e}),!0}catch(e){return this.ui&&this.ui.showToast("Failed to delete alias","error"),!1}}async duplicateAlias(e,t=void 0){const i=this.cache.aliases[e];if(!i)return!1;try{let a=t?.trim();if(a){if(this.cache.aliases[a])return this.ui&&this.ui.showToast(Q.t("alias_name_in_use")||"Alias already exists","error"),!1;if(!/^[A-Za-z0-9_]+$/.test(a))return this.ui&&this.ui.showToast(Q.t("invalid_alias_name")||"Invalid alias name","error"),!1}else{let t=0;do{a=`${e}_copy${t||""}`,t++}while(this.cache.aliases[a])}return Tt(a)?(await this.request("data:update-profile",{profileId:this.cache.currentProfile,add:{aliases:{[a]:{description:i.description+" (copy)",commands:i.commands}}}}),this.emit("alias-created",{name:a}),await this.selectAlias(a),!0):(this.ui&&this.ui.showToast(Q.t("reserved_command_name")||"Reserved command name","error"),!1)}catch(e){return this.ui&&this.ui.showToast("Failed to duplicate alias","error"),!1}}getCurrentState(){return{selectedAliasName:this.selectedAliasName,currentProfileId:this.currentProfileId,currentEnvironment:this.currentEnvironment,cachedAliasSelection:this.Ae,aliases:this.getAliases()}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfileId=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.Ae=null,this.updateCacheFromProfile(e),this.emit("aliases-changed",{aliases:this.cache.aliases})}"AliasBrowserService"===e&&(this.selectedAliasName=t.selectedAliasName??this.selectedAliasName,this.Ae=t.cachedAliasSelection??this.Ae)}}}class Bt extends oe{constructor({i18n:e,eventBus:t=null}={}){super(t),this.componentName="CommandChainService",this.i18n=e,this.selectedKey=null,this.currentEnvironment="space",this.commands=[],this.currentProfile=null,this.cache={profile:null,keys:{},aliases:{},currentProfile:null,currentEnvironment:"space"},this.j=[],this.eventBus&&this.j.push(this.respond("command:set-stabilize",({name:e,stabilize:t})=>this.setStabilize(e,t)),this.respond("command:is-stabilized",({name:e})=>this.isStabilized(e)),this.respond("command-chain:clear",async({key:e})=>{try{return await this.clearCommandChain(e)}catch(e){throw e}}),this.respond("command-chain:is-stabilized",({name:e})=>this.isStabilized(e)))}onInit(){this.setupEventListeners()}setupEventListeners(){this.addEventListener("profile:updated",e=>{if(e?.profile&&e?.profileId){const t={...e.profile,id:e.profileId};this.updateCacheFromProfile(t),this.selectedKey&&this.refreshCommands()}}),this.addEventListener("profile:switched",e=>{this.currentProfile=e.profileId||e.profile||e.id,this.currentEnvironment=e.environment||"space",this.cache.currentProfile=this.currentProfile,this.cache.currentEnvironment=this.currentEnvironment,e.profile&&this.updateCacheFromProfile(e.profile),this.selectedKey=null}),this.addEventListener("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.currentEnvironment=t,this.cache.currentEnvironment=t,this.selectedKey&&this.refreshCommands())}),this.addEventListener("key-selected",async({key:e,name:t})=>{if("alias"===this.currentEnvironment)return;this.selectedKey=e||t||null;const i=await this.getCommandsForSelectedKey();this.emit("chain-data-changed",{commands:i})}),this.addEventListener("alias-selected",async({name:e})=>{if(!e)return;if("alias"!==this.currentEnvironment)return;this.selectedKey=e;const t=await this.getCommandsForSelectedKey();this.emit("chain-data-changed",{commands:t})}),this.addEventListener("command-added",async({command:e,key:t})=>{const i=await this.getCommandsForSelectedKey();this.emit("chain-data-changed",{commands:i})}),this.addEventListener("commandchain:edit",async({index:e})=>{if(void 0===e)return;const t=(await this.getCommandsForSelectedKey())[e];if(!t)return;let i;if(i="string"==typeof t?{command:t}:t.parameters?{...t,parameters:{...t.parameters}}:{...t},!i.parameters)try{const e=await this.request("parser:parse-command-string",{commandString:i.command,options:{generateDisplayText:!1}});e.commands&&e.commands[0]?.parameters&&(i.parameters=e.commands[0].parameters)}catch(e){}const a=await this.findCommandDefinition(i);a&&a.customizable?this.emit("parameter-command:edit",{index:e,command:i,commandDef:a,categoryId:a.categoryId||i.type,commandId:a.commandId}):"undefined"!=typeof stoUI&&stoUI.showToast&&stoUI.showToast(i.command||t,"info")}),this.addEventListener("commandchain:delete",async({index:e})=>{if(void 0!==e&&this.selectedKey)try{await this.request("command:delete",{key:this.selectedKey,index:e}),this.emit("chain-data-changed",{commands:await this.getCommandsForSelectedKey()})}catch(e){}}),this.addEventListener("commandchain:move",async({fromIndex:e,toIndex:t})=>{if(this.selectedKey)try{await this.request("command:move",{key:this.selectedKey,fromIndex:e,toIndex:t}),this.emit("chain-data-changed",{commands:await this.getCommandsForSelectedKey()})}catch(e){}}),this.addEventListener("command-chain:clear",async({key:e})=>{e&&await this.clearCommandChain(e)})}async getCommandsForSelectedKey(){try{return await this.request("command:get-for-selected-key")}catch(e){return Array.isArray(this.commands)?this.commands:[]}}async getEmptyStateInfo(){try{return await this.request("command:get-empty-state-info")}catch(e){return{title:"",preview:"",commandCount:0,icon:"",emptyTitle:"",emptyDesc:""}}}async findCommandDefinition(e){try{return await this.request("command:find-definition",{command:e})}catch(e){return null}}async getCommandWarning(e){try{return await this.request("command:get-warning",{command:e})}catch(e){return null}}async getCommandsForKey(e){try{if(!e)return[];const t=await this.getCurrentProfile();if(!t)return[];if("alias"===this.currentEnvironment){const i=t.aliases&&t.aliases[e];return i&&Array.isArray(i.commands)?[...i.commands]:[]}{const i=t.builds?.[this.currentEnvironment]?.keys?.[e];return Array.isArray(i)?[...i]:[]}}catch(e){return[]}}async clearCommandChain(e){try{if(!e)return!1;const t=await this.getCurrentProfile();if(!t)return!1;if("alias"===this.currentEnvironment)t.aliases&&t.aliases[e]&&(t.aliases[e].commands=[]);else{const i=t.builds?.[this.currentEnvironment]?.keys?.[e];i&&(t.builds[this.currentEnvironment].keys[e]=[])}const i=this.cache.currentProfile||this.currentProfile;if(!i)return!1;const a=await this.request("data:update-profile",{profileId:i,modify:"alias"===this.currentEnvironment?{aliases:{[e]:t.aliases[e]}}:{builds:{[this.currentEnvironment]:{keys:{[e]:t.builds[this.currentEnvironment].keys[e]}}}}});return!!a?.success&&(this.emit("command-chain-cleared",{key:e}),!0)}catch(e){return!1}}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.currentProfile=e.id,e.builds&&e.builds[this.currentEnvironment]&&(this.cache.keys=e.builds[this.currentEnvironment].keys||{}),e.aliases&&(this.cache.aliases=e.aliases))}getCurrentProfile(){return this.cache.profile?this.getCurrentBuild(this.cache.profile):null}getCurrentBuild(e){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[this.currentEnvironment]||(e.builds[this.currentEnvironment]={keys:{}}),e.builds[this.currentEnvironment].keys||(e.builds[this.currentEnvironment].keys={}),{...e,keys:e.builds[this.currentEnvironment].keys,aliases:e.aliases||{}}):null}async refreshCommands(){if(this.selectedKey){const e=await this.getCommandsForSelectedKey();this.emit("chain-data-changed",{commands:e})}}getCurrentState(){return{selectedKey:this.selectedKey,currentEnvironment:this.currentEnvironment,currentProfile:this.currentProfile,commands:this.commands}}handleInitialState(e,t){"DataCoordinator"===e&&t?.currentProfileData&&(this.updateCacheFromProfile(t.currentProfileData),this.currentProfile=t.currentProfile,this.currentEnvironment=t.currentEnvironment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.cache.currentProfile=this.cache.currentProfile||t.currentProfile)}destroy(){this.j&&(this.j.forEach(e=>e()),this.j=[]),super.destroy()}isStabilized(e){if(!e)return!1;const t=this.cache.profile||null;return!!t&&("alias"===this.currentEnvironment?!!(t.aliasMetadata&&t.aliasMetadata[e]&&t.aliasMetadata[e].stabilizeExecutionOrder):!!(t.keybindMetadata&&t.keybindMetadata[this.currentEnvironment]&&t.keybindMetadata[this.currentEnvironment][e]&&t.keybindMetadata[this.currentEnvironment][e].stabilizeExecutionOrder))}async setStabilize(e,t=!0){try{if(!e)return{success:!1};const i=this.cache.profile;if(!i)return{success:!1};const a="alias"===this.currentEnvironment;let s;if(a){const a={},n=i.aliasMetadata&&i.aliasMetadata[e]||{};a[e]={...n},t?a[e].stabilizeExecutionOrder=!0:(delete a[e].stabilizeExecutionOrder,0===Object.keys(a[e]).length&&(a[e]={})),s={aliasMetadata:a}}else{const a={};a[this.currentEnvironment]||(a[this.currentEnvironment]={});const n=i.keybindMetadata&&i.keybindMetadata[this.currentEnvironment]&&i.keybindMetadata[this.currentEnvironment][e]||{};a[this.currentEnvironment][e]={...n},t?a[this.currentEnvironment][e].stabilizeExecutionOrder=!0:(delete a[this.currentEnvironment][e].stabilizeExecutionOrder,0===Object.keys(a[this.currentEnvironment][e]).length&&(a[this.currentEnvironment][e]={})),s={keybindMetadata:a}}const n=this.cache.currentProfile||this.currentProfile;if(!n)return{success:!1};const r=await this.request("data:update-profile",{profileId:n,modify:s});return r?.success?(this.emit("stabilize-changed",{name:e,stabilize:t,isAlias:a}),this.emit("profile:updated",{profileId:n,profile:r.profile}),{success:!0}):{success:!1}}catch(e){return{success:!1,error:e.message}}}}class It extends oe{constructor({eventBus:e=o,ui:t=null,document:i=("undefined"!=typeof window?window.document:void 0)}={}){super(e),this.componentName="CommandChainUI",this.ui=t||("undefined"!=typeof stoUI?stoUI:null),this.document=i,this.pe=null,this.le="space"}async onInit(){this.pe=null,this._e=null,this.le="space",this.Fe=[],this.Fe.push(this.eventBus.on("chain-data-changed",({commands:e})=>{this.render(e)})),this.Fe.push(this.eventBus.on("environment:changed",e=>{const t="string"==typeof e?e:e?.environment;t&&(this.le=t,this.updateChainActions(),this.render())})),this.Fe.push(this.eventBus.on("key-selected",e=>{this.pe=e.key||e.name,this._e=null,this.updateChainActions()})),this.Fe.push(this.eventBus.on("alias-selected",e=>{this._e=e.name,this.pe=null,this.updateChainActions()})),this.Fe.push(this.eventBus.on("language:changed",()=>{this.render()}));const e=this.document.getElementById("stabilizeExecutionOrderBtn");e&&!this.Be&&(e.addEventListener("click",async()=>{await this.toggleStabilize()}),this.Be=!0),this.setupDragAndDrop(),this.updateChainActions()}async render(e=null){const t=this.document.getElementById("commandList"),i=this.document.getElementById("chainTitle"),a=this.document.getElementById("commandPreview"),s=this.document.getElementById("commandCount"),n=this.document.getElementById("emptyState");if(!t||!i||!a)return;let r=e;if(!r){if(!("alias"===this.le?this._e:this.pe)){const e=await this.request("command:get-empty-state-info");i.textContent=e.title,a.textContent=e.preview,s&&(s.textContent=e.commandCount);const n=this.document.createElement("div");return n.innerHTML=`\n            <div class="empty-state show" id="emptyState">\n              <i class="${e.icon}"></i>\n              <h4>${e.emptyTitle}</h4>\n              <p>${e.emptyDesc}</p>\n            </div>`,void t.replaceChildren(...n.children)}r=await this.request("command:get-for-selected-key")}const o=await this.request("command:get-empty-state-info"),c="alias"===this.le?this._e:this.pe;if(!c||0===r.length){i.textContent=o.title,a.textContent=o.preview,s&&(s.textContent=o.commandCount);const e=this.document.createElement("div");return e.innerHTML=`\n          <div class="empty-state ${c?"":"show"}" id="emptyState">\n            <i class="${o.icon}"></i>\n            <h4>${o.emptyTitle}</h4>\n            <p>${o.emptyDesc}</p>\n          </div>`,void t.replaceChildren(...e.children)}i.textContent=o.title,a.textContent=o.preview,s&&(s.textContent=r.length.toString()),n&&n.classList.remove("show");const l=[];for(let e=0;e<r.length;e++){const t=await this.createCommandElement(r[e],e,r.length);l.push(t)}t.replaceChildren(...l);try{const e=await this.request("command-chain:is-stabilized",{name:c}),t="alias"===this.le;this.emit("command-chain:validate",{key:c,stabilized:e,isAlias:t})}catch(e){}}async createCommandElement(e,t,i){const a=this.document.createElement("div")||{};a.dataset||(a.dataset={}),a.className="command-item-row",a.dataset.index=t,a.draggable=!0;const s="string"==typeof e?e:ye(e),n="undefined"!=typeof i18next?i18next:null,r=await fe(s,n,{eventBus:this.eventBus}),o=await this.request("command:find-definition",{command:s}),c=o&&o.customizable;let l=(e=>{if("string"==typeof e)return e;if("object"==typeof e&&e){if(e.key&&e.fallback){if("undefined"!=typeof i18next&&i18next.t){const t=i18next.t(e.key,e.params||{});if(t&&t!==e.key)return t}return e.fallback}if(e.fallback)return e.fallback;if(e.text)return e.text;const t=e.name||e.displayText;if(t)return t}return s})(r.displayText)||r.text||s,d=r.icon;c&&(a.dataset.parameters="true",a.classList.add("customizable"),a.addEventListener("dblclick",e=>{this.emit("commandchain:edit",{index:t})}));const m=await this.request("command:get-warning",{command:s});let h=null;if(m)try{const e=await this.request("i18n:translate",{key:m});h=e&&e!==m?e:m}catch{h=m}const u=h?`<span class="command-warning-icon" title="${h}" data-i18n-title="${m}"><i class="fas fa-exclamation-triangle"></i></span>`:"",p=c?' <span class="param-indicator" title="Editable parameters">⚙️</span>':"";let _=r.type||r.category;o&&o.categoryId&&!["vfx-alias","alias"].includes(r.type)&&!["vfx-alias","alias"].includes(r.category)&&(_=o.categoryId),a.innerHTML=`\n      <div class="command-number">${t+1}</div>\n      <div class="command-content">\n        <span class="command-icon">${d}</span>\n        <span class="command-text">${l}${p}</span>\n        ${u}\n      </div>\n      <span class="command-type ${_}">${_}</span>\n      <div class="command-actions">\n        <button class="btn btn-small-icon btn-edit" title="Edit Command"><i class="fas fa-edit"></i></button>\n        <button class="btn btn-small-icon btn-danger btn-delete" title="Delete Command"><i class="fas fa-times"></i></button>\n        <button class="btn btn-small-icon btn-up" title="Move Up" ${0===t?"disabled":""}><i class="fas fa-chevron-up"></i></button>\n        <button class="btn btn-small-icon btn-down" title="Move Down" ${t===i-1?"disabled":""}><i class="fas fa-chevron-down"></i></button>\n      </div>`;const f=a.querySelector(".btn-edit"),y=a.querySelector(".btn-delete"),g=a.querySelector(".btn-up"),b=a.querySelector(".btn-down");return f&&(f.id=`edit-btn-${t}`,f.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.emit("commandchain:edit",{index:t})})),y&&(y.id=`delete-btn-${t}`,y.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.emit("commandchain:delete",{index:t})})),g&&g.addEventListener("click",()=>{this.emit("commandchain:move",{fromIndex:t,toIndex:t-1})}),b&&b.addEventListener("click",()=>{this.emit("commandchain:move",{fromIndex:t,toIndex:t+1})}),a}setupDragAndDrop(){if(!this.ui||"function"!=typeof this.ui.initDragAndDrop)return;const e=this.document.getElementById("commandList");e&&this.ui.initDragAndDrop(e,{draggableSelector:".command-item-row",dropZoneSelector:".command-item-row",onDrop:(e,t,i)=>{if(!t?.dragElement||!i)return;const a=parseInt(t.dragElement.dataset.index),s=parseInt(i.dataset.index);a===s||Number.isNaN(a)||Number.isNaN(s)||this.emit("commandchain:move",{fromIndex:a,toIndex:s})}})}async updateChainActions(){const e=!!("alias"===this.le?this._e:this.pe),t=this.document.getElementById("stabilizeExecutionOrderBtn");if(t)if(t.disabled=!e,e){const e="alias"===this.le?this._e:this.pe;try{const i=await this.request("command:is-stabilized",{name:e});t.classList.toggle("active",!!i)}catch{}}else t.classList.remove("active");if("alias"===this.le){["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(t=>{const i=this.document.getElementById(t);i&&(i.disabled=!e)});const t=this.document.getElementById("addCommandBtn");t&&(t.disabled=!e);const i=this.document.getElementById("importFromKeyOrAliasBtn");i&&(i.disabled=!e),["deleteKeyBtn","duplicateKeyBtn"].forEach(e=>{const t=this.document.getElementById(e);t&&(t.disabled=!0)})}else["addCommandBtn","importFromKeyOrAliasBtn","deleteKeyBtn","duplicateKeyBtn"].forEach(t=>{const i=this.document.getElementById(t);i&&(i.disabled=!e)}),["deleteAliasChainBtn","duplicateAliasChainBtn"].forEach(e=>{const t=this.document.getElementById(e);t&&(t.disabled=!0)})}async toggleStabilize(){const e="alias"===this.le?this._e:this.pe;if(!e)return;const t=this.document.getElementById("stabilizeExecutionOrderBtn"),i=t?.classList.contains("active");try{const a=await this.request("command:set-stabilize",{name:e,stabilize:!i});a&&a.success&&t&&(t.classList.toggle("active",!i),this.render())}catch(e){}}destroy(){this.Fe&&(this.Fe.forEach(e=>{if("function"==typeof e)try{e()}catch(e){}}),this.Fe=[])}handleInitialState(e,t){if(t&&(t.environment||t.currentEnvironment)){const e=t.environment||t.currentEnvironment;this.le=e,this.updateChainActions()}}}class Pt extends oe{constructor({storage:e,profileService:t,ui:i}={}){super(o),this.componentName="KeyBrowserService",this.storage=e,this.profileService=t||null,this.ui=i,this.currentProfileId=null,this.currentEnvironment="space",this.selectedKeyName=null,this.Ie={space:null,ground:null},this.cache={currentProfile:null,currentEnvironment:"space",keys:{},builds:{space:{keys:{}},ground:{keys:{}}},profile:null},this.eventBus&&(this.respond("key:get-all",()=>this.getKeys()),this.respond("key:get-profile",()=>this.getProfile()),this.respond("key:select",({key:e})=>this.selectKey(e)))}async init(){super.init(),this.setupEventListeners()}onInit(){}setupEventListeners(){this.addEventListener("profile:updated",({profileId:e,profile:t})=>{e===this.cache.currentProfile&&(this.updateCacheFromProfile(t),this.emit("key:list-changed",{keys:this.getKeys()}))}),this.addEventListener("profile:switched",({profileId:e,profile:t,environment:i})=>{this.currentProfileId=e,this.cache.currentProfile=e,i&&(this.currentEnvironment=i,this.cache.currentEnvironment=i),this.selectedKeyName=null,this.Ie={space:null,ground:null},this.updateCacheFromProfile(t),this.emit("key:list-changed",{keys:this.getKeys()})}),this.addEventListener("environment:changed",async e=>{const t="string"==typeof e?e:e?.environment;t&&("alias"!==this.currentEnvironment&&this.selectedKeyName&&(this.Ie[this.currentEnvironment]=this.selectedKeyName),this.currentEnvironment=t,this.cache.currentEnvironment=t,this.selectedKeyName=null,this.cache.keys=this.cache.builds[t]?.keys||{},"alias"!==t&&await this.Pe(t),this.emit("key:list-changed",{keys:this.getKeys()}))}),this.addEventListener("profile-modified",()=>{this.emit("key:list-changed",{keys:this.getKeys()})}),this.addEventListener("keys:changed",({keys:e})=>{this.cache.keys=e||{},this.emit("key:list-changed",{keys:this.getKeys()})})}updateCacheFromProfile(e){e&&(this.cache.profile=e,this.cache.builds=e.builds||{space:{keys:{}},ground:{keys:{}}},this.cache.keys=this.cache.builds[this.cache.currentEnvironment]?.keys||{})}async Pe(e){const t=this.getProfile(),i=t?.selections?.[e],a=this.getKeys();if(i&&a[i])return void this.selectKey(i);const s=Object.keys(a);s.length>0&&(s.sort(),this.selectKey(s[0]))}getProfile(){return this.cache.profile}getKeys(){return this.cache.keys||{}}async selectKey(e){return this.selectedKeyName===e||(this.selectedKeyName=e,await this.De(e),this.emit("key-selected",{key:e,name:e}),"undefined"!=typeof window&&window.app&&(window.app.renderKeyGrid&&window.app.renderKeyGrid(),window.app.updateChainActions&&window.app.updateChainActions())),e}async De(e){try{const t=this.getProfile();if(!t||!this.currentEnvironment||"alias"===this.currentEnvironment)return;const i={...t.selections||{},[this.currentEnvironment]:e},{request:a}=await Promise.resolve().then(function(){return re});await this.request("data:update-profile",{profileId:this.currentProfileId,properties:{selections:i}})}catch(e){}}getValidKeys(){if(this.je)return this.je;const e=new Set;for(let t=1;t<=12;t++)e.add(`F${t}`);for(let t=0;t<=9;t++)e.add(t.toString());for(let t=65;t<=90;t++)e.add(String.fromCharCode(t));["Space","Tab","Enter","Escape","Backspace","Delete","Insert","Home","End","PageUp","PageDown","Up","Down","Left","Right","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","NumPadEnter","NumPadPlus","NumPadMinus","NumPadMultiply","NumPadDivide","Button4","Button5","Button6","Button7","Button8","Lbutton","Rbutton","Mbutton","Leftdrag","Rightdrag","Middleclick","Mousechord","Wheelplus","Wheelminus","Semicolon","Equals","Comma","Minus","Period","Slash","Grave","LeftBracket","Backslash","RightBracket","Quote","[","]"].forEach(t=>e.add(t));const t=Array.from(e);return["Ctrl","Alt","Shift","Control"].forEach(i=>t.forEach(t=>e.add(`${i}+${t}`))),this.je=Array.from(e).sort(),this.je}getCurrentState(){return{selectedKeyName:this.selectedKeyName,currentProfileId:this.currentProfileId,currentEnvironment:this.currentEnvironment,cachedSelections:{...this.Ie},keys:this.getKeys()}}handleInitialState(e,t){if(t){if("DataCoordinator"===e&&t.currentProfileData){const e=t.currentProfileData;this.currentProfileId=e.id,this.cache.currentProfile=e.id,this.currentEnvironment=e.environment||"space",this.cache.currentEnvironment=this.currentEnvironment,this.Ie={space:null,ground:null},this.updateCacheFromProfile(e),this.emit("key:list-changed",{keys:this.getKeys()})}"KeyBrowserService"===e&&(this.selectedKeyName=t.selectedKeyName??this.selectedKeyName,this.Ie={...this.Ie,...t.cachedSelections})}}}class Dt extends oe{constructor({ui:e=null,document:t=null}={}){super(o),this.componentName="PreferencesUI",this.ui=e,this.document=t||("undefined"!=typeof window?window.document:null),this.eventsSetup=!1,this.settingDefinitions={theme:{type:"select",element:"themeSelect"},language:{type:"select",element:"languageSelect"},autoSave:{type:"boolean",element:"autoSaveCheckbox"},compactView:{type:"boolean",element:"compactViewCheckbox"},autoSync:{type:"boolean",element:"autoSync"},autoSyncInterval:{type:"select",element:"autoSyncInterval"}}}async init(){await this.request("preferences:init"),this.populatePreferencesModal(),this.setupEventListeners()}setupEventListeners(){this.eventBus.on("preferences:show",()=>{this.showPreferences()}),this.eventBus.on("sync:folder-set",()=>{this.updateFolderDisplay()}),this.eventBus.on("preferences:changed",e=>{"autoSync"!==e.key&&"autoSyncInterval"!==e.key||this.notifyAutoSyncSettingsChanged()}),document.querySelectorAll(".category-item").forEach(e=>{o.onDom(e,"click","pref-cat",e=>{const t=e.currentTarget.dataset.category;this.switchCategory(t)})}),o.onDom("savePreferencesBtn","click","pref-save",()=>{this.saveAllSettings(!0)}),this.setupSettingControls();const e=document.getElementById("setSyncFolderBtn");e&&e.addEventListener("click",async()=>{if(window.stoSync?.setSyncFolder)try{await window.stoSync.setSyncFolder(!0)&&(await this.request("preferences:load-settings"),this.updateFolderDisplay())}catch(e){}})}setupSettingControls(){Object.entries(this.settingDefinitions).forEach(([e,t])=>{const i=document.getElementById(t.element);if(i)switch(t.type){case"boolean":o.onDom(i,"change",`pref-${e}`,t=>{this.updateSetting(e,t.target.checked)});break;case"select":o.onDom(i,"change",`pref-${e}`,t=>{this.updateSetting(e,t.target.value)})}})}switchCategory(e){document.querySelectorAll(".category-item").forEach(e=>e.classList.remove("active"));const t=document.querySelector(`[data-category="${e}"]`);t&&t.classList.add("active"),document.querySelectorAll(".settings-panel").forEach(e=>e.classList.remove("active"));const i=document.getElementById(`${e}-settings`);i&&i.classList.add("active")}async updateSetting(e,t){await this.setSetting(e,t),"syncFolderName"!==e&&"syncFolderPath"!==e||this.updateFolderDisplay()}updateUI(e,t){const i=this.settingDefinitions[e];if(!i)return;const a=document.getElementById(i.element);a&&("boolean"===i.type?a.checked=!!t:"select"===i.type&&(a.value=t))}async saveAllSettings(e=!0){await this.saveSettings()&&e&&this.ui?.showToast&&this.ui.showToast(Q.t("preferences_saved"),"success"),this.notifyAutoSyncSettingsChanged(),this.emit("modal:hide",{modalId:"preferencesModal"})}async showPreferences(){await this.request("preferences:load-settings");const e=await this.request("preferences:get-settings");Object.entries(e).forEach(([e,t])=>this.updateUI(e,t)),this.updateFolderDisplay(),this.emit("modal:show",{modalId:"preferencesModal"})}async populatePreferencesModal(){await this.request("preferences:load-settings"),this.updatePreferencesFromStorage(),this.setupPreferencesEventListeners()}async updateFolderDisplay(){const e=await this.request("preferences:get-settings"),{syncFolderName:t,syncFolderPath:i}=e,a=this.document.getElementById("currentSyncFolder");a&&(t?(a.textContent=t,a.removeAttribute("data-i18n")):(a.textContent=Q.t("no_folder_selected"),a.setAttribute("data-i18n","no_folder_selected")))}async notifyAutoSyncSettingsChanged(){this.emit("preferences:autosync-settings-changed")}async setSetting(e,t){await this.request("preferences:set-setting",{key:e,value:t}),this.updateUI(e,t)}async saveSettings(){return await this.request("preferences:save-settings")}updatePreferencesFromStorage(){}setupPreferencesEventListeners(){}toggleSettingsMenu(){const e=this.document.getElementById("settingsBtn"),t=e?.closest(".dropdown");t&&t.classList.toggle("active")}}class jt extends oe{constructor({eventBus:e=o}={}){super(e||o),this.eventBus||(this.eventBus=o),this.currentProfile=null}onInit(){this.setupEventListeners(),this.setupStateListeners()}setupEventListeners(){this.eventBus.onDom("exportKeybindsBtn","click","exportKeybinds",()=>{this.showExportOptions()}),this.eventBus.onDom("confirmExportBtn","click","export-confirm",()=>{this.performExport()}),this.eventBus.onDom("copyPreviewBtn","click","copyPreview",()=>{this.copyCommandPreview()})}setupStateListeners(){this.addEventListener("profile:switched",({profile:e}={})=>{this.currentProfile=e}),this.addEventListener("profile-updated",({profile:e}={})=>{this.currentProfile&&e&&this.currentProfile.id===e.id&&(this.currentProfile=e)})}showExportOptions(){this.currentProfile?this.emit("modal:show",{modalId:"exportModal"}):this.emit("toast:show",{message:Q.t("no_profile_selected_to_export"),type:"warning"})}populateExportModal(){const e=document.getElementById("exportModal");e&&"function"==typeof window.applyTranslations&&window.applyTranslations(e)}performExport(){if(!this.currentProfile)return void this.emit("toast:show",{message:Q.t("no_profile_selected_to_export"),type:"warning"});const e=document.getElementById("exportFormat")?.value||"sto_keybind",t=document.getElementById("exportEnvironment")?.value||this.currentProfile.currentEnvironment||"space";switch(e){case"sto_keybind":this.exportSTOKeybindFile(this.currentProfile,t);break;case"json_profile":this.exportJSONProfile(this.currentProfile,t);break;case"json_project":this.exportCompleteProject();break;case"csv_data":this.exportCSVData(this.currentProfile,t);break;case"html_report":this.exportHTMLReport(this.currentProfile,t);break;case"alias_file":this.exportAliases(this.currentProfile)}this.emit("modal:hide",{modalId:"exportModal"})}async exportSTOKeybindFile(e,t="space"){try{const i=await this.request("export:generate-keybind-file",{profile:e,options:{environment:t}}),a=await this.request("export:generate-filename",{profile:e,extension:"txt",environment:t});this.downloadFile(i,a,"text/plain"),this.emit("toast:show",{message:Q.t("keybind_file_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_keybind_file",{error:e.message}),type:"error"})}}async exportJSONProfile(e,t="space"){try{const i=await this.request("export:sanitize-profile",{profile:e}),a={version:STO_DATA.settings.version,exported:(new Date).toISOString(),type:"profile",profile:i},s=JSON.stringify(a,null,2),n=await this.request("export:generate-filename",{profile:e,extension:"json",environment:t});this.downloadFile(s,n,"application/json"),this.emit("toast:show",{message:Q.t("profile_exported_json"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_profile",{error:e.message}),type:"error"})}}async exportCompleteProject(){try{const e=await this.request("storage:get-all-data"),t={version:STO_DATA.settings.version,exported:(new Date).toISOString(),type:"project",data:e},i=JSON.stringify(t,null,2),a=`STO_Tools_Keybinds_Project_${(new Date).toISOString().split("T")[0]}.json`;this.downloadFile(i,a,"application/json"),this.emit("toast:show",{message:Q.t("complete_project_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_project",{error:e.message}),type:"error"})}}async exportCSVData(e,t="space"){try{const i=await this.request("export:generate-csv-data",{profile:e}),a=await this.request("export:generate-filename",{profile:e,extension:"csv",environment:t});this.downloadFile(i,a,"text/csv"),this.emit("toast:show",{message:Q.t("data_exported_csv"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_csv",{error:e.message}),type:"error"})}}async exportHTMLReport(e,t="space"){try{const i=await this.request("export:generate-html-report",{profile:e}),a=await this.request("export:generate-filename",{profile:e,extension:"html",environment:t});this.downloadFile(i,a,"text/html"),this.emit("toast:show",{message:Q.t("html_report_exported"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_html_report",{error:e.message}),type:"error"})}}async exportAliases(e){try{const t=await this.request("export:generate-alias-file",{profile:e}),i=await this.request("export:generate-alias-filename",{profile:e,extension:"txt"});this.downloadFile(t,i,"text/plain"),this.emit("toast:show",{message:Q.t("aliases_exported_successfully"),type:"success"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_aliases",{error:e.message}),type:"error"})}}async exportAllProfiles(){try{const e=(await this.request("storage:get-all-data")).profiles;if(!e||0===Object.keys(e).length)return void this.emit("toast:show",{message:Q.t("no_profiles_to_export"),type:"warning"});Object.values(e).forEach((e,t)=>{setTimeout(()=>this.exportSTOKeybindFile(e),100*t)}),this.emit("toast:show",{message:Q.t("exporting_profiles",{count:Object.keys(e).length}),type:"info"})}catch(e){this.emit("toast:show",{message:Q.t("failed_to_export_profiles",{error:e.message}),type:"error"})}}async copyCommandPreview(){const e=document.getElementById("commandPreview");if(e){if(!e.textContent.trim())try{const t=await this.request("command:get-chain-preview");t&&(e.textContent=t)}catch(e){}e.textContent.trim()?this.emit("ui:copy-to-clipboard",{text:e.textContent}):this.emit("toast:show",{message:Q.t("no_command_to_copy"),type:"warning"})}}downloadFile(e,t,i){const a=new Blob([e],{type:i}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}}class Nt extends oe{constructor({ui:e=null}={}){super(o),this.componentName="SyncUI",this.ui=e}init(){this.setupEventListeners()}setupEventListeners(){this.eventBus.on("sync:sync-now",()=>{this.performSync("manual")})}async performSync(e="manual"){this.ui?.showToast(Q.t("syncing"),"info"),await this.request("sync:sync-project",{source:e})}}class Mt{constructor(){this.store=tt,this.eventListeners=new Map,this.autoSyncManager=null,this.dataService=null,this.profileService=null,this.profileUI=null,this.aliasService=null,this.aliasUI=null,this.commandService=null,this.commandLibraryService=null,this.keyBrowserService=null,this.keyBrowserUI=null,this.commandUI=null,this.keyService=null,this.fileOperationsService=null,this.keyCaptureService=null,this.keyCaptureUI=null,this.importUI=null,this.projectManagementService=null}get currentMode(){return this.interfaceModeService?this.interfaceModeService.currentMode:this.store?.currentMode}set currentMode(e){this.store&&(this.store.currentMode=e),this.interfaceModeService&&(this.interfaceModeService.currentMode=e)}get undoStack(){return(this&&this.store?this.store:tt).undoStack}set undoStack(e){(this&&this.store?this.store:tt).undoStack=e}get redoStack(){return(this&&this.store?this.store:tt).redoStack}set redoStack(e){(this&&this.store?this.store:tt).redoStack=e}get maxUndoSteps(){return(this&&this.store?this.store:tt).maxUndoSteps}set maxUndoSteps(e){(this&&this.store?this.store:tt).maxUndoSteps=e}get commandIdCounter(){return(this&&this.store?this.store:tt).commandIdCounter}set commandIdCounter(e){(this&&this.store?this.store:tt).commandIdCounter=e}async init(){try{if("undefined"==typeof storageService||"undefined"==typeof stoUI)throw new Error("Required dependencies not loaded");this.modalManagerService=new Me(o),this.modalManagerService.init();const e=this.modalManagerService;if(this.stoCommandParser=new wt(o),window.stoCommandParser=this.stoCommandParser,this.dataService=window.dataService,!this.dataService)throw new Error("DataService not available - it should be initialized in main.js before app.init()");this.profileService=new he({storage:storageService,eventBus:o,i18n:i18next});try{this.profileUI=new it({service:this.profileService,eventBus:o,ui:stoUI,modalManager:e,document:document})}catch(e){throw e}this.aliasBrowserService=new Ft({storage:storageService,ui:stoUI,eventBus:o}),this.aliasBrowserService.init(),this.aliasBrowserUI=new Ct({eventBus:o,modalManager:e,document:document}),this.aliasBrowserUI.init(),this.keyBrowserService=new Pt({storage:storageService,profileService:this.profileService,ui:stoUI}),this.keyBrowserUI=new bt({service:this.keyBrowserService,eventBus:o,document:document,modalManager:e}),this.keyService=new Ae({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI}),this.keyService.init(),this.importService=new Be({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI}),this.importService.init(),this.exportService=new Pe({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI}),this.exportService.init(),this.exportUI=new jt({eventBus:o}),this.exportUI.init(),this.keyCaptureService=new Ne({eventBus:o}),this.keyCaptureService.init(),this.keyCaptureUI=new yt({eventBus:o,modalManager:e,document:document}),this.keyCaptureUI.init(),this.commandService=new ve({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI}),this.commandService.init(),this.commandLibraryService=new _e({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI,modalManager:e}),this.commandLibraryUI=new ct({service:this.commandLibraryService,eventBus:o,ui:stoUI,modalManager:e,document:document}),this.commandChainService=new Bt({eventBus:o,i18n:i18next}),this.commandChainUI=new It({eventBus:o,ui:stoUI,document:document}),this.parameterCommandUI=new ot({eventBus:o,modalManager:e,i18n:i18next,ui:stoUI}),this.commandUI=new lt({eventBus:o,ui:stoUI,modalManager:e,parameterCommandUI:this.parameterCommandUI}),this.headerMenuUI=new At({eventBus:o,document:document}),this.syncUI=new Nt({ui:stoUI}),this.aboutModalUI=new Et({eventBus:o,document:document}),this.interfaceModeService=new ke({eventBus:o,storage:storageService,profileService:this.profileService,app:this}),this.interfaceModeUI=new dt({eventBus:o,ui:stoUI,profileUI:this.profileUI,document:document}),this.profileService.init(),await this.profileService.loadData(),this.commandLibraryService&&this.profileService&&(this.commandLibraryService.currentProfile=this.profileService.getCurrentProfileId()),window.stoAliases=this.aliasBrowserUI,this.aliasBrowserService.init(),this.aliasBrowserUI.init(),this.commandLibraryService.init(),this.commandLibraryUI.init(),this.commandChainService.init(),this.commandChainUI.init(),this.keyBrowserService.init(),this.keyBrowserUI.init(),this.commandUI.init(),this.parameterCommandUI.init(),this.preferencesService=new ce({storage:storageService,eventBus:o,i18n:i18next,ui:stoUI}),this.preferencesUI=new Dt({service:this.preferencesService,ui:stoUI}),this.preferencesManager=this.preferencesUI,this.preferencesService.init(),this.preferencesUI.init(),this.vfxManagerService=new Oe(o),this.vfxManagerUI=new gt(o,e),this.vfxManagerService.init(),this.vfxManagerUI.init(),this.autoSyncManager=new me({eventBus:o,storage:storageService,syncManager:window.stoSync,ui:stoUI}),this.autoSyncManager.init(),this.profileUI.init();try{this.interfaceModeService.init()}catch(e){throw e}await new Promise(e=>setTimeout(e,10));try{this.headerMenuUI.onInit()}catch(e){throw e}try{this.syncUI.init()}catch(e){throw e}try{this.aboutModalUI.onInit()}catch(e){throw e}try{this.interfaceModeUI.init()}catch(e){throw e}this.profileUI.renderProfiles(),this.profileUI.updateProfileInfo(),this.checkAndShowWelcomeMessage(),stoUI.showToast(i18next.t("sto_tools_keybind_manager_loaded_successfully"),"success"),this.initialized=!0,o.emit("sto-app-ready",{app:this}),window.commandChainUI=this.commandChainUI,window.keyBrowserUI=this.keyBrowserUI,window.keyBrowserService=this.keyBrowserService,this.projectManagementService=new de({storage:storageService,ui:stoUI,exportManager:window.stoExport,i18n:i18next,app:this,eventBus:o}),this.importUI=new $t({eventBus:o,document:document}),this.importUI.init()}catch(e){throw"undefined"!=typeof stoUI&&stoUI.showToast&&stoUI.showToast("undefined"!=typeof i18next?i18next.t("failed_to_load_application"):"Failed to load application","error"),o.emit("sto-app-error",{error:e}),e}}generateCommandId(){return`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}isFirstTime(){return!localStorage.getItem("sto_keybind_manager_visited")}checkAndShowWelcomeMessage(){this.isFirstTime()&&(localStorage.setItem("sto_keybind_manager_visited","true"),"undefined"!=typeof modalManager&&modalManager.show("aboutModal"))}}const Ot=new class extends oe{constructor({eventBus:e=o,storageKey:t="sto_keybind_manager",backupKey:i="sto_keybind_manager_backup",settingsKey:a="sto_keybind_settings",version:s="1.0.0",dataService:n=null,data:r={}}={}){super(e),this.componentName="StorageService",this.storageKey=t,this.backupKey=i,this.settingsKey=a,this.version=s,this.dataService=n,this.data=r||{}}onInit(){this.migrateData(),this.ensureStorageStructure(),this.emit("storage:ready",{service:this})}getAllData(e=!1){if(!e&&this.Ne)return this.Ne;try{const e=localStorage.getItem(this.storageKey),t=localStorage.getItem("sto_app_reset");if(!e)return t?(localStorage.removeItem("sto_app_reset"),this.getEmptyData()):this.getDefaultData();const i=JSON.parse(e);return this.isValidDataStructure(i,!0)?(this.Ne=i,i):this.getDefaultData()}catch(e){const t=this.getDefaultData();return this.Ne=t,t}}saveAllData(e){try{this.createBackup();const t={...e,version:this.version,lastModified:(new Date).toISOString(),lastBackup:(new Date).toISOString()};return localStorage.setItem(this.storageKey,JSON.stringify(t)),this.Ne=t,this.emit("storage:data-changed",{data:t}),!0}catch(e){return!1}}getProfile(e){return this.getAllData().profiles[e]||null}saveProfile(e,t){const i=this.getAllData(!0);return i.profiles[e]={...t,lastModified:(new Date).toISOString()},this.saveAllData(i)}deleteProfile(e){const t=this.getAllData();if(t.profiles[e]){if(delete t.profiles[e],t.currentProfile===e){const e=Object.keys(t.profiles);t.currentProfile=e.length>0?e[0]:null}return this.saveAllData(t)}return!1}getSettings(){try{const e=localStorage.getItem(this.settingsKey);if(!e)return this.getDefaultSettings();const t=JSON.parse(e);return{...this.getDefaultSettings(),...t}}catch(e){return this.getDefaultSettings()}}saveSettings(e){try{const t={...this.getSettings(),...e};return localStorage.setItem(this.settingsKey,JSON.stringify(t)),this.emit("storage:settings-changed",{settings:t}),!0}catch(e){return!1}}createBackup(){try{const e=localStorage.getItem(this.storageKey);if(e){const t={data:e,timestamp:(new Date).toISOString(),version:this.version};localStorage.setItem(this.backupKey,JSON.stringify(t)),this.emit("storage:backup-created",{backup:t})}}catch(e){}}restoreFromBackup(){try{const e=localStorage.getItem(this.backupKey);if(e){const t=JSON.parse(e);return localStorage.setItem(this.storageKey,t.data),this.emit("storage:backup-restored",{backup:t}),!0}}catch(e){}return!1}exportData(){const e=this.getAllData();return JSON.stringify(e,null,2)}importData(e){try{const t=JSON.parse(e);if(!this.isValidDataStructure(t))return!1;const i=this.saveAllData(t);return i&&this.emit("storage:data-imported",{data:t}),i}catch(t){return t instanceof SyntaxError&&e.includes("invalid"),!1}}clearAllData(){try{return localStorage.removeItem(this.storageKey),localStorage.removeItem(this.backupKey),localStorage.removeItem(this.settingsKey),localStorage.setItem("sto_app_reset","true"),this.emit("storage:data-cleared"),!0}catch(e){return!1}}getStorageInfo(){try{const e=localStorage.getItem(this.storageKey)?.length||0,t=localStorage.getItem(this.backupKey)?.length||0,i=localStorage.getItem(this.settingsKey)?.length||0;return{totalSize:e+t+i,dataSize:e,backupSize:t,settingsSize:i,available:this.getAvailableStorage()}}catch(e){return null}}getDefaultData(){return{version:this.version,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),currentProfile:null,profiles:{},globalAliases:{},settings:this.getDefaultSettings()}}getEmptyData(){return{version:this.version,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),currentProfile:null,profiles:{},globalAliases:{},settings:this.getDefaultSettings()}}getDefaultSettings(){return{theme:"default",autoSave:!0,showTooltips:!0,confirmDeletes:!0,maxUndoSteps:50,defaultMode:"space",compactView:!1,language:this.detectBrowserLanguage(),syncFolderName:null,syncFolderPath:null,autoSync:!1,autoSyncInterval:"change"}}detectBrowserLanguage(){try{if("undefined"==typeof navigator)return"en";const e=navigator.languages&&navigator.languages[0]||navigator.language;if(!e)return"en";const t=e.toLowerCase().split(/[-_]/)[0];return["en","de","es","fr"].includes(t)?t:"en"}catch(e){return"en"}}isValidDataStructure(e,t=!1){if(!e||"object"!=typeof e)return!1;const i=["profiles","currentProfile"];for(const t of i)if(!(t in e))return!1;if("object"!=typeof e.profiles)return!1;for(const[i,a]of Object.entries(e.profiles)){const e=this.isValidProfile(a),i=t&&this.needsProfileMigration(a);if(!e&&!i)return!1}return!0}isValidProfile(e){if(!e||"object"!=typeof e)return!1;if(!e.name)return!1;if(e.builds&&"object"==typeof e.builds){const t=e.builds;if(!t.space&&!t.ground)return!1;for(const[e,i]of Object.entries(t))if("space"===e||"ground"===e){if(!i||"object"!=typeof i)return!1;if(!i.keys||"object"!=typeof i.keys)return!1}return!0}return!(!e.mode||!e.keys||"object"!=typeof e.keys)}ensureStorageStructure(){const e=this.getAllData();e.globalAliases||(e.globalAliases={}),e.settings||(e.settings=this.getDefaultSettings()),Object.keys(e.profiles).length>0&&!e.profiles[e.currentProfile]&&(e.currentProfile=Object.keys(e.profiles)[0]),this.saveAllData(e)}migrateData(){const e=this.getAllData();let t=!1;e.version!==this.version&&(t=!0);for(const[i,a]of Object.entries(e.profiles))this.needsProfileMigration(a)&&(e.profiles[i]=this.migrateProfile(a),t=!0);t&&(e.version=this.version,this.saveAllData(e))}needsProfileMigration(e){return!(!(e&&e.mode&&e.keys)||e.builds)}migrateProfile(e){const t={name:e.name,description:e.description||"",currentEnvironment:this.mapOldModeToEnvironment(e.mode),builds:{space:{keys:{}},ground:{keys:{}}},aliases:e.aliases||{},keybindMetadata:e.keybindMetadata||{},created:e.created||(new Date).toISOString(),lastModified:(new Date).toISOString()},i=this.mapOldModeToEnvironment(e.mode);if(t.builds[i].keys=e.keys||{},e.keybindMetadata&&"object"==typeof e.keybindMetadata){const a=e.keybindMetadata.space||e.keybindMetadata.ground;t.keybindMetadata=a?e.keybindMetadata:{[i]:e.keybindMetadata}}return t}mapOldModeToEnvironment(e){if(!e)return"space";const t=("string"==typeof e?e:String(e)).toLowerCase();return"ground"===t||"ground mode"===t?"ground":"space"}getAvailableStorage(){try{let e="storage_test",t="0",i=0,a=0,s=10485760;for(;a<=s;){let n=Math.floor((a+s)/2);t="0".repeat(n);try{localStorage.setItem(e,t),localStorage.removeItem(e),i=n,a=n+1}catch(e){s=n-1}}return i}catch(e){return 0}}loadDefaultData(){const e=this.getDefaultData();return this.saveAllData(e)}getCurrentState(){return{service:this,isReady:this.isInitialized()}}}({eventBus:o});Ot.init();const Kt=new class extends oe{constructor({eventBus:e,data:t=null}={}){super(e),this.componentName="DataService",this.data=t||{},this.responseHandlers=[]}onInit(){this.responseHandlers.push(this.respond("data:get-commands",()=>this.data.commands||{})),this.responseHandlers.push(this.respond("data:get-command-category",({categoryId:e})=>this.data.commands?.[e]||null)),this.responseHandlers.push(this.respond("data:get-command-definition",({categoryId:e,commandId:t})=>this.data.commands?.[e]?.commands?.[t]||null)),this.responseHandlers.push(this.respond("data:find-command-by-name",({command:e})=>{if(!this.data.commands||!e)return null;e.toLowerCase().includes("holster");for(const[t,i]of Object.entries(this.data.commands))if(i.commands)for(const[a,s]of Object.entries(i.commands))if(s.command===e)return e.toLowerCase().includes("holster"),{...s,categoryId:t,commandId:a};return e.toLowerCase().includes("holster"),null})),this.responseHandlers.push(this.respond("data:get-validation-patterns",()=>this.data.validation||{})),this.responseHandlers.push(this.respond("data:get-key-name-pattern",()=>this.data.validation?.keyNamePattern||/^[A-Za-z0-9_+]+$/)),this.responseHandlers.push(this.respond("data:get-alias-name-pattern",()=>this.data.validation?.aliasNamePattern||/^[A-Za-z0-9_]+$/)),this.responseHandlers.push(this.respond("data:has-commands",()=>!(!this.data||!this.data.commands))),this.responseHandlers.push(this.respond("data:get-tray-category",()=>this.data.commands?.tray||null)),this.responseHandlers.push(this.respond("data:get-communication-category",()=>this.data.commands?.communication||null)),this.responseHandlers.push(this.respond("data:get-combat-category",()=>this.data.commands?.combat||null)),this.responseHandlers.push(this.respond("data:get-default-profiles",()=>this.data.defaultProfiles||{})),this.responseHandlers.push(this.respond("data:get-default-profile",({profileId:e})=>this.data.defaultProfiles?.[e]||null))}onDestroy(){this.responseHandlers.forEach(e=>{"function"==typeof e&&e()}),this.responseHandlers=[]}updateData(e){this.data=e||{},this.emit("data:updated",{data:this.data})}getCurrentState(){return{defaultProfiles:this.data.defaultProfiles||{},hasCommands:!(!this.data||!this.data.commands),dataAvailable:Object.keys(this.data).length>0}}}({eventBus:o,data:"undefined"!=typeof globalThis?globalThis.STO_DATA:null});Kt.init();const zt=new class extends oe{constructor({eventBus:e,storage:t}){super(e),this.componentName="DataCoordinator",this.storage=t,this.state={currentProfile:null,currentEnvironment:"space",profiles:{},settings:{},metadata:{lastModified:null,version:"1.0.0"}},this.setupRequestHandlers()}async init(){super.init(),await this.loadInitialState()}setupRequestHandlers(){this.respond("data:get-current-state",()=>this.getCurrentState()),this.respond("data:get-all-profiles",()=>this.getAllProfiles()),this.respond("data:get-current-profile",()=>this.getCurrentProfile()),this.respond("data:switch-profile",({profileId:e})=>this.switchProfile(e)),this.respond("data:create-profile",({name:e,description:t,mode:i})=>this.createProfile(e,t,i)),this.respond("data:clone-profile",({sourceId:e,newName:t})=>this.cloneProfile(e,t)),this.respond("data:rename-profile",({profileId:e,newName:t,description:i})=>this.renameProfile(e,t,i)),this.respond("data:delete-profile",({profileId:e})=>this.deleteProfile(e)),this.respond("data:update-profile",(e={})=>{const{profileId:t,updates:i}=e||{};let a=i;if(!a){const{add:t,delete:i,modify:s,properties:n}=e;(t||i||s||n)&&(a={add:t,delete:i,modify:s,properties:n})}return!e.updateSource||a&&a.updateSource||(a||(a={}),a.updateSource=e.updateSource),this.updateProfile(t,a)}),this.respond("data:set-environment",({environment:e})=>this.setEnvironment(e)),this.respond("data:get-settings",()=>this.getSettings()),this.respond("data:update-settings",({settings:e})=>this.updateSettings(e)),this.respond("data:load-default-data",()=>this.loadDefaultData()),this.respond("data:reload-state",()=>this.reloadState()),this.respond("data:get-keys",({environment:e}={})=>this.getKeys(e)),this.respond("data:get-key-commands",({environment:e,key:t}={})=>this.getKeyCommands(e,t))}async loadInitialState(){try{const e=this.storage.getAllData();if(this.state.currentProfile=e.currentProfile,this.state.profiles=e.profiles||{},this.state.settings=e.settings||{},await this.normalizeAllProfiles(),0===Object.keys(this.state.profiles).length&&(this.needsDefaultProfiles=!0,this.tryCreateDefaultProfiles()),!this.state.currentProfile&&Object.keys(this.state.profiles).length>0){this.state.currentProfile=Object.keys(this.state.profiles)[0];const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e)}this.state.currentProfile&&this.state.profiles[this.state.currentProfile]&&(this.state.currentEnvironment=this.state.profiles[this.state.currentProfile].currentEnvironment||"space"),this.state.metadata={lastModified:e.lastModified,version:e.version||"1.0.0"}}catch(e){throw e}}getCurrentState(){let e=null;if(this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const t=this.state.profiles[this.state.currentProfile];e=this.buildVirtualProfile(t,this.state.currentEnvironment),e.id=this.state.currentProfile}return{currentProfile:this.state.currentProfile,currentEnvironment:this.state.currentEnvironment,profiles:{...this.state.profiles},settings:{...this.state.settings},metadata:{...this.state.metadata},currentProfileData:e}}async getAllProfiles(){return{...this.state.profiles}}buildVirtualProfile(e,t){return e?(e.builds||(e.builds={space:{keys:{}},ground:{keys:{}}}),e.builds[t]||(e.builds[t]={keys:{}}),{...e,keys:e.builds[t].keys||{},aliases:e.aliases||{},keybindMetadata:e.keybindMetadata||{},aliasMetadata:e.aliasMetadata||{},environment:t}):null}async switchProfile(e){if(e===this.state.currentProfile){let e=null;if(this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const t=this.state.profiles[this.state.currentProfile];e=this.buildVirtualProfile(t,this.state.currentEnvironment)}return{success:!0,switched:!1,message:"Already on this profile",profile:e}}const t=this.state.profiles[e];if(!t)throw new Error(`Profile ${e} not found`);const i=this.state.currentProfile;this.state.currentProfile=e,this.state.currentEnvironment=t.currentEnvironment||"space";const a=this.storage.getAllData();a.currentProfile=e,await this.storage.saveAllData(a),this.state.metadata.lastModified=(new Date).toISOString();const s=this.buildVirtualProfile(t,this.state.currentEnvironment);return this.emit("profile:switched",{fromProfile:i,toProfile:e,profileId:e,profile:s,environment:this.state.currentEnvironment,timestamp:Date.now()}),{success:!0,switched:!0,profile:s,message:`Switched to ${t.name} (${this.state.currentEnvironment})`}}async createProfile(e,t="",i="space"){if(!e||!e.trim())throw new Error("Profile name is required");const a=this.generateProfileId(e);if(this.state.profiles[a])throw new Error(`Profile with name "${e}" already exists`);const s={name:e.trim(),description:t.trim(),currentEnvironment:i,builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(a,s),this.state.profiles[a]=s,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:created",{profileId:a,profile:s,timestamp:Date.now()}),{success:!0,profileId:a,profile:s,message:`Profile "${e}" created`}}async cloneProfile(e,t){if(!e||!t||!t.trim())throw new Error("Source profile ID and new name are required");const i=this.state.profiles[e];if(!i)throw new Error("Source profile not found");const a=this.generateProfileId(t);if(this.state.profiles[a])throw new Error(`Profile with name "${t}" already exists`);const s={...JSON.parse(JSON.stringify(i)),name:t.trim(),description:`Copy of ${i.name}`,created:(new Date).toISOString(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(a,s),this.state.profiles[a]=s,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:created",{profileId:a,profile:s,clonedFrom:e,timestamp:Date.now()}),{success:!0,profileId:a,profile:s,message:`Profile "${t}" created from "${i.name}"`}}async renameProfile(e,t,i=""){if(!e||!t||!t.trim())throw new Error("Profile ID and new name are required");const a=this.state.profiles[e];if(!a)throw new Error("Profile not found");const s={...a,name:t.trim(),description:i.trim(),lastModified:(new Date).toISOString()};return await this.storage.saveProfile(e,s),this.state.profiles[e]=s,this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:updated",{profileId:e,profile:s,changes:{name:t,description:i},timestamp:Date.now()}),{success:!0,profile:s,message:`Profile renamed to "${t}"`}}async deleteProfile(e){if(!e)throw new Error("Profile ID is required");const t=this.state.profiles[e];if(!t)throw new Error("Profile not found");if(Object.keys(this.state.profiles).length<=1)throw new Error("Cannot delete the last profile");await this.storage.deleteProfile(e),delete this.state.profiles[e];let i=null;if(this.state.currentProfile===e){const t=Object.keys(this.state.profiles);this.state.currentProfile=t[0];const a=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=a.currentEnvironment||"space";const s=this.storage.getAllData();s.currentProfile=this.state.currentProfile,await this.storage.saveAllData(s),i=this.buildVirtualProfile(a,this.state.currentEnvironment),this.emit("profile:switched",{fromProfile:e,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:i,environment:this.state.currentEnvironment,timestamp:Date.now()})}return this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profile:deleted",{profileId:e,profile:t,switchedProfile:i,timestamp:Date.now()}),{success:!0,deletedProfile:t,switchedProfile:i,message:`Profile "${t.name}" deleted`}}processUpdateOperations(e,t){const i=JSON.parse(JSON.stringify(e));if(t.delete&&(t.delete.aliases&&t.delete.aliases.forEach(e=>{i.aliases&&delete i.aliases[e]}),t.delete.builds))for(const[e,a]of Object.entries(t.delete.builds))i.builds?.[e]?.keys&&a.keys&&a.keys.forEach(t=>{delete i.builds[e].keys[t]});if(t.add&&(t.add.aliases&&(i.aliases={...i.aliases||{},...t.add.aliases}),t.add.builds)){i.builds=i.builds||{space:{keys:{}},ground:{keys:{}}};for(const[e,a]of Object.entries(t.add.builds))i.builds[e]=i.builds[e]||{keys:{}},a.keys&&(i.builds[e].keys={...i.builds[e].keys||{},...a.keys})}if(t.modify){if(t.modify.aliases){i.aliases=i.aliases||{};for(const[e,a]of Object.entries(t.modify.aliases))i.aliases[e]&&(i.aliases[e]={...i.aliases[e],...a})}if(t.modify.keybindMetadata){i.keybindMetadata=i.keybindMetadata||{};for(const[e,a]of Object.entries(t.modify.keybindMetadata)){i.keybindMetadata[e]=i.keybindMetadata[e]||{};for(const[t,s]of Object.entries(a))0===Object.keys(s).length?delete i.keybindMetadata[e][t]:i.keybindMetadata[e][t]=s}}if(t.modify.aliasMetadata){i.aliasMetadata=i.aliasMetadata||{};for(const[e,a]of Object.entries(t.modify.aliasMetadata))0===Object.keys(a).length?delete i.aliasMetadata[e]:i.aliasMetadata[e]=a}if(t.modify.builds){i.builds=i.builds||{space:{keys:{}},ground:{keys:{}}};for(const[e,a]of Object.entries(t.modify.builds))if(i.builds[e]=i.builds[e]||{keys:{}},a.keys){i.builds[e].keys=i.builds[e].keys||{};for(const[t,s]of Object.entries(a.keys))i.builds[e].keys[t]&&(i.builds[e].keys[t]=s)}}}return t.properties&&Object.assign(i,t.properties),i}async updateProfile(e,t){if(!e||!t)throw new Error("Profile ID and updates are required");const i=this.state.profiles[e];if(!i)throw new Error(`Profile ${e} not found`);const{updateSource:a,...s}=t;if(!(s.add||s.delete||s.modify||s.properties))throw new Error("Explicit operations (add/delete/modify/properties) required");const n=this.processUpdateOperations(i,{...s,properties:{...s.properties||{},lastModified:(new Date).toISOString()}});return await this.storage.saveProfile(e,n),this.state.profiles[e]=n,this.state.metadata.lastModified=(new Date).toISOString(),!!(s.add||s.delete||s.modify)&&this.emit("profile:updated",{profileId:e,profile:n,updates:s,updateSource:a,timestamp:Date.now()}),{success:!0,profile:n}}async setEnvironment(e){if(!e||!["space","ground","alias"].includes(e))throw new Error("Invalid environment");const t=this.state.currentEnvironment;if(this.state.currentEnvironment=e,this.state.currentProfile){const t={properties:{currentEnvironment:e}};await this.updateProfile(this.state.currentProfile,t)}return this.emit("environment:changed",{fromEnvironment:t,toEnvironment:e,environment:e,timestamp:Date.now()}),{success:!0,environment:e}}getKeys(e){if(!this.state.currentProfile)return{};const t=this.state.profiles[this.state.currentProfile];return t&&t.builds&&t.builds[e]&&t.builds[e].keys||{}}getKeyCommands(e,t){return this.getKeys(e)[t]||[]}async getSettings(){return{...this.state.settings}}async updateSettings(e){if(!e)throw new Error("Settings are required");return this.state.settings={...this.state.settings,...e},await this.storage.saveSettings(this.state.settings),this.state.metadata.lastModified=(new Date).toISOString(),this.emit("settings:changed",{settings:this.state.settings,updates:e,timestamp:Date.now()}),{success:!0,settings:this.state.settings}}async loadDefaultData(){try{const e=await this.request("data:get-default-profiles");return e&&0!==Object.keys(e).length?(await this.createDefaultProfilesFromData(e),{success:!0,profilesCreated:Object.keys(e).length,currentProfile:this.state.currentProfile}):{success:!1,error:"No default profiles available"}}catch(e){return{success:!1,error:e.message}}}async tryCreateDefaultProfiles(){if(this.needsDefaultProfiles)try{const e=await this.request("data:get-default-profiles");e&&Object.keys(e).length>0&&(await this.createDefaultProfilesFromData(e),this.needsDefaultProfiles=!1)}catch(e){setTimeout(()=>this.tryCreateDefaultProfiles(),100)}}async handleInitialState(e,t){"DataService"===e&&this.needsDefaultProfiles&&await this.tryCreateDefaultProfiles()}async createDefaultProfilesFromData(e){if(!e||0===Object.keys(e).length)return void await this.createFallbackProfiles();const t={};for(const[i,a]of Object.entries(e)){const e={name:a.name,description:a.description||"",currentEnvironment:a.currentEnvironment||"space",builds:a.builds||{space:{keys:{}},ground:{keys:{}}},aliases:a.aliases||{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()};Le(e),t[i]=e}for(const[e,i]of Object.entries(t))await this.storage.saveProfile(e,i),this.state.profiles[e]=i;let i=!1;if(!this.state.currentProfile&&Object.keys(t).length>0){this.state.currentProfile=Object.keys(t)[0],i=!0;const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e);const a=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=a.currentEnvironment||"space"}if(this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profiles:initialized",{profiles:this.state.profiles,currentProfile:this.state.currentProfile,timestamp:Date.now()}),i&&this.state.currentProfile){const e=this.state.profiles[this.state.currentProfile],t=this.buildVirtualProfile(e,this.state.currentEnvironment);this.emit("profile:switched",{fromProfile:null,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:t,environment:this.state.currentEnvironment,timestamp:Date.now()})}}async createFallbackProfiles(){const e={default_space:{name:"Default Space",description:"Basic space build profile",currentEnvironment:"space",builds:{space:{keys:{}},ground:{keys:{}}},aliases:{},created:(new Date).toISOString(),lastModified:(new Date).toISOString()}};for(const[t,i]of Object.entries(e))Le(i),await this.storage.saveProfile(t,i),this.state.profiles[t]=i;let t=!1;if(!this.state.currentProfile){this.state.currentProfile="default_space",t=!0;const e=this.storage.getAllData();e.currentProfile=this.state.currentProfile,await this.storage.saveAllData(e);const i=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=i.currentEnvironment||"space"}if(this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profiles:initialized",{profiles:this.state.profiles,currentProfile:this.state.currentProfile,timestamp:Date.now()}),t&&this.state.currentProfile){const e=this.state.profiles[this.state.currentProfile],t=this.buildVirtualProfile(e,this.state.currentEnvironment);this.emit("profile:switched",{fromProfile:null,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:t,environment:this.state.currentEnvironment,timestamp:Date.now()})}}generateProfileId(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").substring(0,50)}async normalizeAllProfiles(){for(const[e,t]of Object.entries(this.state.profiles))qe(t)&&(Le(t),await this.storage.saveProfile(e,t))}async reloadState(){try{const e=this.storage.getAllData();if(this.state.profiles=e.profiles||{},this.state.currentProfile=e.currentProfile||null,this.state.settings=e.settings||{},await this.normalizeAllProfiles(),this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const e=this.state.profiles[this.state.currentProfile];this.state.currentEnvironment=e.currentEnvironment||"space"}else this.state.currentEnvironment="space";if(this.state.metadata.lastModified=(new Date).toISOString(),this.emit("profiles:initialized",{profiles:this.state.profiles,currentProfile:this.state.currentProfile,timestamp:Date.now()}),this.state.currentProfile&&this.state.profiles[this.state.currentProfile]){const e=this.state.profiles[this.state.currentProfile],t=this.buildVirtualProfile(e,this.state.currentEnvironment);this.emit("profile:switched",{fromProfile:null,toProfile:this.state.currentProfile,profileId:this.state.currentProfile,profile:t,environment:this.state.currentEnvironment,timestamp:Date.now()})}return this.emit("environment:changed",{fromEnvironment:null,toEnvironment:this.state.currentEnvironment,environment:this.state.currentEnvironment,timestamp:Date.now()}),this.emit("settings:changed",{settings:this.state.settings,updates:this.state.settings,timestamp:Date.now()}),{success:!0,profiles:Object.keys(this.state.profiles).length,currentProfile:this.state.currentProfile,environment:this.state.currentEnvironment}}catch(e){return{success:!1,error:e.message}}}}({eventBus:o,storage:Ot});zt.init();const Lt=Ot.getSettings();(async()=>{function t(e=document){e.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n"),i=e.getAttribute("data-i18n-attr");if(!t)return;const a=Q.t(t);i?e.setAttribute(i,a):e.textContent=a}),e.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const t=e.getAttribute("data-i18n-placeholder");t&&e.setAttribute("placeholder",Q.t(t))}),e.querySelectorAll("[data-i18n-title]").forEach(e=>{const t=e.getAttribute("data-i18n-title");t&&e.setAttribute("title",Q.t(t))}),e.querySelectorAll("[data-i18n-alt]").forEach(e=>{const t=e.getAttribute("data-i18n-alt");t&&e.setAttribute("alt",Q.t(t))})}function i(){t();const i=document.getElementById("appVersion");i&&(i.textContent=e)}await Q.init({lng:Lt.language||"en",fallbackLng:"en",resources:{en:{translation:Y},de:{translation:ee},fr:{translation:te},es:{translation:ie}}}),window.i18next=Q,window.localizeCommandData&&window.localizeCommandData(),window.applyTranslations=t,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i();const a=new Ae,s=new Pe({storage:Ot,eventBus:o}),n=new Ee({eventBus:o,storage:Ot});n.init();const r=new je(o);new De({eventBus:o});const c={showToast:(e,t="info")=>o.emit("toast:show",{message:e,type:t}),confirm:(e,t)=>o.emit("confirm:show",{message:e,callback:t}),showModal:e=>o.emit("modal:show",{modalId:e}),hideModal:e=>o.emit("modal:hide",{modalId:e}),copyToClipboard:e=>o.emit("ui:copy-to-clipboard",{text:e}),initDragAndDrop:(e,t={})=>{r&&"function"==typeof r.initDragAndDrop?r.initDragAndDrop(e,t):o.emit("ui:init-drag-drop",{container:e,options:t})}};new Ye({eventBus:o,i18n:Q,ui:c}).init();const l=new et({eventBus:o,storage:Ot,exportManager:s,ui:c});l.init();const d=new Ce({storage:Ot,ui:c});Object.assign(window,{storageService:Ot,dataService:Kt,dataCoordinator:zt,stoKeybinds:a,stoExport:s,stoUI:c,stoFileExplorer:l,stoSync:d,eventBus:o,fileOpsService:n});const m=new Mt;if("function"!=typeof m.init);else try{const e=m.init();e&&"function"==typeof e.catch&&await e}catch(e){}o.on("sto-app-ready",()=>{a.init(),s.init(),l.isInitialized()||l.init(),document.getElementById("settingsBtn"),document.getElementById("settingsMenu"),document.getElementById("preferencesBtn")})})();
//# sourceMappingURL=bundle.js.map
